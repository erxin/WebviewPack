import{a,r as e,f as l,g as t,S as s,T as i,j as o,k as n,w as u,q as c,x as d,y as r,h as A,z as p,A as v,m as f,n as g,C as _,D as m,E as b,G as h,H as w,I as B,_ as x,J as y,M as U,N as C,O as k,d as I,Y as S,p as T,a0 as E,a1 as j,a2 as Q,U as R,a3 as G,$ as L,t as Y,F as O,a4 as D,B as M,a5 as X}from"./index-ed46b72b.js";import{i as H,g as J,a as N,b as z,d as F,e as Z,_ as K,c as V}from"./platform.1f125bf4.js";import{_ as q,a as P}from"./ti-button.8b389a70.js";const W=q({__name:"ti-layout-setserver",emits:["bind","focus","blur"],setup(E,{emit:j}){const{setUserInfo:Q}=a(),R=e({ip:"",port:"",device_id:"null",remark:""}),G=()=>{const a=f();R.value.ip=(null==a?void 0:a.ip)||g()||"127.0.0.1",R.value.port=(null==a?void 0:a.port)||"8080"},L=j;l((()=>{H()?R.value.device_id=J():t({success:a=>{R.value.device_id=a.deviceId}})}));const Y=()=>{L("focus")},O=()=>{L("blur")},D=a=>{R.value.remark=a},M=a=>{R.value.ip=a},X=a=>{R.value.port=a},F=e("");e([]);const Z=e(),K=e(!1),V=async()=>{var a;const e={...R.value};if(e.ip)if(e.port)try{const l=await _(m(`${null==e?void 0:e.ip}:${e.port}`),!0);1==parseInt(l.data.cashier.order_method.is_table_order)?(b(e),h(l.data.app_id),w(l.data.shop_supplier_id),B(null==(a=l.data)?void 0:a.currency),Q(l.data),x(R.value.device_id),setTimeout((()=>{K.value=!0}),150)):uni.showToast({title:p("桌台用餐方式已关闭，请联系管理员"),icon:"none"})}catch(l){-102!=l.code&&uni.showToast({title:p("绑定失败"),icon:"none"})}else uni.showToast({title:p("請輸入連接埠"),icon:"none"});else uni.showToast({title:p("請輸入伺服器位址"),icon:"none"})},q=a=>{K.value=!1,a&&(Z.value=a,F.value=a.table_no)},W=()=>{G(),F.value=y().table_no,Z.value=y()},$=async()=>{var a;const e={...R.value};if(e.ip)if(e.port)try{const l=await _(m(`${null==e?void 0:e.ip}:${e.port}`),!0);if(!Z.value)return void uni.showToast({title:p("請查找桌位"),icon:"none"});1==parseInt(l.data.cashier.order_method.is_table_order)?(b(e),h(l.data.app_id),w(l.data.shop_supplier_id),B(null==(a=l.data)?void 0:a.currency),x(R.value.device_id),setTimeout((()=>{aa()}),150)):uni.showToast({title:p("桌台用餐方式已关闭，请联系管理员"),icon:"none"})}catch(l){-102!=l.code&&uni.showToast({title:p("绑定失败"),icon:"none"})}else uni.showToast({title:p("請輸入連接埠"),icon:"none"});else uni.showToast({title:p("請輸入伺服器位址"),icon:"none"})},aa=async()=>{try{const a=await U({table_id:Z.value.table_id,key:R.value.device_id,device_remark:R.value.remark});C(Z.value),k({key:"machine_remark",data:R.value.remark}),k({key:"machine_id",data:R.value.device_id}),I({url:"/pages/index/index"}),uni.showToast({title:a.msg,icon:"none"})}catch(a){0===a.code?L("bind",a.msg):uni.showToast({title:a.msg,icon:"none"})}};return G(),(a,e)=>{const l=S,t=T,f=s(i("ti-input"),N),g=s(i("ti-button"),P),_=s(i("ti-layout-table-list"),z);return o(),n(t,null,{default:u((()=>[c(t,{class:"ti-item-input"},{default:u((()=>[c(t,{class:"ti-label-box"},{default:u((()=>[c(t,{class:"ti-label-left"},{default:u((()=>[c(l,{class:"ti-label-server"},{default:u((()=>[d(r(A(p)("當前機器ID")),1)])),_:1})])),_:1})])),_:1}),c(t,{class:"ti-input-box"},{default:u((()=>[c(f,{type:"text",clearable:!1,disabled:!0,value:R.value.device_id},null,8,["value"])])),_:1})])),_:1}),c(t,{class:"ti-item-input"},{default:u((()=>[c(t,{class:"ti-label-box"},{default:u((()=>[c(t,{class:"ti-label-left"},{default:u((()=>[c(l,{class:"ti-label-server"},{default:u((()=>[d(r(A(p)("機器備註(非必填)")),1)])),_:1})])),_:1})])),_:1}),c(t,{class:"ti-input-box"},{default:u((()=>[c(f,{type:"text",onInput:D,placeholder:A(p)("機器備註"),clearable:!1,maxlength:100,onFocus:Y,onBlur:O},null,8,["placeholder"])])),_:1})])),_:1}),c(t,{class:"ti-item-input"},{default:u((()=>[c(t,{class:"ti-label-box"},{default:u((()=>[c(t,{class:"ti-label-left"},{default:u((()=>[c(l,{class:"ti-label-server"},{default:u((()=>[d(r(A(p)("服務器連接地址")),1)])),_:1})])),_:1})])),_:1}),c(t,{class:"ti-input-box"},{default:u((()=>[c(f,{type:"text",onInput:M,placeholder:A(p)("伺服器位址"),value:R.value.ip,clearable:!1,onFocus:Y,onBlur:O},null,8,["placeholder","value"]),c(t,{class:"ti-colon"},{default:u((()=>[d(":")])),_:1}),c(t,{class:"ti-input-port"},{default:u((()=>[c(f,{type:"number",onInput:X,placeholder:A(p)("端口"),value:R.value.port,clearable:!1,onFocus:Y,onBlur:O},null,8,["placeholder","value"])])),_:1})])),_:1})])),_:1}),c(t,{class:"ti-bottom"},{default:u((()=>[c(g,{title:A(p)("重置"),onClick:W},null,8,["title"]),c(g,{title:A(p)("確定"),type:"primary",onClick:$},null,8,["title"])])),_:1}),c(t,{class:"ti-select-table-box",onClick:V},{default:u((()=>[c(l,{class:"ti-label-table"},{default:u((()=>[d(r(F.value?A(p)("已選 : ")+A(v)(F.value,21):A(p)("查找桌位")),1)])),_:1})])),_:1}),c(_,{show:K.value,"onUpdate:show":e[0]||(e[0]=a=>K.value=a),onConfirm:q},null,8,["show"])])),_:1})}}},[["__scopeId","data-v-48ac0966"]]),$=""+new URL("binding-page-bg-image-db048039.png",import.meta.url).href,aa=""+new URL("monitor-mobbile-8fa7acb0.svg",import.meta.url).href,ea=q({__name:"set-language",props:{firstBind:{type:Boolean,default:!1}},setup(a){const l=a,t=e(E[j()]),A=e(),p=a=>{A.value.isShow()?A.value.close():A.value.open()},v=()=>{t.value=E[j()]};return(a,e)=>{const f=s(i("ti-layout-language-item"),F),g=T,_=R,m=S;return o(),n(g,{class:"ti-language",onClick:[p,e[0]||(e[0]=Q((()=>{}),["stop"]))]},{default:u((()=>[c(g,{class:"ti-language-box"},{default:u((()=>[c(f,{ref_key:"refShowLanguage",ref:A,firstBind:l.firstBind,onLanguageText:v},null,8,["firstBind"])])),_:1}),c(_,{class:"ti-language-global",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIeSURBVHgB5VXdcdswDAYUKpXVPrAbeASNoExQZ4ImE7QbxB6hE9gb1BvYnSDaoN6gfOg5PsshA0CyJEbUnZK7vCTfnX9EfvgAkAAE8CGgP8c3ehL/1Wns6s+9nnz6OcY2GhRNL2ckWolY9x0Qpp3tjBa/CY84HMCLHOhU3QG43+BcoTVoQMx7JIRc9ogDDpYU0N0oB5U4zuUhORVwUBkMgfeYI3DzkBP0xBNKNYJlxYeteSiv+KjoODJwaMBZU1lFlJXTUOLalGWhJ2rTZmmvzf5xHQxIzjNRlDol/0Kwjdie7y2UQUWkc+XUH0/GlFBQxSwpm/zZJXOGO1rbmn15q9OLGVjKkI7LGDBdWtSJ/gd9NnCM/0GEG4jVrBbqi1eh8VpeP2RiQ7as0a0q1Rq4GyE2EaLpCA1h2nCxcZxTULy+8jLwxGXHGhgL1+NOGxl4Y7QO+NK6sNH4SsIetwg5WFBXblsjp4OOfew8rvBJA+HX+bG5ZHMoV/Szkh44/KeqqI0Q/pATGCpT+U8NBxcknHyhMjXDd9c2Gryi0SDYaMpjoaWoIq5nclaPijjOIHbUSG7ncSOc0ldh9se1jIojjYpIMr31JHuRpGpOy9XQuiy/SldzE4Vg3ZUMO27OSm5BDudeHM9tzP5EBLeQB29aBuBN27540EHjxFKqiJnMlm51ncHTlveQGxSvQ+KjIZefqvvmlcmvz2T4Lfa+8ARyhNbiDRkX2gAAAABJRU5ErkJggg=="}),c(m,{class:"ti-language-text"},{default:u((()=>[d(r(t.value),1)])),_:1}),c(_,{class:"ti-language-arrow-down",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACPSURBVHgB7Y9BCoUwDESH/w3EuskRPIpH8AZ6M72ZR9ClO60KQRGtYF0ofbRQmslMAgQC70TEHkb6SM8kEkPDfBMqcIFJpz02aF377dSMTt8DalfIXLc6/ehZ4JyIqdSJTjbZTL7oSlzFFXLL3BXixfwwxFDlzfwkxJ+5hph/LjE1i3nUCkcZnkAsCAS+xQhmhzo19D7FAAAAAABJRU5ErkJggg=="})])),_:1})}}},[["__scopeId","data-v-990bb9f5"]]),la=q({__name:"first-binding",setup(a){const l=e(!1),t=e(""),n=e(!1),v=G().deviceModel,f=e(""),g=a=>{l.value=!0,t.value=a},_=()=>{"PC"!=v&&(f.value="-25%")},m=()=>{f.value=""};return L("authorization",(a=>{n.value=!a})),(a,e)=>{const v=R,b=T,h=s(i("ti-layout-setserver"),W),w=s(i("ti-modal"),V);return o(),Y(O,null,[c(b,{class:"page",onClick:e[0]||(e[0]=a=>A(M)())},{default:u((()=>[c(b,{class:"ti-page-bg"},{default:u((()=>[c(v,{class:"ti-bg-image",src:$})])),_:1}),c(b,{class:"ti-flex"},{default:u((()=>[c(b,{class:"ti-flex-round"},{default:u((()=>[c(b,{class:"ti-round-box",style:D({top:f.value})},{default:u((()=>[c(b,{class:"ti-round-content"},{default:u((()=>[c(b,{class:"ti-item-logo"},{default:u((()=>[c(v,{class:"ti-logo",src:Z})])),_:1}),c(h,{class:"m-top-32px",onBind:g,onFocus:_,onBlur:m})])),_:1})])),_:1},8,["style"])])),_:1})])),_:1}),c(b,{class:"ti-language-box"},{default:u((()=>[c(ea,{firstBind:!0})])),_:1})])),_:1}),c(w,{class:"ti-action-tips",show:l.value,"onUpdate:show":e[1]||(e[1]=a=>l.value=a),isCancelShow:!1,isConfirmShow:!0,content:t.value,onConfirm:e[2]||(e[2]=a=>l.value=!1)},{title:u((()=>[c(b,{class:"warning-header"},{default:u((()=>[c(b,{class:"warning-image-round"},{default:u((()=>[c(v,{class:"warning-image",src:aa,mode:""})])),_:1}),c(b,{class:"warning-text",style:{"font-weight":"bold"}},{default:u((()=>[d(r(A(p)("綁定失敗")),1)])),_:1})])),_:1})])),default:u((()=>[X("template",null,[c(b)])])),_:1},8,["show","content"]),c(w,{class:"ti-action-tips",show:n.value,title:A(p)("店鋪到期"),isCancelShow:!1,onConfirm:e[3]||(e[3]=a=>n.value=!1),isConfirmShow:!0,content:A(p)("店鋪狀態已到期，如需使用，請聯繫銷售代表")},{title:u((()=>[c(b,{class:"warning-header"},{default:u((()=>[c(b,{class:"warning-image-round"},{default:u((()=>[c(v,{class:"warning-image",src:K,mode:""})])),_:1}),c(b,{class:"warning-text"},{default:u((()=>[d(r(A(p)("店鋪到期")),1)])),_:1})])),_:1})])),_:1},8,["show","title","content"])],64)}}},[["__scopeId","data-v-5d1fe056"]]);export{la as default};
