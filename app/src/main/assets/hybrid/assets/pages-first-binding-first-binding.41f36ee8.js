import{u as a,r as e,e as t,g as l,Q as s,R as i,h as o,j as n,w as u,p as r,v as c,x as d,f as A,$ as p,y as f,Y as g,l as v,m,B as _,C as h,D as b,E as w,G as B,H as x,I as y,M as U,N as k,K as C,c as I,W as S,n as T,Z as R,_ as E,a0 as Q,S as j,a1 as G,q as L,F as Y,z as H,a2 as M}from"./index-a48c9c13.js";import{i as O,g as X,_ as D,a as J,c as N,b as z}from"./platform.573442e2.js";import{_ as Z,a as F}from"./ti-button.6063156f.js";const K=Z({__name:"ti-layout-setserver",emits:["bind"],setup(R,{emit:E}){const{setUserInfo:Q}=a(),j=e({ip:"",port:"",device_id:"null",remark:""}),G=()=>{const a=v();j.value.ip=(null==a?void 0:a.ip)||m()||"127.0.0.1",j.value.port=(null==a?void 0:a.port)||"8080"},L=E;t((()=>{O()?j.value.device_id=X():l({success:a=>{j.value.device_id=a.deviceId}})}));const Y=a=>{j.value.ip=a},H=e(null),M=e(0),N=()=>{let a=H.value.clientHeight;M.value=-a-20},z=a=>{j.value.port=a},Z=e("");e([]);const K=e(),V=e(!1),q=async()=>{var a;const e={...j.value};if(e.ip)if(e.port)try{const t=await _(h(`${null==e?void 0:e.ip}:${e.port}`));1==parseInt(t.data.cashier.order_method.is_table_order)?(b(e),w(t.data.app_id),B(t.data.shop_supplier_id),x(null==(a=t.data)?void 0:a.currency),Q(t.data),setTimeout((()=>{V.value=!0}),150)):uni.showToast({title:p("桌台用餐方式已关闭，请联系管理员"),icon:"none"})}catch(t){uni.showToast({title:p("绑定失败"),icon:"none"})}else uni.showToast({title:p("請輸入連接埠"),icon:"none"});else uni.showToast({title:p("請輸入伺服器位址"),icon:"none"})},P=a=>{V.value=!1,a&&(K.value=a,Z.value=a.table_no)},W=()=>{G(),Z.value=y().table_no,K.value=y()},$=async()=>{var a;const e={...j.value};if(e.ip)if(e.port)try{const t=await _(h(`${null==e?void 0:e.ip}:${e.port}`));if(!K.value)return void uni.showToast({title:p("請查找桌位"),icon:"none"});1==parseInt(t.data.cashier.order_method.is_table_order)?(b(e),w(t.data.app_id),B(t.data.shop_supplier_id),x(null==(a=t.data)?void 0:a.currency),setTimeout((()=>{aa()}),150)):uni.showToast({title:p("桌台用餐方式已关闭，请联系管理员"),icon:"none"})}catch(t){uni.showToast({title:p("绑定失败"),icon:"none"})}else uni.showToast({title:p("請輸入連接埠"),icon:"none"});else uni.showToast({title:p("請輸入伺服器位址"),icon:"none"})},aa=async()=>{try{const a=await U({table_id:K.value.table_id,key:j.value.device_id,device_remark:j.value.remark});k(K.value),C({key:"machine_remark",data:j.value.remark}),C({key:"machine_id",data:j.value.device_id}),I({url:"/pages/index/index"}),uni.showToast({title:a.msg,icon:"none"})}catch(a){0===a.code&&L("bind")}};return G(),(a,e)=>{const t=S,l=T,v=s(i("ti-input"),D),m=s(i("ti-button"),F),_=s(i("ti-layout-table-list"),J);return o(),n(l,{style:g([{transform:`translateY(${M.value}px)`,transition:"transform 0.3s"},{position:"relative"}])},{default:u((()=>[r(l,{class:"ti-item-input"},{default:u((()=>[r(l,{class:"ti-label-box"},{default:u((()=>[r(l,{class:"ti-label-left"},{default:u((()=>[r(t,{class:"ti-label-server"},{default:u((()=>[c(d(A(p)("服務器連接地址")),1)])),_:1})])),_:1})])),_:1}),r(l,{class:"ti-input-box"},{default:u((()=>[r(v,{ref_key:"inputField",ref:H,type:"text",onInput:Y,onFocus:N,placeholder:A(p)("伺服器位址"),value:j.value.ip,clearable:!1},null,8,["placeholder","value"]),r(l,{class:"ti-colon"},{default:u((()=>[c(":")])),_:1}),r(l,{class:"ti-input-port"},{default:u((()=>[r(v,{type:"number",onInput:z,placeholder:A(p)("端口"),value:j.value.port,clearable:!1},null,8,["placeholder","value"])])),_:1})])),_:1})])),_:1}),r(l,{class:"ti-bottom"},{default:u((()=>[r(m,{title:A(p)("重置"),onClick:W},null,8,["title"]),r(m,{title:A(p)("確定"),type:"primary",onClick:$},null,8,["title"])])),_:1}),r(l,{class:"ti-select-table-box",onClick:q},{default:u((()=>[r(t,{class:"ti-label-table"},{default:u((()=>[c(d(Z.value?A(p)("已選 : ")+A(f)(Z.value,21):A(p)("查找桌位")),1)])),_:1})])),_:1}),r(_,{show:V.value,"onUpdate:show":e[0]||(e[0]=a=>V.value=a),onConfirm:P},null,8,["show"])])),_:1},8,["style"])}}},[["__scopeId","data-v-1f559ae2"]]),V=""+new URL("binding-page-bg-image-db048039.png",import.meta.url).href,q=""+new URL("logo-fcaec045.png",import.meta.url).href,P=""+new URL("monitor-mobbile-8fa7acb0.svg",import.meta.url).href,W=Z({__name:"set-language",props:{firstBind:{type:Boolean,default:!1}},setup(a){const t=a,l=e(R[E()]),A=e(),p=a=>{A.value.isShow()?A.value.close():A.value.open()},f=()=>{l.value=R[E()]};return(a,e)=>{const g=s(i("ti-layout-language-item"),N),v=T,m=j,_=S;return o(),n(v,{class:"ti-language",onClick:[p,e[0]||(e[0]=Q((()=>{}),["stop"]))]},{default:u((()=>[r(v,{class:"ti-language-box"},{default:u((()=>[r(g,{ref_key:"refShowLanguage",ref:A,firstBind:t.firstBind,onLanguageText:f},null,8,["firstBind"])])),_:1}),r(m,{class:"ti-language-global",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIeSURBVHgB5VXdcdswDAYUKpXVPrAbeASNoExQZ4ImE7QbxB6hE9gb1BvYnSDaoN6gfOg5PsshA0CyJEbUnZK7vCTfnX9EfvgAkAAE8CGgP8c3ehL/1Wns6s+9nnz6OcY2GhRNL2ckWolY9x0Qpp3tjBa/CY84HMCLHOhU3QG43+BcoTVoQMx7JIRc9ogDDpYU0N0oB5U4zuUhORVwUBkMgfeYI3DzkBP0xBNKNYJlxYeteSiv+KjoODJwaMBZU1lFlJXTUOLalGWhJ2rTZmmvzf5xHQxIzjNRlDol/0Kwjdie7y2UQUWkc+XUH0/GlFBQxSwpm/zZJXOGO1rbmn15q9OLGVjKkI7LGDBdWtSJ/gd9NnCM/0GEG4jVrBbqi1eh8VpeP2RiQ7as0a0q1Rq4GyE2EaLpCA1h2nCxcZxTULy+8jLwxGXHGhgL1+NOGxl4Y7QO+NK6sNH4SsIetwg5WFBXblsjp4OOfew8rvBJA+HX+bG5ZHMoV/Szkh44/KeqqI0Q/pATGCpT+U8NBxcknHyhMjXDd9c2Gryi0SDYaMpjoaWoIq5nclaPijjOIHbUSG7ncSOc0ldh9se1jIojjYpIMr31JHuRpGpOy9XQuiy/SldzE4Vg3ZUMO27OSm5BDudeHM9tzP5EBLeQB29aBuBN27540EHjxFKqiJnMlm51ncHTlveQGxSvQ+KjIZefqvvmlcmvz2T4Lfa+8ARyhNbiDRkX2gAAAABJRU5ErkJggg=="}),r(_,{class:"ti-language-text"},{default:u((()=>[c(d(l.value),1)])),_:1}),r(m,{class:"ti-language-arrow-down",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACPSURBVHgB7Y9BCoUwDESH/w3EuskRPIpH8AZ6M72ZR9ClO60KQRGtYF0ofbRQmslMAgQC70TEHkb6SM8kEkPDfBMqcIFJpz02aF377dSMTt8DalfIXLc6/ehZ4JyIqdSJTjbZTL7oSlzFFXLL3BXixfwwxFDlzfwkxJ+5hph/LjE1i3nUCkcZnkAsCAS+xQhmhzo19D7FAAAAAABJRU5ErkJggg=="})])),_:1})}}},[["__scopeId","data-v-990bb9f5"]]),$=Z({__name:"first-binding",setup(a){const t=e(!1);G().deviceModel;const l=()=>{};return(a,e)=>{const n=j,f=T,g=S,v=s(i("ti-layout-setserver"),K),m=s(i("ti-modal"),z);return o(),L(Y,null,[r(f,{class:"page",onClick:e[0]||(e[0]=a=>A(H)())},{default:u((()=>[r(f,{class:"ti-page-bg"},{default:u((()=>[r(n,{class:"ti-bg-image",src:V})])),_:1}),r(f,{class:"ti-flex"},{default:u((()=>[r(f,{class:"ti-flex-round"},{default:u((()=>[r(f,{class:"ti-round-box"},{default:u((()=>[r(f,{class:"ti-round-content"},{default:u((()=>[r(f,{class:"ti-item-logo"},{default:u((()=>[r(n,{class:"ti-logo",src:q}),r(g,{class:"ti-platform m-top-24px"},{default:u((()=>[c(d(A(p)("平板端")),1)])),_:1})])),_:1}),r(v,{class:"m-top-32px",onBind:l})])),_:1})])),_:1})])),_:1})])),_:1}),r(f,{class:"ti-language-box"},{default:u((()=>[r(W,{firstBind:!0})])),_:1})])),_:1}),r(m,{class:"ti-action-tips",show:t.value,"onUpdate:show":e[1]||(e[1]=a=>t.value=a),isCancelShow:!1,isConfirmShow:!0,content:A(p)("平板設備數量已達上限，請聯繫銷售代表"),onConfirm:e[2]||(e[2]=a=>t.value=!1)},{title:u((()=>[r(f,{class:"warning-header"},{default:u((()=>[r(f,{class:"warning-image-round"},{default:u((()=>[r(n,{class:"warning-image",src:P,mode:""})])),_:1}),r(f,{class:"warning-text",style:{"font-weight":"bold"}},{default:u((()=>[c(d(A(p)("綁定失敗")),1)])),_:1})])),_:1})])),default:u((()=>[M("template",null,[r(f)])])),_:1},8,["show","content"])],64)}}},[["__scopeId","data-v-fd7c5fad"]]);export{$ as default};
