var a=Object.defineProperty,e=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,l=(e,s,t)=>s in e?a(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;import{_ as o,u as r,s as i,m as n,p as u,t as d,z as c,b as f,c as p,w as m,i as v,d as _,B as b,C as y,D as g,$ as w,K as x,U as h,L as j,j as I,r as O,M as P,O as k,P as C,R as E,Q as S,S as U}from"./index-b2264b5a.js";import{_ as V,a as F,S as z}from"./set-language.c7ac2668.js";import"./ti-select.6374d6a5.js";const B=o({__name:"index",setup(a){const o=r(),{userInfo:B}=i(o),D=n(!1),K=n({user_name:"",password:"",device_id:""}),L=u((()=>!K.value.password)),M=()=>{return a=this,r=null,i=function*(){var a;const r=((a,o)=>{for(var r in o||(o={}))s.call(o,r)&&l(a,r,o[r]);if(e)for(var r of e(o))t.call(o,r)&&l(a,r,o[r]);return a})({},K.value);if(!r.password)return uni.showToast({title:w("输入登录密码"),icon:"none"});r.user_name=null==(a=B.value)?void 0:a.account;try{D.value=!0;const a=yield x(r);a.data.token&&(h(),j(a.data.token),o.getUserInfo(!0),I({title:w("加载中...")}),O({url:"/pages/index/index"}))}catch(i){}finally{D.value=!1}},new Promise(((e,s)=>{var t=a=>{try{o(i.next(a))}catch(e){s(e)}},l=a=>{try{o(i.throw(a))}catch(e){s(e)}},o=a=>a.done?e(a.value):Promise.resolve(a.value).then(t,l);o((i=i.apply(a,r)).next())}));var a,r,i},Q=a=>{K.value.password+=a},R=()=>{K.value.password=""};return d((()=>{c({success:a=>{K.value.device_id=a.deviceId}})})),(a,e)=>{const s=P,t=v,l=k(C("ti-input"),E),o=k(C("ti-button"),S),r=k(C("ti-keyboard"),U);return f(),p(t,{class:"ti-login"},{default:m((()=>[_(t,{class:"ti-login-img"},{default:m((()=>[_(s,{src:V,mode:"widthFix"})])),_:1}),_(t,{class:"ti-login-box"},{default:m((()=>[_(t,{class:"ti-login-form"},{default:m((()=>[_(t,{class:"ti-form-box"},{default:m((()=>[_(t,{class:"ti-form-head"},{default:m((()=>[_(t,null,{default:m((()=>[_(s,{class:"ti-login-logo",src:F,style:{},mode:"widthFix"})])),_:1}),_(t,{class:"ti-login-title"},{default:m((()=>[b(y(g(w)("系统已锁定，请输入登录密码解锁")),1)])),_:1})])),_:1}),_(t,{class:"ti-form-username"},{default:m((()=>{var a;return[b(y(g(w)("当前用户："))+y(null==(a=g(B))?void 0:a.account),1)]})),_:1}),_(t,{class:"ti-form-password"},{default:m((()=>[_(l,{modelValue:K.value.password,"onUpdate:modelValue":e[0]||(e[0]=a=>K.value.password=a),prefixIcon:"icon-lock",placeholder:g(w)("請輸入登錄密碼"),focus:!0,password:!0},null,8,["modelValue","placeholder"])])),_:1}),_(t,{class:"ti-form-btn"},{default:m((()=>[_(o,{type:"primary",loading:D.value,disabled:g(L),onClick:M},{default:m((()=>[b(y(g(w)("确定")),1)])),_:1},8,["loading","disabled"])])),_:1})])),_:1}),_(t,{class:"ti-form-keyboard"},{default:m((()=>[_(r,{isExit:!1,isExitConfirm:!0,isPrimary:!1,onInput:Q,onClear:R,onConfirm:M})])),_:1})])),_:1})])),_:1}),_(t,{class:"ti-language-box"},{default:m((()=>[_(z)])),_:1})])),_:1})}}},[["__scopeId","data-v-b9fe827f"]]);export{B as default};
