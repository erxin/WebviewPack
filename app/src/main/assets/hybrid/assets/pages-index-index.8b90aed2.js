import{ab as e,ac as t,ad as a,ae as n,af as i,ag as r,ah as u,ai as s,aj as o,ak as l,al as c,am as d,an as f,ao as h,ap as p,aq as v,ar as m,as as _,at as g,au as y,av as D,aw as w,ax as b,ay as C,az as A,aA as k,aB as x,aC as E,r as F,aD as I,_ as T,aE as S,aF as B,a0 as N,aG as P,a1 as M,b as O,c as L,w as U,d as R,aH as z,aI as j,i as $,z as q,a5 as V,a6 as K,a7 as H,N as W,O as J,K as Z,$ as Y,a4 as G,aJ as Q,aK as X,aL as ee,aM as te,aN as ae,y as ne,aO as ie,aP as re,aQ as ue,aR as se,aS as oe,aT as le,aU as ce,e as de,aV as fe,aW as he,aX as pe,aY as ve,aZ as me,a_ as _e,a$ as ge,b0 as ye,b1 as De,b2 as we,b3 as be,b4 as Ce,b5 as Ae,b6 as ke,b7 as xe,b8 as Ee,b9 as Fe,ba as Ie,q as Te,s as Se,u as Be,bb as Ne,bc as Pe,bd as Me,be as Oe,bf as Le,a8 as Ue,bg as Re,bh as ze,n as je,bi as $e,bj as qe,bk as Ve,A as Ke,bl as He,t as We,bm as Je,bn as Ze,a3 as Ye,bo as Ge,bp as Qe,bq as Xe,br as et,bs as tt,bt as at,bu as nt,bv as it,bw as rt,o as ut,bx as st,by as ot,bz as lt,bA as ct,bB as dt,bC as ft,h as ht,bD as pt,bE as vt,j as mt,bF as _t,bG as gt,bH as yt,bI as Dt,bJ as wt,bK as bt,bL as Ct,bM as At,bN as kt,bO as xt,bP as Et,bQ as Ft,bR as It,k as Tt,H as St,bS as Bt,bT as Nt,bU as Pt,bV as Mt,bW as Ot,bX as Lt,bY as Ut,bZ as Rt,b_ as zt,b$ as jt,c0 as $t,c1 as qt,a2 as Vt,x as Kt,c2 as Ht,c3 as Wt,c4 as Jt,c5 as Zt,a as Yt,l as Gt}from"./index-80b6f279.js";var Qt="[object Symbol]";function Xt(a){return"symbol"==typeof a||e(a)&&t(a)==Qt}function ea(e,t){for(var a=-1,n=null==e?0:e.length,i=Array(n);++a<n;)i[a]=t(e[a],a,e);return i}var ta=1/0,aa=a?a.prototype:void 0,na=aa?aa.toString:void 0;function ia(e){if("string"==typeof e)return e;if(n(e))return ea(e,ia)+"";if(Xt(e))return na?na.call(e):"";var t=e+"";return"0"==t&&1/e==-ta?"-0":t}var ra=/\s/;var ua=/^\s+/;function sa(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&ra.test(e.charAt(t)););return t}(e)+1).replace(ua,""):e}var oa=NaN,la=/^[-+]0x[0-9a-f]+$/i,ca=/^0b[01]+$/i,da=/^0o[0-7]+$/i,fa=parseInt;function ha(e){if("number"==typeof e)return e;if(Xt(e))return oa;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=sa(e);var a=ca.test(e);return a||da.test(e)?fa(e.slice(2),a?2:8):la.test(e)?oa:+e}function pa(e){return e}var va=Date.now;var ma=r?function(e,t){return r(e,"toString",{configurable:!0,enumerable:!1,value:(a=t,function(){return a}),writable:!0});var a}:pa;var _a,ga,ya;const Da=(_a=ma,ga=0,ya=0,function(){var e=va(),t=16-(e-ya);if(ya=e,t>0){if(++ga>=800)return arguments[0]}else ga=0;return _a.apply(void 0,arguments)});var wa=Math.max;function ba(e,t,a){if(!i(a))return!1;var n=typeof t;return!!("number"==n?u(a)&&s(t,a.length):"string"==n&&t in a)&&o(a[t],e)}var Ca=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Aa=/^\w*$/;function ka(e,t){if(n(e))return!1;var a=typeof e;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=e&&!Xt(e))||(Aa.test(e)||!Ca.test(e)||null!=t&&e in Object(t))}var xa="Expected a function";function Ea(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(xa);var a=function(){var n=arguments,i=t?t.apply(this,n):n[0],r=a.cache;if(r.has(i))return r.get(i);var u=e.apply(this,n);return a.cache=r.set(i,u)||r,u};return a.cache=new(Ea.Cache||l),a}Ea.Cache=l;var Fa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ia=/\\(\\)?/g,Ta=function(e){var t=Ea(e,(function(e){return 500===a.size&&a.clear(),e})),a=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Fa,(function(e,a,n,i){t.push(n?i.replace(Ia,"$1"):a||e)})),t}));const Sa=Ta;function Ba(e,t){return n(e)?e:ka(e,t)?[e]:Sa(function(e){return null==e?"":ia(e)}(e))}var Na=1/0;function Pa(e){if("string"==typeof e||Xt(e))return e;var t=e+"";return"0"==t&&1/e==-Na?"-0":t}function Ma(e,t){for(var a=0,n=(t=Ba(t,e)).length;null!=e&&a<n;)e=e[Pa(t[a++])];return a&&a==n?e:void 0}var Oa=a?a.isConcatSpreadable:void 0;function La(e){return n(e)||c(e)||!!(Oa&&e&&e[Oa])}function Ua(e,t,a,n,i){var r=-1,u=e.length;for(a||(a=La),i||(i=[]);++r<u;){var s=e[r];t>0&&a(s)?t>1?Ua(s,t-1,a,n,i):d(i,s):n||(i[i.length]=s)}return i}function Ra(e,t){for(var a=-1,n=null==e?0:e.length;++a<n;)if(t(e[a],a,e))return!0;return!1}var za=1,ja=2;function $a(e,t,a,n,i,r){var u=a&za,s=e.length,o=t.length;if(s!=o&&!(u&&o>s))return!1;var l=r.get(e),c=r.get(t);if(l&&c)return l==t&&c==e;var d=-1,p=!0,v=a&ja?new f:void 0;for(r.set(e,t),r.set(t,e);++d<s;){var m=e[d],_=t[d];if(n)var g=u?n(_,m,d,t,e,r):n(m,_,d,e,t,r);if(void 0!==g){if(g)continue;p=!1;break}if(v){if(!Ra(t,(function(e,t){if(!h(v,t)&&(m===e||i(m,e,a,n,r)))return v.push(t)}))){p=!1;break}}else if(m!==_&&!i(m,_,a,n,r)){p=!1;break}}return r.delete(e),r.delete(t),p}function qa(e){var t=-1,a=Array(e.size);return e.forEach((function(e,n){a[++t]=[n,e]})),a}var Va=1,Ka=2,Ha="[object Boolean]",Wa="[object Date]",Ja="[object Error]",Za="[object Map]",Ya="[object Number]",Ga="[object RegExp]",Qa="[object Set]",Xa="[object String]",en="[object Symbol]",tn="[object ArrayBuffer]",an="[object DataView]",nn=a?a.prototype:void 0,rn=nn?nn.valueOf:void 0;var un=1,sn=Object.prototype.hasOwnProperty;var on=1,ln="[object Arguments]",cn="[object Array]",dn="[object Object]",fn=Object.prototype.hasOwnProperty;function hn(e,t,a,i,r,u){var s=n(e),l=n(t),c=s?cn:_(e),d=l?cn:_(t),f=(c=c==ln?dn:c)==dn,h=(d=d==ln?dn:d)==dn,w=c==d;if(w&&g(e)){if(!g(t))return!1;s=!0,f=!1}if(w&&!f)return u||(u=new y),s||D(e)?$a(e,t,a,i,r,u):function(e,t,a,n,i,r,u){switch(a){case an:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case tn:return!(e.byteLength!=t.byteLength||!r(new p(e),new p(t)));case Ha:case Wa:case Ya:return o(+e,+t);case Ja:return e.name==t.name&&e.message==t.message;case Ga:case Xa:return e==t+"";case Za:var s=qa;case Qa:var l=n&Va;if(s||(s=v),e.size!=t.size&&!l)return!1;var c=u.get(e);if(c)return c==t;n|=Ka,u.set(e,t);var d=$a(s(e),s(t),n,i,r,u);return u.delete(e),d;case en:if(rn)return rn.call(e)==rn.call(t)}return!1}(e,t,c,a,i,r,u);if(!(a&on)){var b=f&&fn.call(e,"__wrapped__"),C=h&&fn.call(t,"__wrapped__");if(b||C){var A=b?e.value():e,k=C?t.value():t;return u||(u=new y),r(A,k,a,i,u)}}return!!w&&(u||(u=new y),function(e,t,a,n,i,r){var u=a&un,s=m(e),o=s.length;if(o!=m(t).length&&!u)return!1;for(var l=o;l--;){var c=s[l];if(!(u?c in t:sn.call(t,c)))return!1}var d=r.get(e),f=r.get(t);if(d&&f)return d==t&&f==e;var h=!0;r.set(e,t),r.set(t,e);for(var p=u;++l<o;){var v=e[c=s[l]],_=t[c];if(n)var g=u?n(_,v,c,t,e,r):n(v,_,c,e,t,r);if(!(void 0===g?v===_||i(v,_,a,n,r):g)){h=!1;break}p||(p="constructor"==c)}if(h&&!p){var y=e.constructor,D=t.constructor;y==D||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof D&&D instanceof D||(h=!1)}return r.delete(e),r.delete(t),h}(e,t,a,i,r,u))}function pn(t,a,n,i,r){return t===a||(null==t||null==a||!e(t)&&!e(a)?t!=t&&a!=a:hn(t,a,n,i,pn,r))}var vn=1,mn=2;function _n(e){return e==e&&!i(e)}function gn(e,t){return function(a){return null!=a&&(a[e]===t&&(void 0!==t||e in Object(a)))}}function yn(e){var t=function(e){for(var t=w(e),a=t.length;a--;){var n=t[a],i=e[n];t[a]=[n,i,_n(i)]}return t}(e);return 1==t.length&&t[0][2]?gn(t[0][0],t[0][1]):function(a){return a===e||function(e,t,a,n){var i=a.length,r=i,u=!n;if(null==e)return!r;for(e=Object(e);i--;){var s=a[i];if(u&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<r;){var o=(s=a[i])[0],l=e[o],c=s[1];if(u&&s[2]){if(void 0===l&&!(o in e))return!1}else{var d=new y;if(n)var f=n(l,c,o,e,t,d);if(!(void 0===f?pn(c,l,vn|mn,n,d):f))return!1}}return!0}(a,e,t)}}function Dn(e,t){return null!=e&&t in Object(e)}function wn(e,t){return null!=e&&function(e,t,a){for(var i=-1,r=(t=Ba(t,e)).length,u=!1;++i<r;){var o=Pa(t[i]);if(!(u=null!=e&&a(e,o)))break;e=e[o]}return u||++i!=r?u:!!(r=null==e?0:e.length)&&b(r)&&s(o,r)&&(n(e)||c(e))}(e,t,Dn)}var bn,Cn=1,An=2;function kn(e,t){return ka(e)&&_n(t)?gn(Pa(e),t):function(a){var n=function(e,t,a){var n=null==e?void 0:Ma(e,t);return void 0===n?a:n}(a,e);return void 0===n&&n===t?wn(a,e):pn(t,n,Cn|An)}}function xn(e){return ka(e)?(t=Pa(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return Ma(t,e)}}(e);var t}function En(e){return"function"==typeof e?e:null==e?pa:"object"==typeof e?n(e)?kn(e[0],e[1]):yn(e):xn(e)}const Fn=function(e,t,a){for(var n=-1,i=Object(e),r=a(e),u=r.length;u--;){var s=r[bn?u:++n];if(!1===t(i[s],s,i))break}return e};var In=function(e,t){return function(a,n){if(null==a)return a;if(!u(a))return e(a,n);for(var i=a.length,r=t?i:-1,s=Object(a);(t?r--:++r<i)&&!1!==n(s[r],r,s););return a}}((function(e,t){return e&&Fn(e,t,w)}));const Tn=In;const Sn=function(){return C.Date.now()};var Bn=Math.max,Nn=Math.min;function Pn(e,t,a){var n,r,u,s,o,l,c=0,d=!1,f=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var a=n,i=r;return n=r=void 0,c=t,s=e.apply(i,a)}function v(e){var a=e-l;return void 0===l||a>=t||a<0||f&&e-c>=u}function m(){var e=Sn();if(v(e))return _(e);o=setTimeout(m,function(e){var a=t-(e-l);return f?Nn(a,u-(e-c)):a}(e))}function _(e){return o=void 0,h&&n?p(e):(n=r=void 0,s)}function g(){var e=Sn(),a=v(e);if(n=arguments,r=this,l=e,a){if(void 0===o)return function(e){return c=e,o=setTimeout(m,t),d?p(e):s}(l);if(f)return clearTimeout(o),o=setTimeout(m,t),p(l)}return void 0===o&&(o=setTimeout(m,t)),s}return t=ha(t)||0,i(a)&&(d=!!a.leading,u=(f="maxWait"in a)?Bn(ha(a.maxWait)||0,t):u,h="trailing"in a?!!a.trailing:h),g.cancel=function(){void 0!==o&&clearTimeout(o),c=0,n=l=r=o=void 0},g.flush=function(){return void 0===o?s:_(Sn())},g}function Mn(e,t){if(e!==t){var a=void 0!==e,n=null===e,i=e==e,r=Xt(e),u=void 0!==t,s=null===t,o=t==t,l=Xt(t);if(!s&&!l&&!r&&e>t||r&&u&&o&&!s&&!l||n&&u&&o||!a&&o||!i)return 1;if(!n&&!r&&!l&&e<t||l&&a&&i&&!n&&!r||s&&a&&i||!u&&i||!o)return-1}return 0}function On(e,t,a){t=t.length?ea(t,(function(e){return n(e)?function(t){return Ma(t,1===e.length?e[0]:e)}:e})):[pa];var i=-1;t=ea(t,A(En));var r=function(e,t){var a=-1,n=u(e)?Array(e.length):[];return Tn(e,(function(e,i,r){n[++a]=t(e,i,r)})),n}(e,(function(e,a,n){return{criteria:ea(t,(function(t){return t(e)})),index:++i,value:e}}));return function(e,t){var a=e.length;for(e.sort(t);a--;)e[a]=e[a].value;return e}(r,(function(e,t){return function(e,t,a){for(var n=-1,i=e.criteria,r=t.criteria,u=i.length,s=a.length;++n<u;){var o=Mn(i[n],r[n]);if(o)return n>=s?o:o*("desc"==a[n]?-1:1)}return e.index-t.index}(e,t,a)}))}var Ln=function(e,t){return Da(function(e,t,a){return t=wa(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,r=wa(n.length-t,0),u=Array(r);++i<r;)u[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=a(u),function(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}(e,this,s)}}(e,t,pa),e+"")}((function(e,t){if(null==e)return[];var a=t.length;return a>1&&ba(e,t[0],t[1])?t=[]:a>2&&ba(t[0],t[1],t[2])&&(t=[t[0]]),On(e,Ua(t,1),[])}));const Un=Ln;function Rn(e){return k("order.cart/add",e,{isLoading:!1})}function zn(e){return k("order.cart/sub",e,{isLoading:!1})}function jn(e){return k("order.cart/changePrice",e,{isLoading:!1})}function $n(e){return k("order.cart/remark",e,{isLoading:!1})}function qn(e){return k("order.order/cancel",e)}function Vn(e){return k("order.order/remove",e)}function Kn(e){return k("order.order/print",e)}function Hn(e){return k("order.order/unlock",e)}function Wn(e){return k("order.order/unSendProductList",e,{isMessage:!1})}const Jn=E("isLockStore",(()=>({cashierIsLock:F(0),tableIsLock:F(0),isPaying:F(0)})));const Zn=T({name:"u-switch",mixins:[S,B,{props:{loading:{type:Boolean,default:I.switch.loading},disabled:{type:Boolean,default:I.switch.disabled},size:{type:[String,Number],default:I.switch.size},activeColor:{type:String,default:I.switch.activeColor},inactiveColor:{type:String,default:I.switch.inactiveColor},modelValue:{type:[Boolean,String,Number],default:I.switch.value},activeValue:{type:[String,Number,Boolean],default:I.switch.activeValue},inactiveValue:{type:[String,Number,Boolean],default:I.switch.inactiveValue},asyncChange:{type:Boolean,default:I.switch.asyncChange},space:{type:[String,Number],default:I.switch.space}}}],watch:{modelValue:{immediate:!0,handler(e){e!==this.inactiveValue&&e!==this.activeValue&&uni.$u.error("v-model绑定的值必须为inactiveValue、activeValue二者之一")}}},data:()=>({bgColor:"#ffffff"}),computed:{isActive(){return this.modelValue===this.activeValue},switchStyle(){let e={};return e.width=uni.$u.addUnit(2*this.size+2),e.height=uni.$u.addUnit(Number(this.size)+2),this.customInactiveColor&&(e.borderColor="rgba(0, 0, 0, 0)"),e.backgroundColor=this.isActive?this.activeColor:this.inactiveColor,e},nodeStyle(){let e={};e.width=uni.$u.addUnit(this.size-this.space),e.height=uni.$u.addUnit(this.size-this.space);const t=this.isActive?uni.$u.addUnit(this.space):uni.$u.addUnit(this.size);return e.transform=`translateX(-${t})`,e},bgStyle(){let e={};return e.width=uni.$u.addUnit(2*Number(this.size)-this.size/2),e.height=uni.$u.addUnit(this.size),e.backgroundColor=this.inactiveColor,e.transform=`scale(${this.isActive?0:1})`,e},customInactiveColor(){return"#fff"!==this.inactiveColor&&"#ffffff"!==this.inactiveColor}},emits:["update:modelValue","change"],methods:{clickHandler(){if(!this.disabled&&!this.loading){const e=this.isActive?this.inactiveValue:this.activeValue;this.asyncChange||this.$emit("update:modelValue",e),this.$nextTick((()=>{this.$emit("change",e)}))}}}},[["render",function(e,t,a,n,i,r){const u=$,s=N(M("u-loading-icon"),P);return O(),L(u,{class:j(["u-switch",[e.disabled&&"u-switch--disabled"]]),style:z([r.switchStyle,e.$u.addStyle(e.customStyle)]),onClick:r.clickHandler},{default:U((()=>[R(u,{class:"u-switch__bg",style:z([r.bgStyle])},null,8,["style"]),R(u,{class:j(["u-switch__node",[e.modelValue&&"u-switch__node--on"]]),style:z([r.nodeStyle]),ref:"u-switch__node"},{default:U((()=>[R(s,{show:e.loading,mode:"circle",timingFunction:"linear",color:e.modelValue?e.activeColor:"#AAABAD",size:.6*e.size},null,8,["show","color","size"])])),_:1},8,["class","style"])])),_:1},8,["class","style","onClick"])}],["__scopeId","data-v-a17af18d"]]),Yn=T({__name:"modify-price",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F("");q((()=>n.show),(()=>{n.show&&(r.value="")}));const u=e=>{if(!e)return;const t=r.value+e;/^\d*\.?\d{0,2}$/.test(t)&&(r.value+=e)},s=async()=>{var e,t;if(!r.value)return uni.showToast({title:Y("請輸入價格"),icon:"none"});if(!((t=r.value)>=0&&t<=1e6))return uni.showToast({title:Y("请输入0-1000000间的價格"),icon:"none"});try{i.value=!0;const t=await jn({order_product_id:null==(e=n.productItem)?void 0:e.order_product_id,price:r.value});uni.showToast({title:t.msg,icon:"none"}),a("update:show",!1),a("success",t.data.res)}catch(u){}finally{i.value=!1}};return(t,o)=>{const l=$,c=N(M("ti-input"),V),d=N(M("ti-keyboard"),K),f=N(M("ti-modal"),H);return O(),L(f,{show:n.show,title:Z(Y)("價格")},{content:U((()=>[R(l,{class:"ti-dialog-content"},{default:U((()=>[R(l,{class:"ti-modify-title text-ellipsis"},{default:U((()=>{var t,a,n;return[W(J((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(n=null==(a=e.productItem)?void 0:a.product)?void 0:n.product_name_text)),1)]})),_:1}),R(l,{class:"ti-modify-input"},{default:U((()=>[R(c,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=e=>r.value=e),placeholder:Z(Y)("請輸入價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:U((()=>[R(l,{class:"ti-dialog-btn"},{default:U((()=>[R(d,{primaryLoading:i.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:o[1]||(o[1]=e=>a("update:show",!1)),onClear:o[2]||(o[2]=e=>r.value=""),onInput:u,onConfirm:s},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-2dd083b7"]]),Gn=T({__name:"remark",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F("");q((()=>n.show),(()=>{var e;n.show&&(r.value=(null==(e=n.productItem)?void 0:e.remark)||"")}));const u=async()=>{var e;try{i.value=!0;const t=await $n({order_product_id:null==(e=n.productItem)?void 0:e.order_product_id,remark:r.value.trim()});1==t.code&&(uni.showToast({title:t.msg,icon:"none"}),a("update:show",!1),a("success",t.data.res))}catch(t){}finally{i.value=!1}};return(t,s)=>{const o=$,l=Q,c=N(M("ti-button"),G),d=N(M("ti-modal"),H);return O(),L(d,{show:n.show,title:Z(Y)("備註")},{content:U((()=>[R(o,{class:"ti-dialog-content"},{default:U((()=>[R(o,{class:"ti-remark-title text-ellipsis"},{default:U((()=>{var t,a,n;return[W(J((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(n=null==(a=e.productItem)?void 0:a.product)?void 0:n.product_name_text)),1)]})),_:1}),R(o,{class:"ti-remark-textarea"},{default:U((()=>[R(l,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),focus:!0,maxlength:50,"placeholder-style":"color:rgba(16,10,5,.3)",placeholder:Z(Y)("请输入")},null,8,["modelValue","placeholder"])])),_:1}),R(o,{class:"ti-remark-num"},{default:U((()=>{var e;return[W(J((null==(e=r.value)?void 0:e.trim().length)||0)+"/50 ",1)]})),_:1})])),_:1})])),footer:U((()=>[R(o,{class:"ti-dialog-btn"},{default:U((()=>[R(c,{onClick:s[1]||(s[1]=e=>a("update:show",!1))},{default:U((()=>[W(J(Z(Y)("退出")),1)])),_:1}),R(c,{onClick:s[2]||(s[2]=e=>r.value="")},{default:U((()=>[W(J(Z(Y)("清空")),1)])),_:1}),R(c,{loading:i.value,type:"primary",onClick:u},{default:U((()=>[W(J(Z(Y)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-bf2db426"]]),Qn=T({__name:"withdrawal",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F(""),u=F([Y("等待時間長"),Y("口味不好"),Y("菜賣光了")]),s=F(0);q((()=>n.show),(()=>{var e;n.show&&(r.value=(null==(e=n.productItem)?void 0:e.total_num)||"")}));const o=e=>{e&&(r.value+=e)},l=async()=>{var e,t,o;if(!r.value)return uni.showToast({title:Y("请输入退菜數量"),icon:"none"});try{i.value=!0;const l=await(o={order_id:null==(e=n.productItem)?void 0:e.order_id,order_product_id:null==(t=n.productItem)?void 0:t.order_product_id,num:r.value,return_reason:u.value[s.value]},k("order.cart/moveProduct",o,{isLoading:!1}));uni.showToast({title:l.msg,icon:"none"}),a("update:show",!1),a("success",l.data.res)}catch(l){}finally{i.value=!1}};return(t,c)=>{const d=$,f=N(M("ti-input"),V),h=N(M("ti-keyboard"),K),p=N(M("ti-modal"),H);return O(),L(p,{show:n.show,title:Z(Y)("退菜")},{content:U((()=>[R(d,{class:"ti-dialog-content"},{default:U((()=>[R(d,{class:"ti-withdrawal-title text-ellipsis"},{default:U((()=>{var t,a,n;return[W(J((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(n=null==(a=e.productItem)?void 0:a.product)?void 0:n.product_name_text)),1)]})),_:1}),R(d,{class:"ti-withdrawal-list"},{default:U((()=>[(O(!0),X(ee,null,te(u.value,((e,t)=>(O(),L(d,{key:t,class:j([{active:t==s.value},"ti-withdrawal-item"]),onClick:e=>(e=>{s.value=e})(t)},{default:U((()=>[W(J(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),R(d,{class:"ti-withdrawal-input"},{default:U((()=>[R(f,{modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=e=>r.value=e),placeholder:Z(Y)("请输入退菜數量"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:U((()=>[R(d,{class:"ti-dialog-btn"},{default:U((()=>[R(h,{primaryLoading:i.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:c[1]||(c[1]=e=>a("update:show",!1)),onClear:c[2]||(c[2]=e=>r.value=""),onInput:o,onConfirm:l},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-e9c1e9a7"]]),Xn=T({__name:"cancel-all",props:{show:{type:Boolean,default:!1},orderId:{type:[Number,String],default:null},sendKitchen:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=async()=>{var e;if(!i.value)try{i.value=!0;const t=await(e={order_id:n.orderId},k("order.cart/delStay",e,{isLoading:!1}));uni.showToast({title:t.msg,icon:"none"}),a("update:show",!1),a("success",{})}catch(t){}finally{i.value=!1}};return(t,u)=>{const s=$,o=ae,l=N(M("ti-modal"),H);return O(),L(l,{class:"ti-action-tips",title:t.$t("溫馨提示"),show:n.show,confirmLoading:i.value,onCancel:u[0]||(u[0]=e=>a("update:show",!1)),onConfirm:r},{content:U((()=>[R(s,{class:"ti-dialog-content"},{default:U((()=>[n.sendKitchen&&e.sendKitchen.length>0?(O(),X(ee,{key:0},[R(s,{class:"ti-cancel-title"},{default:U((()=>[W(J(t.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),R(o,{"scroll-y":""},{default:U((()=>[R(s,{class:"ti-cancel-list"},{default:U((()=>[(O(!0),X(ee,null,te(n.sendKitchen,((e,t)=>(O(),L(s,{key:t,class:"ti-cancel-item"},{default:U((()=>[W(J(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})],64)):(O(),X(ee,{key:1},[W(J(t.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-1382b5da"]]),ei=T({__name:"order-pickup",props:{show:{type:Boolean,default:!1}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(),r=F(!1),u=F(!1),s=F(),o=F({page:1,list_rows:20}),l=F(!1),c=F([]),d=F(!1),f=ne((()=>{var e;return((null==(e=c.value.find((e=>e.order_id==s.value)))?void 0:e.product)||[]).filter((e=>1==e.is_send_kitchen))||[]}));q((()=>n.show),(()=>{n.show&&h()}));const h=()=>{o.value.page=1,v(!0)},p=()=>{d.value&&(o.value.page+=1,v())},v=async e=>{var t,a,n,i,r,u;if(!l.value)try{e&&(l.value=!0);const s=await(u=o.value,k("order.cart/stayList",u,{isLoading:!1}));1==o.value.page&&(c.value=[]),c.value=c.value.concat((null==(t=s.data)?void 0:t.productList)||[]),d.value=(null==(n=null==(a=s.data)?void 0:a.list)?void 0:n.last_page)>(null==(r=null==(i=s.data)?void 0:i.list)?void 0:r.current_page)}catch(s){}finally{e&&(l.value=!1)}},m=async e=>{if(!r.value){i.value=e;try{r.value=!0;const n=await(t={order_id:e},k("order.cart/pick",t));uni.showToast({title:n.msg,icon:"none"}),a("update:show",!1),le(e),a("success",n.data.res)}catch(n){}finally{r.value=!1}var t}};return(e,t)=>{const o=N(M("ti-loading"),ie),v=ce,_=$,g=N(M("ti-button"),G),y=N(M("ti-empty-data"),re),D=ae,w=N(M("ti-drawer"),ue);return O(),L(_,null,{default:U((()=>[R(w,{show:n.show,isConfirmShow:!1,title:Z(Y)("取單"),onCancel:t[0]||(t[0]=e=>a("update:show",!1))},{content:U((()=>[R(_,{class:"ti-order-pickup"},{default:U((()=>[R(D,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:p},{default:U((()=>[l.value?(O(),L(o,{key:0})):c.value&&c.value.length>0?(O(),X(ee,{key:1},[R(_,{class:"ti-pickup-list"},{default:U((()=>[(O(!0),X(ee,null,te(c.value,((e,t)=>(O(),L(_,{key:t,class:"ti-pickup-item"},{default:U((()=>[R(_,{class:"ti-pickup-top"},{default:U((()=>[R(_,{class:"ti-pickup-left"},{default:U((()=>[R(_,{class:"ti-price-box"},{default:U((()=>[R(v,{class:"ti-price-text"},{default:U((()=>[W(J(Z(Y)("訂單總價：")),1)])),_:1}),R(v,{class:"ti-pickup-price"},{default:U((()=>[W(J(Z(se)(null==e?void 0:e.total_price)),1)])),_:2},1024),R(v,{class:"ti-pickup-subPrice"},{default:U((()=>[W(J(Z(oe)(null==e?void 0:e.total_price)),1)])),_:2},1024)])),_:2},1024),R(_,{class:"ti-pickup-time"},{default:U((()=>[R(v,null,{default:U((()=>[W(J(Z(Y)("掛單時間：")),1)])),_:1}),R(v,null,{default:U((()=>[W(J(null==e?void 0:e.create_time),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),R(_,{class:"ti-pickup-action"},{default:U((()=>[R(_,{class:"ti-cancel-all"},{default:U((()=>[R(g,{type:"danger",onClick:t=>{return a=e.order_id,s.value=a,void(u.value=!0);var a}},{default:U((()=>[W(J(Z(Y)("整單取消")),1)])),_:2},1032,["onClick"])])),_:2},1024),R(_,null,{default:U((()=>[R(g,{type:"primary",loading:i.value==e.order_id&&r.value,onClick:t=>m(e.order_id)},{default:U((()=>[W(J(Z(Y)("取單")),1)])),_:2},1032,["loading","onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024),R(_,{class:"ti-pickup-goods"},{default:U((()=>[R(_,{class:"ti-goods-head"},{default:U((()=>[R(_,null,{default:U((()=>[W(J(Z(Y)("商品名称")),1)])),_:1}),R(_,null,{default:U((()=>[W(J(Z(Y)("數量")),1)])),_:1}),R(_,{class:"ti-goods-head-total"},{default:U((()=>[W(J(Z(Y)("小计")),1)])),_:1})])),_:1}),R(_,{class:"ti-goods-body"},{default:U((()=>[(O(!0),X(ee,null,te((null==e?void 0:e.product)||[],((e,t)=>(O(),L(_,{key:t,class:"ti-goods-item"},{default:U((()=>[R(_,null,{default:U((()=>[W(J(null==e?void 0:e.product_name_text),1)])),_:2},1024),R(_,null,{default:U((()=>[W(J(`x ${null==e?void 0:e.total_num}`),1)])),_:2},1024),R(_,{class:"ti-goods-item-price"},{default:U((()=>[R(v,{class:"ti-goods-price"},{default:U((()=>[W(J(Z(se)(null==e?void 0:e.product_price)),1)])),_:2},1024),R(v,{class:"ti-goods-subPrice"},{default:U((()=>[W(J(Z(oe)(null==e?void 0:e.product_price)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),R(o,{status:d.value?"loading":"no-more"},null,8,["status"])],64)):(O(),L(y,{key:2}))])),_:1})])),_:1})])),_:1},8,["show","title"]),R(Xn,{show:u.value,"onUpdate:show":t[1]||(t[1]=e=>u.value=e),orderId:s.value,sendKitchen:f.value,onSuccess:t[2]||(t[2]=e=>h())},null,8,["show","orderId","sendKitchen"])])),_:1})}}},[["__scopeId","data-v-b93842ba"]]),ti={__name:"preferential",props:{show:{type:Boolean,default:!1},orderId:{type:[Number,String],default:null},totalPayPrice:{type:[Number,String],default:0},preferentialData:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F({type:1,money:"",rate:"",discountType:1}),r=F(!1);q((()=>n.show),(()=>{var e,t;if(n.show){const a={type:1,money:"",rate:"",discountType:1};(null==(e=n.preferentialData)?void 0:e.discount_ratio)&&(a.type=2,a.rate=Math.max(null==(t=n.preferentialData)?void 0:t.discount_ratio,0).toString()),i.value=a}})),q((()=>i.value.type),((e,t)=>{var a,r;1==t?i.value.money="":2==t?(null==(a=n.preferentialData)?void 0:a.discount_ratio)?i.value.rate=Math.max(null==(r=n.preferentialData)?void 0:r.discount_ratio,0).toString():i.value.rate="":3==t&&(i.value.discountType=1)}));const u=e=>{i.value.discountType=e.detail.value},s=()=>{1==i.value.type?i.value.money="":2==i.value.type&&(i.value.rate="")},o=e=>{if(e)if(1==i.value.type){const t=i.value.money+e;/^\d*\.?\d{0,2}$/.test(t)&&(i.value.money+=e)}else 2==i.value.type&&(i.value.rate+=e)},l=async()=>{const e={...i.value,order_id:n.orderId};if(!r.value){if(1==e.type){if(!e.money)return uni.showToast({title:Y("请输入實付價格"),icon:"none"});if(!((t=e.money)>=0&&t<=999999999))return uni.showToast({title:Y("请输入0-999999999间的價格"),icon:"none"})}else if(2==e.type){if(!e.rate)return uni.showToast({title:Y("请输入折扣"),icon:"none"});if(!/^(?:[1-9][0-9]?|100|0)$/.test(e.rate))return uni.showToast({title:Y("请输入0-100间的正整数"),icon:"none"})}var t;try{r.value=!0;const t=await function(e){return k("order.cart/changeMoney",e,{isLoading:!1})}(e);uni.showToast({title:t.msg,icon:"none"}),a("update:show",!1),a("success",t.data.res)}catch(u){}finally{r.value=!1}}};return(t,c)=>{const d=$,f=ce,h=N(M("ti-input"),V),p=he,v=pe,m=ve,_=N(M("ti-button"),G),g=N(M("ti-keyboard"),K),y=N(M("ti-modal"),H);return O(),L(y,{show:n.show,title:Z(Y)("優惠折扣")},{content:U((()=>[R(d,{class:"ti-dialog-content"},{default:U((()=>[R(d,{class:"ti-preferential-box"},{default:U((()=>[R(d,{class:"ti-preferential-label"},{default:U((()=>[W(J(Z(Y)("當前價格")),1)])),_:1}),R(d,{class:"ti-preferential-input"},{default:U((()=>[R(f,{class:"ti-preferential-price"},{default:U((()=>[W(J(Z(se)(e.totalPayPrice)),1)])),_:1}),R(f,{class:"ti-preferential-subPrice"},{default:U((()=>[W(J(Z(oe)(e.totalPayPrice)),1)])),_:1})])),_:1}),R(d,{class:"ti-preferential-label"},{default:U((()=>[W(J(Z(Y)("優惠方式")),1)])),_:1}),R(d,{class:"ti-preferential-input ti-preferential-type"},{default:U((()=>[(O(!0),X(ee,null,te([Z(Y)("改價"),Z(Y)("折扣"),Z(Y)("抹零")],((e,t)=>(O(),L(d,{key:t,class:j([{active:i.value.type==t+1},"ti-preferential-type-item"]),onClick:e=>i.value.type=t+1},{default:U((()=>[W(J(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),1==i.value.type?(O(),X(ee,{key:0},[R(d,{class:"ti-preferential-label"},{default:U((()=>[W(J(Z(Y)("實付價格")),1)])),_:1}),R(d,{class:"ti-preferential-input"},{default:U((()=>[R(h,{modelValue:i.value.money,"onUpdate:modelValue":c[0]||(c[0]=e=>i.value.money=e),placeholder:Z(Y)("请输入實付價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})],64)):de("",!0),2==i.value.type?(O(),X(ee,{key:1},[R(d,{class:"ti-preferential-label"},{default:U((()=>[W(J(Z(Y)("折扣")),1)])),_:1}),R(d,{class:"ti-preferential-input"},{default:U((()=>[R(h,{modelValue:i.value.rate,"onUpdate:modelValue":c[1]||(c[1]=e=>i.value.rate=e),regex:/^\d+$/,placeholder:Z(Y)("请输入折扣"),focus:!0},{right:U((()=>[R(d,{class:"ti-preferential-percentage"},{default:U((()=>[W("%")])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1})],64)):de("",!0),3==i.value.type?(O(),X(ee,{key:2},[R(d,{class:"ti-preferential-label ti-preferential-round"},{default:U((()=>[W(J(Z(Y)("抹零方式")),1)])),_:1}),R(d,{class:"ti-preferential-input"},{default:U((()=>[R(m,{class:"ti-type-radio",style:z({"grid-template-columns":"zh"==Z(fe)()||"zhtw"==Z(fe)()?"repeat(4, auto)":"repeat(2, 1fr)"}),onChange:u},{default:U((()=>[R(v,null,{default:U((()=>[R(p,{value:"1",color:"#ffbe00",checked:"true"}),R(f,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("抹分")),1)])),_:1})])),_:1}),R(v,null,{default:U((()=>[R(p,{value:"2",color:"#ffbe00"}),R(f,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("抹角")),1)])),_:1})])),_:1}),R(v,null,{default:U((()=>[R(p,{value:"3",color:"#ffbe00"}),R(f,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("四舍五入保留一位小数")),1)])),_:1})])),_:1}),R(v,null,{default:U((()=>[R(p,{value:"4",color:"#ffbe00"}),R(f,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("四舍五入到整数")),1)])),_:1})])),_:1})])),_:1},8,["style"])])),_:1})],64)):de("",!0)])),_:1})])),_:1})])),footer:U((()=>[3==i.value.type?(O(),L(d,{key:0,class:"ti-dialog-btn"},{default:U((()=>[R(_,{onClick:c[2]||(c[2]=e=>a("update:show",!1))},{default:U((()=>[W(J(Z(Y)("退出")),1)])),_:1}),R(_,{loading:r.value,type:"primary",onClick:l},{default:U((()=>[W(J(Z(Y)("确定")),1)])),_:1},8,["loading"])])),_:1})):(O(),L(d,{key:1,class:"ti-dialog-btn ti-preferential-keyboard"},{default:U((()=>[R(g,{primaryLoading:r.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:c[3]||(c[3]=e=>a("update:show",!1)),onClear:s,onInput:o,onConfirm:l},null,8,["primaryLoading"])])),_:1}))])),_:1},8,["show","title"])}}},ai=T(ti,[["__scopeId","data-v-5ee088a3"]]),ni=T({__name:"cancel-all",props:{show:{type:Boolean,default:!1},sendKitchen:{type:Array,default:()=>[]},msg:{type:String,default:null},cancelShow:{type:Boolean,default:!1}},emits:["update:show","confirm"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=()=>{a("update:show",!1),a("confirm")};return(t,u)=>{const s=$,o=ae,l=N(M("ti-modal"),H);return O(),L(l,{class:"ti-action-tips",title:t.$t("溫馨提示"),isCancelShow:n.cancelShow,show:n.show,confirmLoading:i.value,onCancel:u[0]||(u[0]=e=>a("update:show",!1)),onConfirm:r},{content:U((()=>[R(s,{class:"ti-dialog-content"},{default:U((()=>[n.sendKitchen&&e.sendKitchen.length>0?(O(),X(ee,{key:0},[R(s,{class:"ti-cancel-title"},{default:U((()=>[W(J(n.msg),1)])),_:1}),R(o,{"scroll-y":""},{default:U((()=>[R(s,{class:"ti-cancel-list"},{default:U((()=>[(O(!0),X(ee,null,te(n.sendKitchen,((e,t)=>(O(),L(s,{key:t,class:"ti-cancel-item"},{default:U((()=>[W(J(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})],64)):de("",!0)])),_:1})])),_:1},8,["title","isCancelShow","show","confirmLoading"])}}},[["__scopeId","data-v-249d77fe"]]),ii={__name:"action-list",props:{productItem:{type:Object,default:()=>({})},orderId:{type:[Number,String],default:null},orderList:{type:Array,default:()=>[]},totalPayPrice:{type:[Number,String],default:0},preferentialData:{type:Object,default:()=>({})},isLock:{type:Number,default:0}},emits:["success"],setup(e,{emit:t}){const a=t,n=e,i=ne((()=>n.orderList&&n.orderList.length>0)),r=ne((()=>n.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)>0)))),u=ne((()=>n.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)<=0)))),s=F(me()),o=F(!1),l=F(!1),c=F(!1),d=F(!1),f=F(!1),h=F(!1),p=F(!1),v=F(!1),m=F(!1),_=F(!1),g=F(!1),y=F(!1),D=F(!1),w=F(!1),b=F(""),C=F(!1),A=F([]),x=(e,t)=>{a("success",e,t)},E=()=>{n.orderList&&n.orderList.length>0?D.value=!0:y.value=!0},I=()=>{var e;(null==(e=n.productItem)?void 0:e.finish_time)>0?w.value=!0:_.value=!0},T=e=>{De(e)},S=async()=>{var e,t;if(!d.value)try{d.value=!0;const a=await(t={order_id:we(),order_product_id:null==(e=n.productItem)?void 0:e.order_product_id},k("order.cart/delProduct",t,{isLoading:!1}));uni.showToast({title:a.msg,icon:"none"}),x(a.data.res,"delete"),c.value=!1}catch(a){}finally{d.value=!1}},B=async()=>{var e;if(!h.value)try{h.value=!0;const t=await(e={delivery:s.value?30:40,order_id:n.orderId},k("order.cart/sendKitchen",e,{isLoading:!1,isMessage:!1}));uni.showToast({title:t.msg,icon:"none"}),x(t.data.res),f.value=!1}catch(t){(null==t?void 0:t.data)&&(null==t?void 0:t.data.length)>0?(A.value=null==t?void 0:t.data,b.value=null==t?void 0:t.msg,C.value=!0):uni.showToast({title:null==t?void 0:t.msg,icon:"none"})}finally{h.value=!1,f.value=!1}},P=async()=>{var e;if(!l.value)try{l.value=!0;const t=await(e={order_id:n.orderId},k("order.cart/stay",e,{isLoading:!1}));uni.showToast({title:t.msg,icon:"none"}),x({}),o.value=!1}catch(t){}finally{l.value=!1}};return(t,a)=>{var k;const F=ce,z=N(M("u-switch"),Zn),j=$,q=be,V=N(M("ti-modal"),H),K=_e("permission");return O(),X(ee,null,[R(j,{class:"ti-action-box"},{default:U((()=>[R(j,{class:"ti-action-btn"},{default:U((()=>[R(j,{class:"ti-action-pack"},{default:U((()=>[R(F,{class:"ti-pack-text"},{default:U((()=>[W(J(Z(Y)("打包")),1)])),_:1}),R(z,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),activeColor:"#FFBE00",inactiveColor:"rgb(153,153,153,.1)",size:"20",onChange:T},null,8,["modelValue"])])),_:1}),R(j,{class:"ti-btn-box"},{default:U((()=>{var e,t,r,s;return[ge((O(),L(q,{class:"ti-btn-item danger",disabled:!(1!=n.isLock&&0==(null==(e=n.productItem)?void 0:e.is_send_kitchen)),onClick:a[1]||(a[1]=e=>c.value=!0)},{default:U((()=>[R(F,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("删除")),1)])),_:1})])),_:1},8,["disabled"])),[[K,["cashier_cash_delete"]]]),ge((O(),L(q,{class:"ti-btn-item",disabled:!(1!=n.isLock&&(null==(t=n.productItem)?void 0:t.order_product_id)>0),onClick:a[2]||(a[2]=e=>v.value=!0)},{default:U((()=>[R(F,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("價格")),1)])),_:1})])),_:1},8,["disabled"])),[[K,["cashier_cash_price"]]]),ge((O(),L(q,{class:"ti-btn-item",disabled:!i.value,onClick:a[3]||(a[3]=e=>o.value=!0)},{default:U((()=>[R(F,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("掛單")),1)])),_:1})])),_:1},8,["disabled"])),[[K,["cashier_cash_placement"]]]),R(q,{class:"ti-btn-item",disabled:!1,onClick:E},{default:U((()=>[R(F,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("取單")),1)])),_:1})])),_:1}),ge((O(),L(q,{class:"ti-btn-item danger",disabled:!i.value,onClick:a[4]||(a[4]=e=>p.value=!0)},{default:U((()=>[R(F,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("整單取消")),1)])),_:1})])),_:1},8,["disabled"])),[[K,["cashier_cash_cancel"]]]),ge((O(),L(q,{class:"ti-btn-item",disabled:!(1!=n.isLock&&u.value.length>0),onClick:a[5]||(a[5]=e=>f.value=!0)},{default:U((()=>[R(F,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("送廚")),1)])),_:1})])),_:1},8,["disabled"])),[[K,["cashier_cash_send_kitchen"]]]),ge((O(),L(q,{class:"ti-btn-item danger",disabled:!(1!=n.isLock&&1==(null==(r=n.productItem)?void 0:r.is_send_kitchen)),onClick:I},{default:U((()=>[R(F,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("退菜")),1)])),_:1})])),_:1},8,["disabled"])),[[K,["cashier_cash_return"]]]),ge((O(),L(q,{class:"ti-btn-item",disabled:!(1!=n.isLock&&0==(null==(s=n.productItem)?void 0:s.is_send_kitchen)),onClick:a[6]||(a[6]=e=>m.value=!0)},{default:U((()=>[R(F,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("备注")),1)])),_:1})])),_:1},8,["disabled"])),[[K,["cashier_cash_remark"]]]),ge((O(),L(q,{class:"ti-btn-item",disabled:!i.value,onClick:a[7]||(a[7]=e=>g.value=!0)},{default:U((()=>[R(F,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("優惠折扣")),1)])),_:1})])),_:1},8,["disabled"])),[[K,["cashier_cash_discount"]]])]})),_:1})])),_:1})])),_:1}),R(V,{class:"ti-action-tips",show:c.value,"onUpdate:show":a[8]||(a[8]=e=>c.value=e),confirmLoading:d.value,title:Z(Y)("溫馨提示"),content:Z(Y)("是否删除此商品？"),onConfirm:S},null,8,["show","confirmLoading","title","content"]),R(V,{class:"ti-action-tips",show:f.value,"onUpdate:show":a[9]||(a[9]=e=>f.value=e),confirmLoading:h.value,title:Z(Y)("溫馨提示"),content:Z(Y)("是否将商品送廚？"),onConfirm:B},null,8,["show","confirmLoading","title","content"]),R(ni,{show:C.value,"onUpdate:show":a[10]||(a[10]=e=>C.value=e),sendKitchen:A.value,msg:b.value},null,8,["show","sendKitchen","msg"]),R(V,{class:"ti-action-tips",show:o.value,"onUpdate:show":a[11]||(a[11]=e=>o.value=e),confirmLoading:l.value,title:Z(Y)("溫馨提示"),content:Z(Y)("是否将商品挂单？"),onConfirm:P},null,8,["show","confirmLoading","title","content"]),R(Xn,{show:p.value,"onUpdate:show":a[12]||(a[12]=e=>p.value=e),sendKitchen:r.value,orderId:n.orderId,onSuccess:a[13]||(a[13]=e=>x({}))},null,8,["show","sendKitchen","orderId"]),R(Yn,{show:v.value,"onUpdate:show":a[14]||(a[14]=e=>v.value=e),productItem:n.productItem,onSuccess:x},null,8,["show","productItem"]),R(Gn,{show:m.value,"onUpdate:show":a[15]||(a[15]=e=>m.value=e),productItem:n.productItem,onSuccess:x},null,8,["show","productItem"]),R(ei,{show:y.value,"onUpdate:show":a[16]||(a[16]=e=>y.value=e),onSuccess:x},null,8,["show"]),R(V,{class:"ti-action-tips",show:D.value,"onUpdate:show":a[17]||(a[17]=e=>D.value=e),title:Z(Y)("溫馨提示"),content:Z(Y)("请先将购物车内的商品挂单或结账后再取单"),onConfirm:a[18]||(a[18]=e=>D.value=!1)},null,8,["show","title","content"]),R(V,{class:"ti-action-tips",show:w.value,"onUpdate:show":a[19]||(a[19]=e=>w.value=e),title:Z(Y)("溫馨提示"),content:Z(ye)("此[{name}]已製作，是否退菜？",{name:null==(k=n.productItem)?void 0:k.product_name_text}),onConfirm:a[20]||(a[20]=e=>(_.value=!0,w.value=!1))},null,8,["show","title","content"]),R(Qn,{show:_.value,"onUpdate:show":a[21]||(a[21]=e=>_.value=e),productItem:n.productItem,onSuccess:x},null,8,["show","productItem"]),R(ai,{show:g.value,"onUpdate:show":a[22]||(a[22]=e=>g.value=e),preferentialData:n.preferentialData,orderId:n.orderId,totalPayPrice:e.totalPayPrice,onSuccess:x},null,8,["show","preferentialData","orderId","totalPayPrice"])],64)}}},ri=T(ii,[["__scopeId","data-v-8eec995d"]]),ui=T({__name:"cart-number",props:{productItem:{type:Object,default:()=>({})}},emits:["change"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F(!1),u=F(!1),s=F(null),o=async e=>{var t,o;const l={order_product_id:null==(t=n.productItem)?void 0:t.order_product_id,product_num:null==(o=n.productItem)?void 0:o.total_num,type:e};clearTimeout(s.value),"up"==e?(l.product_num+=1,s.value=setTimeout((()=>{r.value=!0}),500)):(l.product_num-=1,s.value=setTimeout((()=>{u.value=!0}),500));try{i.value=!0;const e=await zn(l);a("change",e.data.res)}catch(c){}finally{clearTimeout(s.value),i.value=!1,r.value=!1,u.value=!1}};return(e,t)=>{const a=N(M("uni-icons"),Ce),s=be,l=$;return O(),L(l,{class:"ti-number-box",onClick:t[2]||(t[2]=Ae((()=>{}),["stop"]))},{default:U((()=>{var e,c,d,f,h,p;return[R(s,{class:"ti-number-btn ti-number-minus",disabled:(null==(e=n.productItem)?void 0:e.total_num)<=1||i.value||(null==(c=n.productItem)?void 0:c.is_send_kitchen)>0,onClick:t[0]||(t[0]=e=>o("down"))},{default:U((()=>[u.value?(O(),L(a,{key:1,class:"ti-number-reload",type:"reload",size:"20"})):(O(),L(a,{key:0,"custom-prefix":"iconfont",type:"icon-minus",size:"16"}))])),_:1},8,["disabled"]),R(l,{class:"ti-number-input"},{default:U((()=>{var e;return[W(J((null==(e=n.productItem)?void 0:e.total_num)||1),1)]})),_:1}),R(s,{class:"ti-number-btn ti-number-plus",disabled:(null==(d=n.productItem)?void 0:d.total_num)>=(null==(h=null==(f=n.productItem)?void 0:f.product)?void 0:h.product_stock)||i.value||(null==(p=n.productItem)?void 0:p.is_send_kitchen)>0,onClick:t[1]||(t[1]=e=>o("up"))},{default:U((()=>[r.value?(O(),L(a,{key:1,class:"ti-number-reload",type:"reload",size:"20"})):(O(),L(a,{key:0,type:"plusempty",size:"16"}))])),_:1},8,["disabled"])]})),_:1})}}},[["__scopeId","data-v-075eebbc"]]);function si(e){return k("order.order/prints",e)}function oi(e){return k("order.Order/printInvoices",e)}const li=T({__name:"member",props:{show:{type:Boolean,default:!1},orderId:{type:[Number,String],default:null}},emits:["update:show","change"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F(""),u=F({}),s=F(!1);q((()=>n.show),(()=>{n.show&&(r.value="",u.value={})}));const o=()=>{a("update:show",!1)},l=e=>{e&&(r.value+=e)},c=async()=>{if(!r.value)return uni.showToast({title:Y("请输入会员手机号/ID"),icon:"none"});try{i.value=!0;const e=await xe({mobile:r.value,order_id:n.orderId});u.value={...e.data.user,total_pay_price:e.data.total_pay_price}}catch(e){}finally{i.value=!1}},d=async()=>{var e;try{s.value=!0;const t=await Ee({order_id:n.orderId,user_id:(null==(e=u.value)?void 0:e.user_id)||0});1==t.data.reset_notice&&uni.showToast({title:Y("改价/抹零已失效，请重新进行改价/抹零操作"),icon:"none"}),a("update:show",!1),a("change",{order_id:t.data.order_id,...t.data.res})}catch(t){}finally{s.value=!1}};return(e,t)=>{const a=N(M("ti-input"),V),f=N(M("ti-button"),G),h=$,p=ce,v=N(M("ti-keyboard"),K),m=N(M("ti-modal"),H);return O(),L(m,{show:n.show,title:Z(Y)("会员")},{content:U((()=>[R(h,{class:"ti-dialog-content"},{default:U((()=>{var e;return[R(h,{class:"ti-payment-input"},{default:U((()=>[R(a,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),regex:/^[\d\-]+$/,placeholder:Z(Y)("請輸入會員手機號/ID"),focus:!0},null,8,["modelValue","placeholder"]),R(f,{loading:i.value,type:"primary",onClick:c},{default:U((()=>[W(J(Z(Y)("查找")),1)])),_:1},8,["loading"])])),_:1}),(null==(e=u.value)?void 0:e.user_id)?(O(),L(h,{key:0,class:"ti-payment-member"},{default:U((()=>[R(h,{class:"ti-member-list"},{default:U((()=>[R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("暱稱")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J((null==(e=u.value)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("會員卡/等級")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e,t,a,n,i,r,s,o;return[W(J(`${1!=(null==(t=null==(e=u.value)?void 0:e.cardRecord)?void 0:t.disabled)&&(null==(n=null==(a=u.value)?void 0:a.card)?void 0:n.card_name)?null==(r=null==(i=u.value)?void 0:i.card)?void 0:r.card_name:"-"}/${(null==(o=null==(s=u.value)?void 0:s.grade)?void 0:o.name)||"-"}`),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("餘額")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J(Z(ke)(null==(e=u.value)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("積分")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J((null==(e=u.value)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),R(h,{class:"ti-member-discount"},{default:U((()=>[R(p,{class:"ti-discount-title"},{default:U((()=>[W(J(Z(Y)("會員折扣應收金額")),1)])),_:1}),R(p,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=u.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),R(p,{class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=u.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1})])),_:1})):de("",!0)]})),_:1})])),footer:U((()=>[R(h,{class:"ti-dialog-btn"},{default:U((()=>[R(v,{primaryLoading:s.value,isDoubleZero:!1,isCross:!0,isDrop:!0,onExit:o,onClear:t[1]||(t[1]=e=>r.value=""),onInput:l,onConfirm:d},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-7fdade5a"]]),ci=T({__name:"pay-code",props:{show:{type:Boolean,default:!1},payItem:{type:Object,default:()=>{}}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=()=>{Ie({},!1),a("update:show",!1)},r=()=>{a("success")};return(t,a)=>{const u=$,s=ce,o=Te,l=N(M("ti-modal"),H);return O(),L(l,{class:"ti-action-tips-pay",show:n.show,confirmText:t.$t("已支付"),cancelText:t.$t("退出"),onCancel:i,onConfirm:r},{content:U((()=>[R(u,{class:"ti-pay-container"},{default:U((()=>[R(u,{class:"ti-pay-title-box"},{default:U((()=>[R(u,{class:"ti-pay-title"},{default:U((()=>{var a;return[W(J((null==(a=e.payItem)?void 0:a.name)+t.$t("收款:")),1)]})),_:1}),R(u,{class:"ti-pay-prices-box"},{default:U((()=>[R(s,{class:"ti-pay-prices"},{default:U((()=>{var t;return[W(J(Z(se)(null==(t=e.payItem)?void 0:t.actual_price)),1)]})),_:1}),R(s,{class:"ti-pay-subPrice"},{default:U((()=>{var t;return[W(J(Z(oe)(null==(t=e.payItem)?void 0:t.actual_price)),1)]})),_:1})])),_:1})])),_:1}),R(u,{class:"ti-pay-content-box"},{default:U((()=>[R(u,{class:"ti-pay-code"},{default:U((()=>{var t;return[R(o,{src:Z(Fe)(null==(t=e.payItem)?void 0:t.qrcode),mode:"widthFix"},null,8,["src"])]})),_:1}),R(u,{class:"ti-pay-code-tips"},{default:U((()=>{var a;return[W(J(t.$t("请使用")+`${null==(a=e.payItem)?void 0:a.name}`+t.$t("扫一扫支付")),1)]})),_:1})])),_:1})])),_:1})])),_:1},8,["show","confirmText","cancelText"])}}},[["__scopeId","data-v-fb9b87fa"]]),di={__name:"payment-type",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0},orderId:{type:[Number,String],default:null},memberDetail:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const{paymentType:a}=Se(Be()),{isPaying:i}=Se(Jn()),r=t,u=e,s=F(!1),o=F({}),l=F(""),c=F(0),d=e=>{const t=l.value+e;/^\d*\.?\d{0,2}$/.test(t)&&(l.value+=e)},f=()=>{l.value=""},h=()=>{let e=parseFloat(l.value)-parseFloat(u.totalPayPrice);return c.value=e,e>=0};q(l,(()=>{h()})),q((()=>u.totalPayPrice),(()=>{h()}));const p=F(!1),v=F([]),m=F({delivery:null,pay_type:"40",user_id:null,order_id:null}),_=F(!1),g=F(!1),y=F(!1),D=F();q((()=>u.show),(()=>{u.show&&(v.value=[],m.value.pay_type="40",l.value="")})),q((()=>m.value.pay_type),(()=>{u.show&&(m.value.pay_type>0||(v.value&&v.value.length>0?(m.value.pay_type=v.value[0].value,o.value=v.value[0]):Ne().then((e=>{v.value=e.data||[],m.value.pay_type=v.value[0].value,o.value=v.value[0]}))))}));const w=(e,t)=>{r("success",e,t)},b=async()=>{try{const e=await Ee({order_id:u.orderId,user_id:0});w({order_id:u.orderId,...e.data.res})}catch(e){}},C=e=>{m.value.pay_type=e.detail.value},A=async()=>{var e,t,a,n;if(!g.value)try{g.value=!0;const e=await si({order_id:u.orderId,is_reload_price:!0});uni.showToast({title:e.msg,icon:"none"}),w({order_id:u.orderId,...e.data.res})}catch(i){(null==(e=null==i?void 0:i.data)?void 0:e.res)&&(null==(t=null==i?void 0:i.data)?void 0:t.order_id)&&w({order_id:null==(a=null==i?void 0:i.data)?void 0:a.order_id,...null==(n=null==i?void 0:i.data)?void 0:n.res})}finally{g.value=!1}},k=async(e=!1)=>{var t,a,c,d,f,p;if(_.value)return;const v={...m.value};if(v.delivery=me()?30:40,v.order_id=u.orderId,v.user_id=null==(t=u.memberDetail)?void 0:t.user_id,v.actual_price=l.value,v.pay_price=u.totalPayPrice,1!=e&&(o.value.actual_price=u.totalPayPrice),"10"==v.pay_type&&!v.user_id)return uni.showToast({title:Y("请选择会员身份以享受更多优惠，再进行余额支付"),icon:"none"});if("40"==v.pay_type&&!l.value)return uni.showToast({title:Y("请输入实收金额"),icon:"none"});if("40"==v.pay_type&&!h())return uni.showToast({title:Y("实收金额不应小于应收金额"),icon:"none"});if("40"!=v.pay_type&&"10"!=v.pay_type&&(null==(a=o.value)?void 0:a.qrcode)&&1!=e)return s.value=!0,void Ie(o.value,!0);try{_.value=!0;const e=await Pe(v);"40"==v.pay_type&&Me((()=>{})),uni.showToast({title:e.msg,icon:"none"}),s.value=!1,i.value=1,r("update:show",!1),w(e.data.pay_res,"handleSubmit")}catch(g){(null==(c=null==g?void 0:g.data)?void 0:c.res)&&(null==(d=null==g?void 0:g.data)?void 0:d.order_id)?(uni.showToast({title:null==g?void 0:g.msg,icon:"none"}),w({order_id:null==(f=null==g?void 0:g.data)?void 0:f.order_id,...null==(p=null==g?void 0:g.data)?void 0:p.res})):n(null==g?void 0:g.data)&&(null==g?void 0:g.data.length)>0?(y.value=!0,D.value=null==g?void 0:g.data):uni.showToast({title:null==g?void 0:g.msg,icon:"none"})}finally{_.value=!1}},x=()=>{Ie(o.value,!1),k(!0)};return(t,n)=>{const i=ce,h=$,E=he,F=pe,I=ve,T=N(M("ti-input"),V),S=Te,B=N(M("ti-empty-data"),re),P=N(M("ti-keyboard"),K),z=N(M("ti-button"),G),q=N(M("ti-modal"),H);return O(),L(q,{show:u.show,title:Z(Y)("結賬")},{content:U((()=>[R(h,{class:"ti-dialog-content"},{default:U((()=>{var t;return[R(h,{class:"ti-payment-money"},{default:U((()=>[R(i,{class:"ti-payment-label"},{default:U((()=>[W(J(Z(Y)("應收金額")),1)])),_:1}),R(i,{class:"ti-payment-price"},{default:U((()=>[W(J(Z(se)(e.totalPayPrice)),1)])),_:1}),R(i,{class:"ti-payment-subPrice"},{default:U((()=>[W(J(Z(oe)(e.totalPayPrice)),1)])),_:1})])),_:1}),R(h,{class:"ti-payment-type"},{default:U((()=>[R(h,{class:"ti-type-label"},{default:U((()=>[W(J(Z(Y)("收款方式")),1)])),_:1}),R(I,{class:"ti-type-radio",onChange:C},{default:U((()=>{var e,t,n;return[1==(null==(e=Z(a))?void 0:e.is_cash)?(O(),L(F,{key:0},{default:U((()=>[R(E,{value:"40",color:"#ffbe00",checked:"true"}),R(i,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("現金")),1)])),_:1})])),_:1})):de("",!0),1==(null==(t=Z(a))?void 0:t.is_balance)?(O(),L(F,{key:1},{default:U((()=>[R(E,{value:"10",color:"#ffbe00"}),R(i,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("餘額")),1)])),_:1})])),_:1})):de("",!0),1==(null==(n=Z(a))?void 0:n.is_other)?(O(),L(F,{key:2},{default:U((()=>[R(E,{value:"",color:"#ffbe00"}),R(i,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("其他方式")),1)])),_:1})])),_:1})):de("",!0)]})),_:1})])),_:1}),"40"==m.value.pay_type?(O(),L(h,{key:0,class:"ti-payment-cashier"},{default:U((()=>[R(T,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=e=>l.value=e),placeholder:Z(Y)("請輸入實收金額"),focus:!0},null,8,["modelValue","placeholder"]),R(h,{class:"ti-payment-cashier-view"},{default:U((()=>[R(h,{class:"ti-payment-cashier-title"},{default:U((()=>[W(J(Z(Y)("找零")),1)])),_:1}),R(h,{class:"ti-payment-cashier-content"},{default:U((()=>[W(J(Z(se)(c.value>=0?c.value:0)),1)])),_:1})])),_:1})])),_:1})):de("",!0),"40"!=m.value.pay_type&&"10"!=m.value.pay_type?(O(),L(h,{key:1,class:"ti-payment-other"},{default:U((()=>[R(h,{class:"ti-other-title"},{default:U((()=>[W(J(Z(Y)("用戶通過店內掃碼等方式進行支付，確認用戶支付完成後，點擊確認即可完成付款操作。")),1)])),_:1}),v.value&&v.value.length>0?(O(),L(h,{key:0,class:"ti-other-list"},{default:U((()=>[(O(!0),X(ee,null,te(v.value,(e=>(O(),L(h,{key:e.value,class:j([{active:e.value==m.value.pay_type},"ti-other-item"]),onClick:t=>(m.value.pay_type=e.value,o.value=e)},{default:U((()=>[R(h,{class:"ti-other-image"},{default:U((()=>[R(S,{src:Z(Fe)(e.img),mode:"widthFix"},null,8,["src"])])),_:2},1024),R(h,{class:"ti-other-text"},{default:U((()=>[W(J(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(O(),L(B,{key:1}))])),_:1})):de("",!0),(null==(t=u.memberDetail)?void 0:t.user_id)?(O(),L(h,{key:2,class:"ti-payment-member"},{default:U((()=>[R(h,{class:"ti-payment-top"},{default:U((()=>[R(h,{class:"ti-payment-top-name"},{default:U((()=>[W(J(Z(Y)("會員")),1)])),_:1}),R(h,{class:"ti-payment-top-discomfort",onClick:b},{default:U((()=>[W(J(Z(Y)("不使用此會員")),1)])),_:1})])),_:1}),R(h,{class:"ti-member-list"},{default:U((()=>[R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("暱稱")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J((null==(e=u.memberDetail)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("會員卡/等級")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e,t,a,n,i,r,s,o;return[W(J(`${1!=(null==(t=null==(e=u.memberDetail)?void 0:e.cardRecord)?void 0:t.disabled)&&(null==(n=null==(a=u.memberDetail)?void 0:a.card)?void 0:n.card_name)?null==(r=null==(i=u.memberDetail)?void 0:i.card)?void 0:r.card_name:"-"}/${(null==(o=null==(s=u.memberDetail)?void 0:s.grade)?void 0:o.name)||"-"}`),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("餘額")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J(Z(ke)(null==(e=u.memberDetail)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("積分")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J((null==(e=u.memberDetail)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1})])),_:1})):de("",!0),R(li,{show:p.value,"onUpdate:show":n[1]||(n[1]=e=>p.value=e),orderId:u.orderId,onChange:w},null,8,["show","orderId"]),R(ni,{show:y.value,"onUpdate:show":n[2]||(n[2]=e=>y.value=e),sendKitchen:D.value},null,8,["show","sendKitchen"]),R(ci,{show:s.value,"onUpdate:show":n[3]||(n[3]=e=>s.value=e),payItem:o.value,onSuccess:x},null,8,["show","payItem"])]})),_:1})])),footer:U((()=>["40"==m.value.pay_type?(O(),L(h,{key:0,class:"keyboard-back"},{default:U((()=>[R(P,{isExit:!1,isPrimary:!1,isDoubleZero:!0,isCross:!1,isDrop:!0,onInput:d,onClear:f})])),_:1})):de("",!0),R(h,{class:"ti-dialog-btn"},{default:U((()=>[R(z,{onClick:n[4]||(n[4]=e=>r("update:show",!1))},{default:U((()=>[W(J(Z(Y)("退出")),1)])),_:1}),R(z,{loading:g.value,onClick:A},{default:U((()=>[W(J(Z(Y)("打印")),1)])),_:1},8,["loading"]),R(z,{onClick:n[5]||(n[5]=e=>p.value=!0)},{default:U((()=>[W(J(Z(Y)("会员")),1)])),_:1}),R(z,{loading:_.value,type:"primary",onClick:k},{default:U((()=>[W(J(Z(Y)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},fi=T(di,[["__scopeId","data-v-0df11180"]]),hi=T({__name:"lock",emits:["unlock"],setup(e,{emit:t}){const a=t,n=()=>{a("unlock")};return(e,t)=>{const a=N(M("uni-icons"),Ce),i=$,r=N(M("ti-button"),G);return O(),L(i,{class:"ti-lock-view"},{default:U((()=>[R(i,{class:"ti-lock-center"},{default:U((()=>[R(a,{"custom-prefix":"iconfont",type:"icon-lock",size:"36",color:"#FFFFFF"}),R(i,{class:"ti-lock-message"},{default:U((()=>[W(J(e.$t("核对单已打印，订单已锁定")),1)])),_:1}),R(i,null,{default:U((()=>[R(r,{class:"ti-lock-unlock",type:"primary",title:e.$t("解锁"),onClick:n},null,8,["title"])])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-9539fd08"]]),pi=T({__name:"pay-result",props:{show:{type:Boolean,default:!1},payResult:{type:Object,default:()=>{}}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=()=>{a("update:show",!1),a("success")},u=async()=>{var e;const t={order_id:null==(e=n.payResult)?void 0:e.order_id};try{i.value=!0;const e=await si(t);uni.showToast({title:e.msg,icon:"none"})}catch(a){uni.showToast({title:a.msg,icon:"none"})}finally{i.value=!1}},s=async()=>{var e;const t={order_id:null==(e=n.payResult)?void 0:e.order_id};try{i.value=!0;const e=await oi(t);uni.showToast({title:e.msg,icon:"none"})}catch(a){uni.showToast({title:a.msg,icon:"none"})}finally{i.value=!1}};return(t,a)=>{const o=$,l=N(M("ti-button"),G),c=N(M("ti-modal"),H);return O(),L(c,{class:"ti-action-tips-pay",show:n.show,confirmText:t.$t("已支付"),onCancel:r},{title:U((()=>[R(o)])),content:U((()=>[R(o,{class:"ti-pay-container"},{default:U((()=>[R(o,{class:"ti-pay-title-box"},{default:U((()=>[R(o,{class:"ti-pay-title"},{default:U((()=>[W(J("收款"))])),_:1})])),_:1}),R(o,{class:"ti-pay-content"},{default:U((()=>{var a,n;return[R(o,{class:"ti-data-other-item"},{default:U((()=>[R(o,{class:"ti-data-other-item-title"},{default:U((()=>[W(J(t.$t("应收金额")),1)])),_:1}),R(o,{class:"ti-data-other-item-content-box"},{default:U((()=>[R(o,{class:"ti-data-other-item-content"},{default:U((()=>{var t;return[W(J(Z(se)(null==(t=e.payResult)?void 0:t.pay_price)),1)]})),_:1}),R(o,{class:"ti-data-other-item-sub-content"},{default:U((()=>{var t;return[W(J(Z(oe)(null==(t=e.payResult)?void 0:t.pay_price)),1)]})),_:1})])),_:1})])),_:1}),R(o,{class:"ti-data-other-item"},{default:U((()=>[R(o,{class:"ti-data-other-item-title"},{default:U((()=>[W(J(t.$t("支付方式")),1)])),_:1}),R(o,{class:"ti-data-other-item-content-box"},{default:U((()=>[R(o,{class:"ti-data-other-item-content"},{default:U((()=>{var t,a,n,i,r,u;return[W(J((null==(a=null==(t=e.payResult)?void 0:t.pay_type)?void 0:a.text.length)>8?(null==(i=null==(n=e.payResult)?void 0:n.pay_type)?void 0:i.text.slice(0,10))+"...":null==(u=null==(r=e.payResult)?void 0:r.pay_type)?void 0:u.text),1)]})),_:1})])),_:1})])),_:1}),R(o,{class:"ti-data-other-item"},{default:U((()=>[R(o,{class:"ti-data-other-item-title"},{default:U((()=>[W(J(t.$t("实收金额")),1)])),_:1}),R(o,{class:"ti-data-other-item-content-box"},{default:U((()=>[R(o,{class:"ti-data-other-item-content"},{default:U((()=>{var t;return[W(J(Z(se)(null==(t=e.payResult)?void 0:t.actual_price)),1)]})),_:1}),R(o,{class:"ti-data-other-item-sub-content"},{default:U((()=>{var t;return[W(J(Z(oe)(null==(t=e.payResult)?void 0:t.actual_price)),1)]})),_:1})])),_:1})])),_:1}),40==(null==(n=null==(a=e.payResult)?void 0:a.pay_type)?void 0:n.value)?(O(),L(o,{key:0,class:"ti-data-other-item"},{default:U((()=>[R(o,{class:"ti-data-other-item-title"},{default:U((()=>[W(J(t.$t("找零")),1)])),_:1}),R(o,{class:"ti-data-other-item-content-box"},{default:U((()=>[R(o,{class:"ti-data-other-item-content"},{default:U((()=>{var t;return[W(J(Z(se)(null==(t=e.payResult)?void 0:t.change_due)),1)]})),_:1}),R(o,{class:"ti-data-other-item-sub-content"},{default:U((()=>{var t;return[W(J(Z(oe)(null==(t=e.payResult)?void 0:t.change_due)),1)]})),_:1})])),_:1})])),_:1})):de("",!0)]})),_:1})])),_:1})])),footer:U((()=>[R(o,{class:"ti-dialog-btn"},{default:U((()=>[R(l,{onClick:r},{default:U((()=>[W(J(t.$t("退出")),1)])),_:1}),R(l,{loading:i.value,onClick:u},{default:U((()=>[W(J(t.$t("打印小票")),1)])),_:1},8,["loading"]),R(l,{loading:i.value,type:"primary",onClick:s},{default:U((()=>[W(J(t.$t("发票")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","confirmText"])}}},[["__scopeId","data-v-aec3a359"]]),vi=T({__name:"cart-list",setup(e,{expose:t}){const{cashierIsLock:a,isPaying:n}=Se(Jn()),{pathName:i}=Se(Oe()),r=F(),u=F(!1),s=F(!1),o=F({}),l=F(0),c=F({}),d=F({}),f=F([]),h=F(),p=F({}),v=F(),m=F(0),_=F(0),g=F(!1),y=F({}),D=()=>{n.value=0,g.value=!1,$e(),P({})},w=(e,t)=>{"handleSubmit"==t?(g.value=!0,y.value=e):P(e,t)},b=()=>{je((()=>{qe().in(this).select("#ti-cart-scroll").fields({size:!0,scrollOffset:!0},(e=>{m.value=e.scrollHeight-e.height})).exec()}))},C=async()=>{if(h.value<=0)return uni.showToast({title:Y("订单ID不存在"),icon:"none"});try{const e=await Hn({order_id:h.value});uni.showToast({title:e.msg,icon:"none"}),P(e.data.res)}catch(e){}},A=F(0),x=F(!1),E=F(""),I=F([]),T=async()=>{const e={order_id:h.value};try{const t=await Wn(e);A.value=t.code,(null==t?void 0:t.data)&&(null==t?void 0:t.data.length)>0?(I.value=null==t?void 0:t.data,E.value=null==t?void 0:t.msg,x.value=!0):u.value=!0}catch(t){A.value=null==t?void 0:t.code,(null==t?void 0:t.data)&&(null==t?void 0:t.data.length)>0?(I.value=null==t?void 0:t.data,E.value=null==t?void 0:t.msg,x.value=!0):uni.showToast({title:null==t?void 0:t.msg,icon:"none"})}},S=()=>{1==A.value&&(u.value=!0)},B=async(e,t)=>{var a,i;const r={...d.value};r.order_id=we();try{e&&(s.value=!0);const u=await function(e){return k("order.cart/list",e,{isLoading:!1})}(r);if((null==(a=u.data)?void 0:a.order_id)&&le(u.data.order_id),1==n.value)return;P(null==(i=u.data)?void 0:i.allProductInfo,t)}catch(u){}finally{e&&(s.value=!1)}},P=(e,t)=>{var n,u,s,d;if(a.value=(null==(n=null==e?void 0:e.orderInfo)?void 0:n.is_lock)||0,p.value={discount_ratio:null==(u=null==e?void 0:e.orderInfo)?void 0:u.discount_ratio},c.value=(null==e?void 0:e.sumInfo)||{},_.value--,_.value<0&&(_.value=0),0==_.value&&(f.value=(null==(s=null==e?void 0:e.orderInfo)?void 0:s.product)||[]),f.value&&f.value.length>0){let a=0;"delete"==t?a=l.value-1:"add"==t?a=f.value.length-1:(null==(d=o.value)?void 0:d.order_product_id)&&(a=f.value.findIndex((e=>{var t;return e.order_product_id==(null==(t=o.value)?void 0:t.order_product_id)}))),o.value=f.value[Math.max(a,0)],l.value=Math.max(a,0),r.value=null==e?void 0:e.userInfo,h.value=we(),"index"==i.value&&(v.value&&clearTimeout(v.value),v.value=setTimeout((()=>{_.value=0,B()}),6e3))}else o.value=null,r.value=null,h.value=null,$e();"index"==i.value&&Re(ze(c.value),ze(f.value))};return Le((()=>{v.value&&clearTimeout(v.value)})),Ue("mini-cashier",(e=>{"index"==e&&Re(ze(c.value),ze(f.value))})),q((()=>i.value),(()=>{"index"==i.value?B(!0):v.value&&clearTimeout(v.value)}),{immediate:!0}),q((()=>f.value),(async(e,t)=>{e.length>t.length&&(await je(),b())})),t({handleResultCart:P,handleAddCart:(e,t)=>{_.value++;const a=f.value;a.push(t),f.value=a},getCartData:B,handleError:()=>{if(_.value>0){f.value.pop()}_.value--,_.value<0&&(_.value=0)}}),(e,t)=>{var n,i;const d=$,v=N(M("ti-loading"),ie),_=ce,b=N(M("ti-empty-data"),re),A=ae,k=be,F=_e("permission");return O(),X(ee,null,[R(d,{class:"ti-cart-box"},{default:U((()=>[R(d,{class:"ti-cart-list"},{default:U((()=>[R(d,{class:"ti-cart-head"},{default:U((()=>[R(d,{class:"ti-cart-shop-head"},{default:U((()=>[R(d,{class:"ti-shop-head-title"},{default:U((()=>[W(J(Z(Y)("商品名稱")),1)])),_:1}),R(d,{class:"ti-shop-head-money"},{default:U((()=>[W(J(Z(Y)("数量")),1)])),_:1}),R(d,{class:"ti-shop-head-num"},{default:U((()=>[R(d),R(d,null,{default:U((()=>[W(J(Z(Y)("小计")),1)])),_:1})])),_:1})])),_:1})])),_:1}),R(d,{class:"ti-shop-list"},{default:U((()=>[R(A,{id:"ti-cart-scroll","scroll-y":"","enable-flex":"","scroll-with-animation":"","scroll-top":m.value},{default:U((()=>[s.value?(O(),L(v,{key:0})):f.value&&f.value.length>0?(O(),L(d,{key:1,class:"ti-shop-box"},{default:U((()=>[(O(!0),X(ee,null,te(f.value,((e,t)=>{var a;return O(),L(d,{key:e,class:j([{active:(null==(a=o.value)?void 0:a.order_product_id)==(null==e?void 0:e.order_product_id)},"ti-shop-item"]),onClick:a=>((e,t)=>{var a;(null==(a=o.value)?void 0:a.order_product_id)!=(null==e?void 0:e.order_product_id)&&(o.value=e,l.value=t)})(e,t)},{default:U((()=>[R(d,{class:"ti-shop-item-box"},{default:U((()=>[R(d,{class:"ti-shop-body"},{default:U((()=>[R(d,{class:"ti-shop-body-top"},{default:U((()=>[R(d,{class:"ti-shop-title text-ellipsis"},{default:U((()=>[W(J(e.product_name_text||e.product_name),1)])),_:2},1024),e.product_attr?(O(),L(d,{key:0,class:"ti-shop-spec"},{default:U((()=>[W("( "+J(e.product_attr)+" )",1)])),_:2},1024)):de("",!0)])),_:2},1024),R(ui,{productItem:e,onChange:P},null,8,["productItem"]),R(d,{class:"ti-shop-body-money"},{default:U((()=>[R(_,{class:"ti-shop-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.total_product_price)||0)),1)])),_:2},1024),R(_,{class:"ti-shop-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.total_product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),e.remark?(O(),L(d,{key:0,class:"ti-shop-remark"},{default:U((()=>[W(J(e.remark),1)])),_:2},1024)):de("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])})),128))])),_:1})):(O(),L(b,{key:2}))])),_:1},8,["scroll-top"])])),_:1}),1==Z(a)?(O(),L(hi,{key:0,onUnlock:C})):de("",!0)])),_:1}),R(d,{class:"ti-cart-statistics"},{default:U((()=>[R(d,{class:"ti-cart-total"},{default:U((()=>[R(_,{class:"ti-total-text"},{default:U((()=>[W(J(Z(Y)("商品金额:")),1)])),_:1}),R(_,{class:"ti-total-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=c.value)?void 0:e.subtotal)||0)),1)]})),_:1}),R(_,{class:"ti-total-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=c.value)?void 0:e.subtotal)||0)),1)]})),_:1})])),_:1}),R(d,{class:"ti-cart-discount"},{default:U((()=>[R(d,{class:"ti-discount-item"},{default:U((()=>[R(d,null,{default:U((()=>[R(_,{class:"ti-discount-text"},{default:U((()=>[W(J(Z(Y)("服務費:")),1)])),_:1}),R(_,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=c.value)?void 0:e.service_money)||0)),1)]})),_:1}),R(_,{class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=c.value)?void 0:e.service_money)||0)),1)]})),_:1})])),_:1}),R(d,null,{default:U((()=>{var e;return[R(_,{class:"ti-discount-text"},{default:U((()=>[W(J(Z(Y)("優惠折扣:")),1)])),_:1}),R(_,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(`-${Z(se)((null==(e=c.value)?void 0:e.special_discount)||0)}`),1)]})),_:1}),Z(oe)((null==(e=c.value)?void 0:e.special_discount)||0)?(O(),L(_,{key:0,class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(`-${Z(oe)((null==(e=c.value)?void 0:e.special_discount)||0)}`),1)]})),_:1})):de("",!0)]})),_:1})])),_:1}),R(d,{class:"ti-discount-item"},{default:U((()=>[R(d,null,{default:U((()=>[R(_,{class:"ti-discount-text"},{default:U((()=>[W(J(Z(Y)("消費稅:")),1)])),_:1}),R(_,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=c.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1}),R(_,{class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=c.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1})])),_:1}),R(d,null,{default:U((()=>{var e;return[R(_,{class:"ti-discount-text"},{default:U((()=>[W(J(Z(Y)("會員折扣:")),1)])),_:1}),R(_,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(`-${Z(se)((null==(e=c.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1}),Z(oe)((null==(e=c.value)?void 0:e.total_user_discount_money)||0)?(O(),L(_,{key:0,class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(`-${Z(oe)((null==(e=c.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1})):de("",!0)]})),_:1})])),_:1})])),_:1}),R(d,{class:"ti-cart-settlement"},{default:U((()=>{var e,t;return[R(d,{class:"ti-settlement-total"},{default:U((()=>[R(_,{class:"ti-settlement-text"},{default:U((()=>[W(J(Z(Y)("合计应收：")),1)])),_:1}),R(_,{class:"ti-settlement-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=c.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),R(_,{class:"ti-settlement-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=c.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1}),ge((O(),L(k,{class:"ti-settlement-btn",disabled:!(null==(e=c.value)?void 0:e.total_num)||(null==(t=c.value)?void 0:t.total_num)<=0,onClick:T},{default:U((()=>{var e;return[R(_,null,{default:U((()=>[W(J(Z(Y)("結賬")),1)])),_:1}),(null==(e=c.value)?void 0:e.total_num)>0?(O(),L(_,{key:0,class:"ti-settlement-badge"},{default:U((()=>{var e;return[W(J(null==(e=c.value)?void 0:e.total_num),1)]})),_:1})):de("",!0)]})),_:1},8,["disabled"])),[[F,["cashier_cash_settle"]]])]})),_:1})])),_:1})])),_:1}),R(ri,{productItem:o.value,orderId:h.value,preferentialData:p.value,totalPayPrice:null==(n=c.value)?void 0:n.total_pay_price,orderList:f.value,isLock:Z(a),onSuccess:P},null,8,["productItem","orderId","preferentialData","totalPayPrice","orderList","isLock"]),R(fi,{show:u.value,"onUpdate:show":t[0]||(t[0]=e=>u.value=e),orderId:h.value,totalPayPrice:null==(i=c.value)?void 0:i.total_pay_price,memberDetail:r.value,onSuccess:w},null,8,["show","orderId","totalPayPrice","memberDetail"]),R(pi,{show:g.value,"onUpdate:show":t[1]||(t[1]=e=>g.value=e),payResult:y.value,onSuccess:D},null,8,["show","payResult"]),R(ni,{show:x.value,"onUpdate:show":t[2]||(t[2]=e=>x.value=e),cancelShow:!0,sendKitchen:I.value,msg:E.value,onConfirm:S},null,8,["show","sendKitchen","msg"])],64)}}},[["__scopeId","data-v-c38115f5"]]),mi={__name:"ti-category",props:{scrollLeft:{type:Number,default:0},scrollInterval:{type:Number,default:200},threshold:{type:Number,default:5}},setup(e,{expose:t}){const a=e,n=F(0),i=F(!1),r=F(!1),u=F(0),s=F(0),o=F(`ti-${Ve(16)}`);q((()=>a.scrollLeft),(()=>{n.value=a.scrollLeft}));const l=Pn((e=>{n.value=e.detail.scrollLeft,i.value=a.threshold<e.detail.scrollLeft,r.value=s.value+e.detail.scrollLeft<e.detail.scrollWidth-a.threshold}),300),c=()=>{i.value=!1},d=()=>{r.value=!1},f=e=>{let t=0;"left"==e?t=n.value-a.scrollInterval:"right"==e&&(t=n.value+a.scrollInterval);const i=u.value-s.value;n.value=Math.min(i,Math.max(t,0))},h=async()=>{await je();qe().in(this).select(`#${o.value}`).fields({size:!0,scrollOffset:!0},(e=>{e&&(n.value=(null==e?void 0:e.scrollLeft)||0,s.value=(null==e?void 0:e.width)||0,u.value=(null==e?void 0:e.scrollWidth)||0,r.value=u.value>s.value+n.value,i.value=a.threshold<n.value)})).exec()};return Ke((()=>{h(),window.addEventListener("resize",h)})),Le((()=>{window.removeEventListener("resize",h)})),t({getScrollWidth:h}),(e,t)=>{const u=N(M("uni-icons"),Ce),s=$,h=ae;return O(),L(s,{class:"ti-category-box"},{default:U((()=>[i.value?(O(),L(s,{key:0,class:"ti-category-left",onClick:t[0]||(t[0]=e=>f("left"))},{default:U((()=>[R(s,{class:"ti-category-btn"},{default:U((()=>[R(u,{type:"left",size:"14",color:"#100A05"})])),_:1})])),_:1})):de("",!0),R(h,{id:o.value,class:"ti-category","scroll-left":n.value,"scroll-x":"","enable-flex":"","scroll-with-animation":"","upper-threshold":a.threshold,"lower-threshold":a.threshold,onScrolltoupper:c,onScrolltolower:d,onScroll:Z(l)},{default:U((()=>[He(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","scroll-left","upper-threshold","lower-threshold","onScroll"]),r.value?(O(),L(s,{key:1,class:"ti-category-right",onClick:t[1]||(t[1]=e=>f("right"))},{default:U((()=>[R(s,{class:"ti-category-btn"},{default:U((()=>[R(u,{type:"right",size:"14",color:"#100A05"})])),_:1})])),_:1})):de("",!0)])),_:3})}}},_i=T(mi,[["__scopeId","data-v-13cf2c63"]]),gi=T({__name:"dish-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null},defaultIndex:{type:Number,default:0}},emits:["update:menuId"],setup(e,{emit:t}){const{pathName:a}=Se(Oe()),n=t,i=e,r=F(0),u=F(i.defaultIndex),s=F([]),o=F(),l=()=>{var e,t;if(!i.list||0==i.list.length||"index"!=a.value)return;const n=qe().in(this);null==(e=i.list)||e.map(((e,t)=>{n.select(`#scroll-index-${t}`).boundingClientRect((e=>{if(!e)return;const a=s.value;a[t]=e.width+10,s.value=a})).exec()})),c(u.value),null==(t=o.value)||t.getScrollWidth()};q((()=>a.value),(async()=>{await je(),l()}),{deep:!0,immediate:!0}),q((()=>i.list),(async()=>{await je(),l()}),{deep:!0,immediate:!0});const c=e=>{u.value=e,r.value=s.value.slice(0,e+1).reduce(((e,t)=>e+t),0)-(s.value[e]+100),n("update:menuId",i.list[e].category_id)};return(e,t)=>{const a=ce,n=$,s=N(M("ti-category"),_i);return O(),L(n,{class:"ti-dish-menu"},{default:U((()=>[i.list&&i.list.length>0?(O(),L(s,{key:0,ref_key:"scrollRef",ref:o,scrollLeft:r.value},{default:U((()=>[R(n,{class:"ti-menu-content"},{default:U((()=>[(O(!0),X(ee,null,te(i.list,((e,t)=>(O(),L(n,{key:t,class:j(["ti-menu-item",{active:t==u.value}]),id:`scroll-index-${t}`,onClick:e=>c(t)},{default:U((()=>[R(a,{class:"ti-menu-title"},{default:U((()=>[W(J(e.name[Z(fe)()]||e.name_text),1)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scrollLeft"])):de("",!0)])),_:1})}}},[["__scopeId","data-v-39379e9b"]]),yi=T({__name:"dish-category",props:{categoryId:{type:Number,default:null}},emits:["update:categoryId","update:isSpecial"],setup(e,{emit:t}){const a=We(),{categoryList:n}=Se(a),i=t,r=F(),u=F(0),s=F(0),o=ne((()=>{let e=(n.value.find((e=>e.category_id==u.value))||{}).child||[];return e&&e.length>0&&(e=[Je].concat(e)),e})),l=ne((()=>n.value.find((e=>e.category_id==u.value)))),c=ne((()=>o.value.find((e=>e.category_id==s.value))));q((()=>u.value),(()=>{var e,t;i("update:isSpecial",null==(e=l.value)?void 0:e.is_special),i("update:categoryId",u.value),o.value&&o.value.length>0&&(s.value=o.value[0].category_id,d(s.value)),null==(t=r.value)||t.getScrollWidth()}));const d=e=>{var t;s.value=e,i("update:isSpecial",null==(t=c.value)?void 0:t.is_special),i("update:categoryId",s.value>0?s.value:u.value)};return null==a||a.getCategory(),(e,t)=>{const a=$,i=N(M("ti-category"),_i);return O(),L(a,{class:"ti-category-content"},{default:U((()=>[R(gi,{list:Z(n),menuId:u.value,"onUpdate:menuId":t[0]||(t[0]=e=>u.value=e)},null,8,["list","menuId"]),o.value&&o.value.length>0?(O(),L(a,{key:0,class:"ti-dish-secondary"},{default:U((()=>[R(i,{ref_key:"categoryRef",ref:r},{default:U((()=>[R(a,{class:"ti-secondary-box"},{default:U((()=>[(O(!0),X(ee,null,te(o.value,((e,t)=>(O(),L(a,{key:t,class:j([{active:e.category_id==s.value},"ti-secondary-item"]),onClick:t=>d(e.category_id)},{default:U((()=>[W(J(e.name[Z(fe)()]||e.name_text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},512)])),_:1})):de("",!0)])),_:1})}}},[["__scopeId","data-v-14066009"]]);function Di(){return Di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Di.apply(this,arguments)}var wi={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function bi(e){return"number"==typeof e}function Ci(e){return!(!e||"object"!=typeof e||"function"!=typeof e.constructor)&&(!0===e.isBigNumber&&"object"==typeof e.constructor.prototype&&!0===e.constructor.prototype.isBigNumber||"function"==typeof e.constructor.isDecimal&&!0===e.constructor.isDecimal(e))}function Ai(e){return e&&"object"==typeof e&&!0===Object.getPrototypeOf(e).isComplex||!1}function ki(e){return e&&"object"==typeof e&&!0===Object.getPrototypeOf(e).isFraction||!1}function xi(e){return e&&!0===e.constructor.prototype.isUnit||!1}function Ei(e){return"string"==typeof e}var Fi=Array.isArray;function Ii(e){return e&&!0===e.constructor.prototype.isMatrix||!1}function Ti(e){return Array.isArray(e)||Ii(e)}function Si(e){return e&&e.isDenseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function Bi(e){return e&&e.isSparseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function Ni(e){return e&&!0===e.constructor.prototype.isRange||!1}function Pi(e){return e&&!0===e.constructor.prototype.isIndex||!1}function Mi(e){return"boolean"==typeof e}function Oi(e){return e&&!0===e.constructor.prototype.isResultSet||!1}function Li(e){return e&&!0===e.constructor.prototype.isHelp||!1}function Ui(e){return"function"==typeof e}function Ri(e){return e instanceof Date}function zi(e){return e instanceof RegExp}function ji(e){return!(!e||"object"!=typeof e||e.constructor!==Object||Ai(e)||ki(e))}function $i(e){return null===e}function qi(e){return void 0===e}function Vi(e){return e&&!0===e.isAccessorNode&&!0===e.constructor.prototype.isNode||!1}function Ki(e){return e&&!0===e.isArrayNode&&!0===e.constructor.prototype.isNode||!1}function Hi(e){return e&&!0===e.isAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function Wi(e){return e&&!0===e.isBlockNode&&!0===e.constructor.prototype.isNode||!1}function Ji(e){return e&&!0===e.isConditionalNode&&!0===e.constructor.prototype.isNode||!1}function Zi(e){return e&&!0===e.isConstantNode&&!0===e.constructor.prototype.isNode||!1}function Yi(e){return e&&!0===e.isFunctionAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function Gi(e){return e&&!0===e.isFunctionNode&&!0===e.constructor.prototype.isNode||!1}function Qi(e){return e&&!0===e.isIndexNode&&!0===e.constructor.prototype.isNode||!1}function Xi(e){return e&&!0===e.isNode&&!0===e.constructor.prototype.isNode||!1}function er(e){return e&&!0===e.isObjectNode&&!0===e.constructor.prototype.isNode||!1}function tr(e){return e&&!0===e.isOperatorNode&&!0===e.constructor.prototype.isNode||!1}function ar(e){return e&&!0===e.isParenthesisNode&&!0===e.constructor.prototype.isNode||!1}function nr(e){return e&&!0===e.isRangeNode&&!0===e.constructor.prototype.isNode||!1}function ir(e){return e&&!0===e.isRelationalNode&&!0===e.constructor.prototype.isNode||!1}function rr(e){return e&&!0===e.isSymbolNode&&!0===e.constructor.prototype.isNode||!1}function ur(e){return e&&!0===e.constructor.prototype.isChain||!1}function sr(e){var t=typeof e;return"object"===t?null===e?"null":Ci(e)?"BigNumber":e.constructor&&e.constructor.name?e.constructor.name:"Object":t}function or(e){var t=typeof e;if("number"===t||"string"===t||"boolean"===t||null==e)return e;if("function"==typeof e.clone)return e.clone();if(Array.isArray(e))return e.map((function(e){return or(e)}));if(e instanceof Date)return new Date(e.valueOf());if(Ci(e))return e;if(ji(e))return function(e,t){var a={};for(var n in e)cr(e,n)&&(a[n]=t(e[n]));return a}(e,or);throw new TypeError("Cannot clone: unknown type of value (value: ".concat(e,")"))}function lr(e,t){var a,n,i;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(n=0,i=e.length;n<i;n++)if(!lr(e[n],t[n]))return!1;return!0}if("function"==typeof e)return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(a in e)if(!(a in t)||!lr(e[a],t[a]))return!1;for(a in t)if(!(a in e))return!1;return!0}return e===t}function cr(e,t){return e&&Object.hasOwnProperty.call(e,t)}var dr=function(e){if(e)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(wi)};function fr(){return!0}function hr(){return!1}function pr(){}Di(dr,wi,{MATRIX_OPTIONS:["Matrix","Array"],NUMBER_OPTIONS:["number","BigNumber","Fraction"]});const vr="Argument is not a typed-function.";const mr=function e(){function t(e){return"object"==typeof e&&null!==e&&e.constructor===Object}const a=[{name:"number",test:function(e){return"number"==typeof e}},{name:"string",test:function(e){return"string"==typeof e}},{name:"boolean",test:function(e){return"boolean"==typeof e}},{name:"Function",test:function(e){return"function"==typeof e}},{name:"Array",test:Array.isArray},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:t},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}}],n={name:"any",test:fr,isAny:!0};let i,r,u=0,s={createCount:0};function o(e){const t=i.get(e);if(t)return t;let a='Unknown type "'+e+'"';const n=e.toLowerCase();let u;for(u of r)if(u.toLowerCase()===n){a+='. Did you mean "'+u+'" ?';break}throw new TypeError(a)}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any";const a=t?o(t).index:r.length,n=[];for(let r=0;r<e.length;++r){if(!e[r]||"string"!=typeof e[r].name||"function"!=typeof e[r].test)throw new TypeError("Object with properties {name: string, test: function} expected");const t=e[r].name;if(i.has(t))throw new TypeError('Duplicate type name "'+t+'"');n.push(t),i.set(t,{name:t,test:e[r].test,isAny:e[r].isAny,index:a+r,conversionsTo:[]})}const u=r.slice(a);r=r.slice(0,a).concat(n).concat(u);for(let s=a+n.length;s<r.length;++s)i.get(r[s]).index=s}function c(){i=new Map,r=[],u=0,l([n],!1)}function d(e){const t=r.filter((t=>{const a=i.get(t);return!a.isAny&&a.test(e)}));return t.length?t:["any"]}function f(e){return e&&"function"==typeof e&&"_typedFunctionData"in e}function h(e,t,a){if(!f(e))throw new TypeError(vr);const n=a&&a.exact,i=g(Array.isArray(t)?t.join(","):t),r=p(i);if(!n||r in e.signatures){const t=e._typedFunctionData.signatureMap.get(r);if(t)return t}const u=i.length;let s,o;if(n){let t;for(t in s=[],e.signatures)s.push(e._typedFunctionData.signatureMap.get(t))}else s=e._typedFunctionData.signatures;for(let l=0;l<u;++l){const e=i[l],t=[];let a;for(a of s){const n=b(a.params,l);if(n&&(!e.restParam||n.restParam)){if(!n.hasAny){const t=_(n);if(e.types.some((e=>!t.has(e.name))))continue}t.push(a)}}if(s=t,0===s.length)break}for(o of s)if(o.params.length<=u)return o;throw new TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+p(i,", ")+"))")}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.map((e=>e.name)).join(t)}function v(e){const t=0===e.indexOf("..."),a=(t?e.length>3?e.slice(3):"any":e).split("|").map((e=>o(e.trim())));let n=!1,i=t?"...":"";return{types:a.map((function(e){return n=e.isAny||n,i+=e.name+"|",{name:e.name,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:null,conversionIndex:-1}})),name:i.slice(0,-1),hasAny:n,hasConversion:!1,restParam:t}}function m(e){const t=function(e){if(0===e.length)return[];const t=e.map(o);e.length>1&&t.sort(((e,t)=>e.index-t.index));let a=t[0].conversionsTo;if(1===e.length)return a;a=a.concat([]);const n=new Set(e);for(let i=1;i<t.length;++i){let e;for(e of t[i].conversionsTo)n.has(e.from)||(a.push(e),n.add(e.from))}return a}(e.types.map((e=>e.name)));let a=e.hasAny,n=e.name;const i=t.map((function(e){const t=o(e.from);return a=t.isAny||a,n+="|"+e.from,{name:e.from,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:e,conversionIndex:e.index}}));return{types:e.types.concat(i),name:n,hasAny:a,hasConversion:i.length>0,restParam:e.restParam}}function _(e){return e.typeSet||(e.typeSet=new Set,e.types.forEach((t=>e.typeSet.add(t.name)))),e.typeSet}function g(e){const t=[];if("string"!=typeof e)throw new TypeError("Signatures must be strings");const a=e.trim();if(""===a)return t;const n=a.split(",");for(let i=0;i<n.length;++i){const e=v(n[i].trim());if(e.restParam&&i!==n.length-1)throw new SyntaxError('Unexpected rest parameter "'+n[i]+'": only allowed for the last parameter');if(0===e.types.length)return null;t.push(e)}return t}function y(e){const t=z(e);return!!t&&t.restParam}function D(e){if(e&&0!==e.types.length){if(1===e.types.length)return o(e.types[0].name).test;if(2===e.types.length){const t=o(e.types[0].name).test,a=o(e.types[1].name).test;return function(e){return t(e)||a(e)}}{const t=e.types.map((function(e){return o(e.name).test}));return function(e){for(let a=0;a<t.length;a++)if(t[a](e))return!0;return!1}}}return fr}function w(e){let t,a,n;if(y(e)){t=R(e).map(D);const a=t.length,n=D(z(e)),i=function(e){for(let t=a;t<e.length;t++)if(!n(e[t]))return!1;return!0};return function(e){for(let a=0;a<t.length;a++)if(!t[a](e[a]))return!1;return i(e)&&e.length>=a+1}}return 0===e.length?function(e){return 0===e.length}:1===e.length?(a=D(e[0]),function(e){return a(e[0])&&1===e.length}):2===e.length?(a=D(e[0]),n=D(e[1]),function(e){return a(e[0])&&n(e[1])&&2===e.length}):(t=e.map(D),function(e){for(let a=0;a<t.length;a++)if(!t[a](e[a]))return!1;return e.length===t.length})}function b(e,t){return t<e.length?e[t]:y(e)?z(e):null}function C(e,t){const a=b(e,t);return a?_(a):new Set}function A(e){return null===e.conversion||void 0===e.conversion}function k(e,t){const a=new Set;return e.forEach((e=>{const n=C(e.params,t);let i;for(i of n)a.add(i)})),a.has("any")?["any"]:Array.from(a)}function x(e,t,a){let n,i;const r=e||"unnamed";let u,s=a;for(u=0;u<t.length;u++){const e=[];if(s.forEach((a=>{const n=D(b(a.params,u));(u<a.params.length||y(a.params))&&n(t[u])&&e.push(a)})),0===e.length){if(i=k(s,u),i.length>0){const e=d(t[u]);return n=new TypeError("Unexpected type of argument in function "+r+" (expected: "+i.join(" or ")+", actual: "+e.join(" | ")+", index: "+u+")"),n.data={category:"wrongType",fn:r,index:u,actual:e,expected:i},n}}else s=e}const o=s.map((function(e){return y(e.params)?1/0:e.params.length}));if(t.length<Math.min.apply(null,o))return i=k(s,u),n=new TypeError("Too few arguments in function "+r+" (expected: "+i.join(" or ")+", index: "+t.length+")"),n.data={category:"tooFewArgs",fn:r,index:t.length,expected:i},n;const l=Math.max.apply(null,o);if(t.length>l)return n=new TypeError("Too many arguments in function "+r+" (expected: "+l+", actual: "+t.length+")"),n.data={category:"tooManyArgs",fn:r,index:t.length,expectedLength:l},n;const c=[];for(let f=0;f<t.length;++f)c.push(d(t[f]).join("|"));return n=new TypeError('Arguments of type "'+c.join(", ")+'" do not match any of the defined signatures of function '+r+"."),n.data={category:"mismatch",actual:c},n}function E(e){let t=r.length+1;for(let a=0;a<e.types.length;a++)A(e.types[a])&&(t=Math.min(t,e.types[a].typeIndex));return t}function F(e){let t=u+1;for(let a=0;a<e.types.length;a++)A(e.types[a])||(t=Math.min(t,e.types[a].conversionIndex));return t}function I(e,t){if(e.hasAny){if(!t.hasAny)return 1}else if(t.hasAny)return-1;if(e.restParam){if(!t.restParam)return 1}else if(t.restParam)return-1;if(e.hasConversion){if(!t.hasConversion)return 1}else if(t.hasConversion)return-1;const a=E(e)-E(t);if(a<0)return-1;if(a>0)return 1;const n=F(e)-F(t);return n<0?-1:n>0?1:0}function T(e,t){const a=e.params,n=t.params,i=z(a),r=z(n),u=y(a),s=y(n);if(u&&i.hasAny){if(!s||!r.hasAny)return 1}else if(s&&r.hasAny)return-1;let o,l=0,c=0;for(o of a)o.hasAny&&++l,o.hasConversion&&++c;let d=0,f=0;for(o of n)o.hasAny&&++d,o.hasConversion&&++f;if(l!==d)return l-d;if(u&&i.hasConversion){if(!s||!r.hasConversion)return 1}else if(s&&r.hasConversion)return-1;if(c!==f)return c-f;if(u){if(!s)return 1}else if(s)return-1;const h=(a.length-n.length)*(u?-1:1);if(0!==h)return h;const p=[];let v,m=0;for(let _=0;_<a.length;++_){const e=I(a[_],n[_]);p.push(e),m+=e}if(0!==m)return m;for(v of p)if(0!==v)return v;return 0}function S(e,t){let a=t;if(e.some((e=>e.hasConversion))){const n=y(e),i=e.map(B);a=function(){const e=[],a=n?arguments.length-1:arguments.length;for(let t=0;t<a;t++)e[t]=i[t](arguments[t]);return n&&(e[a]=arguments[a].map(i[a])),t.apply(this,e)}}let n=a;if(y(e)){const t=e.length-1;n=function(){return a.apply(this,j(arguments,0,t).concat([j(arguments,t)]))}}return n}function B(e){let t,a,n,i;const r=[],u=[];switch(e.types.forEach((function(e){e.conversion&&(r.push(o(e.conversion.from).test),u.push(e.conversion.convert))})),u.length){case 0:return function(e){return e};case 1:return t=r[0],n=u[0],function(e){return t(e)?n(e):e};case 2:return t=r[0],a=r[1],n=u[0],i=u[1],function(e){return t(e)?n(e):a(e)?i(e):e};default:return function(e){for(let t=0;t<u.length;t++)if(r[t](e))return u[t](e);return e}}}function N(e){return function e(t,a,n){if(a<t.length){const u=t[a];let s=[];if(u.restParam){const e=u.types.filter(A);e.length<u.types.length&&s.push({types:e,name:"..."+e.map((e=>e.name)).join("|"),hasAny:e.some((e=>e.isAny)),hasConversion:!1,restParam:!0}),s.push(u)}else s=u.types.map((function(e){return{types:[e],name:e.name,hasAny:e.isAny,hasConversion:e.conversion,restParam:!1}}));return i=s,r=function(i){return e(t,a+1,n.concat([i]))},Array.prototype.concat.apply([],i.map(r))}return[n];var i,r}(e,0,[])}function P(e,t){const a=Math.max(e.length,t.length);for(let s=0;s<a;s++){const a=C(e,s),n=C(t,s);let i,r=!1;for(i of n)if(a.has(i)){r=!0;break}if(!r)return!1}const n=e.length,i=t.length,r=y(e),u=y(t);return r?u?n===i:i>=n:u?n>=i:n===i}function M(e,t,a){const n=[];let i;for(i of e){let e=a[i];if("number"!=typeof e)throw new TypeError('No definition for referenced signature "'+i+'"');if(e=t[e],"function"!=typeof e)return!1;n.push(e)}return n}function O(e,t,a){const n=function(e){return e.map((e=>K(e)?q(e.referToSelf.callback):V(e)?$(e.referTo.references,e.referTo.callback):e))}(e),i=new Array(n.length).fill(!1);let r=!0;for(;r;){r=!1;let e=!0;for(let u=0;u<n.length;++u){if(i[u])continue;const s=n[u];if(K(s))n[u]=s.referToSelf.callback(a),n[u].referToSelf=s.referToSelf,i[u]=!0,e=!1;else if(V(s)){const a=M(s.referTo.references,n,t);a?(n[u]=s.referTo.callback.apply(this,a),n[u].referTo=s.referTo,i[u]=!0,e=!1):r=!0}}if(e&&r)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return n}function L(e,t){if(s.createCount++,0===Object.keys(t).length)throw new SyntaxError("No signatures provided");s.warnAgainstDeprecatedThis&&function(e){const t=/\bthis(\(|\.signatures\b)/;Object.keys(e).forEach((a=>{const n=e[a];if(t.test(n.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")}))}(t);const a=[],n=[],i={},r=[];let u;for(u in t){if(!Object.prototype.hasOwnProperty.call(t,u))continue;const e=g(u);if(!e)continue;a.forEach((function(t){if(P(t,e))throw new TypeError('Conflicting signatures "'+p(t)+'" and "'+p(e)+'".')})),a.push(e);const s=n.length;n.push(t[u]);const o=e.map(m);let l;for(l of N(o)){const e=p(l);r.push({params:l,name:e,fn:s}),l.every((e=>!e.hasConversion))&&(i[e]=s)}}r.sort(T);const o=O(n,i,re);let l;for(l in i)Object.prototype.hasOwnProperty.call(i,l)&&(i[l]=o[i[l]]);const c=[],d=new Map;for(l of r)d.has(l.name)||(l.fn=o[l.fn],c.push(l),d.set(l.name,l));const f=c[0]&&c[0].params.length<=2&&!y(c[0].params),h=c[1]&&c[1].params.length<=2&&!y(c[1].params),v=c[2]&&c[2].params.length<=2&&!y(c[2].params),_=c[3]&&c[3].params.length<=2&&!y(c[3].params),b=c[4]&&c[4].params.length<=2&&!y(c[4].params),C=c[5]&&c[5].params.length<=2&&!y(c[5].params),A=f&&h&&v&&_&&b&&C;for(let s=0;s<c.length;++s)c[s].test=w(c[s].params);const k=f?D(c[0].params[0]):hr,x=h?D(c[1].params[0]):hr,E=v?D(c[2].params[0]):hr,F=_?D(c[3].params[0]):hr,I=b?D(c[4].params[0]):hr,B=C?D(c[5].params[0]):hr,M=f?D(c[0].params[1]):hr,L=h?D(c[1].params[1]):hr,U=v?D(c[2].params[1]):hr,R=_?D(c[3].params[1]):hr,z=b?D(c[4].params[1]):hr,j=C?D(c[5].params[1]):hr;for(let s=0;s<c.length;++s)c[s].implementation=S(c[s].params,c[s].fn);const $=f?c[0].implementation:pr,q=h?c[1].implementation:pr,V=v?c[2].implementation:pr,K=_?c[3].implementation:pr,H=b?c[4].implementation:pr,W=C?c[5].implementation:pr,J=f?c[0].params.length:-1,Z=h?c[1].params.length:-1,Y=v?c[2].params.length:-1,G=_?c[3].params.length:-1,Q=b?c[4].params.length:-1,X=C?c[5].params.length:-1,ee=A?6:0,te=c.length,ae=c.map((e=>e.test)),ne=c.map((e=>e.implementation)),ie=function(){for(let e=ee;e<te;e++)if(ae[e](arguments))return ne[e].apply(this,arguments);return s.onMismatch(e,arguments,c)};function re(e,t){return arguments.length===J&&k(e)&&M(t)?$.apply(this,arguments):arguments.length===Z&&x(e)&&L(t)?q.apply(this,arguments):arguments.length===Y&&E(e)&&U(t)?V.apply(this,arguments):arguments.length===G&&F(e)&&R(t)?K.apply(this,arguments):arguments.length===Q&&I(e)&&z(t)?H.apply(this,arguments):arguments.length===X&&B(e)&&j(t)?W.apply(this,arguments):ie.apply(this,arguments)}try{Object.defineProperty(re,"name",{value:e})}catch(ue){}return re.signatures=i,re._typedFunctionData={signatures:c,signatureMap:d},re}function U(e,t,a){throw x(e,t,a)}function R(e){return j(e,0,e.length-1)}function z(e){return e[e.length-1]}function j(e,t,a){return Array.prototype.slice.call(e,t,a)}function $(e,t){return{referTo:{references:e,callback:t}}}function q(e){if("function"!=typeof e)throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:e}}}function V(e){return e&&"object"==typeof e.referTo&&Array.isArray(e.referTo.references)&&"function"==typeof e.referTo.callback}function K(e){return e&&"object"==typeof e.referToSelf&&"function"==typeof e.referToSelf.callback}function H(e,t){if(!e)return t;if(t&&t!==e){const a=new Error("Function names do not match (expected: "+e+", actual: "+t+")");throw a.data={actual:t,expected:e},a}return e}function W(e){let t;for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(f(e[a])||"string"==typeof e[a].signature)&&(t=H(t,e[a].name));return t}function J(e,t){let a;for(a in t)if(Object.prototype.hasOwnProperty.call(t,a)){if(a in e&&t[a]!==e[a]){const n=new Error('Signature "'+a+'" is defined twice');throw n.data={signature:a,sourceFunction:t[a],destFunction:e[a]},n}e[a]=t[a]}}c(),l(a);const Z=s;function Y(e){if(!e||"string"!=typeof e.from||"string"!=typeof e.to||"function"!=typeof e.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(e.to===e.from)throw new SyntaxError('Illegal to define conversion from "'+e.from+'" to itself.')}return s=function(e){const a="string"==typeof e;let n=a?e:"";const i={};for(let r=a?1:0;r<arguments.length;++r){const e=arguments[r];let u,s={};if("function"==typeof e?(u=e.name,"string"==typeof e.signature?s[e.signature]=e:f(e)&&(s=e.signatures)):t(e)&&(s=e,a||(u=W(e))),0===Object.keys(s).length){const t=new TypeError("Argument to 'typed' at index "+r+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw t.data={index:r,argument:e},t}a||(n=H(n,u)),J(i,s)}return L(n||"",i)},s.create=e,s.createCount=Z.createCount,s.onMismatch=U,s.throwMismatchError=U,s.createError=x,s.clear=c,s.clearConversions=function(){let e;for(e of r)i.get(e).conversionsTo=[];u=0},s.addTypes=l,s._findType=o,s.referTo=function(){const e=R(arguments).map((e=>p(g(e)))),t=z(arguments);if("function"!=typeof t)throw new TypeError("Callback function expected as last argument");return $(e,t)},s.referToSelf=q,s.convert=function(e,t){const a=o(t);if(a.test(e))return e;const n=a.conversionsTo;if(0===n.length)throw new Error("There are no conversions to "+t+" defined.");for(let i=0;i<n.length;i++){if(o(n[i].from).test(e))return n[i].convert(e)}throw new Error("Cannot convert "+e+" to "+t)},s.findSignature=h,s.find=function(e,t,a){return h(e,t,a).implementation},s.isTypedFunction=f,s.warnAgainstDeprecatedThis=!0,s.addType=function(e,t){let a="any";!1!==t&&i.has("Object")&&(a="Object"),s.addTypes([e],a)},s.addConversion=function(e){Y(e);const t=o(e.to);if(!t.conversionsTo.every((function(t){return t.from!==e.from})))throw new Error('There is already a conversion from "'+e.from+'" to "'+t.name+'"');t.conversionsTo.push({from:e.from,convert:e.convert,index:u++})},s.addConversions=function(e){e.forEach(s.addConversion)},s.removeConversion=function(e){Y(e);const t=o(e.to),a=function(e,t){for(let a=0;a<e.length;a++)if(t(e[a]))return e[a]}(t.conversionsTo,(t=>t.from===e.from));if(!a)throw new Error("Attempt to remove nonexistent conversion from "+e.from+" to "+e.to);if(a.convert!==e.convert)throw new Error("Conversion to remove does not match existing conversion");const n=t.conversionsTo.indexOf(a);t.conversionsTo.splice(n,1)},s.resolve=function(e,t){if(!f(e))throw new TypeError(vr);const a=e._typedFunctionData.signatures;for(let n=0;n<a.length;++n)if(a[n].test(t))return a[n];return null},s}();function _r(e){return"boolean"==typeof e||!!isFinite(e)&&e===Math.round(e)}function gr(e,t,a){var n={2:"0b",8:"0o",16:"0x"}[t],i="";if(a){if(a<1)throw new Error("size must be in greater than 0");if(!_r(a))throw new Error("size must be an integer");if(e>2**(a-1)-1||e<-(2**(a-1)))throw new Error("Value must be in range [-2^".concat(a-1,", 2^").concat(a-1,"-1]"));if(!_r(e))throw new Error("Value must be an integer");e<0&&(e+=2**a),i="i".concat(a)}var r="";return e<0&&(e=-e,r="-"),"".concat(r).concat(n).concat(e.toString(t)).concat(i)}function yr(e,t){if("function"==typeof t)return t(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var a,n,i="auto";if(t&&(t.notation&&(i=t.notation),bi(t)?a=t:bi(t.precision)&&(a=t.precision),t.wordSize&&"number"!=typeof(n=t.wordSize)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return function(e,t){if(isNaN(e)||!isFinite(e))return String(e);var a=Dr(e),n="number"==typeof t?br(a,a.exponent+1+t):a,i=n.coefficients,r=n.exponent+1,u=r+(t||0);i.length<u&&(i=i.concat(Cr(u-i.length)));r<0&&(i=Cr(1-r).concat(i),r=1);r<i.length&&i.splice(r,0,0===r?"0.":".");return n.sign+i.join("")}(e,a);case"exponential":return wr(e,a);case"engineering":return function(e,t){if(isNaN(e)||!isFinite(e))return String(e);var a=Dr(e),n=br(a,t),i=n.exponent,r=n.coefficients,u=i%3==0?i:i<0?i-3-i%3:i-i%3;if(bi(t))for(;t>r.length||i-u+1>r.length;)r.push(0);else for(var s=Math.abs(i-u)-(r.length-1),o=0;o<s;o++)r.push(0);var l=Math.abs(i-u),c=1;for(;l>0;)c++,l--;var d=r.slice(c).join(""),f=bi(t)&&d.length||d.match(/[1-9]/)?"."+d:"",h=r.slice(0,c).join("")+f+"e"+(i>=0?"+":"")+u.toString();return n.sign+h}(e,a);case"bin":return gr(e,2,n);case"oct":return gr(e,8,n);case"hex":return gr(e,16,n);case"auto":return function(e,t,a){if(isNaN(e)||!isFinite(e))return String(e);var n=a&&void 0!==a.lowerExp?a.lowerExp:-3,i=a&&void 0!==a.upperExp?a.upperExp:5,r=Dr(e),u=t?br(r,t):r;if(u.exponent<n||u.exponent>=i)return wr(e,t);var s=u.coefficients,o=u.exponent;s.length<t&&(s=s.concat(Cr(t-s.length))),s=s.concat(Cr(o-s.length+1+(s.length<t?t-s.length:0)));var l=o>0?o:0;return l<(s=Cr(-o).concat(s)).length-1&&s.splice(l+1,0,"."),u.sign+s.join("")}(e,a,t&&t).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Dr(e){var t=String(e).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var a=t[1],n=t[2],i=parseFloat(t[4]||"0"),r=n.indexOf(".");i+=-1!==r?r-1:n.length-1;var u=n.replace(".","").replace(/^0*/,(function(e){return i-=e.length,""})).replace(/0*$/,"").split("").map((function(e){return parseInt(e)}));return 0===u.length&&(u.push(0),i++),{sign:a,coefficients:u,exponent:i}}function wr(e,t){if(isNaN(e)||!isFinite(e))return String(e);var a=Dr(e),n=t?br(a,t):a,i=n.coefficients,r=n.exponent;i.length<t&&(i=i.concat(Cr(t-i.length)));var u=i.shift();return n.sign+u+(i.length>0?"."+i.join(""):"")+"e"+(r>=0?"+":"")+r}function br(e,t){for(var a={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},n=a.coefficients;t<=0;)n.unshift(0),a.exponent++,t++;if(n.length>t&&n.splice(t,n.length-t)[0]>=5){var i=t-1;for(n[i]++;10===n[i];)n.pop(),0===i&&(n.unshift(0),a.exponent++,i++),n[--i]++}return a}function Cr(e){for(var t=[],a=0;a<e;a++)t.push(0);return t}var Ar=Number.EPSILON||2220446049250313e-31;function kr(e,t,a){if(null==a)return e===t;if(e===t)return!0;if(isNaN(e)||isNaN(t))return!1;if(isFinite(e)&&isFinite(t)){var n=Math.abs(e-t);return n<=Ar||n<=Math.max(Math.abs(e),Math.abs(t))*a}return!1}function xr(e,t,a){var n=new(0,e.constructor)(2),i="";if(a){if(a<1)throw new Error("size must be in greater than 0");if(!_r(a))throw new Error("size must be an integer");if(e.greaterThan(n.pow(a-1).sub(1))||e.lessThan(n.pow(a-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(a-1,", 2^").concat(a-1,"-1]"));if(!e.isInteger())throw new Error("Value must be an integer");e.lessThan(0)&&(e=e.add(n.pow(a))),i="i".concat(a)}switch(t){case 2:return"".concat(e.toBinary()).concat(i);case 8:return"".concat(e.toOctal()).concat(i);case 16:return"".concat(e.toHexadecimal()).concat(i);default:throw new Error("Base ".concat(t," not supported "))}}function Er(e,t){if("function"==typeof t)return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var a,n,i="auto";if(void 0!==t&&(t.notation&&(i=t.notation),"number"==typeof t?a=t:void 0!==t.precision&&(a=t.precision),t.wordSize&&"number"!=typeof(n=t.wordSize)))throw new Error('Option "wordSize" must be a number');switch(i){case"fixed":return function(e,t){return e.toFixed(t)}(e,a);case"exponential":return Fr(e,a);case"engineering":return function(e,t){var a=e.e,n=a%3==0?a:a<0?a-3-a%3:a-a%3,i=e.mul(Math.pow(10,-n)),r=i.toPrecision(t);if(-1!==r.indexOf("e")){r=new(0,e.constructor)(r).toFixed()}return r+"e"+(a>=0?"+":"")+n.toString()}(e,a);case"bin":return xr(e,2,n);case"oct":return xr(e,8,n);case"hex":return xr(e,16,n);case"auto":var r=t&&void 0!==t.lowerExp?t.lowerExp:-3,u=t&&void 0!==t.upperExp?t.upperExp:5;if(e.isZero())return"0";var s=e.toSignificantDigits(a),o=s.e;return(o>=r&&o<u?s.toFixed():Fr(e,a)).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+i+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Fr(e,t){return void 0!==t?e.toExponential(t-1):e.toExponential()}function Ir(e,t){var a=function(e,t){if("number"==typeof e)return yr(e,t);if(Ci(e))return Er(e,t);if(function(e){return e&&"object"==typeof e&&"number"==typeof e.s&&"number"==typeof e.n&&"number"==typeof e.d||!1}(e))return t&&"decimal"===t.fraction?e.toString():e.s*e.n+"/"+e.d;if(Array.isArray(e))return Br(e,t);if(Ei(e))return Tr(e);if("function"==typeof e)return e.syntax?String(e.syntax):"function";if(e&&"object"==typeof e){return"function"==typeof e.format?e.format(t):e&&e.toString(t)!=={}.toString()?e.toString(t):"{"+Object.keys(e).map((a=>Tr(a)+": "+Ir(e[a],t))).join(", ")+"}"}return String(e)}(e,t);return t&&"object"==typeof t&&"truncate"in t&&a.length>t.truncate?a.substring(0,t.truncate-3)+"...":a}function Tr(e){for(var t=String(e),a="",n=0;n<t.length;){var i=t.charAt(n);a+=i in Sr?Sr[i]:i,n++}return'"'+a+'"'}var Sr={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};function Br(e,t){if(Array.isArray(e)){for(var a="[",n=e.length,i=0;i<n;i++)0!==i&&(a+=", "),a+=Br(e[i],t);return a+="]"}return Ir(e,t)}function Nr(e,t,a){if(!(this instanceof Nr))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=a,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=(new Error).stack}function Pr(e,t,a){if(!(this instanceof Pr))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=a),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function Mr(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function Or(e,t,a){var n,i=e.length;if(i!==t[a])throw new Nr(i,t[a]);if(a<t.length-1){var r=a+1;for(n=0;n<i;n++){var u=e[n];if(!Array.isArray(u))throw new Nr(t.length-1,t.length,"<");Or(e[n],t,r)}}else for(n=0;n<i;n++)if(Array.isArray(e[n]))throw new Nr(t.length+1,t.length,">")}function Lr(e,t){if(0===t.length){if(Array.isArray(e))throw new Nr(e.length,0)}else Or(e,t,0)}function Ur(e,t){if(void 0!==e){if(!bi(e)||!_r(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||"number"==typeof t&&e>=t)throw new Pr(e,t)}}function Rr(e,t,a){if(!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Error("Resizing to scalar is not supported");return t.forEach((function(e){if(!bi(e)||!_r(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Ir(t)+")")})),(bi(e)||Ci(e))&&(e=[e]),zr(e,t,0,void 0!==a?a:0),e}function zr(e,t,a,n){var i,r,u=e.length,s=t[a],o=Math.min(u,s);if(e.length=s,a<t.length-1){var l=a+1;for(i=0;i<o;i++)r=e[i],Array.isArray(r)||(r=[r],e[i]=r),zr(r,t,l,n);for(i=o;i<s;i++)r=[],e[i]=r,zr(r,t,l,n)}else{for(i=0;i<o;i++)for(;Array.isArray(e[i]);)e[i]=e[i][0];for(i=o;i<s;i++)e[i]=n}}function jr(e,t){var a=function(e){if(!Array.isArray(e))return e;var t=[];return e.forEach((function e(a){Array.isArray(a)?a.forEach(e):t.push(a)})),t}(e),n=a.length;if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Nr(0,n,"!=");var i=qr(t=$r(t,n));if(n!==i)throw new Nr(i,n,"!=");try{return function(e,t){for(var a,n=e,i=t.length-1;i>0;i--){var r=t[i];a=[];for(var u=n.length/r,s=0;s<u;s++)a.push(n.slice(s*r,(s+1)*r));n=a}return n}(a,t)}catch(Oc){if(Oc instanceof Nr)throw new Nr(i,n,"!=");throw Oc}}function $r(e,t){var a=qr(e),n=e.slice(),i=e.indexOf(-1);if(e.indexOf(-1,i+1)>=0)throw new Error("More than one wildcard in sizes");if(i>=0){if(!(t%a==0))throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-a);n[i]=-t/a}return n}function qr(e){return e.reduce(((e,t)=>e*t),1)}function Vr(e,t,a,n){var i=n||Mr(e);if(a)for(var r=0;r<a;r++)e=[e],i.unshift(1);for(e=Kr(e,t,0);i.length<t;)i.push(1);return e}function Kr(e,t,a){var n,i;if(Array.isArray(e)){var r=a+1;for(n=0,i=e.length;n<i;n++)e[n]=Kr(e[n],t,r)}else for(var u=a;u<t;u++)e=[e];return e}function Hr(e,t){for(var a,n=0,i=0;i<e.length;i++){var r=e[i],u=Array.isArray(r);if(0===i&&u&&(n=r.length),u&&r.length!==n)return;var s=u?Hr(r,t):t(r);if(void 0===a)a=s;else if(a!==s)return"mixed"}return a}function Wr(e,t,a,n){if(n<a){if(e.length!==t.length)throw new Nr(e.length,t.length);for(var i=[],r=0;r<e.length;r++)i[r]=Wr(e[r],t[r],a,n+1);return i}return e.concat(t)}function Jr(){var e=Array.prototype.slice.call(arguments,0,-1),t=Array.prototype.slice.call(arguments,-1);if(1===e.length)return e[0];if(e.length>1)return e.slice(1).reduce((function(e,a){return Wr(e,a,t,0)}),e[0]);throw new Error("Wrong number of arguments in function concat")}function Zr(e,t){for(var a=t.length,n=e.length,i=0;i<n;i++){var r=a-n+i;if(e[i]<t[r]&&e[i]>1||e[i]>t[r])throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(e,") not possible to broadcast dimension ").concat(n," with size ").concat(e[i]," to size ").concat(t[r]))}}function Yr(e,t){var a=Mr(e);if(lr(a,t))return e;Zr(a,t);var n,i,r,u=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];for(var n=t.map((e=>e.length)),i=Math.max(...n),r=new Array(i).fill(null),u=0;u<t.length;u++)for(var s=t[u],o=n[u],l=0;l<o;l++){var c=i-o+l;s[l]>r[c]&&(r[c]=s[l])}for(var d=0;d<t.length;d++)Zr(t[d],r);return r}(a,t),s=u.length,o=[...Array(s-a.length).fill(1),...a],l=function(e){return Di([],e)}(e);a.length<s&&(a=Mr(l=jr(l,o)));for(var c=0;c<s;c++)a[c]<u[c]&&(n=l,i=u[c],r=c,a=Mr(l=Jr(...Array(i).fill(n),r)));return l}function Gr(e,t,a,n){function i(n){var i=function(e,t){for(var a={},n=0;n<t.length;n++){var i=t[n],r=e[i];void 0!==r&&(a[i]=r)}return a}(n,t.map(Qr));return function(e,t,a){var n=t.filter((e=>!function(e){return e&&"?"===e[0]}(e))).every((e=>void 0!==a[e]));if(!n){var i=t.filter((e=>void 0===a[e]));throw new Error('Cannot create function "'.concat(e,'", ')+"some dependencies are missing: ".concat(i.map((e=>'"'.concat(e,'"'))).join(", "),"."))}}(e,t,n),a(i)}return i.isFactory=!0,i.fn=e,i.dependencies=t.slice().sort(),n&&(i.meta=n),i}function Qr(e){return e&&"?"===e[0]?e.slice(1):e}function Xr(e,t){if(tu(e)&&eu(e,t))return e[t];if("function"==typeof e[t]&&function(e,t){if(null==e||"function"!=typeof e[t])return!1;if(cr(e,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(e))return!1;if(cr(nu,t))return!0;if(t in Object.prototype)return!1;if(t in Function.prototype)return!1;return!0}(e,t))throw new Error('Cannot access method "'+t+'" as a property');throw new Error('No access to property "'+t+'"')}function eu(e,t){return!(!e||"object"!=typeof e)&&(!!cr(au,t)||!(t in Object.prototype)&&!(t in Function.prototype))}function tu(e){return"object"==typeof e&&e&&e.constructor===Object}Nr.prototype=new RangeError,Nr.prototype.constructor=RangeError,Nr.prototype.name="DimensionError",Nr.prototype.isDimensionError=!0,Pr.prototype=new RangeError,Pr.prototype.constructor=RangeError,Pr.prototype.name="IndexError",Pr.prototype.isIndexError=!0;var au={length:!0,name:!0},nu={toString:!0,valueOf:!0,toLocaleString:!0};class iu{constructor(e){this.wrappedObject=e}keys(){return Object.keys(this.wrappedObject)}get(e){return Xr(this.wrappedObject,e)}set(e,t){return function(e,t,a){if(tu(e)&&eu(e,t))return e[t]=a,a;throw new Error('No access to property "'+t+'"')}(this.wrappedObject,e,t),this}has(e){return t=this.wrappedObject,e in t;var t}}function ru(e){return!!e&&(e instanceof Map||e instanceof iu||"function"==typeof e.set&&"function"==typeof e.get&&"function"==typeof e.keys&&"function"==typeof e.has)}var uu=function(){return uu=mr.create,mr},su=Gr("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(e){var{BigNumber:t,Complex:a,DenseMatrix:n,Fraction:i}=e,r=uu();return r.clear(),r.addTypes([{name:"number",test:bi},{name:"Complex",test:Ai},{name:"BigNumber",test:Ci},{name:"Fraction",test:ki},{name:"Unit",test:xi},{name:"identifier",test:e=>Ei&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(e)},{name:"string",test:Ei},{name:"Chain",test:ur},{name:"Array",test:Fi},{name:"Matrix",test:Ii},{name:"DenseMatrix",test:Si},{name:"SparseMatrix",test:Bi},{name:"Range",test:Ni},{name:"Index",test:Pi},{name:"boolean",test:Mi},{name:"ResultSet",test:Oi},{name:"Help",test:Li},{name:"function",test:Ui},{name:"Date",test:Ri},{name:"RegExp",test:zi},{name:"null",test:$i},{name:"undefined",test:qi},{name:"AccessorNode",test:Vi},{name:"ArrayNode",test:Ki},{name:"AssignmentNode",test:Hi},{name:"BlockNode",test:Wi},{name:"ConditionalNode",test:Ji},{name:"ConstantNode",test:Zi},{name:"FunctionNode",test:Gi},{name:"FunctionAssignmentNode",test:Yi},{name:"IndexNode",test:Qi},{name:"Node",test:Xi},{name:"ObjectNode",test:er},{name:"OperatorNode",test:tr},{name:"ParenthesisNode",test:ar},{name:"RangeNode",test:nr},{name:"RelationalNode",test:ir},{name:"SymbolNode",test:rr},{name:"Map",test:ru},{name:"Object",test:ji}]),r.addConversions([{from:"number",to:"BigNumber",convert:function(e){if(t||ou(e),e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t(e)}},{from:"number",to:"Complex",convert:function(e){return a||lu(e),new a(e,0)}},{from:"BigNumber",to:"Complex",convert:function(e){return a||lu(e),new a(e.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(e){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return a||lu(e),new a(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){i||cu(e);var t=new i(e);if(t.valueOf()!==e)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+e+"). Use function fraction(x) to convert to Fraction.");return t}},{from:"string",to:"number",convert:function(e){var t=Number(e);if(isNaN(t))throw new Error('Cannot convert "'+e+'" to a number');return t}},{from:"string",to:"BigNumber",convert:function(e){t||ou(e);try{return new t(e)}catch(a){throw new Error('Cannot convert "'+e+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(e){i||cu(e);try{return new i(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(e){a||lu(e);try{return new a(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Complex')}}},{from:"boolean",to:"number",convert:function(e){return+e}},{from:"boolean",to:"BigNumber",convert:function(e){return t||ou(e),new t(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return i||cu(e),new i(+e)}},{from:"boolean",to:"string",convert:function(e){return String(e)}},{from:"Array",to:"Matrix",convert:function(e){return n||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new n(e)}},{from:"Matrix",to:"Array",convert:function(e){return e.valueOf()}}]),r.onMismatch=(e,t,a)=>{var n=r.createError(e,t,a);if(["wrongType","mismatch"].includes(n.data.category)&&1===t.length&&Ti(t[0])&&a.some((e=>!e.params.includes(",")))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=n.data,i}throw n},r.onMismatch=(e,t,a)=>{var n=r.createError(e,t,a);if(["wrongType","mismatch"].includes(n.data.category)&&1===t.length&&Ti(t[0])&&a.some((e=>!e.params.includes(",")))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=n.data,i}throw n},r}));function ou(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function lu(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function cu(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}
/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var du,fu,hu=9e15,pu=1e9,vu="0123456789abcdef",mu="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",_u="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",gu={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-hu,maxE:hu,crypto:!1},yu=!0,Du="[DecimalError] ",wu=Du+"Invalid argument: ",bu=Du+"Precision limit exceeded",Cu=Du+"crypto unavailable",Au="[object Decimal]",ku=Math.floor,xu=Math.pow,Eu=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Fu=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Iu=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Tu=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Su=1e7,Bu=7,Nu=mu.length-1,Pu=_u.length-1,Mu={toStringTag:Au};function Ou(e){var t,a,n,i=e.length-1,r="",u=e[0];if(i>0){for(r+=u,t=1;t<i;t++)n=e[t]+"",(a=Bu-n.length)&&(r+=Wu(a)),r+=n;u=e[t],(a=Bu-(n=u+"").length)&&(r+=Wu(a))}else if(0===u)return"0";for(;u%10==0;)u/=10;return r+u}function Lu(e,t,a){if(e!==~~e||e<t||e>a)throw Error(wu+e)}function Uu(e,t,a,n){var i,r,u,s;for(r=e[0];r>=10;r/=10)--t;return--t<0?(t+=Bu,i=0):(i=Math.ceil((t+1)/Bu),t%=Bu),r=xu(10,Bu-t),s=e[i]%r|0,null==n?t<3?(0==t?s=s/100|0:1==t&&(s=s/10|0),u=a<4&&99999==s||a>3&&49999==s||5e4==s||0==s):u=(a<4&&s+1==r||a>3&&s+1==r/2)&&(e[i+1]/r/100|0)==xu(10,t-2)-1||(s==r/2||0==s)&&!(e[i+1]/r/100|0):t<4?(0==t?s=s/1e3|0:1==t?s=s/100|0:2==t&&(s=s/10|0),u=(n||a<4)&&9999==s||!n&&a>3&&4999==s):u=((n||a<4)&&s+1==r||!n&&a>3&&s+1==r/2)&&(e[i+1]/r/1e3|0)==xu(10,t-3)-1,u}function Ru(e,t,a){for(var n,i,r=[0],u=0,s=e.length;u<s;){for(i=r.length;i--;)r[i]*=t;for(r[0]+=vu.indexOf(e.charAt(u++)),n=0;n<r.length;n++)r[n]>a-1&&(void 0===r[n+1]&&(r[n+1]=0),r[n+1]+=r[n]/a|0,r[n]%=a)}return r.reverse()}Mu.absoluteValue=Mu.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),ju(e)},Mu.ceil=function(){return ju(new this.constructor(this),this.e+1,2)},Mu.clampedTo=Mu.clamp=function(e,t){var a=this,n=a.constructor;if(e=new n(e),t=new n(t),!e.s||!t.s)return new n(NaN);if(e.gt(t))throw Error(wu+t);return a.cmp(e)<0?e:a.cmp(t)>0?t:new n(a)},Mu.comparedTo=Mu.cmp=function(e){var t,a,n,i,r=this,u=r.d,s=(e=new r.constructor(e)).d,o=r.s,l=e.s;if(!u||!s)return o&&l?o!==l?o:u===s?0:!u^o<0?1:-1:NaN;if(!u[0]||!s[0])return u[0]?o:s[0]?-l:0;if(o!==l)return o;if(r.e!==e.e)return r.e>e.e^o<0?1:-1;for(t=0,a=(n=u.length)<(i=s.length)?n:i;t<a;++t)if(u[t]!==s[t])return u[t]>s[t]^o<0?1:-1;return n===i?0:n>i^o<0?1:-1},Mu.cosine=Mu.cos=function(){var e,t,a=this,n=a.constructor;return a.d?a.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(a.e,a.sd())+Bu,n.rounding=1,a=function(e,t){var a,n,i;if(t.isZero())return t;n=t.d.length,n<32?i=(1/as(4,a=Math.ceil(n/3))).toString():(a=16,i="2.3283064365386962890625e-10");e.precision+=a,t=ts(e,1,t.times(i),new e(1));for(var r=a;r--;){var u=t.times(t);t=u.times(u).minus(u).times(8).plus(1)}return e.precision-=a,t}(n,ns(n,a)),n.precision=e,n.rounding=t,ju(2==fu||3==fu?a.neg():a,e,t,!0)):new n(1):new n(NaN)},Mu.cubeRoot=Mu.cbrt=function(){var e,t,a,n,i,r,u,s,o,l,c=this,d=c.constructor;if(!c.isFinite()||c.isZero())return new d(c);for(yu=!1,(r=c.s*xu(c.s*c,1/3))&&Math.abs(r)!=1/0?n=new d(r.toString()):(a=Ou(c.d),(r=((e=c.e)-a.length+1)%3)&&(a+=1==r||-2==r?"0":"00"),r=xu(a,1/3),e=ku((e+1)/3)-(e%3==(e<0?-1:2)),(n=new d(a=r==1/0?"5e"+e:(a=r.toExponential()).slice(0,a.indexOf("e")+1)+e)).s=c.s),u=(e=d.precision)+3;;)if(l=(o=(s=n).times(s).times(s)).plus(c),n=zu(l.plus(c).times(s),l.plus(o),u+2,1),Ou(s.d).slice(0,u)===(a=Ou(n.d)).slice(0,u)){if("9999"!=(a=a.slice(u-3,u+1))&&(i||"4999"!=a)){+a&&(+a.slice(1)||"5"!=a.charAt(0))||(ju(n,e+1,1),t=!n.times(n).times(n).eq(c));break}if(!i&&(ju(s,e+1,0),s.times(s).times(s).eq(c))){n=s;break}u+=4,i=1}return yu=!0,ju(n,e,d.rounding,t)},Mu.decimalPlaces=Mu.dp=function(){var e,t=this.d,a=NaN;if(t){if(a=((e=t.length-1)-ku(this.e/Bu))*Bu,e=t[e])for(;e%10==0;e/=10)a--;a<0&&(a=0)}return a},Mu.dividedBy=Mu.div=function(e){return zu(this,new this.constructor(e))},Mu.dividedToIntegerBy=Mu.divToInt=function(e){var t=this.constructor;return ju(zu(this,new t(e),0,1,1),t.precision,t.rounding)},Mu.equals=Mu.eq=function(e){return 0===this.cmp(e)},Mu.floor=function(){return ju(new this.constructor(this),this.e+1,3)},Mu.greaterThan=Mu.gt=function(e){return this.cmp(e)>0},Mu.greaterThanOrEqualTo=Mu.gte=function(e){var t=this.cmp(e);return 1==t||0===t},Mu.hyperbolicCosine=Mu.cosh=function(){var e,t,a,n,i,r=this,u=r.constructor,s=new u(1);if(!r.isFinite())return new u(r.s?1/0:NaN);if(r.isZero())return s;a=u.precision,n=u.rounding,u.precision=a+Math.max(r.e,r.sd())+4,u.rounding=1,(i=r.d.length)<32?t=(1/as(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),r=ts(u,1,r.times(t),new u(1),!0);for(var o,l=e,c=new u(8);l--;)o=r.times(r),r=s.minus(o.times(c.minus(o.times(c))));return ju(r,u.precision=a,u.rounding=n,!0)},Mu.hyperbolicSine=Mu.sinh=function(){var e,t,a,n,i=this,r=i.constructor;if(!i.isFinite()||i.isZero())return new r(i);if(t=r.precision,a=r.rounding,r.precision=t+Math.max(i.e,i.sd())+4,r.rounding=1,(n=i.d.length)<3)i=ts(r,2,i,i,!0);else{e=(e=1.4*Math.sqrt(n))>16?16:0|e,i=ts(r,2,i=i.times(1/as(5,e)),i,!0);for(var u,s=new r(5),o=new r(16),l=new r(20);e--;)u=i.times(i),i=i.times(s.plus(u.times(o.times(u).plus(l))))}return r.precision=t,r.rounding=a,ju(i,t,a,!0)},Mu.hyperbolicTangent=Mu.tanh=function(){var e,t,a=this,n=a.constructor;return a.isFinite()?a.isZero()?new n(a):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,zu(a.sinh(),a.cosh(),n.precision=e,n.rounding=t)):new n(a.s)},Mu.inverseCosine=Mu.acos=function(){var e,t=this,a=t.constructor,n=t.abs().cmp(1),i=a.precision,r=a.rounding;return-1!==n?0===n?t.isNeg()?Ku(a,i,r):new a(0):new a(NaN):t.isZero()?Ku(a,i+4,r).times(.5):(a.precision=i+6,a.rounding=1,t=t.asin(),e=Ku(a,i+4,r).times(.5),a.precision=i,a.rounding=r,e.minus(t))},Mu.inverseHyperbolicCosine=Mu.acosh=function(){var e,t,a=this,n=a.constructor;return a.lte(1)?new n(a.eq(1)?0:NaN):a.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(a.e),a.sd())+4,n.rounding=1,yu=!1,a=a.times(a).minus(1).sqrt().plus(a),yu=!0,n.precision=e,n.rounding=t,a.ln()):new n(a)},Mu.inverseHyperbolicSine=Mu.asinh=function(){var e,t,a=this,n=a.constructor;return!a.isFinite()||a.isZero()?new n(a):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(a.e),a.sd())+6,n.rounding=1,yu=!1,a=a.times(a).plus(1).sqrt().plus(a),yu=!0,n.precision=e,n.rounding=t,a.ln())},Mu.inverseHyperbolicTangent=Mu.atanh=function(){var e,t,a,n,i=this,r=i.constructor;return i.isFinite()?i.e>=0?new r(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=r.precision,t=r.rounding,n=i.sd(),Math.max(n,e)<2*-i.e-1?ju(new r(i),e,t,!0):(r.precision=a=n-i.e,i=zu(i.plus(1),new r(1).minus(i),a+e,1),r.precision=e+4,r.rounding=1,i=i.ln(),r.precision=e,r.rounding=t,i.times(.5))):new r(NaN)},Mu.inverseSine=Mu.asin=function(){var e,t,a,n,i=this,r=i.constructor;return i.isZero()?new r(i):(t=i.abs().cmp(1),a=r.precision,n=r.rounding,-1!==t?0===t?((e=Ku(r,a+4,n).times(.5)).s=i.s,e):new r(NaN):(r.precision=a+6,r.rounding=1,i=i.div(new r(1).minus(i.times(i)).sqrt().plus(1)).atan(),r.precision=a,r.rounding=n,i.times(2)))},Mu.inverseTangent=Mu.atan=function(){var e,t,a,n,i,r,u,s,o,l=this,c=l.constructor,d=c.precision,f=c.rounding;if(l.isFinite()){if(l.isZero())return new c(l);if(l.abs().eq(1)&&d+4<=Pu)return(u=Ku(c,d+4,f).times(.25)).s=l.s,u}else{if(!l.s)return new c(NaN);if(d+4<=Pu)return(u=Ku(c,d+4,f).times(.5)).s=l.s,u}for(c.precision=s=d+10,c.rounding=1,e=a=Math.min(28,s/Bu+2|0);e;--e)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(yu=!1,t=Math.ceil(s/Bu),n=1,o=l.times(l),u=new c(l),i=l;-1!==e;)if(i=i.times(o),r=u.minus(i.div(n+=2)),i=i.times(o),void 0!==(u=r.plus(i.div(n+=2))).d[t])for(e=t;u.d[e]===r.d[e]&&e--;);return a&&(u=u.times(2<<a-1)),yu=!0,ju(u,c.precision=d,c.rounding=f,!0)},Mu.isFinite=function(){return!!this.d},Mu.isInteger=Mu.isInt=function(){return!!this.d&&ku(this.e/Bu)>this.d.length-2},Mu.isNaN=function(){return!this.s},Mu.isNegative=Mu.isNeg=function(){return this.s<0},Mu.isPositive=Mu.isPos=function(){return this.s>0},Mu.isZero=function(){return!!this.d&&0===this.d[0]},Mu.lessThan=Mu.lt=function(e){return this.cmp(e)<0},Mu.lessThanOrEqualTo=Mu.lte=function(e){return this.cmp(e)<1},Mu.logarithm=Mu.log=function(e){var t,a,n,i,r,u,s,o,l=this,c=l.constructor,d=c.precision,f=c.rounding;if(null==e)e=new c(10),t=!0;else{if(a=(e=new c(e)).d,e.s<0||!a||!a[0]||e.eq(1))return new c(NaN);t=e.eq(10)}if(a=l.d,l.s<0||!a||!a[0]||l.eq(1))return new c(a&&!a[0]?-1/0:1!=l.s?NaN:a?0:1/0);if(t)if(a.length>1)r=!0;else{for(i=a[0];i%10==0;)i/=10;r=1!==i}if(yu=!1,u=Qu(l,s=d+5),n=t?Vu(c,s+10):Qu(e,s),Uu((o=zu(u,n,s,1)).d,i=d,f))do{if(u=Qu(l,s+=10),n=t?Vu(c,s+10):Qu(e,s),o=zu(u,n,s,1),!r){+Ou(o.d).slice(i+1,i+15)+1==1e14&&(o=ju(o,d+1,0));break}}while(Uu(o.d,i+=10,f));return yu=!0,ju(o,d,f)},Mu.minus=Mu.sub=function(e){var t,a,n,i,r,u,s,o,l,c,d,f,h=this,p=h.constructor;if(e=new p(e),!h.d||!e.d)return h.s&&e.s?h.d?e.s=-e.s:e=new p(e.d||h.s!==e.s?h:NaN):e=new p(NaN),e;if(h.s!=e.s)return e.s=-e.s,h.plus(e);if(l=h.d,f=e.d,s=p.precision,o=p.rounding,!l[0]||!f[0]){if(f[0])e.s=-e.s;else{if(!l[0])return new p(3===o?-0:0);e=new p(h)}return yu?ju(e,s,o):e}if(a=ku(e.e/Bu),c=ku(h.e/Bu),l=l.slice(),r=c-a){for((d=r<0)?(t=l,r=-r,u=f.length):(t=f,a=c,u=l.length),r>(n=Math.max(Math.ceil(s/Bu),u)+2)&&(r=n,t.length=1),t.reverse(),n=r;n--;)t.push(0);t.reverse()}else{for((d=(n=l.length)<(u=f.length))&&(u=n),n=0;n<u;n++)if(l[n]!=f[n]){d=l[n]<f[n];break}r=0}for(d&&(t=l,l=f,f=t,e.s=-e.s),u=l.length,n=f.length-u;n>0;--n)l[u++]=0;for(n=f.length;n>r;){if(l[--n]<f[n]){for(i=n;i&&0===l[--i];)l[i]=Su-1;--l[i],l[n]+=Su}l[n]-=f[n]}for(;0===l[--u];)l.pop();for(;0===l[0];l.shift())--a;return l[0]?(e.d=l,e.e=qu(l,a),yu?ju(e,s,o):e):new p(3===o?-0:0)},Mu.modulo=Mu.mod=function(e){var t,a=this,n=a.constructor;return e=new n(e),!a.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||a.d&&!a.d[0]?ju(new n(a),n.precision,n.rounding):(yu=!1,9==n.modulo?(t=zu(a,e.abs(),0,3,1)).s*=e.s:t=zu(a,e,0,n.modulo,1),t=t.times(e),yu=!0,a.minus(t))},Mu.naturalExponential=Mu.exp=function(){return Gu(this)},Mu.naturalLogarithm=Mu.ln=function(){return Qu(this)},Mu.negated=Mu.neg=function(){var e=new this.constructor(this);return e.s=-e.s,ju(e)},Mu.plus=Mu.add=function(e){var t,a,n,i,r,u,s,o,l,c,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return d.s&&e.s?d.d||(e=new f(e.d||d.s===e.s?d:NaN)):e=new f(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(l=d.d,c=e.d,s=f.precision,o=f.rounding,!l[0]||!c[0])return c[0]||(e=new f(d)),yu?ju(e,s,o):e;if(r=ku(d.e/Bu),n=ku(e.e/Bu),l=l.slice(),i=r-n){for(i<0?(a=l,i=-i,u=c.length):(a=c,n=r,u=l.length),i>(u=(r=Math.ceil(s/Bu))>u?r+1:u+1)&&(i=u,a.length=1),a.reverse();i--;)a.push(0);a.reverse()}for((u=l.length)-(i=c.length)<0&&(i=u,a=c,c=l,l=a),t=0;i;)t=(l[--i]=l[i]+c[i]+t)/Su|0,l[i]%=Su;for(t&&(l.unshift(t),++n),u=l.length;0==l[--u];)l.pop();return e.d=l,e.e=qu(l,n),yu?ju(e,s,o):e},Mu.precision=Mu.sd=function(e){var t,a=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(wu+e);return a.d?(t=Hu(a.d),e&&a.e+1>t&&(t=a.e+1)):t=NaN,t},Mu.round=function(){var e=this,t=e.constructor;return ju(new t(e),e.e+1,t.rounding)},Mu.sine=Mu.sin=function(){var e,t,a=this,n=a.constructor;return a.isFinite()?a.isZero()?new n(a):(e=n.precision,t=n.rounding,n.precision=e+Math.max(a.e,a.sd())+Bu,n.rounding=1,a=function(e,t){var a,n=t.d.length;if(n<3)return t.isZero()?t:ts(e,2,t,t);a=(a=1.4*Math.sqrt(n))>16?16:0|a,t=t.times(1/as(5,a)),t=ts(e,2,t,t);for(var i,r=new e(5),u=new e(16),s=new e(20);a--;)i=t.times(t),t=t.times(r.plus(i.times(u.times(i).minus(s))));return t}(n,ns(n,a)),n.precision=e,n.rounding=t,ju(fu>2?a.neg():a,e,t,!0)):new n(NaN)},Mu.squareRoot=Mu.sqrt=function(){var e,t,a,n,i,r,u=this,s=u.d,o=u.e,l=u.s,c=u.constructor;if(1!==l||!s||!s[0])return new c(!l||l<0&&(!s||s[0])?NaN:s?u:1/0);for(yu=!1,0==(l=Math.sqrt(+u))||l==1/0?(((t=Ou(s)).length+o)%2==0&&(t+="0"),l=Math.sqrt(t),o=ku((o+1)/2)-(o<0||o%2),n=new c(t=l==1/0?"5e"+o:(t=l.toExponential()).slice(0,t.indexOf("e")+1)+o)):n=new c(l.toString()),a=(o=c.precision)+3;;)if(n=(r=n).plus(zu(u,r,a+2,1)).times(.5),Ou(r.d).slice(0,a)===(t=Ou(n.d)).slice(0,a)){if("9999"!=(t=t.slice(a-3,a+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(ju(n,o+1,1),e=!n.times(n).eq(u));break}if(!i&&(ju(r,o+1,0),r.times(r).eq(u))){n=r;break}a+=4,i=1}return yu=!0,ju(n,o,c.rounding,e)},Mu.tangent=Mu.tan=function(){var e,t,a=this,n=a.constructor;return a.isFinite()?a.isZero()?new n(a):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,(a=a.sin()).s=1,a=zu(a,new n(1).minus(a.times(a)).sqrt(),e+10,0),n.precision=e,n.rounding=t,ju(2==fu||4==fu?a.neg():a,e,t,!0)):new n(NaN)},Mu.times=Mu.mul=function(e){var t,a,n,i,r,u,s,o,l,c=this,d=c.constructor,f=c.d,h=(e=new d(e)).d;if(e.s*=c.s,!(f&&f[0]&&h&&h[0]))return new d(!e.s||f&&!f[0]&&!h||h&&!h[0]&&!f?NaN:f&&h?0*e.s:e.s/0);for(a=ku(c.e/Bu)+ku(e.e/Bu),(o=f.length)<(l=h.length)&&(r=f,f=h,h=r,u=o,o=l,l=u),r=[],n=u=o+l;n--;)r.push(0);for(n=l;--n>=0;){for(t=0,i=o+n;i>n;)s=r[i]+h[n]*f[i-n-1]+t,r[i--]=s%Su|0,t=s/Su|0;r[i]=(r[i]+t)%Su|0}for(;!r[--u];)r.pop();return t?++a:r.shift(),e.d=r,e.e=qu(r,a),yu?ju(e,d.precision,d.rounding):e},Mu.toBinary=function(e,t){return is(this,2,e,t)},Mu.toDecimalPlaces=Mu.toDP=function(e,t){var a=this,n=a.constructor;return a=new n(a),void 0===e?a:(Lu(e,0,pu),void 0===t?t=n.rounding:Lu(t,0,8),ju(a,e+a.e+1,t))},Mu.toExponential=function(e,t){var a,n=this,i=n.constructor;return void 0===e?a=$u(n,!0):(Lu(e,0,pu),void 0===t?t=i.rounding:Lu(t,0,8),a=$u(n=ju(new i(n),e+1,t),!0,e+1)),n.isNeg()&&!n.isZero()?"-"+a:a},Mu.toFixed=function(e,t){var a,n,i=this,r=i.constructor;return void 0===e?a=$u(i):(Lu(e,0,pu),void 0===t?t=r.rounding:Lu(t,0,8),a=$u(n=ju(new r(i),e+i.e+1,t),!1,e+n.e+1)),i.isNeg()&&!i.isZero()?"-"+a:a},Mu.toFraction=function(e){var t,a,n,i,r,u,s,o,l,c,d,f,h=this,p=h.d,v=h.constructor;if(!p)return new v(h);if(l=a=new v(1),n=o=new v(0),u=(r=(t=new v(n)).e=Hu(p)-h.e-1)%Bu,t.d[0]=xu(10,u<0?Bu+u:u),null==e)e=r>0?t:l;else{if(!(s=new v(e)).isInt()||s.lt(l))throw Error(wu+s);e=s.gt(t)?r>0?t:l:s}for(yu=!1,s=new v(Ou(p)),c=v.precision,v.precision=r=p.length*Bu*2;d=zu(s,t,0,1,1),1!=(i=a.plus(d.times(n))).cmp(e);)a=n,n=i,i=l,l=o.plus(d.times(i)),o=i,i=t,t=s.minus(d.times(i)),s=i;return i=zu(e.minus(a),n,0,1,1),o=o.plus(i.times(l)),a=a.plus(i.times(n)),o.s=l.s=h.s,f=zu(l,n,r,1).minus(h).abs().cmp(zu(o,a,r,1).minus(h).abs())<1?[l,n]:[o,a],v.precision=c,yu=!0,f},Mu.toHexadecimal=Mu.toHex=function(e,t){return is(this,16,e,t)},Mu.toNearest=function(e,t){var a=this,n=a.constructor;if(a=new n(a),null==e){if(!a.d)return a;e=new n(1),t=n.rounding}else{if(e=new n(e),void 0===t?t=n.rounding:Lu(t,0,8),!a.d)return e.s?a:e;if(!e.d)return e.s&&(e.s=a.s),e}return e.d[0]?(yu=!1,a=zu(a,e,0,t,1).times(e),yu=!0,ju(a)):(e.s=a.s,a=e),a},Mu.toNumber=function(){return+this},Mu.toOctal=function(e,t){return is(this,8,e,t)},Mu.toPower=Mu.pow=function(e){var t,a,n,i,r,u,s=this,o=s.constructor,l=+(e=new o(e));if(!(s.d&&e.d&&s.d[0]&&e.d[0]))return new o(xu(+s,l));if((s=new o(s)).eq(1))return s;if(n=o.precision,r=o.rounding,e.eq(1))return ju(s,n,r);if((t=ku(e.e/Bu))>=e.d.length-1&&(a=l<0?-l:l)<=9007199254740991)return i=Ju(o,s,a,n),e.s<0?new o(1).div(i):ju(i,n,r);if((u=s.s)<0){if(t<e.d.length-1)return new o(NaN);if(1&e.d[t]||(u=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=u,s}return(t=0!=(a=xu(+s,l))&&isFinite(a)?new o(a+"").e:ku(l*(Math.log("0."+Ou(s.d))/Math.LN10+s.e+1)))>o.maxE+1||t<o.minE-1?new o(t>0?u/0:0):(yu=!1,o.rounding=s.s=1,a=Math.min(12,(t+"").length),(i=Gu(e.times(Qu(s,n+a)),n)).d&&Uu((i=ju(i,n+5,1)).d,n,r)&&(t=n+10,+Ou((i=ju(Gu(e.times(Qu(s,t+a)),t),t+5,1)).d).slice(n+1,n+15)+1==1e14&&(i=ju(i,n+1,0))),i.s=u,yu=!0,o.rounding=r,ju(i,n,r))},Mu.toPrecision=function(e,t){var a,n=this,i=n.constructor;return void 0===e?a=$u(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(Lu(e,1,pu),void 0===t?t=i.rounding:Lu(t,0,8),a=$u(n=ju(new i(n),e,t),e<=n.e||n.e<=i.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+a:a},Mu.toSignificantDigits=Mu.toSD=function(e,t){var a=this.constructor;return void 0===e?(e=a.precision,t=a.rounding):(Lu(e,1,pu),void 0===t?t=a.rounding:Lu(t,0,8)),ju(new a(this),e,t)},Mu.toString=function(){var e=this,t=e.constructor,a=$u(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+a:a},Mu.truncated=Mu.trunc=function(){return ju(new this.constructor(this),this.e+1,1)},Mu.valueOf=Mu.toJSON=function(){var e=this,t=e.constructor,a=$u(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+a:a};var zu=function(){function e(e,t,a){var n,i=0,r=e.length;for(e=e.slice();r--;)n=e[r]*t+i,e[r]=n%a|0,i=n/a|0;return i&&e.unshift(i),e}function t(e,t,a,n){var i,r;if(a!=n)r=a>n?1:-1;else for(i=r=0;i<a;i++)if(e[i]!=t[i]){r=e[i]>t[i]?1:-1;break}return r}function a(e,t,a,n){for(var i=0;a--;)e[a]-=i,i=e[a]<t[a]?1:0,e[a]=i*n+e[a]-t[a];for(;!e[0]&&e.length>1;)e.shift()}return function(n,i,r,u,s,o){var l,c,d,f,h,p,v,m,_,g,y,D,w,b,C,A,k,x,E,F,I=n.constructor,T=n.s==i.s?1:-1,S=n.d,B=i.d;if(!(S&&S[0]&&B&&B[0]))return new I(n.s&&i.s&&(S?!B||S[0]!=B[0]:B)?S&&0==S[0]||!B?0*T:T/0:NaN);for(o?(h=1,c=n.e-i.e):(o=Su,h=Bu,c=ku(n.e/h)-ku(i.e/h)),E=B.length,k=S.length,g=(_=new I(T)).d=[],d=0;B[d]==(S[d]||0);d++);if(B[d]>(S[d]||0)&&c--,null==r?(b=r=I.precision,u=I.rounding):b=s?r+(n.e-i.e)+1:r,b<0)g.push(1),p=!0;else{if(b=b/h+2|0,d=0,1==E){for(f=0,B=B[0],b++;(d<k||f)&&b--;d++)C=f*o+(S[d]||0),g[d]=C/B|0,f=C%B|0;p=f||d<k}else{for((f=o/(B[0]+1)|0)>1&&(B=e(B,f,o),S=e(S,f,o),E=B.length,k=S.length),A=E,D=(y=S.slice(0,E)).length;D<E;)y[D++]=0;(F=B.slice()).unshift(0),x=B[0],B[1]>=o/2&&++x;do{f=0,(l=t(B,y,E,D))<0?(w=y[0],E!=D&&(w=w*o+(y[1]||0)),(f=w/x|0)>1?(f>=o&&(f=o-1),1==(l=t(v=e(B,f,o),y,m=v.length,D=y.length))&&(f--,a(v,E<m?F:B,m,o))):(0==f&&(l=f=1),v=B.slice()),(m=v.length)<D&&v.unshift(0),a(y,v,D,o),-1==l&&(l=t(B,y,E,D=y.length))<1&&(f++,a(y,E<D?F:B,D,o)),D=y.length):0===l&&(f++,y=[0]),g[d++]=f,l&&y[0]?y[D++]=S[A]||0:(y=[S[A]],D=1)}while((A++<k||void 0!==y[0])&&b--);p=void 0!==y[0]}g[0]||g.shift()}if(1==h)_.e=c,du=p;else{for(d=1,f=g[0];f>=10;f/=10)d++;_.e=d+c*h-1,ju(_,s?r+_.e+1:r,u,p)}return _}}();function ju(e,t,a,n){var i,r,u,s,o,l,c,d,f,h=e.constructor;e:if(null!=t){if(!(d=e.d))return e;for(i=1,s=d[0];s>=10;s/=10)i++;if((r=t-i)<0)r+=Bu,u=t,o=(c=d[f=0])/xu(10,i-u-1)%10|0;else if((f=Math.ceil((r+1)/Bu))>=(s=d.length)){if(!n)break e;for(;s++<=f;)d.push(0);c=o=0,i=1,u=(r%=Bu)-Bu+1}else{for(c=s=d[f],i=1;s>=10;s/=10)i++;o=(u=(r%=Bu)-Bu+i)<0?0:c/xu(10,i-u-1)%10|0}if(n=n||t<0||void 0!==d[f+1]||(u<0?c:c%xu(10,i-u-1)),l=a<4?(o||n)&&(0==a||a==(e.s<0?3:2)):o>5||5==o&&(4==a||n||6==a&&(r>0?u>0?c/xu(10,i-u):0:d[f-1])%10&1||a==(e.s<0?8:7)),t<1||!d[0])return d.length=0,l?(t-=e.e+1,d[0]=xu(10,(Bu-t%Bu)%Bu),e.e=-t||0):d[0]=e.e=0,e;if(0==r?(d.length=f,s=1,f--):(d.length=f+1,s=xu(10,Bu-r),d[f]=u>0?(c/xu(10,i-u)%xu(10,u)|0)*s:0),l)for(;;){if(0==f){for(r=1,u=d[0];u>=10;u/=10)r++;for(u=d[0]+=s,s=1;u>=10;u/=10)s++;r!=s&&(e.e++,d[0]==Su&&(d[0]=1));break}if(d[f]+=s,d[f]!=Su)break;d[f--]=0,s=1}for(r=d.length;0===d[--r];)d.pop()}return yu&&(e.e>h.maxE?(e.d=null,e.e=NaN):e.e<h.minE&&(e.e=0,e.d=[0])),e}function $u(e,t,a){if(!e.isFinite())return Xu(e);var n,i=e.e,r=Ou(e.d),u=r.length;return t?(a&&(n=a-u)>0?r=r.charAt(0)+"."+r.slice(1)+Wu(n):u>1&&(r=r.charAt(0)+"."+r.slice(1)),r=r+(e.e<0?"e":"e+")+e.e):i<0?(r="0."+Wu(-i-1)+r,a&&(n=a-u)>0&&(r+=Wu(n))):i>=u?(r+=Wu(i+1-u),a&&(n=a-i-1)>0&&(r=r+"."+Wu(n))):((n=i+1)<u&&(r=r.slice(0,n)+"."+r.slice(n)),a&&(n=a-u)>0&&(i+1===u&&(r+="."),r+=Wu(n))),r}function qu(e,t){var a=e[0];for(t*=Bu;a>=10;a/=10)t++;return t}function Vu(e,t,a){if(t>Nu)throw yu=!0,a&&(e.precision=a),Error(bu);return ju(new e(mu),t,1,!0)}function Ku(e,t,a){if(t>Pu)throw Error(bu);return ju(new e(_u),t,a,!0)}function Hu(e){var t=e.length-1,a=t*Bu+1;if(t=e[t]){for(;t%10==0;t/=10)a--;for(t=e[0];t>=10;t/=10)a++}return a}function Wu(e){for(var t="";e--;)t+="0";return t}function Ju(e,t,a,n){var i,r=new e(1),u=Math.ceil(n/Bu+4);for(yu=!1;;){if(a%2&&rs((r=r.times(t)).d,u)&&(i=!0),0===(a=ku(a/2))){a=r.d.length-1,i&&0===r.d[a]&&++r.d[a];break}rs((t=t.times(t)).d,u)}return yu=!0,r}function Zu(e){return 1&e.d[e.d.length-1]}function Yu(e,t,a){for(var n,i=new e(t[0]),r=0;++r<t.length;){if(!(n=new e(t[r])).s){i=n;break}i[a](n)&&(i=n)}return i}function Gu(e,t){var a,n,i,r,u,s,o,l=0,c=0,d=0,f=e.constructor,h=f.rounding,p=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(yu=!1,o=p):o=t,s=new f(.03125);e.e>-2;)e=e.times(s),d+=5;for(o+=n=Math.log(xu(2,d))/Math.LN10*2+5|0,a=r=u=new f(1),f.precision=o;;){if(r=ju(r.times(e),o,1),a=a.times(++c),Ou((s=u.plus(zu(r,a,o,1))).d).slice(0,o)===Ou(u.d).slice(0,o)){for(i=d;i--;)u=ju(u.times(u),o,1);if(null!=t)return f.precision=p,u;if(!(l<3&&Uu(u.d,o-n,h,l)))return ju(u,f.precision=p,h,yu=!0);f.precision=o+=10,a=r=s=new f(1),c=0,l++}u=s}}function Qu(e,t){var a,n,i,r,u,s,o,l,c,d,f,h=1,p=e,v=p.d,m=p.constructor,_=m.rounding,g=m.precision;if(p.s<0||!v||!v[0]||!p.e&&1==v[0]&&1==v.length)return new m(v&&!v[0]?-1/0:1!=p.s?NaN:v?0:p);if(null==t?(yu=!1,c=g):c=t,m.precision=c+=10,n=(a=Ou(v)).charAt(0),!(Math.abs(r=p.e)<15e14))return l=Vu(m,c+2,g).times(r+""),p=Qu(new m(n+"."+a.slice(1)),c-10).plus(l),m.precision=g,null==t?ju(p,g,_,yu=!0):p;for(;n<7&&1!=n||1==n&&a.charAt(1)>3;)n=(a=Ou((p=p.times(e)).d)).charAt(0),h++;for(r=p.e,n>1?(p=new m("0."+a),r++):p=new m(n+"."+a.slice(1)),d=p,o=u=p=zu(p.minus(1),p.plus(1),c,1),f=ju(p.times(p),c,1),i=3;;){if(u=ju(u.times(f),c,1),Ou((l=o.plus(zu(u,new m(i),c,1))).d).slice(0,c)===Ou(o.d).slice(0,c)){if(o=o.times(2),0!==r&&(o=o.plus(Vu(m,c+2,g).times(r+""))),o=zu(o,new m(h),c,1),null!=t)return m.precision=g,o;if(!Uu(o.d,c-10,_,s))return ju(o,m.precision=g,_,yu=!0);m.precision=c+=10,l=u=p=zu(d.minus(1),d.plus(1),c,1),f=ju(p.times(p),c,1),i=s=1}o=l,i+=2}}function Xu(e){return String(e.s*e.s/0)}function es(e,t){var a,n,i;for((a=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(a<0&&(a=n),a+=+t.slice(n+1),t=t.substring(0,n)):a<0&&(a=t.length),n=0;48===t.charCodeAt(n);n++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(n,i)){if(i-=n,e.e=a=a-n-1,e.d=[],n=(a+1)%Bu,a<0&&(n+=Bu),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=Bu;n<i;)e.d.push(+t.slice(n,n+=Bu));t=t.slice(n),n=Bu-t.length}else n-=i;for(;n--;)t+="0";e.d.push(+t),yu&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function ts(e,t,a,n,i){var r,u,s,o,l=e.precision,c=Math.ceil(l/Bu);for(yu=!1,o=a.times(a),s=new e(n);;){if(u=zu(s.times(o),new e(t++*t++),l,1),s=i?n.plus(u):n.minus(u),n=zu(u.times(o),new e(t++*t++),l,1),void 0!==(u=s.plus(n)).d[c]){for(r=c;u.d[r]===s.d[r]&&r--;);if(-1==r)break}r=s,s=n,n=u,u=r}return yu=!0,u.d.length=c+1,u}function as(e,t){for(var a=e;--t;)a*=e;return a}function ns(e,t){var a,n=t.s<0,i=Ku(e,e.precision,1),r=i.times(.5);if((t=t.abs()).lte(r))return fu=n?4:1,t;if((a=t.divToInt(i)).isZero())fu=n?3:2;else{if((t=t.minus(a.times(i))).lte(r))return fu=Zu(a)?n?2:3:n?4:1,t;fu=Zu(a)?n?1:4:n?3:2}return t.minus(i).abs()}function is(e,t,a,n){var i,r,u,s,o,l,c,d,f,h=e.constructor,p=void 0!==a;if(p?(Lu(a,1,pu),void 0===n?n=h.rounding:Lu(n,0,8)):(a=h.precision,n=h.rounding),e.isFinite()){for(p?(i=2,16==t?a=4*a-3:8==t&&(a=3*a-2)):i=t,(u=(c=$u(e)).indexOf("."))>=0&&(c=c.replace(".",""),(f=new h(1)).e=c.length-u,f.d=Ru($u(f),10,i),f.e=f.d.length),r=o=(d=Ru(c,10,i)).length;0==d[--o];)d.pop();if(d[0]){if(u<0?r--:((e=new h(e)).d=d,e.e=r,d=(e=zu(e,f,a,n,0,i)).d,r=e.e,l=du),u=d[a],s=i/2,l=l||void 0!==d[a+1],l=n<4?(void 0!==u||l)&&(0===n||n===(e.s<0?3:2)):u>s||u===s&&(4===n||l||6===n&&1&d[a-1]||n===(e.s<0?8:7)),d.length=a,l)for(;++d[--a]>i-1;)d[a]=0,a||(++r,d.unshift(1));for(o=d.length;!d[o-1];--o);for(u=0,c="";u<o;u++)c+=vu.charAt(d[u]);if(p){if(o>1)if(16==t||8==t){for(u=16==t?4:3,--o;o%u;o++)c+="0";for(o=(d=Ru(c,i,t)).length;!d[o-1];--o);for(u=1,c="1.";u<o;u++)c+=vu.charAt(d[u])}else c=c.charAt(0)+"."+c.slice(1);c=c+(r<0?"p":"p+")+r}else if(r<0){for(;++r;)c="0"+c;c="0."+c}else if(++r>o)for(r-=o;r--;)c+="0";else r<o&&(c=c.slice(0,r)+"."+c.slice(r))}else c=p?"0p+0":"0";c=(16==t?"0x":2==t?"0b":8==t?"0o":"")+c}else c=Xu(e);return e.s<0?"-"+c:c}function rs(e,t){if(e.length>t)return e.length=t,!0}function us(e){return new this(e).abs()}function ss(e){return new this(e).acos()}function os(e){return new this(e).acosh()}function ls(e,t){return new this(e).plus(t)}function cs(e){return new this(e).asin()}function ds(e){return new this(e).asinh()}function fs(e){return new this(e).atan()}function hs(e){return new this(e).atanh()}function ps(e,t){e=new this(e),t=new this(t);var a,n=this.precision,i=this.rounding,r=n+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(a=t.s<0?Ku(this,n,i):new this(0)).s=e.s:!e.d||t.isZero()?(a=Ku(this,r,1).times(.5)).s=e.s:t.s<0?(this.precision=r,this.rounding=1,a=this.atan(zu(e,t,r,1)),t=Ku(this,r,1),this.precision=n,this.rounding=i,a=e.s<0?a.minus(t):a.plus(t)):a=this.atan(zu(e,t,r,1)):(a=Ku(this,r,1).times(t.s>0?.25:.75)).s=e.s:a=new this(NaN),a}function vs(e){return new this(e).cbrt()}function ms(e){return ju(e=new this(e),e.e+1,2)}function _s(e,t,a){return new this(e).clamp(t,a)}function gs(e){if(!e||"object"!=typeof e)throw Error(Du+"Object expected");var t,a,n,i=!0===e.defaults,r=["precision",1,pu,"rounding",0,8,"toExpNeg",-hu,0,"toExpPos",0,hu,"maxE",0,hu,"minE",-hu,0,"modulo",0,9];for(t=0;t<r.length;t+=3)if(a=r[t],i&&(this[a]=gu[a]),void 0!==(n=e[a])){if(!(ku(n)===n&&n>=r[t+1]&&n<=r[t+2]))throw Error(wu+a+": "+n);this[a]=n}if(a="crypto",i&&(this[a]=gu[a]),void 0!==(n=e[a])){if(!0!==n&&!1!==n&&0!==n&&1!==n)throw Error(wu+a+": "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(Cu);this[a]=!0}else this[a]=!1}return this}function ys(e){return new this(e).cos()}function Ds(e){return new this(e).cosh()}function ws(e,t){return new this(e).div(t)}function bs(e){return new this(e).exp()}function Cs(e){return ju(e=new this(e),e.e+1,3)}function As(){var e,t,a=new this(0);for(yu=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)a.d&&(a=a.plus(t.times(t)));else{if(t.s)return yu=!0,new this(1/0);a=t}return yu=!0,a.sqrt()}function ks(e){return e instanceof Hs||e&&e.toStringTag===Au||!1}function xs(e){return new this(e).ln()}function Es(e,t){return new this(e).log(t)}function Fs(e){return new this(e).log(2)}function Is(e){return new this(e).log(10)}function Ts(){return Yu(this,arguments,"lt")}function Ss(){return Yu(this,arguments,"gt")}function Bs(e,t){return new this(e).mod(t)}function Ns(e,t){return new this(e).mul(t)}function Ps(e,t){return new this(e).pow(t)}function Ms(e){var t,a,n,i,r=0,u=new this(1),s=[];if(void 0===e?e=this.precision:Lu(e,1,pu),n=Math.ceil(e/Bu),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));r<n;)(i=t[r])>=429e7?t[r]=crypto.getRandomValues(new Uint32Array(1))[0]:s[r++]=i%1e7;else{if(!crypto.randomBytes)throw Error(Cu);for(t=crypto.randomBytes(n*=4);r<n;)(i=t[r]+(t[r+1]<<8)+(t[r+2]<<16)+((127&t[r+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,r):(s.push(i%1e7),r+=4);r=n/4}else for(;r<n;)s[r++]=1e7*Math.random()|0;for(n=s[--r],e%=Bu,n&&e&&(i=xu(10,Bu-e),s[r]=(n/i|0)*i);0===s[r];r--)s.pop();if(r<0)a=0,s=[0];else{for(a=-1;0===s[0];a-=Bu)s.shift();for(n=1,i=s[0];i>=10;i/=10)n++;n<Bu&&(a-=Bu-n)}return u.e=a,u.d=s,u}function Os(e){return ju(e=new this(e),e.e+1,this.rounding)}function Ls(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function Us(e){return new this(e).sin()}function Rs(e){return new this(e).sinh()}function zs(e){return new this(e).sqrt()}function js(e,t){return new this(e).sub(t)}function $s(){var e=0,t=arguments,a=new this(t[e]);for(yu=!1;a.s&&++e<t.length;)a=a.plus(t[e]);return yu=!0,ju(a,this.precision,this.rounding)}function qs(e){return new this(e).tan()}function Vs(e){return new this(e).tanh()}function Ks(e){return ju(e=new this(e),e.e+1,1)}Mu[Symbol.for("nodejs.util.inspect.custom")]=Mu.toString,Mu[Symbol.toStringTag]="Decimal";var Hs=Mu.constructor=function e(t){var a,n,i;function r(e){var t,a,n,i=this;if(!(i instanceof r))return new r(e);if(i.constructor=r,ks(e))return i.s=e.s,void(yu?!e.d||e.e>r.maxE?(i.e=NaN,i.d=null):e.e<r.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"===(n=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,a=e;a>=10;a/=10)t++;return void(yu?t>r.maxE?(i.e=NaN,i.d=null):t<r.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!=0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):es(i,e.toString())}if("string"!==n)throw Error(wu+e);return 45===(a=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===a&&(e=e.slice(1)),i.s=1),Tu.test(e)?es(i,e):function(e,t){var a,n,i,r,u,s,o,l,c;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Tu.test(t))return es(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Fu.test(t))a=16,t=t.toLowerCase();else if(Eu.test(t))a=2;else{if(!Iu.test(t))throw Error(wu+t);a=8}for((r=t.search(/p/i))>0?(o=+t.slice(r+1),t=t.substring(2,r)):t=t.slice(2),u=(r=t.indexOf("."))>=0,n=e.constructor,u&&(r=(s=(t=t.replace(".","")).length)-r,i=Ju(n,new n(a),r,2*r)),r=c=(l=Ru(t,a,Su)).length-1;0===l[r];--r)l.pop();return r<0?new n(0*e.s):(e.e=qu(l,c),e.d=l,yu=!1,u&&(e=zu(e,i,4*s)),o&&(e=e.times(Math.abs(o)<54?xu(2,o):Hs.pow(2,o))),yu=!0,e)}(i,e)}if(r.prototype=Mu,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=gs,r.clone=e,r.isDecimal=ks,r.abs=us,r.acos=ss,r.acosh=os,r.add=ls,r.asin=cs,r.asinh=ds,r.atan=fs,r.atanh=hs,r.atan2=ps,r.cbrt=vs,r.ceil=ms,r.clamp=_s,r.cos=ys,r.cosh=Ds,r.div=ws,r.exp=bs,r.floor=Cs,r.hypot=As,r.ln=xs,r.log=Es,r.log10=Is,r.log2=Fs,r.max=Ts,r.min=Ss,r.mod=Bs,r.mul=Ns,r.pow=Ps,r.random=Ms,r.round=Os,r.sign=Ls,r.sin=Us,r.sinh=Rs,r.sqrt=zs,r.sub=js,r.sum=$s,r.tan=qs,r.tanh=Vs,r.trunc=Ks,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],a=0;a<i.length;)t.hasOwnProperty(n=i[a++])||(t[n]=this[n]);return r.config(t),r}(gu);mu=new Hs(mu),_u=new Hs(_u);var Ws,Js=Gr("BigNumber",["?on","config"],(e=>{var{on:t,config:a}=e,n=Hs.clone({precision:a.precision,modulo:Hs.EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(e){return new n(e.value)},t&&t("config",(function(e,t){e.precision!==t.precision&&n.config({precision:e.precision})})),n}),{isClass:!0}),Zs={exports:{}};
/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
Ws=Zs,function(e){var t=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:.5*(Math.exp(e)+Math.exp(-e))},a=Math.sinh||function(e){return Math.abs(e)<1e-9?e:.5*(Math.exp(e)-Math.exp(-e))},n=function(){throw SyntaxError("Invalid Param")};function i(e,t){var a=Math.abs(e),n=Math.abs(t);return 0===e?Math.log(n):0===t?Math.log(a):a<3e3&&n<3e3?.5*Math.log(e*e+t*t):(e/=2,t/=2,.5*Math.log(e*e+t*t)+Math.LN2)}function r(e,t){if(!(this instanceof r))return new r(e,t);var a=function(e,t){var a={re:0,im:0};if(null==e)a.re=a.im=0;else if(void 0!==t)a.re=e,a.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)a.re=e.re,a.im=e.im;else if("abs"in e&&"arg"in e){if(!Number.isFinite(e.abs)&&Number.isFinite(e.arg))return r.INFINITY;a.re=e.abs*Math.cos(e.arg),a.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!Number.isFinite(e.r)&&Number.isFinite(e.phi))return r.INFINITY;a.re=e.r*Math.cos(e.phi),a.im=e.r*Math.sin(e.phi)}else 2===e.length?(a.re=e[0],a.im=e[1]):n();break;case"string":a.im=a.re=0;var i=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),u=1,s=0;null===i&&n();for(var o=0;o<i.length;o++){var l=i[o];" "===l||"\t"===l||"\n"===l||("+"===l?u++:"-"===l?s++:"i"===l||"I"===l?(u+s===0&&n()," "===i[o+1]||isNaN(i[o+1])?a.im+=parseFloat((s%2?"-":"")+"1"):(a.im+=parseFloat((s%2?"-":"")+i[o+1]),o++),u=s=0):((u+s===0||isNaN(l))&&n(),"i"===i[o+1]||"I"===i[o+1]?(a.im+=parseFloat((s%2?"-":"")+l),o++):a.re+=parseFloat((s%2?"-":"")+l),u=s=0))}u+s>0&&n();break;case"number":a.im=0,a.re=e;break;default:n()}return isNaN(a.re)||isNaN(a.im),a}(e,t);this.re=a.re,this.im=a.im}r.prototype={re:0,im:0,sign:function(){var e=this.abs();return new r(this.re/e,this.im/e)},add:function(e,t){var a=new r(e,t);return this.isInfinite()&&a.isInfinite()?r.NAN:this.isInfinite()||a.isInfinite()?r.INFINITY:new r(this.re+a.re,this.im+a.im)},sub:function(e,t){var a=new r(e,t);return this.isInfinite()&&a.isInfinite()?r.NAN:this.isInfinite()||a.isInfinite()?r.INFINITY:new r(this.re-a.re,this.im-a.im)},mul:function(e,t){var a=new r(e,t);return this.isInfinite()&&a.isZero()||this.isZero()&&a.isInfinite()?r.NAN:this.isInfinite()||a.isInfinite()?r.INFINITY:0===a.im&&0===this.im?new r(this.re*a.re,0):new r(this.re*a.re-this.im*a.im,this.re*a.im+this.im*a.re)},div:function(e,t){var a=new r(e,t);if(this.isZero()&&a.isZero()||this.isInfinite()&&a.isInfinite())return r.NAN;if(this.isInfinite()||a.isZero())return r.INFINITY;if(this.isZero()||a.isInfinite())return r.ZERO;e=this.re,t=this.im;var n,i,u=a.re,s=a.im;return 0===s?new r(e/u,t/u):Math.abs(u)<Math.abs(s)?new r((e*(i=u/s)+t)/(n=u*i+s),(t*i-e)/n):new r((e+t*(i=s/u))/(n=s*i+u),(t-e*i)/n)},pow:function(e,t){var a=new r(e,t);if(e=this.re,t=this.im,a.isZero())return r.ONE;if(0===a.im){if(0===t&&e>0)return new r(Math.pow(e,a.re),0);if(0===e)switch((a.re%4+4)%4){case 0:return new r(Math.pow(t,a.re),0);case 1:return new r(0,Math.pow(t,a.re));case 2:return new r(-Math.pow(t,a.re),0);case 3:return new r(0,-Math.pow(t,a.re))}}if(0===e&&0===t&&a.re>0&&a.im>=0)return r.ZERO;var n=Math.atan2(t,e),u=i(e,t);return e=Math.exp(a.re*u-a.im*n),t=a.im*u+a.re*n,new r(e*Math.cos(t),e*Math.sin(t))},sqrt:function(){var e,t,a=this.re,n=this.im,i=this.abs();if(a>=0){if(0===n)return new r(Math.sqrt(a),0);e=.5*Math.sqrt(2*(i+a))}else e=Math.abs(n)/Math.sqrt(2*(i-a));return t=a<=0?.5*Math.sqrt(2*(i-a)):Math.abs(n)/Math.sqrt(2*(i+a)),new r(e,n<0?-t:t)},exp:function(){var e=Math.exp(this.re);return this.im,new r(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){var e=this.re,t=this.im;return new r(Math.expm1(e)*Math.cos(t)+function(e){var t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;var a=e*e;return a*(a*(a*(a*(a*(a*(a*(a/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(t),Math.exp(e)*Math.sin(t))},log:function(){var e=this.re,t=this.im;return new r(i(e,t),Math.atan2(t,e))},abs:function(){return e=this.re,t=this.im,a=Math.abs(e),n=Math.abs(t),a<3e3&&n<3e3?Math.sqrt(a*a+n*n):(a<n?(a=n,n=e/t):n=t/e,a*Math.sqrt(1+n*n));var e,t,a,n},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var e=this.re,n=this.im;return new r(Math.sin(e)*t(n),Math.cos(e)*a(n))},cos:function(){var e=this.re,n=this.im;return new r(Math.cos(e)*t(n),-Math.sin(e)*a(n))},tan:function(){var e=2*this.re,n=2*this.im,i=Math.cos(e)+t(n);return new r(Math.sin(e)/i,a(n)/i)},cot:function(){var e=2*this.re,n=2*this.im,i=Math.cos(e)-t(n);return new r(-Math.sin(e)/i,a(n)/i)},sec:function(){var e=this.re,n=this.im,i=.5*t(2*n)+.5*Math.cos(2*e);return new r(Math.cos(e)*t(n)/i,Math.sin(e)*a(n)/i)},csc:function(){var e=this.re,n=this.im,i=.5*t(2*n)-.5*Math.cos(2*e);return new r(Math.sin(e)*t(n)/i,-Math.cos(e)*a(n)/i)},asin:function(){var e=this.re,t=this.im,a=new r(t*t-e*e+1,-2*e*t).sqrt(),n=new r(a.re-t,a.im+e).log();return new r(n.im,-n.re)},acos:function(){var e=this.re,t=this.im,a=new r(t*t-e*e+1,-2*e*t).sqrt(),n=new r(a.re-t,a.im+e).log();return new r(Math.PI/2-n.im,n.re)},atan:function(){var e=this.re,t=this.im;if(0===e){if(1===t)return new r(0,1/0);if(-1===t)return new r(0,-1/0)}var a=e*e+(1-t)*(1-t),n=new r((1-t*t-e*e)/a,-2*e/a).log();return new r(-.5*n.im,.5*n.re)},acot:function(){var e=this.re,t=this.im;if(0===t)return new r(Math.atan2(1,e),0);var a=e*e+t*t;return 0!==a?new r(e/a,-t/a).atan():new r(0!==e?e/0:0,0!==t?-t/0:0).atan()},asec:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new r(0,1/0);var a=e*e+t*t;return 0!==a?new r(e/a,-t/a).acos():new r(0!==e?e/0:0,0!==t?-t/0:0).acos()},acsc:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new r(Math.PI/2,1/0);var a=e*e+t*t;return 0!==a?new r(e/a,-t/a).asin():new r(0!==e?e/0:0,0!==t?-t/0:0).asin()},sinh:function(){var e=this.re,n=this.im;return new r(a(e)*Math.cos(n),t(e)*Math.sin(n))},cosh:function(){var e=this.re,n=this.im;return new r(t(e)*Math.cos(n),a(e)*Math.sin(n))},tanh:function(){var e=2*this.re,n=2*this.im,i=t(e)+Math.cos(n);return new r(a(e)/i,Math.sin(n)/i)},coth:function(){var e=2*this.re,n=2*this.im,i=t(e)-Math.cos(n);return new r(a(e)/i,-Math.sin(n)/i)},csch:function(){var e=this.re,n=this.im,i=Math.cos(2*n)-t(2*e);return new r(-2*a(e)*Math.cos(n)/i,2*t(e)*Math.sin(n)/i)},sech:function(){var e=this.re,n=this.im,i=Math.cos(2*n)+t(2*e);return new r(2*t(e)*Math.cos(n)/i,-2*a(e)*Math.sin(n)/i)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e=this.acos();if(e.im<=0){var t=e.re;e.re=-e.im,e.im=t}else t=e.im,e.im=-e.re,e.re=t;return e},atanh:function(){var e=this.re,t=this.im,a=e>1&&0===t,n=1-e,u=1+e,s=n*n+t*t,o=0!==s?new r((u*n-t*t)/s,(t*n+u*t)/s):new r(-1!==e?e/0:0,0!==t?t/0:0),l=o.re;return o.re=i(o.re,o.im)/2,o.im=Math.atan2(o.im,l)/2,a&&(o.im=-o.im),o},acoth:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new r(0,Math.PI/2);var a=e*e+t*t;return 0!==a?new r(e/a,-t/a).atanh():new r(0!==e?e/0:0,0!==t?-t/0:0).atanh()},acsch:function(){var e=this.re,t=this.im;if(0===t)return new r(0!==e?Math.log(e+Math.sqrt(e*e+1)):1/0,0);var a=e*e+t*t;return 0!==a?new r(e/a,-t/a).asinh():new r(0!==e?e/0:0,0!==t?-t/0:0).asinh()},asech:function(){var e=this.re,t=this.im;if(this.isZero())return r.INFINITY;var a=e*e+t*t;return 0!==a?new r(e/a,-t/a).acosh():new r(0!==e?e/0:0,0!==t?-t/0:0).acosh()},inverse:function(){if(this.isZero())return r.INFINITY;if(this.isInfinite())return r.ZERO;var e=this.re,t=this.im,a=e*e+t*t;return new r(e/a,-t/a)},conjugate:function(){return new r(this.re,-this.im)},neg:function(){return new r(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new r(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new r(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new r(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){var a=new r(e,t);return Math.abs(a.re-this.re)<=r.EPSILON&&Math.abs(a.im-this.im)<=r.EPSILON},clone:function(){return new r(this.re,this.im)},toString:function(){var e=this.re,t=this.im,a="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<r.EPSILON&&(e=0),Math.abs(t)<r.EPSILON&&(t=0),0===t?a+e:(0!==e?(a+=e,a+=" ",t<0?(t=-t,a+="-"):a+="+",a+=" "):t<0&&(t=-t,a+="-"),1!==t&&(a+=t),a+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},r.ZERO=new r(0,0),r.ONE=new r(1,0),r.I=new r(0,1),r.PI=new r(Math.PI,0),r.E=new r(Math.E,0),r.INFINITY=new r(1/0,1/0),r.NAN=new r(NaN,NaN),r.EPSILON=1e-15,Object.defineProperty(r,"__esModule",{value:!0}),r.default=r,r.Complex=r,Ws.exports=r}();const Ys=Ze(Zs.exports);var Gs=Gr("Complex",[],(()=>(Object.defineProperty(Ys,"name",{value:"Complex"}),Ys.prototype.constructor=Ys,Ys.prototype.type="Complex",Ys.prototype.isComplex=!0,Ys.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Ys.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Ys.prototype.format=function(e){var t=this.im,a=this.re,n=yr(this.re,e),i=yr(this.im,e),r=bi(e)?e:e?e.precision:null;if(null!==r){var u=Math.pow(10,-r);Math.abs(a/t)<u&&(a=0),Math.abs(t/a)<u&&(t=0)}return 0===t?n:0===a?1===t?"i":-1===t?"-i":i+"i":t<0?-1===t?n+" - i":n+" - "+i.substring(1)+"i":1===t?n+" + i":n+" + "+i+"i"},Ys.fromPolar=function(e){switch(arguments.length){case 1:var t=arguments[0];if("object"==typeof t)return Ys(t);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var a=arguments[0],n=arguments[1];if(bi(a)){if(xi(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),bi(n))return new Ys({r:a,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Ys.prototype.valueOf=Ys.prototype.toString,Ys.fromJSON=function(e){return new Ys(e)},Ys.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},Ys)),{isClass:!0}),Qs={exports:{}};
/**
 * @license Fraction.js v4.3.0 20/08/2023
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2023, Robert Eisele (robert@raw.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
!function(e,t){!function(t){var a={s:1,n:0,d:1};function n(e,t){if(isNaN(e=parseInt(e,10)))throw c();return e*t}function i(e,t){if(0===t)throw l();var a=Object.create(o.prototype);a.s=e<0?-1:1;var n=s(e=e<0?-e:e,t);return a.n=e/n,a.d=t/n,a}function r(e){for(var t={},a=e,n=2,i=4;i<=a;){for(;a%n==0;)a/=n,t[n]=(t[n]||0)+1;i+=1+2*n++}return a!==e?a>1&&(t[a]=(t[a]||0)+1):t[e]=(t[e]||0)+1,t}var u=function(e,t){var i,r=0,u=1,s=1,o=0,f=0,h=0,p=1,v=1,m=0,_=1,g=1,y=1,D=1e7;if(null==e);else if(void 0!==t){if(s=(r=e)*(u=t),r%1!=0||u%1!=0)throw d()}else switch(typeof e){case"object":if("d"in e&&"n"in e)r=e.n,u=e.d,"s"in e&&(r*=e.s);else{if(!(0 in e))throw c();r=e[0],1 in e&&(u=e[1])}s=r*u;break;case"number":if(e<0&&(s=e,e=-e),e%1==0)r=e;else if(e>0){for(e>=1&&(e/=v=Math.pow(10,Math.floor(1+Math.log(e)/Math.LN10)));_<=D&&y<=D;){if(e===(i=(m+g)/(_+y))){_+y<=D?(r=m+g,u=_+y):y>_?(r=g,u=y):(r=m,u=_);break}e>i?(m+=g,_+=y):(g+=m,y+=_),_>D?(r=g,u=y):(r=m,u=_)}r*=v}else(isNaN(e)||isNaN(t))&&(u=r=NaN);break;case"string":if(null===(_=e.match(/\d+|./g)))throw c();if("-"===_[m]?(s=-1,m++):"+"===_[m]&&m++,_.length===m+1?f=n(_[m++],s):"."===_[m+1]||"."===_[m]?("."!==_[m]&&(o=n(_[m++],s)),(++m+1===_.length||"("===_[m+1]&&")"===_[m+3]||"'"===_[m+1]&&"'"===_[m+3])&&(f=n(_[m],s),p=Math.pow(10,_[m].length),m++),("("===_[m]&&")"===_[m+2]||"'"===_[m]&&"'"===_[m+2])&&(h=n(_[m+1],s),v=Math.pow(10,_[m+1].length)-1,m+=3)):"/"===_[m+1]||":"===_[m+1]?(f=n(_[m],s),p=n(_[m+2],1),m+=3):"/"===_[m+3]&&" "===_[m+1]&&(o=n(_[m],s),f=n(_[m+2],s),p=n(_[m+4],1),m+=5),_.length<=m){s=r=h+(u=p*v)*o+v*f;break}default:throw c()}if(0===u)throw l();a.s=s<0?-1:1,a.n=Math.abs(r),a.d=Math.abs(u)};function s(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}}function o(e,t){if(u(e,t),!(this instanceof o))return i(a.s*a.n,a.d);e=s(a.d,a.n),this.s=a.s,this.n=a.n/e,this.d=a.d/e}var l=function(){return new Error("Division by Zero")},c=function(){return new Error("Invalid argument")},d=function(){return new Error("Parameters must be integer")};o.prototype={s:1,n:0,d:1,abs:function(){return i(this.n,this.d)},neg:function(){return i(-this.s*this.n,this.d)},add:function(e,t){return u(e,t),i(this.s*this.n*a.d+a.s*this.d*a.n,this.d*a.d)},sub:function(e,t){return u(e,t),i(this.s*this.n*a.d-a.s*this.d*a.n,this.d*a.d)},mul:function(e,t){return u(e,t),i(this.s*a.s*this.n*a.n,this.d*a.d)},div:function(e,t){return u(e,t),i(this.s*a.s*this.n*a.d,this.d*a.n)},clone:function(){return i(this.s*this.n,this.d)},mod:function(e,t){if(isNaN(this.n)||isNaN(this.d))return new o(NaN);if(void 0===e)return i(this.s*this.n%this.d,1);if(u(e,t),0===a.n&&0===this.d)throw l();return i(this.s*(a.d*this.n)%(a.n*this.d),a.d*this.d)},gcd:function(e,t){return u(e,t),i(s(a.n,this.n)*s(a.d,this.d),a.d*this.d)},lcm:function(e,t){return u(e,t),0===a.n&&0===this.n?i(0,1):i(a.n*this.n,s(a.n,this.n)*s(a.d,this.d))},ceil:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new o(NaN):i(Math.ceil(e*this.s*this.n/this.d),e)},floor:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new o(NaN):i(Math.floor(e*this.s*this.n/this.d),e)},round:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new o(NaN):i(Math.round(e*this.s*this.n/this.d),e)},inverse:function(){return i(this.s*this.d,this.n)},pow:function(e,t){if(u(e,t),1===a.d)return a.s<0?i(Math.pow(this.s*this.d,a.n),Math.pow(this.n,a.n)):i(Math.pow(this.s*this.n,a.n),Math.pow(this.d,a.n));if(this.s<0)return null;var n=r(this.n),s=r(this.d),o=1,l=1;for(var c in n)if("1"!==c){if("0"===c){o=0;break}if(n[c]*=a.n,n[c]%a.d!=0)return null;n[c]/=a.d,o*=Math.pow(c,n[c])}for(var c in s)if("1"!==c){if(s[c]*=a.n,s[c]%a.d!=0)return null;s[c]/=a.d,l*=Math.pow(c,s[c])}return a.s<0?i(l,o):i(o,l)},equals:function(e,t){return u(e,t),this.s*this.n*a.d==a.s*a.n*this.d},compare:function(e,t){u(e,t);var n=this.s*this.n*a.d-a.s*a.n*this.d;return(0<n)-(n<0)},simplify:function(e){if(isNaN(this.n)||isNaN(this.d))return this;e=e||.001;for(var t=this.abs(),a=t.toContinued(),n=1;n<a.length;n++){for(var r=i(a[n-1],1),u=n-2;u>=0;u--)r=r.inverse().add(a[u]);if(Math.abs(r.sub(t).valueOf())<e)return r.mul(this.s)}return this},divisible:function(e,t){return u(e,t),!(!(a.n*this.d)||this.n*a.d%(a.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(e){var t,a="",n=this.n,i=this.d;return this.s<0&&(a+="-"),1===i?a+=n:(e&&(t=Math.floor(n/i))>0&&(a+=t,a+=" ",n%=i),a+=n,a+="/",a+=i),a},toLatex:function(e){var t,a="",n=this.n,i=this.d;return this.s<0&&(a+="-"),1===i?a+=n:(e&&(t=Math.floor(n/i))>0&&(a+=t,n%=i),a+="\\frac{",a+=n,a+="}{",a+=i,a+="}"),a},toContinued:function(){var e,t=this.n,a=this.d,n=[];if(isNaN(t)||isNaN(a))return n;do{n.push(Math.floor(t/a)),e=t%a,t=a,a=e}while(1!==t);return n},toString:function(e){var t=this.n,a=this.d;if(isNaN(t)||isNaN(a))return"NaN";e=e||15;var n=function(e,t){for(;t%2==0;t/=2);for(;t%5==0;t/=5);if(1===t)return 0;for(var a=10%t,n=1;1!==a;n++)if(a=10*a%t,n>2e3)return 0;return n}(0,a),i=function(e,t,a){for(var n=1,i=function(e,t,a){for(var n=1;t>0;e=e*e%a,t>>=1)1&t&&(n=n*e%a);return n}(10,a,t),r=0;r<300;r++){if(n===i)return r;n=10*n%t,i=10*i%t}return 0}(0,a,n),r=this.s<0?"-":"";if(r+=t/a|0,t%=a,(t*=10)&&(r+="."),n){for(var u=i;u--;)r+=t/a|0,t%=a,t*=10;r+="(";for(u=n;u--;)r+=t/a|0,t%=a,t*=10;r+=")"}else for(u=e;t&&u--;)r+=t/a|0,t%=a,t*=10;return r}},Object.defineProperty(o,"__esModule",{value:!0}),o.default=o,o.Fraction=o,e.exports=o}()}(Qs);const Xs=Ze(Qs.exports);var eo=Gr("Fraction",[],(()=>(Object.defineProperty(Xs,"name",{value:"Fraction"}),Xs.prototype.constructor=Xs,Xs.prototype.type="Fraction",Xs.prototype.isFraction=!0,Xs.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Xs.fromJSON=function(e){return new Xs(e)},Xs)),{isClass:!0}),to=Gr("Matrix",[],(()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(e,t,a){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(e,t,a){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e}),{isClass:!0});function ao(e){return Object.keys(e.signatures||{}).reduce((function(e,t){var a=(t.match(/,/g)||[]).length+1;return Math.max(e,a)}),-1)}var no=Gr("DenseMatrix",["Matrix"],(e=>{var{Matrix:t}=e;function a(e,t){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!Ei(t))throw new Error("Invalid datatype: "+t);if(Ii(e))"DenseMatrix"===e.type?(this._data=or(e._data),this._size=or(e._size),this._datatype=t||e._datatype):(this._data=e.toArray(),this._size=e.size(),this._datatype=t||e._datatype);else if(e&&Fi(e.data)&&Fi(e.size))this._data=e.data,this._size=e.size,Lr(this._data,this._size),this._datatype=t||e.datatype;else if(Fi(e))this._data=s(e),this._size=Mr(this._data),Lr(this._data,this._size),this._datatype=t;else{if(e)throw new TypeError("Unsupported type of data ("+sr(e)+")");this._data=[],this._size=[0],this._datatype=t}}function n(e,t,a,i){var r=i===a-1,u=t.dimension(i);return r?u.map((function(t){return Ur(t,e.length),e[t]})).valueOf():u.map((function(r){return Ur(r,e.length),n(e[r],t,a,i+1)})).valueOf()}function i(e,t,a,n,r){var u=r===n-1,s=t.dimension(r);u?s.forEach((function(t,n){Ur(t),e[t]=a[n[0]]})):s.forEach((function(u,s){Ur(u),i(e[u],t,a[s[0]],n,r+1)}))}function r(e,t,a){if(0===t.length){for(var n=e._data;Fi(n);)n=n[0];return n}return e._size=t.slice(0),e._data=Rr(e._data,e._size,a),e}function u(e,t,a){for(var n=e._size.slice(0),i=!1;n.length<t.length;)n.push(0),i=!0;for(var u=0,s=t.length;u<s;u++)t[u]>n[u]&&(n[u]=t[u],i=!0);i&&r(e,n,a)}function s(e){return Ii(e)?s(e.valueOf()):Fi(e)?e.map(s):e}return a.prototype=new t,a.prototype.createDenseMatrix=function(e,t){return new a(e,t)},Object.defineProperty(a,"name",{value:"DenseMatrix"}),a.prototype.constructor=a,a.prototype.type="DenseMatrix",a.prototype.isDenseMatrix=!0,a.prototype.getDataType=function(){return Hr(this._data,sr)},a.prototype.storage=function(){return"dense"},a.prototype.datatype=function(){return this._datatype},a.prototype.create=function(e,t){return new a(e,t)},a.prototype.subset=function(e,t,r){switch(arguments.length){case 1:return function(e,t){if(!Pi(t))throw new TypeError("Invalid index");var i=t.isScalar();if(i)return e.get(t.min());var r=t.size();if(r.length!==e._size.length)throw new Nr(r.length,e._size.length);for(var u=t.min(),s=t.max(),o=0,l=e._size.length;o<l;o++)Ur(u[o],e._size[o]),Ur(s[o],e._size[o]);return new a(n(e._data,t,r.length,0),e._datatype)}(this,e);case 2:case 3:return function(e,t,a,n){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var r,s=t.size(),o=t.isScalar();Ii(a)?(r=a.size(),a=a.valueOf()):r=Mr(a);if(o){if(0!==r.length)throw new TypeError("Scalar expected");e.set(t.min(),a,n)}else{if(!lr(r,s))try{r=Mr(a=0===r.length?Yr([a],s):Yr(a,s))}catch(h){}if(s.length<e._size.length)throw new Nr(s.length,e._size.length,"<");if(r.length<s.length){for(var l=0,c=0;1===s[l]&&1===r[l];)l++;for(;1===s[l];)c++,l++;a=Vr(a,s.length,c,r)}if(!lr(s,r))throw new Nr(s,r,">");u(e,t.max().map((function(e){return e+1})),n);var d=s.length,f=0;i(e._data,t,a,d,f)}return e}(this,e,t,r);default:throw new SyntaxError("Wrong number of arguments")}},a.prototype.get=function(e){if(!Fi(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new Nr(e.length,this._size.length);for(var t=0;t<e.length;t++)Ur(e[t],this._size[t]);for(var a=this._data,n=0,i=e.length;n<i;n++){var r=e[n];Ur(r,a.length),a=a[r]}return a},a.prototype.set=function(e,t,a){if(!Fi(e))throw new TypeError("Array expected");if(e.length<this._size.length)throw new Nr(e.length,this._size.length,"<");var n,i,r;u(this,e.map((function(e){return e+1})),a);var s=this._data;for(n=0,i=e.length-1;n<i;n++)Ur(r=e[n],s.length),s=s[r];return Ur(r=e[e.length-1],s.length),s[r]=t,this},a.prototype.resize=function(e,t,a){if(!Ti(e))throw new TypeError("Array or Matrix expected");var n=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));return r(a?this.clone():this,n,t)},a.prototype.reshape=function(e,t){var a=t?this.clone():this;a._data=jr(a._data,e);var n=a._size.reduce(((e,t)=>e*t));return a._size=$r(e,n),a},a.prototype.clone=function(){return new a({data:or(this._data),size:or(this._size),datatype:this._datatype})},a.prototype.size=function(){return this._size.slice(0)},a.prototype.map=function(e){var t=this,n=ao(e),i=function a(i,r){return Fi(i)?i.map((function(e,t){return a(e,r.concat(t))})):1===n?e(i):2===n?e(i,r):e(i,r,t)}(this._data,[]);return new a(i,void 0!==this._datatype?Hr(i,sr):void 0)},a.prototype.forEach=function(e){var t=this;!function a(n,i){Fi(n)?n.forEach((function(e,t){a(e,i.concat(t))})):e(n,i,t)}(this._data,[])},a.prototype[Symbol.iterator]=function*(){yield*function*e(t,a){if(Fi(t))for(var n=0;n<t.length;n++)yield*e(t[n],a.concat(n));else yield{value:t,index:a}}(this._data,[])},a.prototype.rows=function(){var e=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var t=this._data;for(var n of t)e.push(new a([n],this._datatype));return e},a.prototype.columns=function(){var e=this,t=[],n=this.size();if(2!==n.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,r=function(n){var r=i.map((e=>[e[n]]));t.push(new a(r,e._datatype))},u=0;u<n[1];u++)r(u);return t},a.prototype.toArray=function(){return or(this._data)},a.prototype.valueOf=function(){return this._data},a.prototype.format=function(e){return Ir(this._data,e)},a.prototype.toString=function(){return Ir(this._data)},a.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},a.prototype.diagonal=function(e){if(e){if(Ci(e)&&(e=e.toNumber()),!bi(e)||!_r(e))throw new TypeError("The parameter k must be an integer number")}else e=0;for(var t=e>0?e:0,n=e<0?-e:0,i=this._size[0],r=this._size[1],u=Math.min(i-n,r-t),s=[],o=0;o<u;o++)s[o]=this._data[o+n][o+t];return new a({data:s,size:[u],datatype:this._datatype})},a.diagonal=function(e,t,n,i){if(!Fi(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(Ci(e)&&(e=e.toNumber()),!bi(e)||!_r(e)||e<1)throw new Error("Size values must be positive integers");return e})),n){if(Ci(n)&&(n=n.toNumber()),!bi(n)||!_r(n))throw new TypeError("The parameter k must be an integer number")}else n=0;var r,u=n>0?n:0,s=n<0?-n:0,o=e[0],l=e[1],c=Math.min(o-s,l-u);if(Fi(t)){if(t.length!==c)throw new Error("Invalid value array length");r=function(e){return t[e]}}else if(Ii(t)){var d=t.size();if(1!==d.length||d[0]!==c)throw new Error("Invalid matrix length");r=function(e){return t.get([e])}}else r=function(){return t};i||(i=Ci(r(0))?r(0).mul(0):0);var f=[];if(e.length>0){f=Rr(f,e,i);for(var h=0;h<c;h++)f[h+s][h+u]=r(h)}return new a({data:f,size:[o,l]})},a.fromJSON=function(e){return new a(e)},a.prototype.swapRows=function(e,t){if(!(bi(e)&&_r(e)&&bi(t)&&_r(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Ur(e,this._size[0]),Ur(t,this._size[0]),a._swapRows(e,t,this._data),this},a._swapRows=function(e,t,a){var n=a[e];a[e]=a[t],a[t]=n},a}),{isClass:!0});function io(e,t,a){return e&&"function"==typeof e.map?e.map((function(e){return io(e,t)})):t(e)}var ro="isInteger",uo=Gr(ro,["typed"],(e=>{var{typed:t}=e;return t(ro,{number:_r,BigNumber:function(e){return e.isInt()},Fraction:function(e){return 1===e.d&&isFinite(e.n)},"Array | Matrix":t.referToSelf((e=>t=>io(t,e)))})}));function so(e,t){return e+t}so.signature="number, number";var oo=Gr("compareUnits",["typed"],(e=>{var{typed:t}=e;return{"Unit, Unit":t.referToSelf((e=>(a,n)=>{if(!a.equalBase(n))throw new Error("Cannot compare units with different base");return t.find(e,[a.valueType(),n.valueType()])(a.value,n.value)}))}})),lo="equalScalar",co=Gr(lo,["typed","config"],(e=>{var{typed:t,config:a}=e,n=oo({typed:t});return t(lo,{"boolean, boolean":function(e,t){return e===t},"number, number":function(e,t){return kr(e,t,a.epsilon)},"BigNumber, BigNumber":function(e,t){return e.eq(t)||function(e,t,a){if(null==a)return e.eq(t);if(e.eq(t))return!0;if(e.isNaN()||t.isNaN())return!1;if(e.isFinite()&&t.isFinite()){var n=e.minus(t).abs();if(n.isZero())return!0;var i=e.constructor.max(e.abs(),t.abs());return n.lte(i.times(a))}return!1}(e,t,a.epsilon)},"Fraction, Fraction":function(e,t){return e.equals(t)},"Complex, Complex":function(e,t){return function(e,t,a){return kr(e.re,t.re,a)&&kr(e.im,t.im,a)}(e,t,a.epsilon)}},n)}));Gr(lo,["typed","config"],(e=>{var{typed:t,config:a}=e;return t(lo,{"number, number":function(e,t){return kr(e,t,a.epsilon)}})}));var fo=Gr("SparseMatrix",["typed","equalScalar","Matrix"],(e=>{var{typed:t,equalScalar:a,Matrix:n}=e;function i(e,t){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!Ei(t))throw new Error("Invalid datatype: "+t);if(Ii(e))!function(e,t,a){"SparseMatrix"===t.type?(e._values=t._values?or(t._values):void 0,e._index=or(t._index),e._ptr=or(t._ptr),e._size=or(t._size),e._datatype=a||t._datatype):r(e,t.valueOf(),a||t._datatype)}(this,e,t);else if(e&&Fi(e.index)&&Fi(e.ptr)&&Fi(e.size))this._values=e.values,this._index=e.index,this._ptr=e.ptr,this._size=e.size,this._datatype=t||e.datatype;else if(Fi(e))r(this,e,t);else{if(e)throw new TypeError("Unsupported type of data ("+sr(e)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=t}}function r(e,n,i){e._values=[],e._index=[],e._ptr=[],e._datatype=i;var r=n.length,u=0,s=a,o=0;if(Ei(i)&&(s=t.find(a,[i,i])||a,o=t.convert(0,i)),r>0){var l=0;do{e._ptr.push(e._index.length);for(var c=0;c<r;c++){var d=n[c];if(Fi(d)){if(0===l&&u<d.length&&(u=d.length),l<d.length){var f=d[l];s(f,o)||(e._values.push(f),e._index.push(c))}}else 0===l&&u<1&&(u=1),s(d,o)||(e._values.push(d),e._index.push(c))}l++}while(l<u)}e._ptr.push(e._index.length),e._size=[r,u]}function u(e,t,a,n){if(a-t==0)return a;for(var i=t;i<a;i++)if(n[i]===e)return i;return t}function s(e,t,a,n,i,r,u){i.splice(e,0,n),r.splice(e,0,t);for(var s=a+1;s<u.length;s++)u[s]++}function o(e,n,i,r){var u=r||0,s=a,o=0;Ei(e._datatype)&&(s=t.find(a,[e._datatype,e._datatype])||a,o=t.convert(0,e._datatype),u=t.convert(u,e._datatype));var l,c,d,f=!s(u,o),h=e._size[0],p=e._size[1];if(i>p){for(c=p;c<i;c++)if(e._ptr[c]=e._values.length,f)for(l=0;l<h;l++)e._values.push(u),e._index.push(l);e._ptr[i]=e._values.length}else i<p&&(e._ptr.splice(i+1,p-i),e._values.splice(e._ptr[i],e._values.length),e._index.splice(e._ptr[i],e._index.length));if(p=i,n>h){if(f){var v=0;for(c=0;c<p;c++){e._ptr[c]=e._ptr[c]+v,d=e._ptr[c+1]+v;var m=0;for(l=h;l<n;l++,m++)e._values.splice(d+m,0,u),e._index.splice(d+m,0,l),v++}e._ptr[p]=e._values.length}}else if(n<h){var _=0;for(c=0;c<p;c++){e._ptr[c]=e._ptr[c]-_;var g=e._ptr[c],y=e._ptr[c+1]-_;for(d=g;d<y;d++)(l=e._index[d])>n-1&&(e._values.splice(d,1),e._index.splice(d,1),_++)}e._ptr[c]=e._values.length}return e._size[0]=n,e._size[1]=i,e}function l(e,t,a,n,i){var r,u,s=n[0],o=n[1],l=[];for(r=0;r<s;r++)for(l[r]=[],u=0;u<o;u++)l[r][u]=0;for(u=0;u<o;u++)for(var c=a[u],d=a[u+1],f=c;f<d;f++)l[r=t[f]][u]=e?i?or(e[f]):e[f]:1;return l}return i.prototype=new n,i.prototype.createSparseMatrix=function(e,t){return new i(e,t)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return Hr(this._values,sr)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(e,t){return new i(e,t)},i.prototype.density=function(){var e=this._size[0],t=this._size[1];return 0!==e&&0!==t?this._index.length/(e*t):0},i.prototype.subset=function(e,t,a){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(e,t){if(!Pi(t))throw new TypeError("Invalid index");if(t.isScalar())return e.get(t.min());var a,n,r,u,s=t.size();if(s.length!==e._size.length)throw new Nr(s.length,e._size.length);var o=t.min(),l=t.max();for(a=0,n=e._size.length;a<n;a++)Ur(o[a],e._size[a]),Ur(l[a],e._size[a]);var c=e._values,d=e._index,f=e._ptr,h=t.dimension(0),p=t.dimension(1),v=[],m=[];h.forEach((function(e,t){m[e]=t[0],v[e]=!0}));var _=c?[]:void 0,g=[],y=[];return p.forEach((function(e){for(y.push(g.length),r=f[e],u=f[e+1];r<u;r++)a=d[r],!0===v[a]&&(g.push(m[a]),_&&_.push(c[r]))})),y.push(g.length),new i({values:_,index:g,ptr:y,size:s,datatype:e._datatype})}(this,e);case 2:case 3:return function(e,t,a,n){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var i,r=t.size(),u=t.isScalar();Ii(a)?(i=a.size(),a=a.toArray()):i=Mr(a);if(u){if(0!==i.length)throw new TypeError("Scalar expected");e.set(t.min(),a,n)}else{if(1!==r.length&&2!==r.length)throw new Nr(r.length,e._size.length,"<");if(i.length<r.length){for(var s=0,o=0;1===r[s]&&1===i[s];)s++;for(;1===r[s];)o++,s++;a=Vr(a,r.length,o,i)}if(!lr(r,i))throw new Nr(r,i,">");if(1===r.length){t.dimension(0).forEach((function(t,i){Ur(t),e.set([t,0],a[i[0]],n)}))}else{var l=t.dimension(0),c=t.dimension(1);l.forEach((function(t,i){Ur(t),c.forEach((function(r,u){Ur(r),e.set([t,r],a[i[0]][u[0]],n)}))}))}}return e}(this,e,t,a);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(e){if(!Fi(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new Nr(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var t=e[0],a=e[1];Ur(t,this._size[0]),Ur(a,this._size[1]);var n=u(t,this._ptr[a],this._ptr[a+1],this._index);return n<this._ptr[a+1]&&this._index[n]===t?this._values[n]:0},i.prototype.set=function(e,n,i){if(!Fi(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new Nr(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var r=e[0],l=e[1],c=this._size[0],d=this._size[1],f=a,h=0;Ei(this._datatype)&&(f=t.find(a,[this._datatype,this._datatype])||a,h=t.convert(0,this._datatype)),(r>c-1||l>d-1)&&(o(this,Math.max(r+1,c),Math.max(l+1,d),i),c=this._size[0],d=this._size[1]),Ur(r,c),Ur(l,d);var p=u(r,this._ptr[l],this._ptr[l+1],this._index);return p<this._ptr[l+1]&&this._index[p]===r?f(n,h)?function(e,t,a,n,i){a.splice(e,1),n.splice(e,1);for(var r=t+1;r<i.length;r++)i[r]--}(p,l,this._values,this._index,this._ptr):this._values[p]=n:f(n,h)||s(p,r,l,n,this._values,this._index,this._ptr),this},i.prototype.resize=function(e,t,a){if(!Ti(e))throw new TypeError("Array or Matrix expected");var n=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));if(2!==n.length)throw new Error("Only two dimensions matrix are supported");return n.forEach((function(e){if(!bi(e)||!_r(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Ir(n)+")")})),o(a?this.clone():this,n[0],n[1],t)},i.prototype.reshape=function(e,t){if(!Fi(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");e.forEach((function(t){if(!bi(t)||!_r(t)||t<=-2||0===t)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Ir(e)+")")}));var a=this._size[0]*this._size[1];if(a!==(e=$r(e,a))[0]*e[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var n=t?this.clone():this;if(this._size[0]===e[0]&&this._size[1]===e[1])return n;for(var i=[],r=0;r<n._ptr.length;r++)for(var o=0;o<n._ptr[r+1]-n._ptr[r];o++)i.push(r);for(var l=n._values.slice(),c=n._index.slice(),d=0;d<n._index.length;d++){var f=c[d],h=i[d],p=f*n._size[1]+h;i[d]=p%e[1],c[d]=Math.floor(p/e[1])}n._values.length=0,n._index.length=0,n._ptr.length=e[1]+1,n._size=e.slice();for(var v=0;v<n._ptr.length;v++)n._ptr[v]=0;for(var m=0;m<l.length;m++){var _=c[m],g=i[m],y=l[m];s(u(_,n._ptr[g],n._ptr[g+1],n._index),_,g,y,n._values,n._index,n._ptr)}return n},i.prototype.clone=function(){return new i({values:this._values?or(this._values):void 0,index:or(this._index),ptr:or(this._ptr),size:or(this._size),datatype:this._datatype})},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(e,n){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var r=this,u=this._size[0],s=this._size[1],o=ao(e);return function(e,n,r,u,s,o,l){var c=[],d=[],f=[],h=a,p=0;Ei(e._datatype)&&(h=t.find(a,[e._datatype,e._datatype])||a,p=t.convert(0,e._datatype));for(var v=function(e,t,a){e=o(e,t,a),h(e,p)||(c.push(e),d.push(t))},m=u;m<=s;m++){f.push(c.length);var _=e._ptr[m],g=e._ptr[m+1];if(l)for(var y=_;y<g;y++){var D=e._index[y];D>=n&&D<=r&&v(e._values[y],D-n,m-u)}else{for(var w={},b=_;b<g;b++){w[e._index[b]]=e._values[b]}for(var C=n;C<=r;C++){v(C in w?w[C]:0,C-n,m-u)}}}return f.push(c.length),new i({values:c,index:d,ptr:f,size:[r-n+1,s-u+1]})}(this,0,u-1,0,s-1,(function(t,a,n){return 1===o?e(t):2===o?e(t,[a,n]):e(t,[a,n],r)}),n)},i.prototype.forEach=function(e,t){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var a=this._size[0],n=this._size[1],i=0;i<n;i++){var r=this._ptr[i],u=this._ptr[i+1];if(t)for(var s=r;s<u;s++){var o=this._index[s];e(this._values[s],[o,i],this)}else{for(var l={},c=r;c<u;c++){l[this._index[c]]=this._values[c]}for(var d=0;d<a;d++){e(d in l?l[d]:0,[d,i],this)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var e=this._size[1],t=0;t<e;t++)for(var a=this._ptr[t],n=this._ptr[t+1],i=a;i<n;i++){var r=this._index[i];yield{value:this._values[i],index:[r,t]}}},i.prototype.toArray=function(){return l(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return l(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(e){for(var t=this._size[0],a=this._size[1],n=this.density(),i="Sparse Matrix ["+Ir(t,e)+" x "+Ir(a,e)+"] density: "+Ir(n,e)+"\n",r=0;r<a;r++)for(var u=this._ptr[r],s=this._ptr[r+1],o=u;o<s;o++){i+="\n    ("+Ir(this._index[o],e)+", "+Ir(r,e)+") ==> "+(this._values?Ir(this._values[o],e):"X")}return i},i.prototype.toString=function(){return Ir(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(e){if(e){if(Ci(e)&&(e=e.toNumber()),!bi(e)||!_r(e))throw new TypeError("The parameter k must be an integer number")}else e=0;var t=e>0?e:0,a=e<0?-e:0,n=this._size[0],r=this._size[1],u=Math.min(n-a,r-t),s=[],o=[],l=[];l[0]=0;for(var c=t;c<r&&s.length<u;c++)for(var d=this._ptr[c],f=this._ptr[c+1],h=d;h<f;h++){var p=this._index[h];if(p===c-t+a){s.push(this._values[h]),o[s.length-1]=p-a;break}}return l.push(s.length),new i({values:s,index:o,ptr:l,size:[u,1]})},i.fromJSON=function(e){return new i(e)},i.diagonal=function(e,n,r,u,s){if(!Fi(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(Ci(e)&&(e=e.toNumber()),!bi(e)||!_r(e)||e<1)throw new Error("Size values must be positive integers");return e})),r){if(Ci(r)&&(r=r.toNumber()),!bi(r)||!_r(r))throw new TypeError("The parameter k must be an integer number")}else r=0;var o=a,l=0;Ei(s)&&(o=t.find(a,[s,s])||a,l=t.convert(0,s));var c,d=r>0?r:0,f=r<0?-r:0,h=e[0],p=e[1],v=Math.min(h-f,p-d);if(Fi(n)){if(n.length!==v)throw new Error("Invalid value array length");c=function(e){return n[e]}}else if(Ii(n)){var m=n.size();if(1!==m.length||m[0]!==v)throw new Error("Invalid matrix length");c=function(e){return n.get([e])}}else c=function(){return n};for(var _=[],g=[],y=[],D=0;D<p;D++){y.push(_.length);var w=D-d;if(w>=0&&w<v){var b=c(w);o(b,l)||(g.push(w+f),_.push(b))}}return y.push(_.length),new i({values:_,index:g,ptr:y,size:[h,p]})},i.prototype.swapRows=function(e,t){if(!(bi(e)&&_r(e)&&bi(t)&&_r(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Ur(e,this._size[0]),Ur(t,this._size[0]),i._swapRows(e,t,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(e,t,a,n,i){for(var r=n[e],u=n[e+1],s=r;s<u;s++)i(a[s],t[s])},i._swapRows=function(e,t,a,n,i,r){for(var s=0;s<a;s++){var o=r[s],l=r[s+1],c=u(e,o,l,i),d=u(t,o,l,i);if(c<l&&d<l&&i[c]===e&&i[d]===t){if(n){var f=n[c];n[c]=n[d],n[d]=f}}else if(c<l&&i[c]===e&&(d>=l||i[d]!==t)){var h=n?n[c]:void 0;i.splice(d,0,t),n&&n.splice(d,0,h),i.splice(d<=c?c+1:c,1),n&&n.splice(d<=c?c+1:c,1)}else if(d<l&&i[d]===t&&(c>=l||i[c]!==e)){var p=n?n[d]:void 0;i.splice(c,0,e),n&&n.splice(c,0,p),i.splice(c<=d?d+1:d,1),n&&n.splice(c<=d?d+1:d,1)}}},i}),{isClass:!0}),ho="matrix",po=Gr(ho,["typed","Matrix","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,Matrix:a,DenseMatrix:n,SparseMatrix:i}=e;return t(ho,{"":function(){return r([])},string:function(e){return r([],e)},"string, string":function(e,t){return r([],e,t)},Array:function(e){return r(e)},Matrix:function(e){return r(e,e.storage())},"Array | Matrix, string":r,"Array | Matrix, string, string":r});function r(e,t,a){if("dense"===t||"default"===t||void 0===t)return new n(e,a);if("sparse"===t)return new i(e,a);throw new TypeError("Unknown matrix type "+JSON.stringify(t)+".")}})),vo="addScalar",mo=Gr(vo,["typed"],(e=>{var{typed:t}=e;return t(vo,{"number, number":so,"Complex, Complex":function(e,t){return e.add(t)},"BigNumber, BigNumber":function(e,t){return e.plus(t)},"Fraction, Fraction":function(e,t){return e.add(t)},"Unit, Unit":t.referToSelf((e=>(a,n)=>{if(null===a.value||void 0===a.value)throw new Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw new Error("Parameter y contains a unit with undefined value");if(!a.equalBase(n))throw new Error("Units do not match");var i=a.clone();return i.value=t.find(e,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i}))})})),_o=Gr("matAlgo14xDs",["typed"],(e=>{var{typed:t}=e;return function(e,n,i,r){var u,s=e._data,o=e._size,l=e._datatype,c=i;"string"==typeof l&&(u=l,n=t.convert(n,u),c=t.find(i,[u,u]));var d=o.length>0?a(c,0,o,o[0],s,n,r):[];return e.createDenseMatrix({data:d,size:or(o),datatype:u})};function a(e,t,n,i,r,u,s){var o=[];if(t===n.length-1)for(var l=0;l<i;l++)o[l]=s?e(u,r[l]):e(r[l],u);else for(var c=0;c<i;c++)o[c]=a(e,t+1,n,n[t+1],r[c],u,s);return o}})),go=Gr("matAlgo13xDD",["typed"],(e=>{var{typed:t}=e;return function(e,n,i){var r,u=e._data,s=e._size,o=e._datatype,l=n._data,c=n._size,d=n._datatype,f=[];if(s.length!==c.length)throw new Nr(s.length,c.length);for(var h=0;h<s.length;h++){if(s[h]!==c[h])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+c+")");f[h]=s[h]}var p=i;"string"==typeof o&&o===d&&(r=o,p=t.find(i,[r,r]));var v=f.length>0?a(p,0,f,f[0],u,l):[];return e.createDenseMatrix({data:v,size:f,datatype:r})};function a(e,t,n,i,r,u){var s=[];if(t===n.length-1)for(var o=0;o<i;o++)s[o]=e(r[o],u[o]);else for(var l=0;l<i;l++)s[l]=a(e,t+1,n,n[t+1],r[l],u[l]);return s}})),yo=Gr("broadcast",["concat"],(e=>{var{concat:t}=e;return function(e,t){var i=Math.max(e._size.length,t._size.length);if(e._size.length===t._size.length&&e._size.every(((e,a)=>e===t._size[a])))return[e,t];for(var r=a(e._size,i,0),u=a(t._size,i,0),s=[],o=0;o<i;o++)s[o]=Math.max(r[o],u[o]);Zr(r,s),Zr(u,s);var l=e.clone(),c=t.clone();l._size.length<i?l.reshape(a(l._size,i,1)):c._size.length<i&&c.reshape(a(c._size,i,1));for(var d=0;d<i;d++)l._size[d]<s[d]&&(l=n(l,s[d],d)),c._size[d]<s[d]&&(c=n(c,s[d],d));return[l,c]};function a(e,t,a){return[...Array(t-e.length).fill(a),...e]}function n(e,a,n){return t(...Array(a).fill(e),n)}})),Do=Gr("matrixAlgorithmSuite",["typed","matrix","concat"],(e=>{var{typed:t,matrix:a,concat:n}=e,i=go({typed:t}),r=_o({typed:t}),u=yo({concat:n});return function(e){var n,s=e.elop,o=e.SD||e.DS;s?(n={"DenseMatrix, DenseMatrix":(e,t)=>i(...u(e,t),s),"Array, Array":(e,t)=>i(...u(a(e),a(t)),s).valueOf(),"Array, DenseMatrix":(e,t)=>i(...u(a(e),t),s),"DenseMatrix, Array":(e,t)=>i(...u(e,a(t)),s)},e.SS&&(n["SparseMatrix, SparseMatrix"]=(t,a)=>e.SS(...u(t,a),s,!1)),e.DS&&(n["DenseMatrix, SparseMatrix"]=(t,a)=>e.DS(...u(t,a),s,!1),n["Array, SparseMatrix"]=(t,n)=>e.DS(...u(a(t),n),s,!1)),o&&(n["SparseMatrix, DenseMatrix"]=(e,t)=>o(...u(t,e),s,!0),n["SparseMatrix, Array"]=(e,t)=>o(...u(a(t),e),s,!0))):(n={"DenseMatrix, DenseMatrix":t.referToSelf((e=>(t,a)=>i(...u(t,a),e))),"Array, Array":t.referToSelf((e=>(t,n)=>i(...u(a(t),a(n)),e).valueOf())),"Array, DenseMatrix":t.referToSelf((e=>(t,n)=>i(...u(a(t),n),e))),"DenseMatrix, Array":t.referToSelf((e=>(t,n)=>i(...u(t,a(n)),e)))},e.SS&&(n["SparseMatrix, SparseMatrix"]=t.referToSelf((t=>(a,n)=>e.SS(...u(a,n),t,!1)))),e.DS&&(n["DenseMatrix, SparseMatrix"]=t.referToSelf((t=>(a,n)=>e.DS(...u(a,n),t,!1))),n["Array, SparseMatrix"]=t.referToSelf((t=>(n,i)=>e.DS(...u(a(n),i),t,!1)))),o&&(n["SparseMatrix, DenseMatrix"]=t.referToSelf((e=>(t,a)=>o(...u(a,t),e,!0))),n["SparseMatrix, Array"]=t.referToSelf((e=>(t,n)=>o(...u(a(n),t),e,!0)))));var l=e.scalar||"any";(e.Ds||e.Ss)&&(s?(n["DenseMatrix,"+l]=(e,t)=>r(e,t,s,!1),n[l+", DenseMatrix"]=(e,t)=>r(t,e,s,!0),n["Array,"+l]=(e,t)=>r(a(e),t,s,!1).valueOf(),n[l+", Array"]=(e,t)=>r(a(t),e,s,!0).valueOf()):(n["DenseMatrix,"+l]=t.referToSelf((e=>(t,a)=>r(t,a,e,!1))),n[l+", DenseMatrix"]=t.referToSelf((e=>(t,a)=>r(a,t,e,!0))),n["Array,"+l]=t.referToSelf((e=>(t,n)=>r(a(t),n,e,!1).valueOf())),n[l+", Array"]=t.referToSelf((e=>(t,n)=>r(a(n),t,e,!0).valueOf()))));var c=void 0!==e.sS?e.sS:e.Ss;return s?(e.Ss&&(n["SparseMatrix,"+l]=(t,a)=>e.Ss(t,a,s,!1)),c&&(n[l+", SparseMatrix"]=(e,t)=>c(t,e,s,!0))):(e.Ss&&(n["SparseMatrix,"+l]=t.referToSelf((t=>(a,n)=>e.Ss(a,n,t,!1)))),c&&(n[l+", SparseMatrix"]=t.referToSelf((e=>(t,a)=>c(a,t,e,!0))))),s&&s.signatures&&function(e,t){for(var a in t)cr(t,a)&&(e[a]=t[a])}(n,s.signatures),n}})),wo=Gr("matAlgo01xDSid",["typed"],(e=>{var{typed:t}=e;return function(e,a,n,i){var r=e._data,u=e._size,s=e._datatype,o=a._values,l=a._index,c=a._ptr,d=a._size,f=a._datatype;if(u.length!==d.length)throw new Nr(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");if(!o)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var h,p,v=u[0],m=u[1],_="string"==typeof s&&s===f?s:void 0,g=_?t.find(n,[_,_]):n,y=[];for(h=0;h<v;h++)y[h]=[];var D=[],w=[];for(p=0;p<m;p++){for(var b=p+1,C=c[p],A=c[p+1],k=C;k<A;k++)D[h=l[k]]=i?g(o[k],r[h][p]):g(r[h][p],o[k]),w[h]=b;for(h=0;h<v;h++)w[h]===b?y[h][p]=D[h]:y[h][p]=r[h][p]}return e.createDenseMatrix({data:y,size:[v,m],datatype:_})}})),bo=Gr("matAlgo04xSidSid",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:a}=e;return function(e,n,i){var r=e._values,u=e._index,s=e._ptr,o=e._size,l=e._datatype,c=n._values,d=n._index,f=n._ptr,h=n._size,p=n._datatype;if(o.length!==h.length)throw new Nr(o.length,h.length);if(o[0]!==h[0]||o[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+h+")");var v,m=o[0],_=o[1],g=a,y=0,D=i;"string"==typeof l&&l===p&&(v=l,g=t.find(a,[v,v]),y=t.convert(0,v),D=t.find(i,[v,v]));var w,b,C,A,k,x=r&&c?[]:void 0,E=[],F=[],I=r&&c?[]:void 0,T=r&&c?[]:void 0,S=[],B=[];for(b=0;b<_;b++){F[b]=E.length;var N=b+1;for(A=s[b],k=s[b+1],C=A;C<k;C++)w=u[C],E.push(w),S[w]=N,I&&(I[w]=r[C]);for(A=f[b],k=f[b+1],C=A;C<k;C++)if(S[w=d[C]]===N){if(I){var P=D(I[w],c[C]);g(P,y)?S[w]=null:I[w]=P}}else E.push(w),B[w]=N,T&&(T[w]=c[C]);if(I&&T)for(C=F[b];C<E.length;)S[w=E[C]]===N?(x[C]=I[w],C++):B[w]===N?(x[C]=T[w],C++):E.splice(C,1)}return F[_]=E.length,e.createSparseMatrix({values:x,index:E,ptr:F,size:[m,_],datatype:v})}})),Co=Gr("matAlgo10xSids",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:a}=e;return function(e,n,i,r){var u=e._values,s=e._index,o=e._ptr,l=e._size,c=e._datatype;if(!u)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d,f=l[0],h=l[1],p=i;"string"==typeof c&&(d=c,n=t.convert(n,d),p=t.find(i,[d,d]));for(var v=[],m=[],_=[],g=0;g<h;g++){for(var y=g+1,D=o[g],w=o[g+1],b=D;b<w;b++){var C=s[b];m[C]=u[b],_[C]=y}for(var A=0;A<f;A++)0===g&&(v[A]=[]),_[A]===y?v[A][g]=r?p(n,m[A]):p(m[A],n):v[A][g]=n}return new a({data:v,size:[f,h],datatype:d})}})),Ao="concat",ko=Gr(Ao,["typed","matrix","isInteger"],(e=>{var{typed:t,matrix:a,isInteger:n}=e;return t(Ao,{"...Array | Matrix | number | BigNumber":function(e){var t,i,r=e.length,u=-1,s=!1,o=[];for(t=0;t<r;t++){var l=e[t];if(Ii(l)&&(s=!0),bi(l)||Ci(l)){if(t!==r-1)throw new Error("Dimension must be specified as last argument");if(i=u,u=l.valueOf(),!n(u))throw new TypeError("Integer number expected for dimension");if(u<0||t>0&&u>i)throw new Pr(u,i+1)}else{var c=or(l).valueOf(),d=Mr(c);if(o[t]=c,i=u,u=d.length-1,t>0&&u!==i)throw new Nr(i+1,u+1)}}if(0===o.length)throw new SyntaxError("At least one matrix expected");for(var f=o.shift();o.length;)f=Jr(f,o.shift(),u);return s?a(f):f},"...string":function(e){return e.join("")}})})),xo=Gr("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],(e=>{var{typed:t,matrix:a,addScalar:n,equalScalar:i,DenseMatrix:r,SparseMatrix:u,concat:s}=e,o=wo({typed:t}),l=bo({typed:t,equalScalar:i}),c=Co({typed:t,DenseMatrix:r}),d=Do({typed:t,matrix:a,concat:s});return t("add",{"any, any":n,"any, any, ...any":t.referToSelf((e=>(t,a,n)=>{for(var i=e(t,a),r=0;r<n.length;r++)i=e(i,n[r]);return i}))},d({elop:n,DS:o,SS:l,Ss:c}))})),Eo=Js({config:dr}),Fo=Gs({}),Io=eo({}),To=to({}),So=no({Matrix:To}),Bo=su({BigNumber:Eo,Complex:Fo,DenseMatrix:So,Fraction:Io}),No=mo({typed:Bo}),Po=co({config:dr,typed:Bo}),Mo=uo({typed:Bo}),Oo=fo({Matrix:To,equalScalar:Po,typed:Bo}),Lo=po({DenseMatrix:So,Matrix:To,SparseMatrix:Oo,typed:Bo}),Uo=xo({DenseMatrix:So,SparseMatrix:Oo,addScalar:No,concat:ko({isInteger:Mo,matrix:Lo,typed:Bo}),equalScalar:Po,matrix:Lo,typed:Bo});const Ro=T({__name:"goods-detail",props:{show:{type:Boolean,default:!1},goodsDetail:{type:Object,default:()=>({})}},emits:["update:show","success","reload"],setup(e,{emit:t}){const a=t,n=e,i=F({}),r=F(!1),u=F({product_id:null,product_num:1,price:null,product_price:null,product_sku_id:null,attr:[],feed_uuids:[],bag_price:0,delivery:me()?30:40,describe:null});q((()=>n.show),(()=>{n.show&&s()}));const s=async()=>{var e,t,a,r,s,o,l,c,d;i.value=n.goodsDetail,u.value.product_id=null==(e=i.value)?void 0:e.product_id,u.value.price=null==(t=i.value)?void 0:t.product_price,u.value.product_price=null==(a=i.value)?void 0:a.product_price,(null==(r=i.value)?void 0:r.sku)&&(null==(s=i.value)?void 0:s.sku.length)>0&&(null==(o=i.value)||o.sku.some((e=>{if(e.stock_num>0)return u.value.product_sku_id=e.product_sku_id,!0}))),(null==(l=i.value)?void 0:l.product_attr)&&(null==(c=i.value)?void 0:c.product_attr.length)>0&&(null==(d=i.value)||d.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value_text)&&(null==e?void 0:e.attribute_value_text.length)>0?u.value.attr[t]=0:u.value.attr[t]=null}))),u.value.feed_uuids&&u.value.feed_uuids.length>0&&(u.value.feed_uuids=[])},o=async()=>{var e,t,n;if(r.value)return;const s={...u.value};s.attr=s.attr.join(",");let o=[];if(u.value.product_sku_id&&(null==(e=i.value)?void 0:e.sku)&&(null==(t=i.value)?void 0:t.sku.length)>0){const e=null==(n=i.value)?void 0:n.sku.find((e=>e.product_sku_id==u.value.product_sku_id));s.price=(null==e?void 0:e.product_price)||0,o.push(null==e?void 0:e.spec_name)}u.value.attr&&u.value.attr.length>0&&u.value.attr.map(((e,t)=>{var a;const n=null==(a=i.value)?void 0:a.product_attr[t];(null==n?void 0:n.attribute_value)&&n.attribute_value[e]&&o.push(n.attribute_value[e])})),u.value.feed_uuids&&u.value.feed_uuids.length>0&&u.value.feed_uuids.map((e=>{var t;const a=((null==(t=i.value)?void 0:t.feed)||[]).find((t=>t.product_feed_id==e));o.push(null==a?void 0:a.feed_name),s.price=Uo(s.price,null==a?void 0:a.price)})),s.describe=o.join(";"),s.delivery=me()?30:40,s.order_id=we();try{r.value=!0;const e=await Rn(s);uni.showToast({title:e.msg,icon:"none"}),a("update:show",!1),le(e.data.order_id),setTimeout((()=>{a("success",e.data.res,"add")}),300)}catch(l){}finally{r.value=!1}},l=(e,t)=>u.value.attr[e]==t;return(e,t)=>{const s=N(M("ti-image"),Ye),c=$,d=ce,f=ae,h=N(M("ti-modal"),H);return O(),L(h,{show:n.show,title:Z(Y)("商品详情"),class:"ti-goods-detail",confirmLoading:r.value,onCancel:t[0]||(t[0]=e=>a("update:show",!1)),onConfirm:o},{content:U((()=>[R(c,{class:"ti-dialog-content"},{default:U((()=>[R(c,{class:"ti-detail-box"},{default:U((()=>{var e,t;return[R(s,{class:"ti-detail-image",src:Z(Fe)(null==(t=null==(e=i.value)?void 0:e.image[0])?void 0:t.file_path,107,80)||""},null,8,["src"]),R(c,{class:"ti-detail-con"},{default:U((()=>[R(c,{class:"ti-detail-title text-ellipsis"},{default:U((()=>{var e,t;return[W(J((null==(e=i.value)?void 0:e.product_name[Z(fe)()])||(null==(t=i.value)?void 0:t.product_name_text)),1)]})),_:1}),R(c,{class:"ti-price-box"},{default:U((()=>[R(d,{class:"ti-detail-unit"},{default:U((()=>[W(J(Z(Y)("單價：")),1)])),_:1}),R(d,{class:"ti-detail-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=i.value)?void 0:e.product_price)||0)),1)]})),_:1}),R(d,{class:"ti-detail-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=i.value)?void 0:e.product_price)||0)),1)]})),_:1})])),_:1}),R(c,{class:"ti-price-box"},{default:U((()=>[R(d,{class:"ti-detail-unit"},{default:U((()=>[W(J(Z(Y)("單位：")),1)])),_:1}),R(d,{class:"ti-detail-price"},{default:U((()=>{var e,t;return[W(J((null==(e=i.value)?void 0:e.product_unit[Z(fe)()])||(null==(t=i.value)?void 0:t.product_unit_text)),1)]})),_:1})])),_:1})])),_:1})]})),_:1}),R(c,{class:"ti-detail-specs"},{default:U((()=>[R(f,{"scroll-y":""},{default:U((()=>[R(c,{class:"ti-specs-box"},{default:U((()=>{var e,t,a,n,r,s,o;return[(null==(e=i.value)?void 0:e.sku)&&(null==(t=i.value)?void 0:t.sku.length)>0?(O(),L(c,{key:0,class:"ti-specs-item"},{default:U((()=>[R(c,{class:"ti-specs-title"},{default:U((()=>[W(J(Z(Y)("規格")),1)])),_:1}),R(c,{class:"ti-specs-child"},{default:U((()=>{var e;return[(O(!0),X(ee,null,te(null==(e=i.value)?void 0:e.sku,(e=>(O(),L(c,{key:e.product_sku_id,class:j([{active:e.product_sku_id==u.value.product_sku_id,disabled:e.stock_num<=0},"ti-child-item"]),onClick:t=>(e=>{e.stock_num<=0||u.value.product_sku_id!=e.product_sku_id&&(u.value.product_sku_id=e.product_sku_id)})(e)},{default:U((()=>[R(d,{class:"ti-child-name"},{default:U((()=>[W(J(e.spec_name_i18n[Z(fe)()]||e.spec_name_text),1)])),_:2},1024),R(d,{class:"ti-child-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.product_price)||0,!0)),1)])),_:2},1024),R(d,{class:"ti-child-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.product_price)||0,!0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):de("",!0),(null==(a=i.value)?void 0:a.product_attr)&&(null==(n=i.value)?void 0:n.product_attr.length)>0?(O(!0),X(ee,{key:1},te(null==(r=i.value)?void 0:r.product_attr,((e,t)=>(O(),L(c,{key:t,class:"ti-specs-item"},{default:U((()=>[R(c,{class:"ti-specs-title"},{default:U((()=>[W(J(e.attribute_name_i18n[Z(fe)()]||e.attribute_name_text),1)])),_:2},1024),R(c,{class:"ti-specs-child"},{default:U((()=>[(O(!0),X(ee,null,te(null==e?void 0:e.attribute_value_i18n,((a,n)=>(O(),L(c,{key:n,class:j([{active:l(t,n)},"ti-child-item"]),onClick:e=>((e,t)=>{u.value.attr[e]=t})(t,n)},{default:U((()=>[R(d,{class:"ti-child-name"},{default:U((()=>[W(J(a[Z(fe)()]||(null==e?void 0:e.attribute_value_text[n])),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128)):de("",!0),(null==(s=i.value)?void 0:s.feed)&&(null==(o=i.value)?void 0:o.feed.length)>0?(O(),L(c,{key:2,class:"ti-specs-item"},{default:U((()=>[R(c,{class:"ti-specs-title"},{default:U((()=>[W(J(Z(Y)("加料")),1)])),_:1}),R(c,{class:"ti-specs-child"},{default:U((()=>{var e;return[(O(!0),X(ee,null,te(null==(e=i.value)?void 0:e.feed,(e=>(O(),L(c,{key:e.product_feed_id,class:j([{active:(u.value.feed_uuids||[]).indexOf(e.product_feed_id)>-1,disabled:e.stock_num<=0},"ti-child-item"]),onClick:t=>(e=>{if(e.stock_num<=0)return;const t=e.product_feed_id,a=u.value.feed_uuids.indexOf(t);a>=0?u.value.feed_uuids.splice(a,1):u.value.feed_uuids.push(t)})(e)},{default:U((()=>[R(d,{class:"ti-child-name"},{default:U((()=>[W(J(e.feed_name_i18n[Z(fe)()]||e.feed_name_text),1)])),_:2},1024),R(d,{class:"ti-child-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.price)||0,!0)),1)])),_:2},1024),R(d,{class:"ti-child-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.price)||0,!0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):de("",!0)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title","confirmLoading"])}}},[["__scopeId","data-v-586ef4eb"]]),zo=T({__name:"dish-list",emits:["success","add","error"],setup(e,{emit:t}){const a=t,n=Ge(),{cashierIsLock:i}=Se(Jn()),{pathName:r}=Se(Oe()),u=F({page:1,list_rows:10,category_id:null}),s=F(0),o=F(!1),l=F([]),c=F(!1),d=F(!1),f=F({}),h=(e,t)=>{a("success",e,t)},p=()=>{c.value&&(u.value.page++,m())},v=async()=>{var e,t;if(we()<=0)return uni.showToast({title:Y("订单ID不存在"),icon:"none"});try{const a=await Hn({order_id:we()});uni.showToast({title:a.msg,icon:"none"}),i.value=(null==(t=null==(e=a.data.res)?void 0:e.orderInfo)?void 0:t.is_lock)||0}catch(a){}},m=async()=>{const e={...u.value};e.category_id||(e.category_id="0"),1==s.value&&(e.is_special=1);try{o.value=!0;const t=await(null==n?void 0:n.getGoodsList(e)),a=n.getGoodsInfo((null==t?void 0:t.list)||[]);l.value=1==e.page?a:l.value.concat(a),c.value=(null==t?void 0:t.last_page)>(null==t?void 0:t.current_page)}catch(t){uni.showToast({title:t.toString(),icon:"none"})}finally{o.value=!1}},_=()=>{l.value=[],u.value.page=1,c.value=!1,m()};return q((()=>u.value.category_id),(()=>{_()})),q((()=>r.value),(()=>{"index"==r.value&&_()})),Ue("indexRefresh",(()=>{u.value.page=1,o.value=!0,setTimeout((()=>{_()}),300)})),(e,t)=>{const a=N(M("ti-loading"),ie),n=$,r=N(M("ti-image"),Ye),m=ce,_=N(M("ti-empty-data"),re),g=ae;return O(),X(ee,null,[R(n,{class:"ti-dish-box"},{default:U((()=>[R(yi,{categoryId:u.value.category_id,"onUpdate:categoryId":t[0]||(t[0]=e=>u.value.category_id=e),isSpecial:s.value,"onUpdate:isSpecial":t[1]||(t[1]=e=>s.value=e)},null,8,["categoryId","isSpecial"]),R(n,{class:"ti-dish-list"},{default:U((()=>[R(g,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:p},{default:U((()=>[o.value&&1==u.value.page?(O(),L(a,{key:0})):l.value&&l.value.length>0?(O(),X(ee,{key:1},[R(n,{class:"ti-dish-goods"},{default:U((()=>[(O(!0),X(ee,null,te(l.value,((e,t)=>(O(),L(n,{key:t,class:"ti-goods-item",onClick:t=>(async e=>{var t,a,n,r;if(1==i.value)return uni.showToast({title:Y("订单已被锁定，请解锁后重新操作"),icon:"none"});if(e.product_stock<=0)return uni.showToast({title:Y("已售罄"),icon:"none"});if(1==e.limit_num_status)return uni.showToast({title:Y("已限购"),icon:"none"});if((null==e?void 0:e.sku)&&(null==e?void 0:e.sku.length)<=1&&(!(null==e?void 0:e.product_attr)||(null==e?void 0:e.product_attr.length)<=0)&&(!e.feed||e.feed.length<=0)){const i={product_id:e.product_id,product_num:1,price:(null==(t=null==e?void 0:e.sku[0])?void 0:t.product_price)||0,product_price:(null==(a=null==e?void 0:e.sku[0])?void 0:a.product_price)||0,product_sku_id:null==(n=null==e?void 0:e.sku[0])?void 0:n.product_sku_id,attr:[],feed:[],bag_price:0,delivery:me()?30:40,describe:null==(r=null==e?void 0:e.sku[0])?void 0:r.spec_name,order_id:we()};try{const e=await Rn(i);setTimeout((()=>{uni.showToast({title:e.msg,icon:"none"})}),100),le(e.data.order_id),h(e.data.res,"add")}catch(u){}}else d.value=!0,f.value=e})(e)},{default:U((()=>[!e.product_stock||e.product_stock<=0?(O(),L(n,{key:0,class:"ti-goods-sold-out"},{default:U((()=>[W(J(Z(Y)("已售罄")),1)])),_:1})):1==e.limit_num_status?(O(),L(n,{key:1,class:"ti-goods-sold-out"},{default:U((()=>[W(J(Z(Y)("已限购")),1)])),_:1})):de("",!0),R(n,{class:j(["ti-goods-box",{"ti-goods-disabled":e.product_stock<=0||1==e.limit_num_status}])},{default:U((()=>[e.limit_num&&e.limit_num>0?(O(),L(n,{key:0,class:"ti-goods-quota"},{default:U((()=>[W(J(Z(ye)("限購{count}份",{count:e.limit_num||0})),1)])),_:2},1024)):de("",!0),R(n,{class:"ti-goods-image"},{default:U((()=>{var t;return[R(r,{src:Z(Fe)(null==(t=e.image[0])?void 0:t.file_path,147,110)||""},null,8,["src"])]})),_:2},1024),R(n,{class:"ti-goods-content"},{default:U((()=>[R(n,{class:"ti-goods-title line-clamp-2"},{default:U((()=>[W(J(e.product_name[Z(fe)()]||e.product_name_text||"-"),1)])),_:2},1024),R(n,{class:"ti-price-box"},{default:U((()=>[R(m,{class:"ti-goods-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),R(m,{class:"ti-goods-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1}),R(a,{status:c.value?"loading":"no-more"},null,8,["status"])],64)):(O(),L(_,{key:2}))])),_:1})])),_:1}),1==Z(i)?(O(),L(hi,{key:0,onUnlock:v})):de("",!0)])),_:1}),R(Ro,{show:d.value,"onUpdate:show":t[2]||(t[2]=e=>d.value=e),goodsDetail:f.value,onSuccess:h},null,8,["show","goodsDetail"])],64)}}},[["__scopeId","data-v-5f261952"]]),jo=T({__name:"home",setup(e){const t=We(),a=F(),n=(e,t)=>{var n;null==(n=a.value)||n.handleResultCart(e,t)};Ue("reIndex",(()=>{var e;null==(e=a.value)||e.getCartData(!0)})),Ue("langChange",(()=>{null==t||t.getCategory()}));const i=(e,t)=>{var n;t.is_send_kitchen=0,t.total_product_price=t.product_price,null==(n=a.value)||n.handleAddCart(e,t)},r=()=>{var e;null==(e=a.value)||e.handleError()};return(e,t)=>{const u=$;return O(),L(u,{class:"ti-index"},{default:U((()=>[R(vi,{ref_key:"cartRef",ref:a},null,512),R(zo,{onError:r,onAdd:i,onSuccess:n})])),_:1})}}},[["__scopeId","data-v-3d459e7f"]]);function $o(e){return k("order.HallCart/add",e,{isLoading:!1})}function qo(e){return k("order.HallCart/cancel",e,{isLoading:!1})}const Vo=E("buffetStore",(()=>{const e=F(0),t=F(0),a=F(0),n=F();return q((()=>a.value),(()=>{n.value&&clearInterval(n.value),1==e.value&&a.value>0&&(n.value=setInterval((()=>{a.value<=0?n.value&&clearInterval(n.value):a.value--}),1e3))})),{isBuffet:e,buffetTime:a,isUnlimitedTime:t}})),Ko=T({__name:"modify-price",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F("");q((()=>n.show),(()=>{n.show&&(r.value="")}));const u=e=>{if(!e)return;const t=r.value+e;/^\d*\.?\d{0,2}$/.test(t)&&(r.value+=e)},s=async()=>{var e,t;if(!r.value)return uni.showToast({title:Y("請輸入價格"),icon:"none"});if(!((t=r.value)>=0&&t<=1e6))return uni.showToast({title:Y("请输入0-1000000间的價格"),icon:"none"});try{i.value=!0;const t=await jn({order_product_id:null==(e=n.productItem)?void 0:e.order_product_id,price:r.value});uni.showToast({title:t.msg,icon:"none"}),a("update:show",!1),a("success",{order_id:t.data.order_id,...t.data.res})}catch(u){}finally{i.value=!1}};return(t,o)=>{const l=$,c=N(M("ti-input"),V),d=N(M("ti-keyboard"),K),f=N(M("ti-modal"),H);return O(),L(f,{show:n.show,title:Z(Y)("價格")},{content:U((()=>[R(l,{class:"ti-dialog-content"},{default:U((()=>[R(l,{class:"ti-modify-title text-ellipsis"},{default:U((()=>{var t,a,n;return[W(J((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(n=null==(a=e.productItem)?void 0:a.product)?void 0:n.product_name_text)),1)]})),_:1}),R(l,{class:"ti-modify-input"},{default:U((()=>[R(c,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=e=>r.value=e),placeholder:Z(Y)("請輸入價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:U((()=>[R(l,{class:"ti-dialog-btn"},{default:U((()=>[R(d,{primaryLoading:i.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:o[1]||(o[1]=e=>a("update:show",!1)),onClear:o[2]||(o[2]=e=>r.value=""),onInput:u,onConfirm:s},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-da17d970"]]),Ho=T({__name:"remark",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F("");q((()=>n.show),(()=>{var e;n.show&&(r.value=(null==(e=n.productItem)?void 0:e.remark)||"")}));const u=async()=>{var e;try{i.value=!0;const t=await $n({order_product_id:null==(e=n.productItem)?void 0:e.order_product_id,remark:r.value.trim()});uni.showToast({title:t.msg,icon:"none"}),a("update:show",!1),a("success",{order_id:t.data.order_id,...t.data.res})}catch(t){}finally{i.value=!1}};return(t,s)=>{const o=$,l=Q,c=N(M("ti-button"),G),d=N(M("ti-modal"),H);return O(),L(d,{show:n.show,title:Z(Y)("備註")},{content:U((()=>[R(o,{class:"ti-dialog-content"},{default:U((()=>[R(o,{class:"ti-remark-title text-ellipsis"},{default:U((()=>{var t,a,n;return[W(J((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(n=null==(a=e.productItem)?void 0:a.product)?void 0:n.product_name_text)),1)]})),_:1}),R(o,{class:"ti-remark-textarea"},{default:U((()=>[R(l,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),focus:!0,maxlength:50,"placeholder-style":"color:rgba(16,10,5,.3)",placeholder:Z(Y)("请输入")},null,8,["modelValue","placeholder"])])),_:1}),R(o,{class:"ti-remark-num"},{default:U((()=>{var e;return[W(J((null==(e=r.value)?void 0:e.trim().length)||0)+"/50 ",1)]})),_:1})])),_:1})])),footer:U((()=>[R(o,{class:"ti-dialog-btn"},{default:U((()=>[R(c,{onClick:s[1]||(s[1]=e=>a("update:show",!1))},{default:U((()=>[W(J(Z(Y)("退出")),1)])),_:1}),R(c,{onClick:s[2]||(s[2]=e=>r.value="")},{default:U((()=>[W(J(Z(Y)("清空")),1)])),_:1}),R(c,{loading:i.value,type:"primary",onClick:u},{default:U((()=>[W(J(Z(Y)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-3b3a5321"]]),Wo=T({__name:"withdrawal",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F(""),u=F([Y("等待時間長"),Y("口味不好"),Y("菜賣光了")]),s=F(0);q((()=>n.show),(()=>{var e;n.show&&(r.value=(null==(e=n.productItem)?void 0:e.total_num)||"")}));const o=e=>{e&&(r.value+=e)},l=async()=>{var e,t;if(!r.value)return uni.showToast({title:Y("请输入退菜數量"),icon:"none"});try{i.value=!0;const o=await(t={table_id:Qe(),order_product_id:null==(e=n.productItem)?void 0:e.order_product_id,num:r.value,return_reason:u.value[s.value]},k("order.HallCart/moveProduct",t,{isLoading:!1}));uni.showToast({title:o.msg,icon:"none"}),a("update:show",!1),a("success",{order_id:o.data.order_id,...o.data.res})}catch(o){}finally{i.value=!1}};return(t,c)=>{const d=$,f=N(M("ti-input"),V),h=N(M("ti-keyboard"),K),p=N(M("ti-modal"),H);return O(),L(p,{show:n.show,title:Z(Y)("退菜")},{content:U((()=>[R(d,{class:"ti-dialog-content"},{default:U((()=>[R(d,{class:"ti-withdrawal-title text-ellipsis"},{default:U((()=>{var t,a,n;return[W(J((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(n=null==(a=e.productItem)?void 0:a.product)?void 0:n.product_name_text)),1)]})),_:1}),R(d,{class:"ti-withdrawal-list"},{default:U((()=>[(O(!0),X(ee,null,te(u.value,((e,t)=>(O(),L(d,{key:t,class:j([{active:t==s.value},"ti-withdrawal-item"]),onClick:e=>(e=>{s.value=e})(t)},{default:U((()=>[W(J(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),R(d,{class:"ti-withdrawal-input"},{default:U((()=>[R(f,{modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=e=>r.value=e),placeholder:Z(Y)("请输入退菜數量"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:U((()=>[R(d,{class:"ti-dialog-btn"},{default:U((()=>[R(h,{primaryLoading:i.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:c[1]||(c[1]=e=>a("update:show",!1)),onClear:c[2]||(c[2]=e=>r.value=""),onInput:o,onConfirm:l},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-e8b23bc2"]]),Jo={__name:"preferential",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0},preferentialData:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F({type:1,money:"",rate:"",discountType:1}),r=F(!1);q((()=>n.show),(()=>{var e,t;if(n.show){const a={type:1,money:"",rate:"",discountType:1};(null==(e=n.preferentialData)?void 0:e.discount_ratio)&&(a.type=2,a.rate=Math.max(null==(t=n.preferentialData)?void 0:t.discount_ratio,0).toString()),i.value=a}})),q((()=>i.value.type),((e,t)=>{var a,r;1==t?i.value.money="":2==t?(null==(a=n.preferentialData)?void 0:a.discount_ratio)?i.value.rate=Math.max(null==(r=n.preferentialData)?void 0:r.discount_ratio,0).toString():i.value.rate="":3==t&&(i.value.discountType=1)}));const u=e=>{i.value.discountType=e.detail.value},s=()=>{1==i.value.type?i.value.money="":2==i.value.type&&(i.value.rate="")},o=e=>{if(e)if(1==i.value.type){const t=i.value.money+e;/^\d*\.?\d{0,2}$/.test(t)&&(i.value.money+=e)}else 2==i.value.type&&(i.value.rate+=e)},l=async()=>{const e={...i.value,table_id:Qe()};if(!r.value){if(1==e.type){if(e.money<0)return uni.showToast({title:Y("请输入實付價格"),icon:"none"});if(!((t=e.money)>=0&&t<=999999999))return uni.showToast({title:Y("请输入0-999999999间的價格"),icon:"none"})}else if(2==e.type){if(!e.rate)return uni.showToast({title:Y("请输入折扣"),icon:"none"});if(!/^(?:[1-9][0-9]?|100|0)$/.test(e.rate))return uni.showToast({title:Y("请输入0-100间的正整数"),icon:"none"})}var t;try{r.value=!0;const t=await function(e){return k("order.HallCart/changeMoney",e,{isLoading:!1})}(e);uni.showToast({title:t.msg,icon:"none"}),a("update:show",!1),a("success",{order_id:t.data.order_id,...t.data.res})}catch(n){}finally{r.value=!1}}};return(t,c)=>{const d=$,f=ce,h=N(M("ti-input"),V),p=he,v=pe,m=ve,_=N(M("ti-button"),G),g=N(M("ti-keyboard"),K),y=N(M("ti-modal"),H);return O(),L(y,{show:n.show,title:Z(Y)("優惠折扣")},{content:U((()=>[R(d,{class:"ti-dialog-content"},{default:U((()=>[R(d,{class:"ti-preferential-box"},{default:U((()=>[R(d,{class:"ti-preferential-label"},{default:U((()=>[W(J(Z(Y)("當前價格")),1)])),_:1}),R(d,{class:"ti-preferential-input"},{default:U((()=>[R(f,{class:"ti-preferential-price"},{default:U((()=>[W(J(Z(se)(e.totalPayPrice)),1)])),_:1}),R(f,{class:"ti-preferential-subPrice"},{default:U((()=>[W(J(Z(oe)(e.totalPayPrice)),1)])),_:1})])),_:1}),R(d,{class:"ti-preferential-label"},{default:U((()=>[W(J(Z(Y)("優惠方式")),1)])),_:1}),R(d,{class:"ti-preferential-input ti-preferential-type"},{default:U((()=>[(O(!0),X(ee,null,te([Z(Y)("改價"),Z(Y)("折扣"),Z(Y)("抹零")],((e,t)=>(O(),L(d,{key:t,class:j([{active:i.value.type==t+1},"ti-preferential-type-item"]),onClick:e=>i.value.type=t+1},{default:U((()=>[W(J(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),1==i.value.type?(O(),X(ee,{key:0},[R(d,{class:"ti-preferential-label"},{default:U((()=>[W(J(Z(Y)("實付價格")),1)])),_:1}),R(d,{class:"ti-preferential-input"},{default:U((()=>[R(h,{modelValue:i.value.money,"onUpdate:modelValue":c[0]||(c[0]=e=>i.value.money=e),placeholder:Z(Y)("请输入實付價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})],64)):de("",!0),2==i.value.type?(O(),X(ee,{key:1},[R(d,{class:"ti-preferential-label"},{default:U((()=>[W(J(Z(Y)("折扣")),1)])),_:1}),R(d,{class:"ti-preferential-input"},{default:U((()=>[R(h,{modelValue:i.value.rate,"onUpdate:modelValue":c[1]||(c[1]=e=>i.value.rate=e),regex:/^\d+$/,placeholder:Z(Y)("请输入折扣"),focus:!0},{right:U((()=>[R(d,{class:"ti-preferential-percentage"},{default:U((()=>[W("%")])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1})],64)):de("",!0),3==i.value.type?(O(),X(ee,{key:2},[R(d,{class:"ti-preferential-label ti-preferential-round"},{default:U((()=>[W(J(Z(Y)("抹零方式")),1)])),_:1}),R(d,{class:"ti-preferential-input"},{default:U((()=>[R(m,{class:"ti-type-radio",style:z({"grid-template-columns":"zh"==Z(fe)()||"zhtw"==Z(fe)()?"repeat(4, auto)":"repeat(2, 1fr)"}),onChange:u},{default:U((()=>[R(v,null,{default:U((()=>[R(p,{value:"1",color:"#ffbe00",checked:"true"}),R(f,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("抹分")),1)])),_:1})])),_:1}),R(v,null,{default:U((()=>[R(p,{value:"2",color:"#ffbe00"}),R(f,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("抹角")),1)])),_:1})])),_:1}),R(v,null,{default:U((()=>[R(p,{value:"3",color:"#ffbe00"}),R(f,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("四舍五入保留一位小数")),1)])),_:1})])),_:1}),R(v,null,{default:U((()=>[R(p,{value:"4",color:"#ffbe00"}),R(f,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("四舍五入到整数")),1)])),_:1})])),_:1})])),_:1},8,["style"])])),_:1})],64)):de("",!0)])),_:1})])),_:1})])),footer:U((()=>[3==i.value.type?(O(),L(d,{key:0,class:"ti-dialog-btn"},{default:U((()=>[R(_,{onClick:c[2]||(c[2]=e=>a("update:show",!1))},{default:U((()=>[W(J(Z(Y)("退出")),1)])),_:1}),R(_,{loading:r.value,type:"primary",onClick:l},{default:U((()=>[W(J(Z(Y)("确定")),1)])),_:1},8,["loading"])])),_:1})):(O(),L(d,{key:1,class:"ti-dialog-btn ti-preferential-keyboard"},{default:U((()=>[R(g,{primaryLoading:r.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:c[3]||(c[3]=e=>a("update:show",!1)),onClear:s,onInput:o,onConfirm:l},null,8,["primaryLoading"])])),_:1}))])),_:1},8,["show","title"])}}},Zo=T(Jo,[["__scopeId","data-v-11c7e7fe"]]),Yo=T({__name:"cancel-all",props:{show:{type:Boolean,default:!1},sendKitchen:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(e,{emit:t}){const a=Xe(),n=t,i=e,r=F(!1),u=async()=>{if(!r.value)try{r.value=!0;const e=await qo({table_id:Qe()});uni.showToast({title:e.msg,icon:"none"}),null==a||a.clearTableGoodsData(),n("success",e.data),n("update:show",!1)}catch(e){}finally{r.value=!1}};return(t,a)=>{const s=$,o=ae,l=N(M("ti-modal"),H);return O(),L(l,{class:"ti-action-tips",title:t.$t("溫馨提示"),show:i.show,confirmLoading:r.value,onCancel:a[0]||(a[0]=e=>n("update:show",!1)),onConfirm:u},{content:U((()=>[R(s,{class:"ti-dialog-content"},{default:U((()=>[i.sendKitchen&&e.sendKitchen.length>0?(O(),X(ee,{key:0},[R(s,{class:"ti-cancel-title"},{default:U((()=>[W(J(t.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),R(o,{"scroll-y":""},{default:U((()=>[R(s,{class:"ti-cancel-list"},{default:U((()=>[(O(!0),X(ee,null,te(i.sendKitchen,((e,t)=>(O(),L(s,{key:t,class:"ti-cancel-item"},{default:U((()=>[W(J(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})],64)):(O(),X(ee,{key:1},[W(J(t.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-fbb3cb44"]]),Go=T({__name:"buffet-not",props:{show:{type:Boolean,default:!1},buffetNotSendKitchen:{type:Array,default:()=>[]}},emits:["update:show"],setup(e,{emit:t}){const a=t,n=e;return(t,i)=>{const r=$,u=ae,s=N(M("ti-modal"),H);return O(),L(s,{class:"ti-action-tips",title:t.$t("溫馨提示"),show:e.show,isCancelShow:!1,onConfirm:i[0]||(i[0]=e=>a("update:show",!1))},{content:U((()=>[R(r,{class:"ti-dialog-content"},{default:U((()=>[R(r,{class:"ti-cancel-title"},{default:U((()=>[W(J(t.$t("自助餐時間已到達，以下自助餐商品不可繼續送厨")),1)])),_:1}),R(u,{"scroll-y":""},{default:U((()=>[R(r,{class:"ti-cancel-list"},{default:U((()=>[(O(!0),X(ee,null,te(n.buffetNotSendKitchen,((e,t)=>(O(),L(r,{key:t,class:"ti-cancel-item"},{default:U((()=>[W(J((null==e?void 0:e.product_name_text)||(null==e?void 0:e.product_name)),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["title","show"])}}},[["__scopeId","data-v-d1eb41ed"]]);function Qo(e){return k("store.table/table",e,{isLoading:!1})}const Xo=T({__name:"turntable",props:{show:{type:Boolean,default:!1},tableNo:{type:[Number,String],default:null}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F({table_status:"10"}),r=F(!1),u=F(!1),s=F([]),o=F(),l=F(!1);q((()=>n.show),(()=>{n.show&&(o.value=null,d())}));const c=async()=>{if(!l.value){if(!o.value)return uni.showToast({title:Y("请选择桌号"),icon:"none"});try{l.value=!0;const t=await(e={old_table_id:Qe(),new_table_id:o.value},k("order.order/changeTable",e,{isLoading:!1}));uni.showToast({title:t.msg,icon:"none"}),a("update:show",!1),et(o.value),setTimeout((()=>{a("success",{order_id:t.data.order_id,...t.data.res})}),100)}catch(t){}finally{l.value=!1}var e}},d=()=>{i.value.page=1,h(!0)},f=()=>{r.value&&(i.value.page+=1,h())},h=async e=>{var t;if(!u.value)try{e&&(u.value=!0);const a=await Qo(i.value);s.value=(null==(t=a.data)?void 0:t.list)||[]}catch(a){}finally{e&&(u.value=!1)}};return(e,t)=>{const i=N(M("ti-loading"),ie),d=$,h=N(M("ti-empty-data"),re),p=ae,v=N(M("ti-drawer"),ue);return O(),L(v,{show:n.show,confirmLoading:l.value,title:`[${n.tableNo}]${Z(Y)("轉台")}`,onCancel:t[0]||(t[0]=e=>a("update:show",!1)),onConfirm:c},{content:U((()=>[R(d,{class:"ti-turntable-box"},{default:U((()=>[R(p,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:f},{default:U((()=>[u.value?(O(),L(i,{key:0})):s.value&&s.value.length>0?(O(),X(ee,{key:1},[R(d,{class:"ti-turntable-list"},{default:U((()=>[(O(!0),X(ee,null,te(s.value,(e=>(O(),L(d,{key:e.table_id,class:j([{active:o.value==e.table_id},"ti-turntable-item"]),onClick:t=>o.value=e.table_id},{default:U((()=>[W(J(e.table_no),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),R(i,{status:r.value?"loading":"no-more"},null,8,["status"])],64)):(O(),L(h,{key:2}))])),_:1})])),_:1})])),_:1},8,["show","confirmLoading","title"])}}},[["__scopeId","data-v-f8f85dd2"]]);class el{constructor(e,t){this.options=e,this.animation=tt({...e}),this.currentStepAnimates={},this.next=0,this.$=t}_nvuePushAnimates(e,t){let a=this.currentStepAnimates[this.next],n={};if(n=a||{styles:{},config:{}},tl.includes(e)){n.styles.transform||(n.styles.transform="");let a="";"rotate"===e&&(a="deg"),n.styles.transform+=`${e}(${t+a}) `}else n.styles[e]=`${t}`;this.currentStepAnimates[this.next]=n}_animateRun(e={},t={}){let a=this.$.$refs.ani.ref;if(a)return new Promise(((n,i)=>{nvueAnimation.transition(a,{styles:e,...t},(e=>{n()}))}))}_nvueNextAnimate(e,t=0,a){let n=e[t];if(n){let{styles:i,config:r}=n;this._animateRun(i,r).then((()=>{t+=1,this._nvueNextAnimate(e,t,a)}))}else this.currentStepAnimates={},"function"==typeof a&&a(),this.isEnd=!0}step(e={}){return this.animation.step(e),this}run(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof e&&e()}),this.$.durationTime)}}const tl=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function al(e,t){if(t)return clearTimeout(t.timer),new el(e,t)}tl.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((e=>{el.prototype[e]=function(...t){return this.animation[e](...t),this}}));const nl=T({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""},onceRender:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e={...this.styles,"transition-duration":this.duration/1e3+"s"},t="";for(let a in e){t+=this.toLine(a)+":"+e[a]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=al(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,t={}){if(this.animation){for(let t in e)try{"object"==typeof e[t]?this.animation[t](...e[t]):this.animation[t](e[t])}catch(Oc){}return this.animation.step(t),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);void 0!==e&&(this.opacity=e),this.transform=t,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=al(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(e){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:e,transform:t}=this.styleInit(!1);this.opacity=e||1,this.transform=t,this.$emit("change",{detail:this.isShow})}))},styleInit(e){let t={transform:""},a=(e,a)=>{"fade"===a?t.opacity=this.animationType(e)[a]:t.transform+=this.animationType(e)[a]+" "};return"string"==typeof this.modeClass?a(e,this.modeClass):this.modeClass.forEach((t=>{a(e,t)})),t},tranfromInit(e){let t=(e,t)=>{let a=null;"fade"===t?a=e?0:1:(a=e?"-100%":"0","zoom-in"===t&&(a=e?.8:1),"zoom-out"===t&&(a=e?1.2:1),"slide-right"===t&&(a=e?"100%":"0"),"slide-bottom"===t&&(a=e?"100%":"0")),this.animation[this.animationMode()[t]](a)};return"string"==typeof this.modeClass?t(e,this.modeClass):this.modeClass.forEach((a=>{t(e,a)})),this.animation},animationType:e=>({fade:e?1:0,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:e=>e.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(e,t,a,n,i,r){const u=$;return ge((O(),L(u,{ref:"ani",animation:i.animationData,class:j(a.customClass),style:z(r.transformStyles),onClick:r.onClick},{default:U((()=>[He(e.$slots,"default")])),_:3},8,["animation","class","style","onClick"])),[[at,i.isShow]])}]]),il={name:"uniPopup",components:{keypress:{name:"Keypress",props:{disable:{type:Boolean,default:!1}},mounted(){const e={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]};document.addEventListener("keyup",(t=>{if(this.disable)return;const a=Object.keys(e).find((a=>{const n=t.key,i=e[a];return i===n||Array.isArray(i)&&i.includes(n)}));a&&setTimeout((()=>{this.$emit(a,{})}),0)}))},render:()=>{}}},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"}},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(e){this.mkclick=e},immediate:!0},isMaskClick:{handler:function(e){this.mkclick=e},immediate:!0},showPopup(e){document.getElementsByTagName("body")[0].style.overflow=e?"hidden":"visible"}},data:()=>({duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:"top"}),computed:{isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:e,windowHeight:t,windowTop:a,safeArea:n,screenHeight:i,safeAreaInsets:r}=it();this.popupWidth=e,this.popupHeight=t+(a||0),n&&this.safeArea?this.safeAreaInsets=r.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(){document.getElementsByTagName("body")[0].style.overflow="visible"},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(e){e.stopPropagation(),this.clearPropagation=!0},open(e){if(this.showPopup)return;e&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(e)||(e=this.type),this.config[e]&&(this[this.config[e]](),this.$emit("change",{show:!0,type:e}))},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(e){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg},e||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(e){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets+"px",backgroundColor:this.bg},e||(this.showPopup=!0,this.showTrans=!0)},center(e){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center"},e||(this.showPopup=!0,this.showTrans=!0)},left(e){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)},right(e){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)}}};const rl=T(il,[["render",function(e,t,a,n,i,r){const u=N(M("uni-transition"),nl),s=$,o=nt("keypress");return i.showPopup?(O(),L(s,{key:0,class:j(["uni-popup",[i.popupstyle,r.isDesktop?"fixforpc-z-index":""]])},{default:U((()=>[R(s,{onTouchstart:r.touchstart},{default:U((()=>[i.maskShow?(O(),L(u,{key:"1",name:"mask","mode-class":"fade",styles:i.maskClass,duration:i.duration,show:i.showTrans,onClick:r.onTap},null,8,["styles","duration","show","onClick"])):de("",!0),R(u,{key:"2","mode-class":i.ani,name:"content",styles:i.transClass,duration:i.duration,show:i.showTrans,onClick:r.onTap},{default:U((()=>[R(s,{class:j(["uni-popup__wrapper",[i.popupstyle]]),style:z({backgroundColor:r.bg}),onClick:r.clear},{default:U((()=>[He(e.$slots,"default",{},void 0,!0)])),_:3},8,["style","class","onClick"])])),_:3},8,["mode-class","styles","duration","show","onClick"])])),_:3},8,["onTouchstart"]),i.maskShow?(O(),L(o,{key:0,onEsc:r.onTap},null,8,["onEsc"])):de("",!0)])),_:3},8,["class"])):de("",!0)}],["__scopeId","data-v-221fc41c"]]),ul=T({__name:"open-table",props:{show:{type:Boolean,default:!1},tableNo:{type:String,default:null},tableId:{type:[Number,String],default:null},isUpdate:{type:Boolean,default:!1},buffetIds:{type:Array,default:()=>[]},buffetCustomerType:{type:Array,default:()=>[]},isBuffetProduct:{type:Boolean,default:!1}},emits:["update:show","success"],setup(e,{emit:t}){const{buffetConfig:a}=Se(Be()),{isBuffet:n}=Se(Vo()),{getGoodsList:i,clearTableGoodsData:r}=Xe(),u=t,s=e,o=F(null),l=F(!1),c=F({table_id:s.tableId,is_buffet:s.isBuffet,meal_num:"",buffet_ids:[],buffet_customer_type:[]}),d=F(null),f=F(!1),h=F(""),p=F([]),v=ne((()=>{var e;const t=[];return null==(e=p.value)||e.map((e=>{var a;(null==(a=c.value)?void 0:a.buffet_ids.includes(e.id))&&t.push(e.name_text)})),t})),m=ne((()=>{var e;return((null==(e=c.value)?void 0:e.buffet_customer_type)||[]).reduce(((e,t)=>e+Number(t.num)),0)||0})),_=F(0);q((()=>c.value.buffet_ids),(()=>{var e;let t=[];((null==(e=c.value)?void 0:e.buffet_ids)||[]).map((e=>{var a;const n=null==(a=p.value)?void 0:a.find((t=>t.id==e));n.buffetCustomerType&&n.buffetCustomerType.length>0&&n.buffetCustomerType.map((e=>{if(-1===t.findIndex((t=>t.customer_type_id==e.customer_type_id))){const a=(c.value.buffet_customer_type||[]).find((t=>t.customer_type_id==e.customer_type_id));(null==a?void 0:a.customer_type_id)?t.push(a):t.push({name_text:e.name_text,customer_type_id:e.customer_type_id,num:0})}}))})),c.value.buffet_customer_type=Un(t,"customer_type_id")}),{deep:!0}),q((()=>c.value.is_buffet),(()=>{c.value.meal_num="",c.value.buffet_ids=[],c.value.buffet_customer_type=[],_.value=0})),q((()=>s.show),(async()=>{var e,t,i;s.show?(await je(),null==(e=o.value)||e.open(),c.value={table_id:s.tableId,is_buffet:s.isUpdate?n.value:1==(null==(t=a.value)?void 0:t.is_open)?1:0,meal_num:"",buffet_ids:[],buffet_customer_type:[]},_.value=0,1==c.value.is_buffet&&k("order.HallCart/buffetList").then((e=>{var t;if(p.value=e.data,s.isUpdate&&s.buffetIds&&s.buffetIds.length>0){const e=null==(t=p.value)?void 0:t.find((e=>e.id==s.buffetIds[0]));d.value=null==e?void 0:e.is_comb,c.value.buffet_ids=s.buffetIds,setTimeout((()=>{c.value.buffet_customer_type.map((e=>{const t=(s.buffetCustomerType||[]).find((t=>t.customer_type_id==e.customer_type_id));e.num=(null==t?void 0:t.num)||0}))}),10)}}))):null==(i=o.value)||i.close()}));const g=()=>{var e;null==(e=o.value)||e.close(),u("update:show",!1)},y=()=>{!c.value.buffet_customer_type||c.value.buffet_customer_type.length<=0||(c.value.buffet_customer_type[_.value].num=0)},D=e=>{!c.value.buffet_customer_type||c.value.buffet_customer_type.length<=0||/^\d+$/.test(e)&&(c.value.buffet_customer_type[_.value].num=Number(`${(c.value.buffet_customer_type[_.value].num||"").toString()}${e}`))},w=e=>{e&&0==c.value.is_buffet&&(c.value.meal_num+=e)},b=async()=>{var e,t,a;if(0==c.value.is_buffet){if(!c.value.meal_num)return uni.showToast({title:Y("請輸入人數"),icon:"none"});if(!/^(?!0+$)\d{1,3}$/.test(c.value.meal_num))return uni.showToast({title:Y("用餐人数支持1-999"),icon:"none"})}else{if(!v.value||v.value.length<=0)return uni.showToast({title:Y("请选择自助餐套餐"),icon:"none"});if(!c.value.buffet_customer_type||c.value.buffet_customer_type.length<=0)return uni.showToast({title:Y("暂无可选顾客类型"),icon:"none"});let t="";if(((null==(e=c.value)?void 0:e.buffet_ids)||[]).some((e=>{var a;const n=null==(a=p.value)?void 0:a.find((t=>t.id==e));if(!n.buffetCustomerType||n.buffetCustomerType.length<=0)return t=n.name_text,!0})),t)return f.value=!0,void(h.value=t);if(!m.value)return uni.showToast({title:Y("請輸入人數"),icon:"none"});if(!/^(?!0+$)\d{1,3}$/.test(m.value))return uni.showToast({title:Y("用餐人数支持1-999"),icon:"none"})}try{l.value=!0;const e=await(t=c.value,a=s.isUpdate,k(a?0==t.is_buffet?"order.Order/updateMealNum":"order.Order/updateBuffet":"order.Order/tableBuy",t,{isLoading:!1}));1==e.code&&(uni.showToast({title:e.msg,icon:"none"}),s.isUpdate&&(r(),i(!0)),et(s.tableId),u("update:show",!1),setTimeout((()=>{u("success",{order_id:e.data.order_id,...e.data.res})}),100))}catch(n){}finally{l.value=!1}};return(e,t)=>{const n=$,i=N(M("ti-input"),V),r=ce,C=N(M("ti-empty-data"),re),A=ae,k=N(M("uni-icons"),Ce),x=be,E=N(M("ti-keyboard"),K),F=N(M("uni-popup"),rl),I=N(M("ti-modal"),H);return O(),X(ee,null,[R(F,{ref_key:"dialogRef",ref:o,onMaskClick:g},{default:U((()=>[R(n,{class:j(["ti-dialog-box",{"ti-open-buffet":0!=c.value.is_buffet&&!s.isBuffetProduct}])},{default:U((()=>[R(n,{class:"ti-dialog-top"},{default:U((()=>[R(n,{class:"ti-dialog-title"},{default:U((()=>[W(J(s.isUpdate&&1==c.value.is_buffet?Z(Y)("调整自助餐"):Z(ye)("[{table_no}]就餐人數",{table_no:s.tableNo})),1)])),_:1}),R(n,{class:"ti-dialog-content"},{default:U((()=>{var e;return[1!=(null==(e=Z(a))?void 0:e.is_open)||s.isUpdate?de("",!0):(O(),L(n,{key:0,class:"ti-modify-buffet"},{default:U((()=>[R(n,{class:j(["ti-buffet-item",{active:1==c.value.is_buffet}]),onClick:t[0]||(t[0]=e=>c.value.is_buffet=1)},{default:U((()=>[W(J(Z(Y)("自助餐")),1)])),_:1},8,["class"]),R(n,{class:j(["ti-buffet-item",{active:0==c.value.is_buffet}]),onClick:t[1]||(t[1]=e=>c.value.is_buffet=0)},{default:U((()=>[W(J(Z(Y)("非自助餐")),1)])),_:1},8,["class"])])),_:1})),0==c.value.is_buffet?(O(),L(n,{key:1,class:"ti-modify-input"},{default:U((()=>[R(i,{modelValue:c.value.meal_num,"onUpdate:modelValue":t[2]||(t[2]=e=>c.value.meal_num=e),regex:/^\d+$/,placeholder:Z(Y)("請輸入人數"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})):(O(),L(n,{key:2,class:"ti-buffet-box",style:z({"grid-template-columns":s.isBuffetProduct?"1fr":""})},{default:U((()=>[s.isBuffetProduct?de("",!0):(O(),L(A,{key:0,class:"ti-buffet-scroll","scroll-y":""},{default:U((()=>[p.value&&p.value.length>0?(O(),L(n,{key:0,class:"ti-buffet-list"},{default:U((()=>[(O(!0),X(ee,null,te(p.value,(e=>(O(),L(n,{key:e.id,class:j(["ti-buffet-item",{active:c.value.buffet_ids.includes(e.id),disabled:c.value.buffet_ids.length>0&&d.value!=e.is_comb}]),onClick:t=>(e=>{if(!(c.value.buffet_ids.length>0&&d.value!=e.is_comb))if(d.value=e.is_comb,0==d.value)c.value.buffet_ids=c.value.buffet_ids[0]!=e.id?[e.id]:[];else{const t=c.value.buffet_ids.indexOf(e.id);if(t>-1)c.value.buffet_ids.splice(t,1);else{if(c.value.buffet_ids.length>=2)return uni.showToast({title:ye("最多只能选择{count}个",{count:2}),icon:"none"});c.value.buffet_ids.push(e.id)}}})(e)},{default:U((()=>[R(n,{class:"ti-buffet-name"},{default:U((()=>[W(J(e.name_text||e.name),1)])),_:2},1024),R(n,null,{default:U((()=>[R(r,{class:"ti-buffet-price"},{default:U((()=>{var t;return[W(J(Z(se)(e.buffetCustomerType?null==(t=e.buffetCustomerType[0])?void 0:t.price:0)),1)]})),_:2},1024),R(r,{class:"ti-buffet-subPrice"},{default:U((()=>{var t;return[W(J(Z(oe)(e.buffetCustomerType?null==(t=e.buffetCustomerType[0])?void 0:t.price:0)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(O(),L(C,{key:1}))])),_:1})),R(n,{style:{overflow:"hidden"}},{default:U((()=>[R(n,{class:"ti-buffet-info"},{default:U((()=>[v.value&&0!=v.value.length?(O(),X(ee,{key:1},[R(n,{class:"ti-buffet-select"},{default:U((()=>[(O(!0),X(ee,null,te(v.value,((e,t)=>(O(),L(n,{key:t,class:"ti-buffet-select-item"},{default:U((()=>[W(J(e),1)])),_:2},1024)))),128))])),_:1}),c.value.buffet_customer_type&&c.value.buffet_customer_type.length>0?(O(),X(ee,{key:0},[R(n,{class:"ti-buffet-num"},{default:U((()=>[(O(!0),X(ee,null,te(c.value.buffet_customer_type,((e,t)=>(O(),L(n,{key:e.customer_type_id,class:"ti-buffet-num-item"},{default:U((()=>[R(n,{class:"ti-buffet-num-label"},{default:U((()=>[W(J(e.name_text),1)])),_:2},1024),R(n,{class:"ti-buffet-num-input"},{default:U((()=>[R(x,{class:"ti-input-minus",disabled:e.num<=0,onClick:t=>e.num--},{default:U((()=>[R(k,{"custom-prefix":"iconfont",type:"icon-minus",size:"16",color:"#FFBE00"})])),_:2},1032,["disabled","onClick"]),R(n,{class:j(["ti-input-box",{active:_.value==t}]),onClick:e=>_.value=t},{default:U((()=>[W(J(e.num),1)])),_:2},1032,["class","onClick"]),R(x,{class:"ti-input-plus",disabled:m.value>=999,onClick:t=>e.num++},{default:U((()=>[R(k,{type:"plusempty",size:"16",color:"#FFBE00"})])),_:2},1032,["disabled","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),R(n,{class:"ti-buffet-num-total"},{default:U((()=>[R(r,null,{default:U((()=>[W(J(Z(Y)("共")),1)])),_:1}),R(r,{class:"orange"},{default:U((()=>[W(J(m.value),1)])),_:1}),R(r,null,{default:U((()=>[W(J(Z(Y)("人")),1)])),_:1})])),_:1})],64)):(O(),L(n,{key:1,class:"ti-buffet-num-empty"},{default:U((()=>[W(J(Z(Y)("暂无可选顾客类型")),1)])),_:1}))],64)):(O(),L(n,{key:0,class:"ti-buffet-info-empty"},{default:U((()=>[W(J(Z(Y)("请选择自助餐套餐")),1)])),_:1}))])),_:1}),R(n,{class:"ti-dialog-btn",style:{padding:"16px","border-radius":"10px"}},{default:U((()=>[R(E,{primaryLoading:l.value,isDoubleZero:!0,isCross:!1,isDrop:!1,onExit:t[3]||(t[3]=e=>u("update:show",!1)),onClear:y,onInput:D,onConfirm:b},null,8,["primaryLoading"])])),_:1})])),_:1})])),_:1},8,["style"]))]})),_:1})])),_:1}),0==c.value.is_buffet?(O(),L(n,{key:0,class:"ti-dialog-btn"},{default:U((()=>[R(E,{primaryLoading:l.value,isDoubleZero:!0,isCross:!1,isDrop:!1,onExit:t[4]||(t[4]=e=>u("update:show",!1)),onClear:t[5]||(t[5]=e=>c.value.meal_num=""),onInput:w,onConfirm:b},null,8,["primaryLoading"])])),_:1})):de("",!0)])),_:1},8,["class"])])),_:1},512),R(I,{class:"ti-action-tips",show:f.value,"onUpdate:show":t[6]||(t[6]=e=>f.value=e),title:Z(Y)("溫馨提示"),content:Z(ye)("[{title}]暂无用户类型，请选择其他自助餐",{title:h.value}),isCancelShow:!1,onConfirm:t[7]||(t[7]=e=>f.value=!1)},null,8,["show","title","content"])],64)}}},[["__scopeId","data-v-f1098571"]]),sl=T({__name:"cancel-all",props:{show:{type:Boolean,default:!1},sendKitchen:{type:Array,default:()=>[]},msg:{type:String,default:null},cancelShow:{type:Boolean,default:!1}},emits:["update:show","confirm"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=()=>{a("update:show",!1),a("confirm")};return(t,u)=>{const s=$,o=ae,l=N(M("ti-modal"),H);return O(),L(l,{class:"ti-action-tips",title:t.$t("溫馨提示"),isCancelShow:n.cancelShow,show:n.show,confirmLoading:i.value,onCancel:u[0]||(u[0]=e=>a("update:show",!1)),onConfirm:r},{content:U((()=>[R(s,{class:"ti-dialog-content"},{default:U((()=>[n.sendKitchen&&e.sendKitchen.length>0?(O(),X(ee,{key:0},[R(s,{class:"ti-cancel-title"},{default:U((()=>[W(J(n.msg),1)])),_:1}),R(o,{"scroll-y":""},{default:U((()=>[R(s,{class:"ti-cancel-list"},{default:U((()=>[(O(!0),X(ee,null,te(n.sendKitchen,((e,t)=>(O(),L(s,{key:t,class:"ti-cancel-item"},{default:U((()=>[W(J(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})],64)):de("",!0)])),_:1})])),_:1},8,["title","isCancelShow","show","confirmLoading"])}}},[["__scopeId","data-v-66800af2"]]),ol=T({__name:"action-list",props:{productItem:{type:Object,default:()=>({})},tableId:{type:[Number,String],default:null},tableNo:{type:[Number,String],default:null},orderList:{type:Array,default:()=>[]},totalPayPrice:{type:[Number,String],default:0},preferentialData:{type:Object,default:()=>({})},isLock:{type:Number,default:0},orderBuffetId:{type:Number,default:0},orderDelayId:{type:Number,default:0},totalNum:{type:[Number,String],default:0},buffetList:{type:Array,default:()=>[]},buffetCustomerType:{type:Array,default:()=>[]},mealNum:{type:[Number,String],default:0},buffetDiscountNum:{type:[Number,String],default:0}},emits:["success","backTable"],setup(e,{emit:t}){const a=t,n=e,i=ne((()=>n.orderList.filter((e=>0!=(null==e?void 0:e.is_send_kitchen)))||[])),r=ne((()=>n.orderList.filter((e=>0==(null==e?void 0:e.is_send_kitchen)))||[])),u=ne((()=>r.value.filter((e=>1==e.is_buffet_product))||[])),{isBuffet:s,buffetTime:o,isUnlimitedTime:l}=Se(Vo()),c=Be(),{buffetConfig:d}=Se(c),f=F(""),h=F(!1),p=F(!1),v=F(!1),m=F(!1),_=F(!1),g=F(!1),y=F(!1),D=F(!1),w=F(!1),b=F(!1),C=F(!1),A=F(!1),x=F(!1),E=F(!1),I=ne((()=>(n.buffetList||[]).map((e=>e.buffet_id)))),T=ne((()=>{var e;return null==(e=n.orderList)?void 0:e.some((e=>1==e.is_buffet_product))})),S=F(""),B=F(!1),P=F([]),z=(e,t)=>{a("success",e,t)},j=()=>{A.value=!1,b.value=!0},q=()=>{var e;(null==(e=n.productItem)?void 0:e.finish_time)>0?A.value=!0:b.value=!0},V=()=>{h.value=!0,n.orderBuffetId>0?n.buffetCustomerType&&n.buffetCustomerType.length<=1?f.value=Y("是否删除该套餐，将清台退出？"):f.value=Y("是否删除该套餐？"):n.orderDelayId>0?f.value=Y("是否删除该加钟？"):f.value=Y("是否删除该商品？")},K=async()=>{var e,t,i;if(!p.value)try{if(p.value=!0,n.orderBuffetId>0){const e=await(i=n.orderBuffetId,k("order.HallCart/delOrderBuffetCustomer",{id:i},{isLoading:!1}));uni.showToast({title:e.msg,icon:"none"}),n.buffetCustomerType&&n.buffetCustomerType.length<=1?(await qo({table_id:Qe()}),setTimeout((async()=>{a("backTable")}),300)):a("success",{order_id:e.data.order_id,...e.data.res},"delBuffet")}else if(n.orderDelayId>0){const e=await(t={table_id:Qe(),order_delay_id:n.orderDelayId},k("order.HallCart/delOrderDelay",t,{isLoading:!1}));z({order_id:e.data.order_id,...e.data.res},"delDelay"),uni.showToast({title:e.msg,icon:"none"})}else{const t=await function(e){return k("order.HallCart/delProduct",e,{isLoading:!1})}({table_id:Qe(),order_product_id:null==(e=n.productItem)?void 0:e.order_product_id});uni.showToast({title:t.msg,icon:"none"}),z({order_id:t.data.order_id,...t.data.res},"delete")}h.value=!1}catch(r){}finally{p.value=!1}},G=()=>{var e,t;if(1==s.value&&o.value<=0&&-1!=l.value){if(1==(null==(e=d.value)?void 0:e.is_buy_continue)&&u.value.length>0)return void(_.value=!0);if(1!=(null==(t=d.value)?void 0:t.is_buy_continue)&&r.value.length>0)return void(g.value=!0)}v.value=!0},Q=async()=>{var e;if(!m.value)try{m.value=!0;const t=await(e={table_id:Qe()},k("order.HallCart/sendKitchen",e,{isMessage:!1}));uni.showToast({title:t.msg,icon:"none"}),v.value=!1,z({order_id:t.data.order_id,...t.data.res})}catch(t){(null==t?void 0:t.data)&&(null==t?void 0:t.data.length)>0?(P.value=null==t?void 0:t.data,S.value=null==t?void 0:t.msg,B.value=!0):uni.showToast({title:null==t?void 0:t.msg,icon:"none"})}finally{m.value=!1,v.value=!1}};return(t,o)=>{var l;const c=ce,d=be,k=$,F=N(M("ti-modal"),H),te=_e("permission");return O(),X(ee,null,[R(k,{class:"ti-action-box"},{default:U((()=>[R(k,{class:"ti-action-btn"},{default:U((()=>[R(k,{class:"ti-btn-box"},{default:U((()=>{var e,t,i,u;return[R(d,{class:"ti-btn-item",disabled:!1,onClick:o[0]||(o[0]=e=>a("backTable"))},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("返回")),1)])),_:1})])),_:1}),ge((O(),L(d,{class:"ti-btn-item danger",disabled:!(1!=n.isLock&&(0==(null==(e=n.productItem)?void 0:e.is_send_kitchen)||n.orderBuffetId>0||n.orderDelayId>0)),onClick:V},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("删除")),1)])),_:1})])),_:1},8,["disabled"])),[[te,["cashier_table_delete"]]]),ge((O(),L(d,{class:"ti-btn-item",disabled:!(1!=n.isLock&&(null==(t=n.productItem)?void 0:t.order_product_id)>0),onClick:o[1]||(o[1]=e=>D.value=!0)},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("價格")),1)])),_:1})])),_:1},8,["disabled"])),[[te,["cashier_table_price"]]]),ge((O(),L(d,{class:"ti-btn-item",disabled:1==n.isLock,onClick:o[2]||(o[2]=e=>E.value=!0)},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(s)?Z(Y)("调整自助餐"):Z(Y)("人数")),1)])),_:1})])),_:1},8,["disabled"])),[[te,["cashier_table_number_people"]]]),ge((O(),L(d,{class:"ti-btn-item",disabled:1==n.isLock,onClick:o[3]||(o[3]=e=>x.value=!0)},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("转台")),1)])),_:1})])),_:1},8,["disabled"])),[[te,["cashier_table_turntable"]]]),ge((O(),L(d,{class:"ti-btn-item",disabled:!(1!=n.isLock&&r.value.length>0),onClick:G},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("送廚")),1)])),_:1})])),_:1},8,["disabled"])),[[te,["cashier_table_send_kitchen"]]]),ge((O(),L(d,{class:"ti-btn-item danger",disabled:!(1!=n.isLock&&1==(null==(i=n.productItem)?void 0:i.is_send_kitchen)),onClick:q},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("退菜")),1)])),_:1})])),_:1},8,["disabled"])),[[te,["cashier_table_return"]]]),ge((O(),L(d,{class:"ti-btn-item danger",disabled:!1,onClick:o[4]||(o[4]=e=>y.value=!0)},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("清台")),1)])),_:1})])),_:1})),[[te,["cashier_table_clear"]]]),ge((O(),L(d,{class:"ti-btn-item",disabled:!(1!=n.isLock&&0==(null==(u=n.productItem)?void 0:u.is_send_kitchen)),onClick:o[5]||(o[5]=e=>w.value=!0)},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("备注")),1)])),_:1})])),_:1},8,["disabled"])),[[te,["cashier_table_remark"]]]),ge((O(),L(d,{class:"ti-btn-item",disabled:n.totalNum<=0,onClick:o[6]||(o[6]=e=>C.value=!0)},{default:U((()=>[R(c,{class:"ti-btn-item-text"},{default:U((()=>[W(J(Z(Y)("優惠折扣")),1)])),_:1})])),_:1},8,["disabled"])),[[te,["cashier_table_discount"]]])]})),_:1})])),_:1})])),_:1}),R(F,{class:"ti-action-tips",show:h.value,"onUpdate:show":o[7]||(o[7]=e=>h.value=e),confirmLoading:p.value,title:Z(Y)("溫馨提示"),content:f.value,onConfirm:K},null,8,["show","confirmLoading","title","content"]),R(F,{class:"ti-action-tips",show:v.value,"onUpdate:show":o[8]||(o[8]=e=>v.value=e),confirmLoading:m.value,title:Z(Y)("溫馨提示"),content:Z(Y)("是否将商品送廚？"),onConfirm:Q},null,8,["show","confirmLoading","title","content"]),R(Go,{show:_.value,"onUpdate:show":o[9]||(o[9]=e=>_.value=e),buffetNotSendKitchen:u.value},null,8,["show","buffetNotSendKitchen"]),R(sl,{show:B.value,"onUpdate:show":o[10]||(o[10]=e=>B.value=e),sendKitchen:P.value,msg:S.value},null,8,["show","sendKitchen","msg"]),R(ul,{show:E.value,"onUpdate:show":o[11]||(o[11]=e=>E.value=e),isUpdate:!0,tableId:n.tableId,tableNo:n.tableNo,buffetIds:I.value,isBuffetProduct:T.value,buffetCustomerType:e.buffetCustomerType,onSuccess:z},null,8,["show","tableId","tableNo","buffetIds","isBuffetProduct","buffetCustomerType"]),R(Xo,{show:x.value,"onUpdate:show":o[12]||(o[12]=e=>x.value=e),tableNo:n.tableNo,onSuccess:z},null,8,["show","tableNo"]),R(Yo,{show:y.value,"onUpdate:show":o[13]||(o[13]=e=>y.value=e),sendKitchen:i.value,onSuccess:o[14]||(o[14]=e=>a("backTable"))},null,8,["show","sendKitchen"]),R(Ko,{show:D.value,"onUpdate:show":o[15]||(o[15]=e=>D.value=e),productItem:n.productItem,onSuccess:z},null,8,["show","productItem"]),R(Ho,{show:w.value,"onUpdate:show":o[16]||(o[16]=e=>w.value=e),productItem:n.productItem,onSuccess:z},null,8,["show","productItem"]),R(F,{class:"ti-action-tips",show:A.value,"onUpdate:show":o[17]||(o[17]=e=>A.value=e),title:Z(Y)("溫馨提示"),content:Z(ye)("此[{name}]已製作，是否退菜？",{name:null==(l=n.productItem)?void 0:l.product_name_text}),onConfirm:j},null,8,["show","title","content"]),R(Wo,{show:b.value,"onUpdate:show":o[18]||(o[18]=e=>b.value=e),productItem:n.productItem,onSuccess:z},null,8,["show","productItem"]),R(Zo,{show:C.value,"onUpdate:show":o[19]||(o[19]=e=>C.value=e),preferentialData:e.preferentialData,totalPayPrice:e.totalPayPrice,onSuccess:z},null,8,["show","preferentialData","totalPayPrice"]),R(F,{class:"ti-action-tips",title:Z(Y)("溫馨提示"),show:g.value,isCancelShow:!1,onConfirm:o[20]||(o[20]=e=>g.value=!1)},{content:U((()=>[R(k,{class:"ti-dialog-content"},{default:U((()=>[W(J(Z(Y)("用餐时间已到，无法继续下单")),1)])),_:1})])),_:1},8,["title","show"])],64)}}},[["__scopeId","data-v-9f5b565b"]]),ll=T({__name:"cart-number",props:{productItem:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1}},emits:["change"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F(!1),u=F(!1),s=F(null),o=async e=>{var t,o,l;const c={order_product_id:null==(t=n.productItem)?void 0:t.order_product_id,product_num:null==(o=n.productItem)?void 0:o.total_num,type:e,is_buffet:null==(l=n.productItem)?void 0:l.is_buffet_product};"up"==e?(c.product_num+=1,s.value=setTimeout((()=>{r.value=!0}),500)):(c.product_num-=1,s.value=setTimeout((()=>{u.value=!0}),500));try{i.value=!0;const e=await zn(c);a("change",{order_id:e.data.order_id,...e.data.res})}catch(d){}finally{clearTimeout(s.value),i.value=!1,r.value=!1,u.value=!1}};return(e,t)=>{const a=N(M("uni-icons"),Ce),s=be,l=$;return O(),L(l,{class:"ti-number-box",onClick:t[2]||(t[2]=Ae((()=>{}),["stop"]))},{default:U((()=>{var e,c,d,f,h,p;return[R(s,{class:"ti-number-btn ti-number-minus",disabled:n.disabled||(null==(e=n.productItem)?void 0:e.total_num)<=1||i.value||(null==(c=n.productItem)?void 0:c.is_send_kitchen)>0,onClick:t[0]||(t[0]=e=>o("down"))},{default:U((()=>[u.value?(O(),L(a,{key:1,class:"ti-number-reload",type:"reload",size:"20"})):(O(),L(a,{key:0,"custom-prefix":"iconfont",type:"icon-minus",size:"16"}))])),_:1},8,["disabled"]),R(l,{class:"ti-number-input"},{default:U((()=>{var e,t;return[W(J((null==(e=n.productItem)?void 0:e.total_num)||(null==(t=n.productItem)?void 0:t.num)||1),1)]})),_:1}),R(s,{class:"ti-number-btn ti-number-plus",disabled:n.disabled||(null==(d=n.productItem)?void 0:d.total_num)>=(null==(h=null==(f=n.productItem)?void 0:f.product)?void 0:h.product_stock)||i.value||(null==(p=n.productItem)?void 0:p.is_send_kitchen)>0,onClick:t[1]||(t[1]=e=>o("up"))},{default:U((()=>[r.value?(O(),L(a,{key:1,class:"ti-number-reload",type:"reload",size:"20"})):(O(),L(a,{key:0,type:"plusempty",size:"16"}))])),_:1},8,["disabled"])]})),_:1})}}},[["__scopeId","data-v-0592a469"]]),cl=T({__name:"member",props:{show:{type:Boolean,default:!1}},emits:["update:show","change"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=F(""),u=F({}),s=F(!1);q((()=>n.show),(()=>{n.show&&(r.value="",u.value={})}));const o=()=>{a("update:show",!1)},l=e=>{e&&(r.value+=e)},c=async()=>{if(!r.value)return uni.showToast({title:Y("请输入会员手机号/ID"),icon:"none"});try{i.value=!0;const e=await xe({mobile:r.value,table_id:Qe()});u.value={...e.data.user,total_pay_price:e.data.total_pay_price}}catch(e){}finally{i.value=!1}},d=async()=>{var e;try{s.value=!0;const t=await Ee({table_id:Qe(),user_id:(null==(e=u.value)?void 0:e.user_id)||0});1==t.data.reset_notice&&uni.showToast({title:Y("改价/抹零已失效，请重新进行改价/抹零操作"),icon:"none"}),a("update:show",!1),a("change",{order_id:t.data.order_id,...t.data.res})}catch(t){}finally{s.value=!1}};return(e,t)=>{const a=N(M("ti-input"),V),f=N(M("ti-button"),G),h=$,p=ce,v=N(M("ti-keyboard"),K),m=N(M("ti-modal"),H);return O(),L(m,{show:n.show,title:Z(Y)("会员")},{content:U((()=>[R(h,{class:"ti-dialog-content"},{default:U((()=>{var e;return[R(h,{class:"ti-payment-input"},{default:U((()=>[R(a,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),regex:/^[\d\-]+$/,placeholder:Z(Y)("請輸入會員手機號/ID"),focus:!0},null,8,["modelValue","placeholder"]),R(f,{loading:i.value,type:"primary",onClick:c},{default:U((()=>[W(J(Z(Y)("查找")),1)])),_:1},8,["loading"])])),_:1}),(null==(e=u.value)?void 0:e.user_id)?(O(),L(h,{key:0,class:"ti-payment-member"},{default:U((()=>[R(h,{class:"ti-member-list"},{default:U((()=>[R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("暱稱")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J((null==(e=u.value)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("會員卡/等級")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e,t,a,n,i,r,s,o;return[W(J(`${1!=(null==(t=null==(e=u.value)?void 0:e.cardRecord)?void 0:t.disabled)&&(null==(n=null==(a=u.value)?void 0:a.card)?void 0:n.card_name)?null==(r=null==(i=u.value)?void 0:i.card)?void 0:r.card_name:"-"}/${(null==(o=null==(s=u.value)?void 0:s.grade)?void 0:o.name)||"-"}`),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("餘額")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J(Z(ke)(null==(e=u.value)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("積分")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J((null==(e=u.value)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),R(h,{class:"ti-member-discount"},{default:U((()=>[R(p,{class:"ti-discount-title"},{default:U((()=>[W(J(Z(Y)("會員折扣應收金額")),1)])),_:1}),R(p,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=u.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),R(p,{class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=u.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1})])),_:1})):de("",!0)]})),_:1})])),footer:U((()=>[R(h,{class:"ti-dialog-btn"},{default:U((()=>[R(v,{primaryLoading:s.value,isDoubleZero:!1,isCross:!0,isDrop:!0,onExit:o,onClear:t[1]||(t[1]=e=>r.value=""),onInput:l,onConfirm:d},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-f2bec8a8"]]),dl=T({__name:"pay-code",props:{show:{type:Boolean,default:!1},payItem:{type:Object,default:()=>{}}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=()=>{Ie({},!1),a("update:show",!1)},r=()=>{a("success")};return(t,a)=>{const u=$,s=ce,o=Te,l=N(M("ti-modal"),H);return O(),L(l,{class:"ti-action-tips-pay",show:n.show,confirmText:t.$t("已支付"),cancelText:t.$t("退出"),onCancel:i,onConfirm:r},{content:U((()=>[R(u,{class:"ti-pay-container"},{default:U((()=>[R(u,{class:"ti-pay-title-box"},{default:U((()=>[R(u,{class:"ti-pay-title"},{default:U((()=>{var a;return[W(J((null==(a=e.payItem)?void 0:a.name)+t.$t("收款:")),1)]})),_:1}),R(u,{class:"ti-pay-prices-box"},{default:U((()=>[R(s,{class:"ti-pay-prices"},{default:U((()=>{var t;return[W(J(Z(se)(null==(t=e.payItem)?void 0:t.actual_price)),1)]})),_:1}),R(s,{class:"ti-pay-subPrice"},{default:U((()=>{var t;return[W(J(Z(oe)(null==(t=e.payItem)?void 0:t.actual_price)),1)]})),_:1})])),_:1})])),_:1}),R(u,{class:"ti-pay-content-box"},{default:U((()=>[R(u,{class:"ti-pay-code"},{default:U((()=>{var t;return[R(o,{src:Z(Fe)(null==(t=e.payItem)?void 0:t.qrcode),mode:"widthFix"},null,8,["src"])]})),_:1}),R(u,{class:"ti-pay-code-tips"},{default:U((()=>{var a;return[W(J(t.$t("请使用")+`${null==(a=e.payItem)?void 0:a.name}`+t.$t("扫一扫支付")),1)]})),_:1})])),_:1})])),_:1})])),_:1},8,["show","confirmText","cancelText"])}}},[["__scopeId","data-v-87b13621"]]),fl={__name:"payment-type",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0},orderId:{type:[Number,String],default:null},memberDetail:{type:Object,default:()=>({})}},emits:["update:show","success","backTable"],setup(e,{emit:t}){const{paymentType:a}=Se(Be()),{isPaying:i}=Se(Jn()),r=t,u=e,s=F(!1),o=F({}),l=F(""),c=F(0),d=e=>{const t=l.value+e;/^\d*\.?\d{0,2}$/.test(t)&&(l.value+=e)},f=()=>{l.value=""},h=()=>{let e=parseFloat(l.value)-parseFloat(u.totalPayPrice);return c.value=e,e>=0},p=F(!1),v=F([]),m=F({delivery:40,pay_type:"40",user_id:null,table_id:null}),_=F(!1),g=F(!1),y=F(!1),D=F(),w=F(0),b=F("");q((()=>u.show),(()=>{u.show&&(v.value=[],m.value.pay_type="40",l.value="")})),q((()=>m.value.pay_type),(()=>{u.show&&(m.value.pay_type>0||(v.value&&v.value.length>0?(m.value.pay_type=v.value[0].value,o.value=v.value[0]):Ne().then((e=>{v.value=e.data||[],m.value.pay_type=v.value[0].value,o.value=v.value[0]}))))})),q((()=>u.totalPayPrice),(()=>{h()})),q(l,(()=>{h()}));const C=(e,t)=>{r("success",e,t)},A=async()=>{try{const e=await Ee({table_id:Qe(),user_id:0});C({order_id:e.data.order_id,...e.data.res})}catch(e){}},x=e=>{m.value.pay_type=e.detail.value},E=async()=>{var e,t,a,n;if(!g.value)try{g.value=!0;const e=await si({order_id:u.orderId,is_reload_price:!0});uni.showToast({title:e.msg,icon:"none"}),C({order_id:e.data.order_id,...e.data.res})}catch(i){(null==(e=null==i?void 0:i.data)?void 0:e.res)&&(null==(t=null==i?void 0:i.data)?void 0:t.order_id)&&C({order_id:null==(a=null==i?void 0:i.data)?void 0:a.order_id,...null==(n=null==i?void 0:i.data)?void 0:n.res})}finally{g.value=!1}},I=async(e=!1)=>{var t,a,c,d,f,p;if(_.value)return;const v={...m.value};if(v.table_id=Qe(),v.user_id=null==(t=u.memberDetail)?void 0:t.user_id,v.actual_price=l.value,v.pay_price=u.totalPayPrice,1!=e&&(o.value.actual_price=u.totalPayPrice),"10"==v.pay_type&&!v.user_id)return uni.showToast({title:Y("请选择会员身份以享受更多优惠，再进行余额支付"),icon:"none"});if("40"==v.pay_type&&!l.value)return uni.showToast({title:Y("请输入实收金额"),icon:"none"});if("40"==v.pay_type&&!h())return uni.showToast({title:Y("实收金额不应小于应收金额"),icon:"none"});if("40"!=v.pay_type&&"10"!=v.pay_type&&(null==(a=o.value)?void 0:a.qrcode)&&1!=e)return s.value=!0,void Ie(o.value,!0);try{_.value=!0;const e=await function(e){return k("order.order/pay",e,{isMessage:!1})}(v);"40"==v.pay_type&&Me((()=>{})),uni.showToast({title:e.msg,icon:"none"}),s.value=!1,i.value=1,r("update:show",!1),C(e.data.pay_res,"handleSubmit")}catch(g){(null==(c=null==g?void 0:g.data)?void 0:c.res)&&(null==(d=null==g?void 0:g.data)?void 0:d.order_id)?(uni.showToast({title:null==g?void 0:g.msg,icon:"none"}),C({order_id:null==(f=null==g?void 0:g.data)?void 0:f.order_id,...null==(p=null==g?void 0:g.data)?void 0:p.res})):n(null==g?void 0:g.data)&&(null==g?void 0:g.data.length)>0?(y.value=!0,D.value=null==g?void 0:g.data,w.value=null==g?void 0:g.code,b.value=null==g?void 0:g.msg):uni.showToast({title:null==g?void 0:g.msg,icon:"none"})}finally{_.value=!1}},T=()=>{Ie(o.value,!1),I(!0)};return(t,n)=>{const i=ce,h=$,k=he,F=pe,S=ve,B=N(M("ti-input"),V),P=Te,z=N(M("ti-empty-data"),re),q=N(M("ti-keyboard"),K),Q=N(M("ti-button"),G),ae=N(M("ti-modal"),H);return O(),L(ae,{show:u.show,title:Z(Y)("結賬")},{content:U((()=>[R(h,{class:"ti-dialog-content"},{default:U((()=>{var t;return[R(h,{class:"ti-payment-money"},{default:U((()=>[R(i,{class:"ti-payment-label"},{default:U((()=>[W(J(Z(Y)("應收金額")),1)])),_:1}),R(i,{class:"ti-payment-price"},{default:U((()=>[W(J(Z(se)(e.totalPayPrice)),1)])),_:1}),R(i,{class:"ti-payment-subPrice"},{default:U((()=>[W(J(Z(oe)(e.totalPayPrice)),1)])),_:1})])),_:1}),R(h,{class:"ti-payment-type"},{default:U((()=>[R(h,{class:"ti-type-label"},{default:U((()=>[W(J(Z(Y)("收款方式")),1)])),_:1}),R(S,{class:"ti-type-radio",onChange:x},{default:U((()=>{var e,t,n;return[1==(null==(e=Z(a))?void 0:e.is_cash)?(O(),L(F,{key:0},{default:U((()=>[R(k,{value:"40",color:"#ffbe00",checked:"true"}),R(i,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("現金")),1)])),_:1})])),_:1})):de("",!0),1==(null==(t=Z(a))?void 0:t.is_balance)?(O(),L(F,{key:1},{default:U((()=>[R(k,{value:"10",color:"#ffbe00"}),R(i,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("餘額")),1)])),_:1})])),_:1})):de("",!0),1==(null==(n=Z(a))?void 0:n.is_other)?(O(),L(F,{key:2},{default:U((()=>[R(k,{value:"",color:"#ffbe00"}),R(i,{class:"ti-radio-text"},{default:U((()=>[W(J(Z(Y)("其他方式")),1)])),_:1})])),_:1})):de("",!0)]})),_:1})])),_:1}),"40"==m.value.pay_type?(O(),L(h,{key:0,class:"ti-payment-cashier"},{default:U((()=>[R(B,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=e=>l.value=e),focus:!0,placeholder:Z(Y)("請輸入實收金額")},null,8,["modelValue","placeholder"]),R(h,{class:"ti-payment-cashier-view"},{default:U((()=>[R(h,{class:"ti-payment-cashier-title"},{default:U((()=>[W(J(Z(Y)("找零")),1)])),_:1}),R(h,{class:"ti-payment-cashier-content"},{default:U((()=>[W(J(Z(se)(c.value>=0?c.value:0)),1)])),_:1})])),_:1})])),_:1})):de("",!0),"40"!=m.value.pay_type&&"10"!=m.value.pay_type?(O(),L(h,{key:1,class:"ti-payment-other"},{default:U((()=>[R(h,{class:"ti-other-title"},{default:U((()=>[W(J(Z(Y)("用戶通過店內掃碼等方式進行支付，確認用戶支付完成後，點擊確認即可完成付款操作。")),1)])),_:1}),v.value&&v.value.length>0?(O(),L(h,{key:0,class:"ti-other-list"},{default:U((()=>[(O(!0),X(ee,null,te(v.value,(e=>(O(),L(h,{key:e.value,class:j([{active:e.value==m.value.pay_type},"ti-other-item"]),onClick:t=>(m.value.pay_type=e.value,o.value=e)},{default:U((()=>[R(h,{class:"ti-other-image"},{default:U((()=>[R(P,{src:Z(Fe)(e.img),mode:"widthFix"},null,8,["src"])])),_:2},1024),R(h,{class:"ti-other-text"},{default:U((()=>[W(J(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(O(),L(z,{key:1}))])),_:1})):de("",!0),(null==(t=u.memberDetail)?void 0:t.user_id)?(O(),L(h,{key:2,class:"ti-payment-member"},{default:U((()=>[R(h,{class:"ti-payment-top"},{default:U((()=>[R(h,{class:"ti-payment-top-name"},{default:U((()=>[W(J(Z(Y)("會員")),1)])),_:1}),R(h,{class:"ti-payment-top-discomfort",onClick:A},{default:U((()=>[W(J(Z(Y)("不使用此會員")),1)])),_:1})])),_:1}),R(h,{class:"ti-member-list"},{default:U((()=>[R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("暱稱")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J((null==(e=u.memberDetail)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("會員卡/等級")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e,t,a,n,i,r,s,o;return[W(J(`${1!=(null==(t=null==(e=u.memberDetail)?void 0:e.cardRecord)?void 0:t.disabled)&&(null==(n=null==(a=u.memberDetail)?void 0:a.card)?void 0:n.card_name)?null==(r=null==(i=u.memberDetail)?void 0:i.card)?void 0:r.card_name:"-"}/${(null==(o=null==(s=u.memberDetail)?void 0:s.grade)?void 0:o.name)||"-"}`),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("餘額")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J(Z(ke)(null==(e=u.memberDetail)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),R(h,{class:"ti-member-item"},{default:U((()=>[R(h,{class:"ti-member-head"},{default:U((()=>[W(J(Z(Y)("積分")),1)])),_:1}),R(h,{class:"ti-member-name text-ellipsis"},{default:U((()=>{var e;return[W(J((null==(e=u.memberDetail)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),R(h,{class:"ti-member-discount"},{default:U((()=>[R(i,{class:"ti-discount-title"},{default:U((()=>[W(J(Z(Y)("會員折扣應收金額")),1)])),_:1}),R(i,{class:"ti-discount-price"},{default:U((()=>[W(J(Z(se)(e.totalPayPrice)),1)])),_:1}),R(i,{class:"ti-discount-subPrice"},{default:U((()=>[W(J(Z(oe)(e.totalPayPrice)),1)])),_:1})])),_:1})])),_:1})):de("",!0),R(cl,{show:p.value,"onUpdate:show":n[1]||(n[1]=e=>p.value=e),onChange:C},null,8,["show"]),R(sl,{show:y.value,"onUpdate:show":n[2]||(n[2]=e=>y.value=e),sendKitchen:D.value,code:w.value,msg:b.value},null,8,["show","sendKitchen","code","msg"]),R(dl,{show:s.value,"onUpdate:show":n[3]||(n[3]=e=>s.value=e),payItem:o.value,onSuccess:T},null,8,["show","payItem"])]})),_:1})])),footer:U((()=>["40"==m.value.pay_type?(O(),L(h,{key:0,class:"keyboard-back"},{default:U((()=>[R(q,{isExit:!1,isPrimary:!1,isDoubleZero:!0,isCross:!1,isDrop:!0,onInput:d,onClear:f})])),_:1})):de("",!0),R(h,{class:"ti-dialog-btn"},{default:U((()=>[R(Q,{onClick:n[4]||(n[4]=e=>r("update:show",!1))},{default:U((()=>[W(J(Z(Y)("退出")),1)])),_:1}),R(Q,{loading:g.value,onClick:E},{default:U((()=>[W(J(Z(Y)("打印")),1)])),_:1},8,["loading"]),R(Q,{onClick:n[5]||(n[5]=e=>p.value=!0)},{default:U((()=>[W(J(Z(Y)("会员")),1)])),_:1}),R(Q,{loading:_.value,type:"primary",onClick:I},{default:U((()=>[W(J(Z(Y)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},hl=T(fl,[["__scopeId","data-v-ac245f17"]]),pl=T({__name:"pay-result",props:{show:{type:Boolean,default:!1},payResult:{type:Object,default:()=>{}}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=()=>{a("update:show",!1),a("success")},u=async()=>{var e;const t={order_id:null==(e=n.payResult)?void 0:e.order_id};try{i.value=!0;const e=await si(t);uni.showToast({title:e.msg,icon:"none"})}catch(a){uni.showToast({title:a.msg,icon:"none"})}finally{i.value=!1}},s=async()=>{var e;const t={order_id:null==(e=n.payResult)?void 0:e.order_id};try{i.value=!0;const e=await oi(t);uni.showToast({title:e.msg,icon:"none"})}catch(a){uni.showToast({title:a.msg,icon:"none"})}finally{i.value=!1}};return(t,a)=>{const o=$,l=N(M("ti-button"),G),c=N(M("ti-modal"),H);return O(),L(c,{class:"ti-action-tips-pay",show:n.show,confirmText:t.$t("已支付"),onCancel:r},{title:U((()=>[R(o)])),content:U((()=>[R(o,{class:"ti-pay-container"},{default:U((()=>[R(o,{class:"ti-pay-title-box"},{default:U((()=>[R(o,{class:"ti-pay-title"},{default:U((()=>[W(J("收款"))])),_:1})])),_:1}),R(o,{class:"ti-pay-content"},{default:U((()=>{var a,n;return[R(o,{class:"ti-data-other-item"},{default:U((()=>[R(o,{class:"ti-data-other-item-title"},{default:U((()=>[W(J(t.$t("应收金额")),1)])),_:1}),R(o,{class:"ti-data-other-item-content-box"},{default:U((()=>[R(o,{class:"ti-data-other-item-content"},{default:U((()=>{var t;return[W(J(Z(se)(null==(t=e.payResult)?void 0:t.pay_price)),1)]})),_:1}),R(o,{class:"ti-data-other-item-sub-content"},{default:U((()=>{var t;return[W(J(Z(oe)(null==(t=e.payResult)?void 0:t.pay_price)),1)]})),_:1})])),_:1})])),_:1}),R(o,{class:"ti-data-other-item"},{default:U((()=>[R(o,{class:"ti-data-other-item-title"},{default:U((()=>[W(J(t.$t("支付方式")),1)])),_:1}),R(o,{class:"ti-data-other-item-content-box"},{default:U((()=>[R(o,{class:"ti-data-other-item-content"},{default:U((()=>{var t,a,n,i,r,u;return[W(J((null==(a=null==(t=e.payResult)?void 0:t.pay_type)?void 0:a.text.length)>10?(null==(i=null==(n=e.payResult)?void 0:n.pay_type)?void 0:i.text.slice(0,11))+"...":null==(u=null==(r=e.payResult)?void 0:r.pay_type)?void 0:u.text),1)]})),_:1})])),_:1})])),_:1}),R(o,{class:"ti-data-other-item"},{default:U((()=>[R(o,{class:"ti-data-other-item-title"},{default:U((()=>[W(J(t.$t("实收金额")),1)])),_:1}),R(o,{class:"ti-data-other-item-content-box"},{default:U((()=>[R(o,{class:"ti-data-other-item-content"},{default:U((()=>{var t;return[W(J(Z(se)(null==(t=e.payResult)?void 0:t.actual_price)),1)]})),_:1}),R(o,{class:"ti-data-other-item-sub-content"},{default:U((()=>{var t;return[W(J(Z(oe)(null==(t=e.payResult)?void 0:t.actual_price)),1)]})),_:1})])),_:1})])),_:1}),40==(null==(n=null==(a=e.payResult)?void 0:a.pay_type)?void 0:n.value)?(O(),L(o,{key:0,class:"ti-data-other-item"},{default:U((()=>[R(o,{class:"ti-data-other-item-title"},{default:U((()=>[W(J(t.$t("找零")),1)])),_:1}),R(o,{class:"ti-data-other-item-content-box"},{default:U((()=>[R(o,{class:"ti-data-other-item-content"},{default:U((()=>{var t;return[W(J(Z(se)(null==(t=e.payResult)?void 0:t.change_due)),1)]})),_:1}),R(o,{class:"ti-data-other-item-sub-content"},{default:U((()=>{var t;return[W(J(Z(oe)(null==(t=e.payResult)?void 0:t.change_due)),1)]})),_:1})])),_:1})])),_:1})):de("",!0)]})),_:1})])),_:1})])),footer:U((()=>[R(o,{class:"ti-dialog-btn"},{default:U((()=>[R(l,{onClick:r},{default:U((()=>[W(J(t.$t("退出")),1)])),_:1}),R(l,{loading:i.value,onClick:u},{default:U((()=>[W(J(t.$t("打印小票")),1)])),_:1},8,["loading"]),R(l,{loading:i.value,type:"primary",onClick:s},{default:U((()=>[W(J(t.$t("发票")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","confirmText"])}}},[["__scopeId","data-v-fe393606"]]),vl=T({__name:"time-meter",props:{tableDetail:{type:Object,default:()=>({})},buffetName:{type:String,default:""}},emits:["change","changeLock"],setup(e,{emit:t}){const a=t,n=e,{isBuffet:i,buffetTime:r,isUnlimitedTime:u}=Se(Vo()),{buffetConfig:s,cashier:o}=Se(Be()),l=F(),c=F(),d=F(`00 ${Y("分钟")} 00 ${Y("秒")}`),f=F(`00 ${Y("分钟")} 00 ${Y("秒")}`),h=F(!1),p=F(!1),v=F([]),m=F([]),_=ne((()=>-1==u.value?"#100a05":"#e50028")),g=e=>e<10?`0${e}`:e,y=e=>{const t=Math.floor((e||0)/3600),a=Math.floor((e||0)/60)%60,n=Math.floor(e||0)%60;let i="";return t>0&&(i+=`${g(t)} ${Y("小时")} `),i+=`${g(a)} ${Y("分钟")} ${g(n)} ${Y("秒")}`,i};q((()=>{var e;return null==(e=n.tableDetail)?void 0:e.elapsed_time}),(()=>{var e;0==i.value&&(c.value=null==(e=n.tableDetail)?void 0:e.elapsed_time,l.value&&clearInterval(l.value),c.value>0&&(l.value=setInterval((()=>{c.value++,d.value=y(c.value)}),1e3)))}),{deep:!0}),q((()=>u.value),(()=>{-1==u.value?f.value=Y("不限时"):f.value=y(r.value)}),{deep:!0,immediate:!0}),q((()=>r.value),(()=>{if(1==i.value)if(r.value>0)f.value=y(r.value);else{if(-1==u.value)return;f.value=`00 ${Y("分钟")} 00 ${Y("秒")}`}})),Le((()=>{l.value&&clearInterval(l.value)}));const D=async()=>{var e;if(1==(null==(e=n.tableDetail)?void 0:e.is_lock))return uni.showToast({title:Y("该订单已被锁定，请解锁后重新操作"),icon:"none"});try{const e=await k("order.HallCart/delayList");v.value=e.data||[],m.value=[],h.value=!0}catch(t){}},w=async()=>{if(m.value.length<=0)uni.showToast({title:Y("请选择加钟"),icon:"none"});else{p.value=!0;try{const t=await(e={table_id:Qe(),delay_ids:m.value},k("order.HallCart/addDelay",e));uni.showToast({title:t.msg,icon:"none"}),h.value=!1,a("change",{order_id:t.data.order_id,...t.data.res})}catch(t){}finally{p.value=!1}var e}};return(e,t)=>{const a=$,r=ce,o=N(M("uni-icons"),Ce),l=N(M("ti-empty-data"),re),c=ae,g=N(M("ti-button"),G),y=N(M("ti-modal"),H);return O(),X(ee,null,[R(a,{class:"ti-table-info"},{default:U((()=>[R(a,{class:"ti-table-noBuffet"},{default:U((()=>[R(a,{class:"ti-table-num"},{default:U((()=>[R(a,{class:"ti-table-name"},{default:U((()=>{var e;return[W(J(`${(null==(e=n.tableDetail)?void 0:e.table_no)||""}`),1)]})),_:1}),R(a,{class:"ti-table-name-p"},{default:U((()=>{var e;return[W(J(`(${(null==(e=n.tableDetail)?void 0:e.meal_num)||0})`),1)]})),_:1})])),_:1}),0==Z(i)?(O(),L(a,{key:0,class:"ti-table-time"},{default:U((()=>[W(J(Z(Y)("已就餐："))+J(d.value),1)])),_:1})):de("",!0)])),_:1}),1==Z(i)?(O(),L(a,{key:0,class:"ti-table-buffet"},{default:U((()=>[R(a,{class:"ti-buffet-name"},{default:U((()=>[W(J(n.buffetName),1)])),_:1}),R(a,{class:"ti-buffet-right"},{default:U((()=>{var e;return[R(a,{class:"ti-buffet-time"},{default:U((()=>[R(r,null,{default:U((()=>[W(J(Z(Y)("剩余时间：")),1)])),_:1}),R(r,{class:"ti-buffet-countdown",style:z({color:_.value})},{default:U((()=>[W(J(f.value),1)])),_:1},8,["style"])])),_:1}),1==(null==(e=Z(s))?void 0:e.is_add_clock)&&-1!=Z(u)?(O(),L(a,{key:0,class:"ti-buffet-icon",onClick:D},{default:U((()=>[R(o,{"custom-prefix":"iconfont",type:"icon-add-circle",size:"20",color:"#100A05"})])),_:1})):de("",!0)]})),_:1})])),_:1})):de("",!0)])),_:1}),R(y,{class:"ti-dialog-buffet",show:h.value,title:Z(Y)("加钟")},{content:U((()=>[R(a,{class:"ti-dialog-content"},{default:U((()=>[R(c,{class:"ti-buffet-scroll","scroll-y":""},{default:U((()=>[v.value&&v.value.length>0?(O(),L(a,{key:0,class:"ti-buffet-list"},{default:U((()=>[(O(!0),X(ee,null,te(v.value,(e=>(O(),L(a,{key:e.id,class:j(["ti-buffet-item",{active:m.value.includes(e.id)}]),onClick:t=>(e=>{const t=m.value.indexOf(e.id);if(t>-1)m.value.splice(t,1);else{if(m.value.length>=2)return uni.showToast({title:ye("最多能选择{count}个加钟",{count:2}),icon:"none"});m.value.push(e.id)}})(e)},{default:U((()=>[R(a,{class:"ti-buffet-name"},{default:U((()=>[W(J(e.name_text||e.name),1)])),_:2},1024),R(a,null,{default:U((()=>[R(r,{class:"ti-buffet-price"},{default:U((()=>[W(J(Z(se)(e.price)),1)])),_:2},1024),R(r,{class:"ti-buffet-subPrice"},{default:U((()=>[W(J(Z(oe)(e.price)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(O(),L(l,{key:1}))])),_:1})])),_:1})])),footer:U((()=>[R(a,{class:"ti-dialog-btn"},{default:U((()=>[R(g,{disabled:p.value,onClick:t[0]||(t[0]=e=>h.value=!1)},{default:U((()=>[W(J(Z(Y)("取消")),1)])),_:1},8,["disabled"]),R(g,{loading:p.value,type:"primary",onClick:w},{default:U((()=>[W(J(Z(Y)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])],64)}}},[["__scopeId","data-v-f66f5ee7"]]),ml=T({__name:"lock",emits:["unlock"],setup(e,{emit:t}){const a=t,n=()=>{a("unlock")};return(e,t)=>{const a=N(M("uni-icons"),Ce),i=$,r=N(M("ti-button"),G);return O(),L(i,{class:"ti-lock-view"},{default:U((()=>[R(i,{class:"ti-lock-center"},{default:U((()=>[R(a,{"custom-prefix":"iconfont",type:"icon-lock",size:"36",color:"#FFFFFF"}),R(i,{class:"ti-lock-message"},{default:U((()=>[W(J(e.$t("核对单已打印，订单已锁定")),1)])),_:1}),R(i,null,{default:U((()=>[R(r,{class:"ti-lock-unlock",type:"primary",title:e.$t("解锁"),onClick:n},null,8,["title"])])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-ab340b23"]]),_l=T({__name:"cart-list",emits:["change","success","orderID"],setup(e,{expose:t,emit:a}){const n=Xe(),{isBuffet:i,buffetTime:r,isUnlimitedTime:u}=Se(Vo()),{tableIsLock:s,isPaying:o}=Se(Jn()),{pathName:l}=Se(Oe()),c=a,d=F(),f=F(!1),h=F(!1),p=F({}),v=F(0),m=F({}),_=F(),g=F(),y=F([]),D=F({table_no:"",meal_num:"",elapsed_time:""}),w=F({}),b=F(),C=F(0),A=F(""),x=F(!1),E=F([]),I=F([]),T=F({}),S=F([]),B=ne((()=>{const e=[];return S.value.map((t=>{e.push(t.name_text||t.name)})),e.join("+")})),P=F([]),z=F({}),V=F(0),K=F(!1),H=F({}),G=()=>{K.value=!1,o.value=0,null==n||n.clearTableGoodsData(),pe()},Q=(e,t)=>{"handleSubmit"==t?(K.value=!0,H.value=e):me(e,t)},ue=()=>{je((()=>{qe().in(this).select("#ti-table-cart-scroll").fields({size:!0,scrollOffset:!0},(e=>{V.value=e.scrollHeight-e.height})).exec()}))},le=async()=>{if(!g.value||g.value<=0)return uni.showToast({title:Y("订单ID不存在"),icon:"none"});try{const e=await Hn({order_id:g.value});uni.showToast({title:e.msg,icon:"none"}),me({order_id:e.data.order_id,...e.data.res})}catch(e){}},fe=async()=>{const e={order_id:g.value};try{const t=await Wn(e);C.value=null==t?void 0:t.code,(null==t?void 0:t.data)&&(null==t?void 0:t.data.length)>0?(E.value=null==t?void 0:t.data,A.value=null==t?void 0:t.msg,x.value=!0):f.value=!0}catch(t){C.value=null==t?void 0:t.code,(null==t?void 0:t.data)&&(null==t?void 0:t.data.length)>0?(E.value=null==t?void 0:t.data,A.value=null==t?void 0:t.msg,x.value=!0):uni.showToast({title:null==t?void 0:t.msg,icon:"none"})}},he=()=>{1==C.value&&(f.value=!0)},pe=()=>{me({}),rt(),1!=o.value&&setTimeout((()=>{Re(),c("change")}),100)},ve=async(e,t)=>{var a,n,i;if(Qe())try{e&&(h.value=!0);const r=await(i={table_id:Qe()},k("order.HallCart/tableProductList",i,{isLoading:!1}));if(1==o.value)return;me({order_id:null==(a=r.data)?void 0:a.order_id,...null==(n=r.data)?void 0:n.allProductInfo},t)}catch(r){}finally{e&&(h.value=!1)}else b.value&&clearTimeout(b.value)},me=(e,t)=>{var a,n,o,f,h,C,A,k,x,E,F,B,N,M,O,L;if((null==e?void 0:e.order_id)<=0&&pe(),w.value={discount_ratio:null==(a=null==e?void 0:e.orderInfo)?void 0:a.discount_ratio},null!=(null==e?void 0:e.order_id)&&(g.value=null==e?void 0:e.order_id,c("orderID",g.value)),_.value=Qe(),D.value={table_no:null==(n=null==e?void 0:e.orderInfo)?void 0:n.table_no,meal_num:null==(o=null==e?void 0:e.orderInfo)?void 0:o.meal_num,elapsed_time:null==(f=null==e?void 0:e.orderInfo)?void 0:f.elapsed_time,is_buffet:(null==(h=null==e?void 0:e.orderInfo)?void 0:h.is_buffet)||0},s.value=(null==(C=null==e?void 0:e.orderInfo)?void 0:C.is_lock)||0,i.value=(null==(A=null==e?void 0:e.orderInfo)?void 0:A.is_buffet)||0,r.value=(null==(k=null==e?void 0:e.orderInfo)?void 0:k.buffet_remaining_time)||0,u.value=(null==(x=null==e?void 0:e.orderInfo)?void 0:x.buffet_expired_time)||0,m.value=(null==e?void 0:e.sumInfo)||{},y.value=(null==(E=null==e?void 0:e.orderInfo)?void 0:E.product)||[],I.value=(null==(F=null==e?void 0:e.orderInfo)?void 0:F.buffetCustomerType)||[],S.value=((null==(B=null==e?void 0:e.orderInfo)?void 0:B.buffet)||[]).map((t=>{var a;return t.total_num=(null==(a=null==e?void 0:e.orderInfo)?void 0:a.meal_num)||1,t})),P.value=((null==(N=null==e?void 0:e.orderInfo)?void 0:N.delay)||[]).map((t=>{var a;return t.total_num=(null==(a=null==e?void 0:e.orderInfo)?void 0:a.meal_num)||1,t})),d.value=null==e?void 0:e.userInfo,"delDelay"==t?z.value={}:"delBuffet"==t&&(T.value={}),!(null==(M=z.value)?void 0:M.id)&&!(null==(O=T.value)?void 0:O.id)&&y.value&&y.value.length>0){let e=0;"delete"==t?e=v.value-1:"add"==t?e=y.value.length-1:(null==(L=p.value)?void 0:L.order_product_id)&&(e=y.value.findIndex((e=>{var t;return e.order_product_id==(null==(t=p.value)?void 0:t.order_product_id)}))),p.value=y.value[Math.max(e,0)],v.value=Math.max(e,0)}else p.value={};"desk"==l.value&&(Re(ze(m.value),ze(y.value),ze([...I.value,...P.value])),b.value&&clearTimeout(b.value),b.value=setTimeout((()=>{ve()}),6e3))};return u.value=0,ve(!0),Le((()=>{b.value&&clearTimeout(b.value)})),Ue("mini-cashier",(e=>{"desk"==e&&"desk"==l.value&&Re(ze(m.value),ze(y.value),ze([...I.value,...P.value]))})),q((()=>y.value),((e,t)=>{e.length>t.length&&ue()})),q((()=>l.value),(()=>{"desk"==l.value&&Qe()?ve():b.value&&clearTimeout(b.value)}),{immediate:!0}),t({handleResultCart:me}),(e,t)=>{var a,n,i,r,u;const o=$,l=N(M("ti-loading"),ie),c=ce,b=N(M("ti-empty-data"),re),C=ae,k=be,F=_e("permission");return O(),X(ee,null,[R(o,{class:"ti-cart-box"},{default:U((()=>[R(o,{class:"ti-cart-list"},{default:U((()=>[R(vl,{tableDetail:D.value,buffetName:B.value,onChangeLock:le,onChange:me},null,8,["tableDetail","buffetName"]),R(o,{class:"ti-cart-head"},{default:U((()=>[R(o,{class:"ti-cart-shop-head"},{default:U((()=>[R(o,{class:"ti-shop-head-title"},{default:U((()=>[W(J(Z(Y)("商品名稱")),1)])),_:1}),R(o,{class:"ti-shop-head-money"},{default:U((()=>[W(J(Z(Y)("数量")),1)])),_:1}),R(o,{class:"ti-shop-head-num"},{default:U((()=>[R(o),R(o,null,{default:U((()=>[W(J(Z(Y)("小计")),1)])),_:1})])),_:1})])),_:1})])),_:1}),R(o,{class:"ti-shop-list"},{default:U((()=>[R(C,{id:"ti-table-cart-scroll","scroll-y":"","enable-flex":"","scroll-with-animation":"","scroll-top":V.value},{default:U((()=>[h.value?(O(),L(l,{key:0})):I.value&&I.value.length>0||P.value&&P.value.length>0||y.value&&y.value.length>0?(O(),L(o,{key:1,class:"ti-shop-box"},{default:U((()=>[(O(!0),X(ee,null,te(I.value,((e,t)=>(O(),L(o,{key:t,class:j(["ti-shop-item",{active:T.value.id==e.id}]),onClick:t=>(e=>{var t;z.value={},p.value={},(null==(t=T.value)?void 0:t.id)!=(null==e?void 0:e.id)&&(T.value=e)})(e)},{default:U((()=>[R(o,{class:"ti-shop-item-box"},{default:U((()=>[R(o,{class:"ti-shop-body"},{default:U((()=>[R(o,{class:"ti-shop-body-top"},{default:U((()=>[R(o,{class:"ti-shop-title text-ellipsis"},{default:U((()=>[W(J(e.buffet_name_text||e.buffet_name),1)])),_:2},1024)])),_:2},1024),R(ll,{productItem:e,disabled:!0},null,8,["productItem"]),R(o,{class:"ti-shop-body-money"},{default:U((()=>[R(c,{class:"ti-shop-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.total_price)||0)),1)])),_:2},1024),R(c,{class:"ti-shop-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.total_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),e.customer_type_name?(O(),L(o,{key:0,class:"ti-shop-customer"},{default:U((()=>[W("("+J(e.customer_type_name_text||e.customer_type_name)+")",1)])),_:2},1024)):de("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),(O(!0),X(ee,null,te(P.value,((e,t)=>(O(),L(o,{key:t,class:j(["ti-shop-item",{active:z.value.id==e.id}]),onClick:t=>(e=>{var t;p.value={},T.value={},(null==(t=z.value)?void 0:t.id)!=(null==e?void 0:e.id)&&(z.value=e)})(e)},{default:U((()=>[R(o,{class:"ti-shop-item-box"},{default:U((()=>[R(o,{class:"ti-shop-body"},{default:U((()=>[R(o,{class:"ti-shop-body-top"},{default:U((()=>[R(o,{class:"ti-shop-title text-ellipsis"},{default:U((()=>[W(J(e.name_text||e.name),1)])),_:2},1024)])),_:2},1024),R(ll,{productItem:e,disabled:!0},null,8,["productItem"]),R(o,{class:"ti-shop-body-money"},{default:U((()=>[R(c,{class:"ti-shop-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.total_price)||0)),1)])),_:2},1024),R(c,{class:"ti-shop-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.total_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),e.remark?(O(),L(o,{key:0,class:"ti-shop-remark"},{default:U((()=>[W(J(e.remark),1)])),_:2},1024)):de("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),(O(!0),X(ee,null,te(y.value,((e,t)=>{var a;return O(),L(o,{key:null==e?void 0:e.order_product_id,class:j([{active:(null==(a=p.value)?void 0:a.order_product_id)==(null==e?void 0:e.order_product_id)},"ti-shop-item"]),onClick:a=>((e,t)=>{var a;z.value={},T.value={},(null==(a=p.value)?void 0:a.order_product_id)!=(null==e?void 0:e.order_product_id)&&(p.value=e,v.value=t)})(e,t)},{default:U((()=>[R(o,{class:"ti-shop-item-box"},{default:U((()=>[R(o,{class:"ti-shop-body"},{default:U((()=>[R(o,{class:"ti-shop-body-top"},{default:U((()=>[R(o,{class:"ti-shop-title text-ellipsis"},{default:U((()=>[W(J(e.product_name_text||e.product_name),1)])),_:2},1024),e.product_attr?(O(),L(o,{key:0,class:"ti-shop-spec"},{default:U((()=>[W("( "+J(e.product_attr)+" )",1)])),_:2},1024)):de("",!0)])),_:2},1024),R(ll,{productItem:e,onChange:me},null,8,["productItem"]),R(o,{class:"ti-shop-body-money"},{default:U((()=>[R(c,{class:"ti-shop-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.total_product_price)||0)),1)])),_:2},1024),R(c,{class:"ti-shop-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.total_product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),e.remark?(O(),L(o,{key:0,class:"ti-shop-remark"},{default:U((()=>[W(J(e.remark),1)])),_:2},1024)):de("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])})),128))])),_:1})):(O(),L(b,{key:2}))])),_:1},8,["scroll-top"])])),_:1}),1==Z(s)?(O(),L(ml,{key:0,onUnlock:le})):de("",!0)])),_:1}),R(o,{class:"ti-cart-statistics"},{default:U((()=>[R(o,{class:"ti-cart-total"},{default:U((()=>[R(c,{class:"ti-total-text"},{default:U((()=>[W(J(Z(Y)("商品金额:")),1)])),_:1}),R(c,{class:"ti-total-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=m.value)?void 0:e.subtotal)||0)),1)]})),_:1}),R(c,{class:"ti-total-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=m.value)?void 0:e.subtotal)||0)),1)]})),_:1})])),_:1}),R(o,{class:"ti-cart-discount"},{default:U((()=>[R(o,{class:"ti-discount-item"},{default:U((()=>[R(o,null,{default:U((()=>[R(c,{class:"ti-discount-text"},{default:U((()=>[W(J(Z(Y)("服務費:")),1)])),_:1}),R(c,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=m.value)?void 0:e.service_money)||0)),1)]})),_:1}),R(c,{class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=m.value)?void 0:e.service_money)||0)),1)]})),_:1})])),_:1}),R(o,null,{default:U((()=>{var e;return[R(c,{class:"ti-discount-text"},{default:U((()=>[W(J(Z(Y)("優惠折扣:")),1)])),_:1}),R(c,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(`-${Z(se)((null==(e=m.value)?void 0:e.special_discount)||0)}`),1)]})),_:1}),Z(oe)((null==(e=m.value)?void 0:e.special_discount)||0)?(O(),L(c,{key:0,class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(`-${Z(oe)((null==(e=m.value)?void 0:e.special_discount)||0)}`),1)]})),_:1})):de("",!0)]})),_:1})])),_:1}),R(o,{class:"ti-discount-item"},{default:U((()=>[R(o,null,{default:U((()=>[R(c,{class:"ti-discount-text"},{default:U((()=>[W(J(Z(Y)("消費稅:")),1)])),_:1}),R(c,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=m.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1}),R(c,{class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=m.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1})])),_:1}),R(o,null,{default:U((()=>{var e;return[R(c,{class:"ti-discount-text"},{default:U((()=>[W(J(Z(Y)("會員折扣:")),1)])),_:1}),R(c,{class:"ti-discount-price"},{default:U((()=>{var e;return[W(J(`-${Z(se)((null==(e=m.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1}),Z(oe)((null==(e=m.value)?void 0:e.total_user_discount_money)||0)?(O(),L(c,{key:0,class:"ti-discount-subPrice"},{default:U((()=>{var e;return[W(J(`-${Z(oe)((null==(e=m.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1})):de("",!0)]})),_:1})])),_:1})])),_:1}),R(o,{class:"ti-cart-settlement"},{default:U((()=>{var e,t;return[R(o,{class:"ti-settlement-total"},{default:U((()=>[R(c,{class:"ti-settlement-text"},{default:U((()=>[W(J(Z(Y)("合计应收：")),1)])),_:1}),R(c,{class:"ti-settlement-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=m.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),R(c,{class:"ti-settlement-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=m.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1}),ge((O(),L(k,{class:"ti-settlement-btn",disabled:!(null==(e=m.value)?void 0:e.total_num)||(null==(t=m.value)?void 0:t.total_num)<=0,onClick:fe},{default:U((()=>{var e;return[R(c,null,{default:U((()=>[W(J(Z(Y)("結賬")),1)])),_:1}),(null==(e=m.value)?void 0:e.total_num)>0?(O(),L(c,{key:0,class:"ti-settlement-badge"},{default:U((()=>{var e;return[W(J(null==(e=m.value)?void 0:e.total_num),1)]})),_:1})):de("",!0)]})),_:1},8,["disabled"])),[[F,["cashier_table_settle"]]])]})),_:1})])),_:1})])),_:1}),R(ol,{productItem:p.value,totalPayPrice:null==(a=m.value)?void 0:a.total_pay_price,tableNo:D.value.table_no,orderList:y.value,tableId:_.value,preferentialData:w.value,isLock:Z(s),orderBuffetId:null==(n=T.value)?void 0:n.id,orderDelayId:null==(i=z.value)?void 0:i.id,totalNum:null==(r=m.value)?void 0:r.total_num,buffetList:S.value,buffetCustomerType:I.value,onBackTable:pe,onSuccess:me},null,8,["productItem","totalPayPrice","tableNo","orderList","tableId","preferentialData","isLock","orderBuffetId","orderDelayId","totalNum","buffetList","buffetCustomerType"]),R(hl,{show:f.value,"onUpdate:show":t[0]||(t[0]=e=>f.value=e),totalPayPrice:null==(u=m.value)?void 0:u.total_pay_price,orderId:g.value,memberDetail:d.value,onBackTable:pe,onSuccess:Q},null,8,["show","totalPayPrice","orderId","memberDetail"]),R(pl,{show:K.value,"onUpdate:show":t[1]||(t[1]=e=>K.value=e),payResult:H.value,onSuccess:G},null,8,["show","payResult"]),R(sl,{show:x.value,"onUpdate:show":t[2]||(t[2]=e=>x.value=e),cancelShow:!0,sendKitchen:E.value,msg:A.value,onConfirm:he},null,8,["show","sendKitchen","msg"])],64)}}},[["__scopeId","data-v-96d7b9a7"]]),gl=T({__name:"dish-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null},defaultIndex:{type:Number,default:0}},emits:["update:menuId"],setup(e,{emit:t}){const{pathName:a}=Se(Oe()),n=t,i=e,r=F(0),u=F(i.defaultIndex),s=F([]),o=F(),l=()=>{var e,t;if(!i.list||0==i.list.length||"desk"!=a.value)return;const n=qe().in(this);null==(e=i.list)||e.map(((e,t)=>{n.select(`#scroll-desk-${t}`).boundingClientRect((e=>{if(!e)return;const a=s.value;a[t]=e.width+10,s.value=a})).exec()})),c(u.value),null==(t=o.value)||t.getScrollWidth()};q((()=>a.value),(async()=>{await je(),l()}),{deep:!0,immediate:!0}),q((()=>i.list),(async()=>{await je(),l()}),{deep:!0,immediate:!0});const c=e=>{u.value=e,r.value=s.value.slice(0,e+1).reduce(((e,t)=>e+t),0)-(s.value[e]+100),n("update:menuId",i.list[e].category_id)};return(e,t)=>{const a=ce,n=$,s=N(M("ti-category"),_i);return O(),L(n,{class:"ti-dish-menu"},{default:U((()=>[i.list&&i.list.length>0?(O(),L(s,{key:0,ref_key:"scrollRef",ref:o,scrollLeft:r.value},{default:U((()=>[R(n,{class:"ti-menu-content"},{default:U((()=>[(O(!0),X(ee,null,te(i.list,((e,t)=>(O(),L(n,{key:t,class:j(["ti-menu-item",{active:t==u.value}]),id:`scroll-desk-${t}`,onClick:e=>c(t)},{default:U((()=>[R(a,{class:"ti-menu-title"},{default:U((()=>[W(J(e.name[Z(fe)()]||e.name_text),1)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scrollLeft"])):de("",!0)])),_:1})}}},[["__scopeId","data-v-bc6a03c5"]]),yl=T({__name:"dish-category",props:{categoryId:{type:Number,default:null}},emits:["update:categoryId","update:isSpecial"],setup(e,{emit:t}){const a=We(),{categoryList:n}=Se(a),i=t,r=F(),u=F(0),s=F(0),o=ne((()=>{let e=(n.value.find((e=>e.category_id==u.value))||{}).child||[];return e&&e.length>0&&(e=[Je].concat(e)),e})),l=ne((()=>n.value.find((e=>e.category_id==u.value)))),c=ne((()=>o.value.find((e=>e.category_id==s.value))));q((()=>u.value),(()=>{var e,t;i("update:isSpecial",null==(e=l.value)?void 0:e.is_special),i("update:categoryId",u.value),o.value&&o.value.length>0&&(s.value=o.value[0].category_id,d(s.value)),null==(t=r.value)||t.getScrollWidth()}));const d=e=>{var t;s.value=e,i("update:isSpecial",null==(t=c.value)?void 0:t.is_special),i("update:categoryId",s.value>0?s.value:u.value)};return null==a||a.getCategory(),(e,t)=>{const a=$,i=N(M("ti-category"),_i);return O(),L(a,{class:"ti-category-content"},{default:U((()=>[R(gl,{list:Z(n),menuId:u.value,"onUpdate:menuId":t[0]||(t[0]=e=>u.value=e)},null,8,["list","menuId"]),o.value&&o.value.length>0?(O(),L(a,{key:0,class:"ti-dish-secondary"},{default:U((()=>[R(i,{ref_key:"categoryRef",ref:r},{default:U((()=>[R(a,{class:"ti-secondary-box"},{default:U((()=>[(O(!0),X(ee,null,te(o.value,((e,t)=>(O(),L(a,{key:t,class:j([{active:e.category_id==s.value},"ti-secondary-item"]),onClick:t=>d(e.category_id)},{default:U((()=>[W(J(e.name[Z(fe)()]||e.name_text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},512)])),_:1})):de("",!0)])),_:1})}}},[["__scopeId","data-v-b5ee87b5"]]),Dl=T({__name:"goods-detail",props:{show:{type:Boolean,default:!1},goodsDetail:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F({}),r=F(!1),u=F({product_id:null,product_num:1,price:null,product_price:null,product_sku_id:null,attr:[],feed_uuids:[],bag_price:0,delivery:40,describe:null});q((()=>n.show),(()=>{n.show&&s()}));const s=()=>{var e,t,a,r,s,o,l,c,d;i.value=n.goodsDetail,u.value.product_id=null==(e=i.value)?void 0:e.product_id,u.value.price=null==(t=i.value)?void 0:t.product_price,u.value.product_price=null==(a=i.value)?void 0:a.product_price,(null==(r=i.value)?void 0:r.sku)&&(null==(s=i.value)?void 0:s.sku.length)>0&&(null==(o=i.value)||o.sku.some((e=>{if(e.stock_num>0)return u.value.product_sku_id=e.product_sku_id,!0}))),(null==(l=i.value)?void 0:l.product_attr)&&(null==(c=i.value)?void 0:c.product_attr.length)>0&&(null==(d=i.value)||d.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value_text)&&(null==e?void 0:e.attribute_value_text.length)>0?u.value.attr[t]=0:u.value.attr[t]=null}))),u.value.feed_uuids&&u.value.feed_uuids.length>0&&(u.value.feed_uuids=[])},o=async()=>{var e,t,n;if(r.value)return;const s={...u.value};s.attr=s.attr.join(",");let o=[];if(u.value.product_sku_id&&(null==(e=i.value)?void 0:e.sku)&&(null==(t=i.value)?void 0:t.sku.length)>0){const e=null==(n=i.value)?void 0:n.sku.find((e=>e.product_sku_id==u.value.product_sku_id));s.price=(null==e?void 0:e.product_price)||0,o.push(null==e?void 0:e.spec_name)}u.value.attr&&u.value.attr.length>0&&u.value.attr.map(((e,t)=>{var a;const n=null==(a=i.value)?void 0:a.product_attr[t];(null==n?void 0:n.attribute_value)&&n.attribute_value[e]&&o.push(n.attribute_value[e])})),u.value.feed_uuids&&u.value.feed_uuids.length>0&&u.value.feed_uuids.map((e=>{var t;const a=((null==(t=i.value)?void 0:t.feed)||[]).find((t=>t.product_feed_id==e));o.push(null==a?void 0:a.feed_name),s.price=Uo(s.price,null==a?void 0:a.price)})),s.describe=o.join(";"),s.table_id=Qe(),s.is_buffet=i.value.is_buffet;try{r.value=!0;const e=await $o(s);if(uni.showToast({title:e.msg,icon:"none"}),0==e.code)return;a("update:show",!1),a("success",{order_id:e.data.order_id,...e.data.res},"add")}catch(l){}finally{r.value=!1}},l=(e,t)=>u.value.attr[e]==t;return(e,t)=>{const s=N(M("ti-image"),Ye),c=$,d=ce,f=ae,h=N(M("ti-modal"),H);return O(),L(h,{show:n.show,title:Z(Y)("商品详情"),class:"ti-goods-detail",confirmLoading:r.value,onCancel:t[0]||(t[0]=e=>a("update:show",!1)),onConfirm:o},{content:U((()=>[R(c,{class:"ti-dialog-content"},{default:U((()=>[R(c,{class:"ti-detail-box"},{default:U((()=>[R(c,{class:"ti-detail-image"},{default:U((()=>{var e,t;return[R(s,{class:"ti-detail-image",src:Z(Fe)(null==(t=null==(e=i.value)?void 0:e.image[0])?void 0:t.file_path,107,80)||""},null,8,["src"])]})),_:1}),R(c,{class:"ti-detail-con"},{default:U((()=>[R(c,{class:"ti-detail-title text-ellipsis"},{default:U((()=>{var e,t;return[W(J((null==(e=i.value)?void 0:e.product_name[Z(fe)()])||(null==(t=i.value)?void 0:t.product_name_text)),1)]})),_:1}),R(c,{class:"ti-price-box"},{default:U((()=>[R(d,{class:"ti-detail-unit"},{default:U((()=>[W(J(Z(Y)("單價：")),1)])),_:1}),R(d,{class:"ti-detail-price"},{default:U((()=>{var e;return[W(J(Z(se)((null==(e=i.value)?void 0:e.product_price)||0)),1)]})),_:1}),R(d,{class:"ti-detail-subPrice"},{default:U((()=>{var e;return[W(J(Z(oe)((null==(e=i.value)?void 0:e.product_price)||0)),1)]})),_:1})])),_:1}),R(c,{class:"ti-price-box"},{default:U((()=>[R(d,{class:"ti-detail-unit"},{default:U((()=>[W(J(Z(Y)("單位：")),1)])),_:1}),R(d,{class:"ti-detail-price"},{default:U((()=>{var e,t;return[W(J((null==(e=i.value)?void 0:e.product_unit[Z(fe)()])||(null==(t=i.value)?void 0:t.product_unit_text)),1)]})),_:1})])),_:1})])),_:1})])),_:1}),R(c,{class:"ti-detail-specs"},{default:U((()=>[R(f,{"scroll-y":""},{default:U((()=>[R(c,{class:"ti-specs-box"},{default:U((()=>{var e,t,a,n,r,s,o;return[(null==(e=i.value)?void 0:e.sku)&&(null==(t=i.value)?void 0:t.sku.length)>0?(O(),L(c,{key:0,class:"ti-specs-item"},{default:U((()=>[R(c,{class:"ti-specs-title"},{default:U((()=>[W(J(Z(Y)("規格")),1)])),_:1}),R(c,{class:"ti-specs-child"},{default:U((()=>{var e;return[(O(!0),X(ee,null,te(null==(e=i.value)?void 0:e.sku,(e=>(O(),L(c,{key:e.product_sku_id,class:j([{active:e.product_sku_id==u.value.product_sku_id,disabled:e.stock_num<=0},"ti-child-item"]),onClick:t=>(e=>{e.stock_num<=0||u.value.product_sku_id!=e.product_sku_id&&(u.value.product_sku_id=e.product_sku_id)})(e)},{default:U((()=>[R(d,{class:"ti-child-name"},{default:U((()=>[W(J(e.spec_name_i18n[Z(fe)()]||e.spec_name_text),1)])),_:2},1024),R(d,{class:"ti-child-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.product_price)||0,!0)),1)])),_:2},1024),R(d,{class:"ti-child-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.product_price)||0,!0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):de("",!0),(null==(a=i.value)?void 0:a.product_attr)&&(null==(n=i.value)?void 0:n.product_attr.length)>0?(O(!0),X(ee,{key:1},te(null==(r=i.value)?void 0:r.product_attr,((e,t)=>(O(),L(c,{key:t,class:"ti-specs-item"},{default:U((()=>[R(c,{class:"ti-specs-title"},{default:U((()=>[W(J(e.attribute_name_i18n[Z(fe)()]||e.attribute_name_text),1)])),_:2},1024),R(c,{class:"ti-specs-child"},{default:U((()=>[(O(!0),X(ee,null,te(null==e?void 0:e.attribute_value_i18n,((a,n)=>(O(),L(c,{key:n,class:j([{active:l(t,n)},"ti-child-item"]),onClick:e=>((e,t)=>{u.value.attr[e]=t})(t,n)},{default:U((()=>[R(d,{class:"ti-child-name"},{default:U((()=>[W(J(a[Z(fe)()]||(null==e?void 0:e.attribute_value_text[n])),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128)):de("",!0),(null==(s=i.value)?void 0:s.feed)&&(null==(o=i.value)?void 0:o.feed.length)>0?(O(),L(c,{key:2,class:"ti-specs-item"},{default:U((()=>[R(c,{class:"ti-specs-title"},{default:U((()=>[W(J(Z(Y)("加料")),1)])),_:1}),R(c,{class:"ti-specs-child"},{default:U((()=>{var e;return[(O(!0),X(ee,null,te(null==(e=i.value)?void 0:e.feed,(e=>(O(),L(c,{key:e.product_feed_id,class:j([{active:(u.value.feed_uuids||[]).indexOf(e.product_feed_id)>-1,disabled:e.stock_num<=0},"ti-child-item"]),onClick:t=>(e=>{if(e.stock_num<=0)return;const t=e.product_feed_id,a=u.value.feed_uuids.indexOf(t);a>=0?u.value.feed_uuids.splice(a,1):u.value.feed_uuids.push(t)})(e)},{default:U((()=>[R(d,{class:"ti-child-name"},{default:U((()=>[W(J(e.feed_name_i18n[Z(fe)()]||e.feed_name_text),1)])),_:2},1024),R(d,{class:"ti-child-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.price)||0,!0)),1)])),_:2},1024),R(d,{class:"ti-child-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.price)||0,!0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):de("",!0)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title","confirmLoading"])}}},[["__scopeId","data-v-c068da8e"]]),wl=T({__name:"dish-list",props:{orderId:{type:[Number,String],default:""}},emits:["success"],setup(e,{emit:t}){const{pathName:a}=Se(Oe()),n=We(),i=Xe(),r=Be(),{buffetConfig:u}=Se(r),{isBuffet:s,buffetTime:o,isUnlimitedTime:l}=Se(Vo()),{tableIsLock:c}=Se(Jn()),d=t,f=e,h=F({category_id:null,page:1,list_rows:10}),p=F(0),v=F({}),m=F(!1),_=F(!1),g=F(),y=F([]),D=F(!1),w=F(!1),b=(e,t,a)=>{d("success",e,t,a)},C=()=>{D.value&&(h.value.page++,x())},A=async()=>{var e,t;if(f.orderId<=0)return uni.showToast({title:Y("订单ID不存在"),icon:"none"});try{const a=await Hn({order_id:f.orderId});uni.showToast({title:a.msg,icon:"none"}),c.value=(null==(t=null==(e=a.data.res)?void 0:e.orderInfo)?void 0:t.is_lock)||0}catch(a){}},k=async e=>{var t,a;if(1==c.value)return uni.showToast({title:Y("订单已被锁定，请解锁后重新操作"),icon:"none"});if(e.product_stock<=0)return uni.showToast({title:Y("已售罄"),icon:"none"});if(1==e.limit_num_status)return uni.showToast({title:Y("已限购"),icon:"none"});if((e=>{var t;if(1==s.value&&-1!=l.value&&o.value<=0){if(1==e.is_buffet)return!0;if(0==(null==(t=u.value)?void 0:t.is_buy_continue))return!0}return!1})(e))return v.value=e,void(m.value=!0);if((null==e?void 0:e.sku)&&(null==e?void 0:e.sku.length)<=1&&(!(null==e?void 0:e.product_attr)||(null==e?void 0:e.product_attr.length)<=0)&&(!e.feed||e.feed.length<=0)){const n={product_id:e.product_id,product_num:1,price:(null==e?void 0:e.product_price)||0,product_price:(null==e?void 0:e.product_price)||0,product_sku_id:null==(t=null==e?void 0:e.sku[0])?void 0:t.product_sku_id,attr:[],feed:[],bag_price:0,delivery:40,describe:null==(a=null==e?void 0:e.sku[0])?void 0:a.spec_name,is_buffet:null==e?void 0:e.is_buffet,table_id:Qe()},i=await $o(n);return uni.showToast({title:i.msg,icon:"none"}),void b({order_id:i.data.order_id,...i.data.res},"add")}g.value=e,_.value=!0},x=async()=>{const e={...h.value};e.category_id||(e.category_id="0"),1==p.value&&(e.is_special=1);try{w.value=!0;const t=await(null==i?void 0:i.getGoodsList(e)),a=i.getGoodsInfo((null==t?void 0:t.list)||[]);y.value=1==e.page?a:y.value.concat(a),D.value=(null==t?void 0:t.last_page)>(null==t?void 0:t.current_page)}catch(t){uni.showToast({title:t.toString(),icon:"none"})}finally{w.value=!1}},E=()=>{y.value=[],h.value.page=1,D.value=!1,x()};return Ue("langChange",(()=>{null==n||n.getCategory()})),q((()=>h.value.category_id),(()=>{E()})),q((()=>a.value),(()=>{"desk"==a.value&&E()})),(e,t)=>{const a=N(M("ti-loading"),ie),n=$,i=N(M("ti-image"),Ye),r=ce,s=N(M("ti-empty-data"),re),o=ae,l=N(M("ti-modal"),H);return O(),X(ee,null,[R(n,{class:"ti-dish-box"},{default:U((()=>[R(yl,{categoryId:h.value.category_id,"onUpdate:categoryId":t[0]||(t[0]=e=>h.value.category_id=e),isSpecial:p.value,"onUpdate:isSpecial":t[1]||(t[1]=e=>p.value=e)},null,8,["categoryId","isSpecial"]),R(n,{class:"ti-dish-list"},{default:U((()=>[R(o,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:C},{default:U((()=>[w.value&&1==h.value.page?(O(),L(a,{key:0})):y.value&&y.value.length>0?(O(),X(ee,{key:1},[R(n,{class:"ti-dish-goods"},{default:U((()=>[(O(!0),X(ee,null,te(y.value,((e,t)=>(O(),L(n,{key:t,class:"ti-goods-item",onClick:t=>k(e)},{default:U((()=>[!e.product_stock||e.product_stock<=0?(O(),L(n,{key:0,class:"ti-goods-sold-out"},{default:U((()=>[W(J(Z(Y)("已售罄")),1)])),_:1})):1==e.limit_num_status?(O(),L(n,{key:1,class:"ti-goods-sold-out"},{default:U((()=>[W(J(Z(Y)("已限购")),1)])),_:1})):de("",!0),R(n,{class:j(["ti-goods-box",{"ti-goods-disabled":e.product_stock<=0||1==e.limit_num_status}])},{default:U((()=>[1==(null==e?void 0:e.is_buffet)&&(null==e?void 0:e.buffet_limit_num)>0||0==(null==e?void 0:e.is_buffet)&&(null==e?void 0:e.limit_num)>0?(O(),L(n,{key:0,class:"ti-goods-quota"},{default:U((()=>[W(J(Z(ye)("限購{count}份",{count:1==(null==e?void 0:e.is_buffet)?null==e?void 0:e.buffet_limit_num:(null==e?void 0:e.limit_num)||0})),1)])),_:2},1024)):de("",!0),R(n,{class:"ti-goods-image"},{default:U((()=>{var t;return[R(i,{src:Z(Fe)(null==(t=e.image[0])?void 0:t.file_path,147,110)||""},null,8,["src"])]})),_:2},1024),R(n,{class:"ti-goods-content"},{default:U((()=>[R(n,{class:"ti-goods-title line-clamp-2"},{default:U((()=>[W(J(e.product_name[Z(fe)()]||e.product_name_text||"-"),1)])),_:2},1024),R(n,{class:"ti-price-box"},{default:U((()=>[R(r,{class:"ti-goods-price"},{default:U((()=>[W(J(Z(se)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),R(r,{class:"ti-goods-subPrice"},{default:U((()=>[W(J(Z(oe)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1}),R(a,{status:D.value?"loading":"no-more"},null,8,["status"])],64)):(O(),L(s,{key:2}))])),_:1})])),_:1}),1==Z(c)?(O(),L(ml,{key:0,onUnlock:A})):de("",!0)])),_:1}),R(Dl,{show:_.value,"onUpdate:show":t[2]||(t[2]=e=>_.value=e),goodsDetail:g.value,onSuccess:b},null,8,["show","goodsDetail"]),R(l,{class:"ti-action-tips",title:Z(Y)("溫馨提示"),show:m.value,isCancelShow:!1,onConfirm:t[3]||(t[3]=e=>m.value=!1)},{content:U((()=>[R(n,{class:"ti-dialog-content"},{default:U((()=>{var e,t;return[W(J(1==(null==(e=v.value)?void 0:e.is_buffet)&&1==(null==(t=Z(u))?void 0:t.is_buy_continue)?Z(Y)("自助餐时间已到达，自助餐商品不可继续下单"):Z(Y)("用餐时间已到，无法继续下单")),1)]})),_:1})])),_:1},8,["title","show"])],64)}}},[["__scopeId","data-v-292aa93c"]]),bl=T({__name:"index",emits:["change"],setup(e,{emit:t}){const a=We(),n=t,i=F(),r=F(),u=(e,t,a)=>{var n;null==(n=i.value)||n.handleResultCart(e,t,a)},s=e=>{r.value=e};return ut((()=>{st()})),Ue("langChange",(()=>{null==a||a.getCategory()})),(e,t)=>{const a=$;return O(),L(a,{class:"ti-order-food"},{default:U((()=>[R(_l,{ref_key:"cartRef",ref:i,onOrderID:s,onChange:t[0]||(t[0]=e=>n("change"))},null,512),R(wl,{orderId:r.value,onSuccess:u},null,8,["orderId"])])),_:1})}}},[["__scopeId","data-v-f1fb2d9e"]]),Cl=T({__name:"cancel-all",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},list:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=async()=>{var e;if(!i.value)try{i.value=!0;const t=await(e={table_id:n.tableId},k("order.HallCart/cancel",e));a("update:show",!1),a("success"),setTimeout((()=>{uni.showToast({title:t.msg,icon:"none"})}),100)}catch(t){}finally{i.value=!1}};return(t,u)=>{const s=$,o=ae,l=N(M("ti-modal"),H);return O(),L(l,{class:"ti-action-tips",title:t.$t("溫馨提示"),show:n.show,confirmLoading:i.value,onCancel:u[0]||(u[0]=e=>a("update:show",!1)),onConfirm:r},{content:U((()=>[R(s,{class:"ti-dialog-content"},{default:U((()=>[n.list&&e.list.length>0?(O(),X(ee,{key:0},[R(s,{class:"ti-cancel-title"},{default:U((()=>[W(J(t.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),R(o,{"scroll-y":""},{default:U((()=>[R(s,{class:"ti-cancel-list"},{default:U((()=>[(O(!0),X(ee,null,te(n.list,((e,t)=>(O(),L(s,{key:t,class:"ti-cancel-item"},{default:U((()=>[W(J(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})],64)):(O(),X(ee,{key:1},[W(J(t.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-3f21f172"]]),Al=T({__name:"count-down",props:{time:{type:[Number,String],default:null},reverse:{type:Boolean,default:!1},unlimitedTime:{type:Number,default:0}},setup(e){const{cashier:t}=Se(Be()),a=e,n=F(),i=F(0),r=F("00:00"),u=ne((()=>{var e,n,r,u,s;return-1==a.unlimitedTime?"#100a05":a.reverse?i.value<600&&"1"==(null==(e=t.value)?void 0:e.is_remain_color)&&(null==(n=t.value)?void 0:n.remain_color.length)>0?t.value.remain_color[0]:i.value<1200&&"1"==(null==(r=t.value)?void 0:r.is_remain_color)&&(null==(u=t.value)?void 0:u.remain_color.length)>1?null==(s=t.value)?void 0:s.remain_color[1]:"#100a05":"#100a05"}));q((()=>a.time),(()=>{n.value&&clearInterval(n.value),-1==a.unlimitedTime?r.value=Y("不限时"):a.time>0&&(i.value=a.time,n.value=setInterval((()=>{if(a.reverse){if(0==i.value)return;i.value--}else i.value++;s(i.value)}),1e3))}),{immediate:!0}),Le((()=>{n.value&&clearInterval(n.value)}));const s=e=>{const t=Math.floor((e||0)/3600),a=Math.floor((e||0)/60)%60,n=Math.floor(e||0)%60;let i="";t>0&&(i+=`${o(t)}:`),i+=`${o(a)}:${o(n)}`,r.value=i},o=e=>e<10?`0${e}`:e;return(e,t)=>{const a=$;return O(),L(a,{class:"ti-dining-info-text",style:z({color:u.value})},{default:U((()=>[W(J(r.value),1)])),_:1},8,["style"])}}},[["__scopeId","data-v-dd41a47a"]]),kl=T({__name:"index",emits:["change"],setup(e,{emit:t}){const{pathName:a}=Se(Oe()),n=t,i=F({area_id:"",type_id:"",table_status:""}),r=F(!1),u=F(!1),s=F([]),o=F(),l=F(),c=F([]),d=F([]),f=ne((()=>o.value-l.value)),h=F(),p=F(!1),v=F(),m=F([]),_=F(!1),g=F(),y=F(),D=Be(),{allPermission:w}=Se(D);q((()=>i.value),(()=>{I(!0)}),{deep:!0});const b=()=>{i.value.area_id="",i.value.type_id="",i.value.table_status=""},C=async e=>{try{const a=await(t=e.table_id,k("order.HallCart/getTableInfo",{table_id:t}));if(a.data.status!=e.status&&I(),30!=a.data.status){if(!(w.value||[]).includes("cashier_table_open"))return uni.showToast({title:Y("当前没有权限使用此功能"),icon:"none"});y.value=e.table_no,g.value=e.table_id,_.value=!0}else et(e.table_id),n("change")}catch(a){}var t},A=async e=>{var t,a,n;try{const i=await(n={table_id:e},k("order.HallCart/getSendKitchen",n));m.value=(null==(a=null==(t=i.data)?void 0:t.detail)?void 0:a.sendKitchenProduct)||[],p.value=!0,v.value=e}catch(i){}},x=F(),E=F(!1),I=async e=>{var t,n,r;if(u.value)return T();if(E.value)return T();if(!ot())return T();try{e&&(u.value=!0),E.value=!0;const a=await Qo(i.value);s.value=(null==(t=a.data)?void 0:t.list)||[],o.value=(null==(n=a.data)?void 0:n.total_num)||0,l.value=(null==(r=a.data)?void 0:r.available_num)||0}catch(c){}finally{e&&(u.value=!1),"desk"==a.value&&T()}},T=()=>{E.value=!1,clearTimeout(x.value),x.value=null,x.value=setTimeout((()=>{I(!1)}),15e3)},S=async()=>{var e,t,a;try{const n=await k("store.table/tableType",a,{isLoading:!1});c.value=(null==(e=n.data)?void 0:e.areaList)||[],d.value=(null==(t=n.data)?void 0:t.typeList)||[],je((()=>{var e;null==(e=h.value)||e.getScrollWidth()}))}catch(n){}};return Ue("tableRefresh",(()=>{I(!0)})),lt((()=>{ct("tableRefresh"),x.value&&clearTimeout(x.value)})),q((()=>a.value),(()=>{"desk"==a.value?(S(),I(!0)):x.value&&clearTimeout(x.value)}),{immediate:!0}),(e,t)=>{const a=$,D=N(M("ti-category"),_i),w=N(M("ti-loading"),ie),k=N(M("uni-icons"),Ce),x=ce,E=N(M("ti-empty-data"),re),F=ae;return O(),X(ee,null,[R(a,{class:"ti-dining-box"},{default:U((()=>[R(a,{class:"ti-dining-category"},{default:U((()=>[R(D,{ref_key:"categoryRef",ref:h},{default:U((()=>[R(a,{class:"ti-category-list"},{default:U((()=>[R(a,{class:"ti-category-item"},{default:U((()=>[R(a,{class:j(["ti-category-all",{active:""==i.value.area_id}]),onClick:t[0]||(t[0]=e=>i.value.area_id=""),onDblclick:b},{default:U((()=>[W(J(Z(Y)("全部")),1)])),_:1},8,["class"]),R(a,{class:"ti-category-child"},{default:U((()=>[(O(!0),X(ee,null,te(c.value,(e=>(O(),L(a,{key:e.area_id,class:j([{active:i.value.area_id==e.area_id,onlyOne:1==d.value.length},"ti-category-childItem"]),onClick:t=>i.value.area_id=e.area_id},{default:U((()=>[W(J(e.area_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),R(a,{class:"ti-category-item"},{default:U((()=>[R(a,{class:j(["ti-category-all",{active:""==i.value.type_id}]),onClick:t[1]||(t[1]=e=>i.value.type_id="")},{default:U((()=>[W(J(Z(Y)("全部")),1)])),_:1},8,["class"]),R(a,{class:"ti-category-child"},{default:U((()=>[(O(!0),X(ee,null,te(d.value,(e=>(O(),L(a,{key:e.type_id,class:j([{active:i.value.type_id==e.type_id,onlyOne:1==d.value.length},"ti-category-childItem"]),onClick:t=>i.value.type_id=e.type_id},{default:U((()=>[W(J(e.type_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),R(a,{class:"ti-category-item"},{default:U((()=>[R(a,{class:j(["ti-category-all",{active:""==i.value.table_status}]),onClick:t[2]||(t[2]=e=>i.value.table_status="")},{default:U((()=>[W(J(Z(Y)("全部")),1)])),_:1},8,["class"]),R(a,{class:"ti-category-child"},{default:U((()=>[R(a,{class:j(["ti-category-childItem",{active:"10"==i.value.table_status}]),onClick:t[3]||(t[3]=e=>i.value.table_status="10")},{default:U((()=>[W(J(Z(Y)("可用"))+" ("+J(l.value||0)+") ",1)])),_:1},8,["class"]),R(a,{class:j(["ti-category-childItem",{active:"30"==i.value.table_status}]),onClick:t[4]||(t[4]=e=>i.value.table_status="30")},{default:U((()=>[W(J(Z(Y)("佔用"))+" ("+J(f.value||0)+") ",1)])),_:1},8,["class"])])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1}),R(a,{class:"ti-dining-table"},{default:U((()=>[R(F,{class:"ti-scroll","scroll-y":""},{default:U((()=>[u.value?(O(),L(w,{key:0})):s.value&&s.value.length>0?(O(),X(ee,{key:1},[R(a,{class:"ti-dining-list"},{default:U((()=>[(O(!0),X(ee,null,te(s.value,(e=>(O(),L(a,{key:e.table_id,class:j([{green:30!=e.status},"ti-dining-item"]),onClick:t=>C(e)},{default:U((()=>[R(a,{class:"ti-dining-number"},{default:U((()=>[W(J(e.table_no),1)])),_:2},1024),30!=e.status?(O(),L(a,{key:0,class:"ti-dining-idle"},{default:U((()=>[W(J(Z(Y)("空闲中")),1)])),_:1})):(O(),X(ee,{key:1},[R(a,{class:"ti-dining-info"},{default:U((()=>[R(a,{class:"ti-dining-info-item"},{default:U((()=>[R(a,{class:"ti-dining-info-icon"},{default:U((()=>[R(k,{"custom-prefix":"iconfont",type:"icon-user",size:"18",color:"#100A05"})])),_:1}),R(a,{class:"ti-dining-info-text"},{default:U((()=>{var t;return[W(J((null==(t=e.underwayOrder)?void 0:t.meal_num)||0),1)]})),_:2},1024)])),_:2},1024),R(a,{class:"ti-dining-info-item"},{default:U((()=>[R(a,{class:"ti-dining-info-icon"},{default:U((()=>[R(k,{"custom-prefix":"iconfont",type:"icon-wallet",size:"18",color:"#100A05"})])),_:1}),R(a,{class:"ti-dining-info-text"},{default:U((()=>[R(x,{class:"ti-dining-info-price"},{default:U((()=>{var t;return[W(J(Z(se)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024),R(x,{class:"ti-dining-info-subPrice"},{default:U((()=>{var t;return[W(J(Z(oe)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024),R(a,{class:"ti-dining-info-item"},{default:U((()=>{var t,n,i,r,u;return[R(a,{class:"ti-dining-info-icon"},{default:U((()=>[R(k,{"custom-prefix":"iconfont",type:"icon-clock",size:"18",color:"#100A05"})])),_:1}),R(Al,{time:1==(null==(t=e.underwayOrder)?void 0:t.is_buffet)?null==(n=e.underwayOrder)?void 0:n.buffet_remaining_time:null==(i=e.underwayOrder)?void 0:i.elapsed_time,reverse:1==(null==(r=e.underwayOrder)?void 0:r.is_buffet),unlimitedTime:null==(u=e.underwayOrder)?void 0:u.buffet_expired_time},null,8,["time","reverse","unlimitedTime"])]})),_:2},1024)])),_:2},1024),R(a,{class:"ti-dining-close",onClick:Ae((t=>A(e.table_id)),["stop"])},{default:U((()=>[R(k,{type:"closeempty",size:"14",color:"#fff"})])),_:2},1032,["onClick"])],64))])),_:2},1032,["class","onClick"])))),128))])),_:1}),R(w,{status:r.value?"loading":"no-more"},null,8,["status"])],64)):(O(),L(E,{key:2}))])),_:1})])),_:1}),R(a,{class:"ti-dining-total"},{default:U((()=>[R(a,{class:"ti-dining-total-box"},{default:U((()=>[R(a,{class:"ti-dining-total-item"},{default:U((()=>[W(J(Z(Y)("全部"))+" ("+J(o.value)+")",1)])),_:1}),R(a,{class:"ti-dining-total-item"},{default:U((()=>[R(a,{class:"ti-dining-total-color green"}),R(a,null,{default:U((()=>[W(J(Z(Y)("可用"))+" ("+J(l.value||0)+")",1)])),_:1})])),_:1}),R(a,{class:"ti-dining-total-item"},{default:U((()=>[R(a,{class:"ti-dining-total-color orange"}),R(a,null,{default:U((()=>[W(J(Z(Y)("佔用"))+" ("+J(f.value||0)+")",1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),R(Cl,{show:p.value,"onUpdate:show":t[5]||(t[5]=e=>p.value=e),tableId:v.value,list:m.value,onSuccess:t[6]||(t[6]=e=>I())},null,8,["show","tableId","list"]),R(ul,{show:_.value,"onUpdate:show":t[7]||(t[7]=e=>_.value=e),tableId:g.value,tableNo:y.value,onSuccess:t[8]||(t[8]=e=>n("change"))},null,8,["show","tableId","tableNo"])],64)}}},[["__scopeId","data-v-07a81ce5"]]),xl=T({__name:"index",setup(e){const t=F(),a=()=>{t.value=!!Qe()};return Ue("reDesk",(()=>{a()})),Ke((()=>{a()})),(e,n)=>{const i=$;return O(),L(i,{class:"ti-desk"},{default:U((()=>[t.value?(O(),L(bl,{key:0,onChange:a})):(O(),L(kl,{key:1,onChange:a}))])),_:1})}}},[["__scopeId","data-v-c6ab73f1"]]),El={easycom:{autoscan:!0,custom:{"^u--(.*)":"uview-plus/components/u-$1/u-$1.vue","^up-(.*)":"uview-plus/components/u-$1/u-$1.vue","^u-([^-].*)":"uview-plus/components/u-$1/u-$1.vue","^uni-(.*)":"@dcloudio/uni-ui/lib/uni-$1/uni-$1.vue"}},pages:[{path:"pages/launch/index",style:{navigationBarTitleText:"JBCレジ",navigationStyle:"custom",statusBar:{style:"none"}}},{path:"pages/login/index",style:{navigationBarTitleText:"JBCレジ",navigationStyle:"custom",statusBar:{style:"none"}}},{path:"pages/lock/index",style:{navigationBarTitleText:"JBCレジ",navigationStyle:"custom",statusBar:{style:"none"}}},{path:"pages/index/index",style:{navigationBarTitleText:"JBCレジ",navigationStyle:"custom",statusBar:{style:"none"}}}],globalStyle:{navigationBarTextStyle:"black",navigationBarTitleText:"JBCレジ",navigationBarBackgroundColor:"#ffbe00",backgroundColor:"#ffbe00"},tabBar:{custom:!0,color:"#100a05",selectedColor:"#ffbe00",backgroundColor:"white",list:[{pagePath:"pages/index/index",iconPath:"",selectedIconPath:"",text:"首页"}]}};function Fl(e,t,a){return e(a={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&a.path)}},a.exports),a.exports}var Il=Fl((function(e,t){var a;e.exports=(a=a||function(e,t){var a=Object.create||function(){function e(){}return function(t){var a;return e.prototype=t,a=new e,e.prototype=null,a}}(),n={},i=n.lib={},r=i.Base={extend:function(e){var t=a(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=i.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||o).stringify(this)},concat:function(e){var t=this.words,a=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var r=0;r<i;r++){var u=a[r>>>2]>>>24-r%4*8&255;t[n+r>>>2]|=u<<24-(n+r)%4*8}else for(r=0;r<i;r+=4)t[n+r>>>2]=a[r>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,a=this.sigBytes;t[a>>>2]&=4294967295<<32-a%4*8,t.length=e.ceil(a/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var a,n=[],i=function(t){var a=987654321,n=4294967295;return function(){var i=((a=36969*(65535&a)+(a>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},r=0;r<t;r+=4){var s=i(4294967296*(a||e.random()));a=987654071*s(),n.push(4294967296*s()|0)}return new u.init(n,t)}}),s=n.enc={},o=s.Hex={stringify:function(e){for(var t=e.words,a=e.sigBytes,n=[],i=0;i<a;i++){var r=t[i>>>2]>>>24-i%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,a=[],n=0;n<t;n+=2)a[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new u.init(a,t/2)}},l=s.Latin1={stringify:function(e){for(var t=e.words,a=e.sigBytes,n=[],i=0;i<a;i++){var r=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(r))}return n.join("")},parse:function(e){for(var t=e.length,a=[],n=0;n<t;n++)a[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new u.init(a,t)}},c=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},d=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var a=this._data,n=a.words,i=a.sigBytes,r=this.blockSize,s=i/(4*r),o=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*r,l=e.min(4*o,i);if(o){for(var c=0;c<o;c+=r)this._doProcessBlock(n,c);var d=n.splice(0,o);a.sigBytes-=l}return new u.init(d,l)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=d.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,a){return new e.init(a).finalize(t)}},_createHmacHelper:function(e){return function(t,a){return new f.HMAC.init(e,a).finalize(t)}}});var f=n.algo={};return n}(Math),a)})),Tl=Il,Sl=(Fl((function(e,t){var a;e.exports=(a=Tl,function(e){var t=a,n=t.lib,i=n.WordArray,r=n.Hasher,u=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var o=u.MD5=r.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var a=0;a<16;a++){var n=t+a,i=e[n];e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var r=this._hash.words,u=e[t+0],o=e[t+1],h=e[t+2],p=e[t+3],v=e[t+4],m=e[t+5],_=e[t+6],g=e[t+7],y=e[t+8],D=e[t+9],w=e[t+10],b=e[t+11],C=e[t+12],A=e[t+13],k=e[t+14],x=e[t+15],E=r[0],F=r[1],I=r[2],T=r[3];E=l(E,F,I,T,u,7,s[0]),T=l(T,E,F,I,o,12,s[1]),I=l(I,T,E,F,h,17,s[2]),F=l(F,I,T,E,p,22,s[3]),E=l(E,F,I,T,v,7,s[4]),T=l(T,E,F,I,m,12,s[5]),I=l(I,T,E,F,_,17,s[6]),F=l(F,I,T,E,g,22,s[7]),E=l(E,F,I,T,y,7,s[8]),T=l(T,E,F,I,D,12,s[9]),I=l(I,T,E,F,w,17,s[10]),F=l(F,I,T,E,b,22,s[11]),E=l(E,F,I,T,C,7,s[12]),T=l(T,E,F,I,A,12,s[13]),I=l(I,T,E,F,k,17,s[14]),E=c(E,F=l(F,I,T,E,x,22,s[15]),I,T,o,5,s[16]),T=c(T,E,F,I,_,9,s[17]),I=c(I,T,E,F,b,14,s[18]),F=c(F,I,T,E,u,20,s[19]),E=c(E,F,I,T,m,5,s[20]),T=c(T,E,F,I,w,9,s[21]),I=c(I,T,E,F,x,14,s[22]),F=c(F,I,T,E,v,20,s[23]),E=c(E,F,I,T,D,5,s[24]),T=c(T,E,F,I,k,9,s[25]),I=c(I,T,E,F,p,14,s[26]),F=c(F,I,T,E,y,20,s[27]),E=c(E,F,I,T,A,5,s[28]),T=c(T,E,F,I,h,9,s[29]),I=c(I,T,E,F,g,14,s[30]),E=d(E,F=c(F,I,T,E,C,20,s[31]),I,T,m,4,s[32]),T=d(T,E,F,I,y,11,s[33]),I=d(I,T,E,F,b,16,s[34]),F=d(F,I,T,E,k,23,s[35]),E=d(E,F,I,T,o,4,s[36]),T=d(T,E,F,I,v,11,s[37]),I=d(I,T,E,F,g,16,s[38]),F=d(F,I,T,E,w,23,s[39]),E=d(E,F,I,T,A,4,s[40]),T=d(T,E,F,I,u,11,s[41]),I=d(I,T,E,F,p,16,s[42]),F=d(F,I,T,E,_,23,s[43]),E=d(E,F,I,T,D,4,s[44]),T=d(T,E,F,I,C,11,s[45]),I=d(I,T,E,F,x,16,s[46]),E=f(E,F=d(F,I,T,E,h,23,s[47]),I,T,u,6,s[48]),T=f(T,E,F,I,g,10,s[49]),I=f(I,T,E,F,k,15,s[50]),F=f(F,I,T,E,m,21,s[51]),E=f(E,F,I,T,C,6,s[52]),T=f(T,E,F,I,p,10,s[53]),I=f(I,T,E,F,w,15,s[54]),F=f(F,I,T,E,o,21,s[55]),E=f(E,F,I,T,y,6,s[56]),T=f(T,E,F,I,x,10,s[57]),I=f(I,T,E,F,_,15,s[58]),F=f(F,I,T,E,A,21,s[59]),E=f(E,F,I,T,v,6,s[60]),T=f(T,E,F,I,b,10,s[61]),I=f(I,T,E,F,h,15,s[62]),F=f(F,I,T,E,D,21,s[63]),r[0]=r[0]+E|0,r[1]=r[1]+F|0,r[2]=r[2]+I|0,r[3]=r[3]+T|0},_doFinalize:function(){var t=this._data,a=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;a[i>>>5]|=128<<24-i%32;var r=e.floor(n/4294967296),u=n;a[15+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),a[14+(i+64>>>9<<4)]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8),t.sigBytes=4*(a.length+1),this._process();for(var s=this._hash,o=s.words,l=0;l<4;l++){var c=o[l];o[l]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return s},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function l(e,t,a,n,i,r,u){var s=e+(t&a|~t&n)+i+u;return(s<<r|s>>>32-r)+t}function c(e,t,a,n,i,r,u){var s=e+(t&n|a&~n)+i+u;return(s<<r|s>>>32-r)+t}function d(e,t,a,n,i,r,u){var s=e+(t^a^n)+i+u;return(s<<r|s>>>32-r)+t}function f(e,t,a,n,i,r,u){var s=e+(a^(t|~n))+i+u;return(s<<r|s>>>32-r)+t}t.MD5=r._createHelper(o),t.HmacMD5=r._createHmacHelper(o)}(Math),a.MD5)})),Fl((function(e,t){var a,n,i;e.exports=(n=(a=Tl).lib.Base,i=a.enc.Utf8,void(a.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=i.parse(t));var a=e.blockSize,n=4*a;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),u=this._iKey=t.clone(),s=r.words,o=u.words,l=0;l<a;l++)s[l]^=1549556828,o[l]^=909522486;r.sigBytes=u.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,a=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(a))}})))})),Fl((function(e,t){e.exports=Tl.HmacMD5}))),Bl=Fl((function(e,t){e.exports=Tl.enc.Utf8})),Nl=Fl((function(e,t){var a,n,i;e.exports=(i=(n=a=Tl).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,a=e.sigBytes,n=this._map;e.clamp();for(var i=[],r=0;r<a;r+=3)for(var u=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,s=0;s<4&&r+.75*s<a;s++)i.push(n.charAt(u>>>6*(3-s)&63));var o=n.charAt(64);if(o)for(;i.length%4;)i.push(o);return i.join("")},parse:function(e){var t=e.length,a=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var r=0;r<a.length;r++)n[a.charCodeAt(r)]=r}var u=a.charAt(64);if(u){var s=e.indexOf(u);-1!==s&&(t=s)}return function(e,t,a){for(var n=[],r=0,u=0;u<t;u++)if(u%4){var s=a[e.charCodeAt(u-1)]<<u%4*2,o=a[e.charCodeAt(u)]>>>6-u%4*2;n[r>>>2]|=(s|o)<<24-r%4*8,r++}return i.create(n,r)}(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},a.enc.Base64)}));const Pl="FUNCTION",Ml="pending",Ol="rejected";function Ll(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function Ul(e){return"object"===Ll(e)}function Rl(e){return"function"==typeof e}function zl(e){return function(){try{return e.apply(e,arguments)}catch(t){}}}const jl="REJECTED",$l="NOT_PENDING";class ql{constructor({createPromise:e,retryRule:t=jl}={}){this.createPromise=e,this.status=null,this.promise=null,this.retryRule=t}get needRetry(){if(!this.status)return!0;switch(this.retryRule){case jl:return this.status===Ol;case $l:return this.status!==Ml}}exec(){return this.needRetry?(this.status=Ml,this.promise=this.createPromise().then((e=>(this.status="fulfilled",Promise.resolve(e))),(e=>(this.status=Ol,Promise.reject(e)))),this.promise):this.promise}}function Vl(e){return e&&"string"==typeof e?JSON.parse(e):e}const Kl=Vl([]),Hl="web";Vl("");const Wl=Vl("[]")||[];let Jl="";try{Jl="__UNI__7D5B57D"}catch(Oc){}let Zl={};function Yl(e,t={}){var a,n;return a=Zl,n=e,Object.prototype.hasOwnProperty.call(a,n)||(Zl[e]=t),Zl[e]}const Gl=["invoke","success","fail","complete"],Ql=Yl("_globalUniCloudInterceptor");function Xl(e,t){Ql[e]||(Ql[e]={}),Ul(t)&&Object.keys(t).forEach((a=>{Gl.indexOf(a)>-1&&function(e,t,a){let n=Ql[e][t];n||(n=Ql[e][t]=[]),-1===n.indexOf(a)&&Rl(a)&&n.push(a)}(e,a,t[a])}))}function ec(e,t){Ql[e]||(Ql[e]={}),Ul(t)?Object.keys(t).forEach((a=>{Gl.indexOf(a)>-1&&function(e,t,a){const n=Ql[e][t];if(!n)return;const i=n.indexOf(a);i>-1&&n.splice(i,1)}(e,a,t[a])})):delete Ql[e]}function tc(e,t){return e&&0!==e.length?e.reduce(((e,a)=>e.then((()=>a(t)))),Promise.resolve()):Promise.resolve()}function ac(e,t){return Ql[e]&&Ql[e][t]||[]}function nc(e){Xl("callObject",e)}const ic=Yl("_globalUniCloudListener"),rc="response",uc="needLogin",sc="refreshToken",oc="clientdb",lc="cloudfunction",cc="cloudobject";function dc(e){return ic[e]||(ic[e]=[]),ic[e]}function fc(e,t){const a=dc(e);a.includes(t)||a.push(t)}function hc(e,t){const a=dc(e),n=a.indexOf(t);-1!==n&&a.splice(n,1)}function pc(e,t){const a=dc(e);for(let n=0;n<a.length;n++)(0,a[n])(t)}let vc,mc=!1;function _c(){return vc||(vc=new Promise((e=>{mc&&e(),function t(){if("function"==typeof ht){const t=ht();t&&t[0]&&(mc=!0,e())}mc||setTimeout((()=>{t()}),30)}()})),vc)}function gc(e){const t={};for(const a in e){const n=e[a];Rl(n)&&(t[a]=zl(n))}return t}class yc extends Error{constructor(e){super(e.message),this.errMsg=e.message||e.errMsg||"unknown system error",this.code=this.errCode=e.code||e.errCode||"SYSTEM_ERROR",this.errSubject=this.subject=e.subject||e.errSubject,this.cause=e.cause,this.requestId=e.requestId}toJson(e=0){if(!(e>=10))return e++,{errCode:this.errCode,errMsg:this.errMsg,errSubject:this.errSubject,cause:this.cause&&this.cause.toJson?this.cause.toJson(e):this.cause}}}var Dc={request:e=>wt(e),uploadFile:e=>bt(e),setStorageSync:(e,t)=>Ct(e,t),getStorageSync:e=>At(e),removeStorageSync:e=>kt(e),clearStorageSync:()=>xt()};function wc(e){return e&&wc(e.__v_raw)||e}function bc(){return{token:Dc.getStorageSync("uni_id_token")||Dc.getStorageSync("uniIdToken"),tokenExpired:Dc.getStorageSync("uni_id_token_expired")}}function Cc({token:e,tokenExpired:t}={}){e&&Dc.setStorageSync("uni_id_token",e),t&&Dc.setStorageSync("uni_id_token_expired",t)}let Ac,kc;function xc(){return Ac||(Ac=it()),Ac}function Ec(){let e,t;try{if(Pt){if(Pt.toString().indexOf("not yet implemented")>-1)return;const{scene:a,channel:n}=Pt();e=n,t=a}}catch(a){}return{channel:e,scene:t}}function Fc(){const e=Nt&&Nt()||"en";if(kc)return{...kc,locale:e,LOCALE:e};const t=xc(),{deviceId:a,osName:n,uniPlatform:i,appId:r}=t,u=["pixelRatio","brand","model","system","language","version","platform","host","SDKVersion","swanNativeVersion","app","AppPlatform","fontSizeSetting"];for(let s=0;s<u.length;s++)delete t[u[s]];return kc={PLATFORM:i,OS:n,APPID:r,DEVICEID:a,...Ec(),...t},{...kc,locale:e,LOCALE:e}}var Ic=function(e,t){let a="";return Object.keys(e).sort().forEach((function(t){e[t]&&(a=a+"&"+t+"="+e[t])})),a=a.slice(1),Sl(a,t).toString()},Tc=function(e,t){return new Promise(((a,n)=>{t(Object.assign(e,{complete(e){e||(e={});const t=e.data&&e.data.header&&e.data.header["x-serverless-request-id"]||e.header&&e.header["request-id"];if(!e.statusCode||e.statusCode>=400)return n(new yc({code:"SYS_ERR",message:e.errMsg||"request:fail",requestId:t}));const i=e.data;if(i.error)return n(new yc({code:i.error.code,message:i.error.message,requestId:t}));i.result=i.data,i.requestId=t,delete i.data,a(i)}}))}))},Sc=function(e){return Nl.stringify(Bl.parse(e))},Bc=class{constructor(e){["spaceId","clientSecret"].forEach((t=>{if(!Object.prototype.hasOwnProperty.call(e,t))throw new Error(`${t} required`)})),this.config=Object.assign({},{endpoint:0===e.spaceId.indexOf("mp-")?"https://api.next.bspapp.com":"https://api.bspapp.com"},e),this.config.provider="aliyun",this.config.requestUrl=this.config.endpoint+"/client",this.config.envType=this.config.envType||"public",this.config.accessTokenKey="access_token_"+this.config.spaceId,this.adapter=Dc,this._getAccessTokenPromiseHub=new ql({createPromise:()=>this.requestAuth(this.setupRequest({method:"serverless.auth.user.anonymousAuthorize",params:"{}"},"auth")).then((e=>{if(!e.result||!e.result.accessToken)throw new yc({code:"AUTH_FAILED",message:"获取accessToken失败"});this.setAccessToken(e.result.accessToken)})),retryRule:$l})}get hasAccessToken(){return!!this.accessToken}setAccessToken(e){this.accessToken=e}requestWrapped(e){return Tc(e,this.adapter.request)}requestAuth(e){return this.requestWrapped(e)}request(e,t){return Promise.resolve().then((()=>this.hasAccessToken?t?this.requestWrapped(e):this.requestWrapped(e).catch((t=>new Promise(((e,a)=>{!t||"GATEWAY_INVALID_TOKEN"!==t.code&&"InvalidParameter.InvalidToken"!==t.code?a(t):e()})).then((()=>this.getAccessToken())).then((()=>{const t=this.rebuildRequest(e);return this.request(t,!0)})))):this.getAccessToken().then((()=>{const t=this.rebuildRequest(e);return this.request(t,!0)}))))}rebuildRequest(e){const t=Object.assign({},e);return t.data.token=this.accessToken,t.header["x-basement-token"]=this.accessToken,t.header["x-serverless-sign"]=Ic(t.data,this.config.clientSecret),t}setupRequest(e,t){const a=Object.assign({},e,{spaceId:this.config.spaceId,timestamp:Date.now()}),n={"Content-Type":"application/json"};return"auth"!==t&&(a.token=this.accessToken,n["x-basement-token"]=this.accessToken),n["x-serverless-sign"]=Ic(a,this.config.clientSecret),{url:this.config.requestUrl,method:"POST",data:a,dataType:"json",header:n}}getAccessToken(){return this._getAccessTokenPromiseHub.exec()}async authorize(){await this.getAccessToken()}callFunction(e){const t={method:"serverless.function.runtime.invoke",params:JSON.stringify({functionTarget:e.name,functionArgs:e.data||{}})};return this.request(this.setupRequest(t))}getOSSUploadOptionsFromPath(e){const t={method:"serverless.file.resource.generateProximalSign",params:JSON.stringify(e)};return this.request(this.setupRequest(t))}uploadFileToOSS({url:e,formData:t,name:a,filePath:n,fileType:i,onUploadProgress:r}){return new Promise(((u,s)=>{const o=this.adapter.uploadFile({url:e,formData:t,name:a,filePath:n,fileType:i,header:{"X-OSS-server-side-encrpytion":"AES256"},success(e){e&&e.statusCode<400?u(e):s(new yc({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail(e){s(new yc({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof r&&o&&"function"==typeof o.onProgressUpdate&&o.onProgressUpdate((e=>{r({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}reportOSSUpload(e){const t={method:"serverless.file.resource.report",params:JSON.stringify(e)};return this.request(this.setupRequest(t))}async uploadFile({filePath:e,cloudPath:t,fileType:a="image",cloudPathAsRealPath:n=!1,onUploadProgress:i,config:r}){if("string"!==Ll(t))throw new yc({code:"INVALID_PARAM",message:"cloudPath必须为字符串类型"});if(!(t=t.trim()))throw new yc({code:"INVALID_PARAM",message:"cloudPath不可为空"});if(/:\/\//.test(t))throw new yc({code:"INVALID_PARAM",message:"cloudPath不合法"});const u=r&&r.envType||this.config.envType;if(n&&("/"!==t[0]&&(t="/"+t),t.indexOf("\\")>-1))throw new yc({code:"INVALID_PARAM",message:"使用cloudPath作为路径时，cloudPath不可包含“\\”"});const s=(await this.getOSSUploadOptionsFromPath({env:u,filename:n?t.split("/").pop():t,fileId:n?t:void 0})).result,o="https://"+s.cdnDomain+"/"+s.ossPath,{securityToken:l,accessKeyId:c,signature:d,host:f,ossPath:h,id:p,policy:v,ossCallbackUrl:m}=s,_={"Cache-Control":"max-age=2592000","Content-Disposition":"attachment",OSSAccessKeyId:c,Signature:d,host:f,id:p,key:h,policy:v,success_action_status:200};if(l&&(_["x-oss-security-token"]=l),m){const e=JSON.stringify({callbackUrl:m,callbackBody:JSON.stringify({fileId:p,spaceId:this.config.spaceId}),callbackBodyType:"application/json"});_.callback=Sc(e)}const g={url:"https://"+s.host,formData:_,fileName:"file",name:"file",filePath:e,fileType:a};if(await this.uploadFileToOSS(Object.assign({},g,{onUploadProgress:i})),m)return{success:!0,filePath:e,fileID:o};if((await this.reportOSSUpload({id:p})).success)return{success:!0,filePath:e,fileID:o};throw new yc({code:"UPLOAD_FAILED",message:"文件上传失败"})}getTempFileURL({fileList:e}={}){return new Promise(((t,a)=>{Array.isArray(e)&&0!==e.length||a(new yc({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"})),t({fileList:e.map((e=>({fileID:e,tempFileURL:e})))})}))}async getFileInfo({fileList:e}={}){if(!Array.isArray(e)||0===e.length)throw new yc({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"});const t={method:"serverless.file.resource.info",params:JSON.stringify({id:e.map((e=>e.split("?")[0])).join(",")})};return{fileList:(await this.request(this.setupRequest(t))).result}}},Nc={init(e){const t=new Bc(e),a={signInAnonymously:function(){return t.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return t.auth=function(){return a},t.customAuth=t.auth,t}};const Pc="undefined"!=typeof location&&"http:"===location.protocol?"http:":"https:";var Mc,Oc;(Oc=Mc||(Mc={})).local="local",Oc.none="none",Oc.session="session";var Lc=function(){},Uc=Fl((function(e,t){var a;e.exports=(a=Tl,function(e){var t=a,n=t.lib,i=n.WordArray,r=n.Hasher,u=t.algo,s=[],o=[];!function(){function t(t){for(var a=e.sqrt(t),n=2;n<=a;n++)if(!(t%n))return!1;return!0}function a(e){return 4294967296*(e-(0|e))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(s[i]=a(e.pow(n,.5))),o[i]=a(e.pow(n,1/3)),i++),n++}();var l=[],c=u.SHA256=r.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,t){for(var a=this._hash.words,n=a[0],i=a[1],r=a[2],u=a[3],s=a[4],c=a[5],d=a[6],f=a[7],h=0;h<64;h++){if(h<16)l[h]=0|e[t+h];else{var p=l[h-15],v=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,m=l[h-2],_=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;l[h]=v+l[h-7]+_+l[h-16]}var g=n&i^n&r^i&r,y=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),D=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&c^~s&d)+o[h]+l[h];f=d,d=c,c=s,s=u+D|0,u=r,r=i,i=n,n=D+(y+g)|0}a[0]=a[0]+n|0,a[1]=a[1]+i|0,a[2]=a[2]+r|0,a[3]=a[3]+u|0,a[4]=a[4]+s|0,a[5]=a[5]+c|0,a[6]=a[6]+d|0,a[7]=a[7]+f|0},_doFinalize:function(){var t=this._data,a=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return a[i>>>5]|=128<<24-i%32,a[14+(i+64>>>9<<4)]=e.floor(n/4294967296),a[15+(i+64>>>9<<4)]=n,t.sigBytes=4*a.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(c),t.HmacSHA256=r._createHmacHelper(c)}(Math),a.SHA256)})),Rc=Uc,zc=Fl((function(e,t){e.exports=Tl.HmacSHA256}));const jc=()=>{let e;if(!Promise){e=()=>{},e.promise={};const t=()=>{throw new yc({message:'Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.'})};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}const t=new Promise(((t,a)=>{e=(e,n)=>e?a(e):t(n)}));return e.promise=t,e};function $c(e){return void 0===e}function qc(e){return"[object Null]"===Object.prototype.toString.call(e)}var Vc;!function(e){e.WEB="web",e.WX_MP="wx_mp"}(Vc||(Vc={}));const Kc={adapter:null,runtime:void 0},Hc=["anonymousUuidKey"];class Wc extends Lc{constructor(){super(),Kc.adapter.root.tcbObject||(Kc.adapter.root.tcbObject={})}setItem(e,t){Kc.adapter.root.tcbObject[e]=t}getItem(e){return Kc.adapter.root.tcbObject[e]}removeItem(e){delete Kc.adapter.root.tcbObject[e]}clear(){delete Kc.adapter.root.tcbObject}}function Jc(e,t){switch(e){case"local":return t.localStorage||new Wc;case"none":return new Wc;default:return t.sessionStorage||new Wc}}class Zc{constructor(e){if(!this._storage){this._persistence=Kc.adapter.primaryStorage||e.persistence,this._storage=Jc(this._persistence,Kc.adapter);const t=`access_token_${e.env}`,a=`access_token_expire_${e.env}`,n=`refresh_token_${e.env}`,i=`anonymous_uuid_${e.env}`,r=`login_type_${e.env}`,u=`user_info_${e.env}`;this.keys={accessTokenKey:t,accessTokenExpireKey:a,refreshTokenKey:n,anonymousUuidKey:i,loginTypeKey:r,userInfoKey:u}}}updatePersistence(e){if(e===this._persistence)return;const t="local"===this._persistence;this._persistence=e;const a=Jc(e,Kc.adapter);for(const n in this.keys){const e=this.keys[n];if(t&&Hc.includes(n))continue;const i=this._storage.getItem(e);$c(i)||qc(i)||(a.setItem(e,i),this._storage.removeItem(e))}this._storage=a}setStore(e,t,a){if(!this._storage)return;const n={version:a||"localCachev1",content:t},i=JSON.stringify(n);try{this._storage.setItem(e,i)}catch(r){throw r}}getStore(e,t){try{if(!this._storage)return}catch(n){return""}t=t||"localCachev1";const a=this._storage.getItem(e);return a&&a.indexOf(t)>=0?JSON.parse(a).content:""}removeStore(e){this._storage.removeItem(e)}}const Yc={},Gc={};function Qc(e){return Yc[e]}class Xc{constructor(e,t){this.data=t||null,this.name=e}}class ed extends Xc{constructor(e,t){super("error",{error:e,data:t}),this.error=e}}const td=new class{constructor(){this._listeners={}}on(e,t){return a=e,n=t,(i=this._listeners)[a]=i[a]||[],i[a].push(n),this;var a,n,i}off(e,t){return function(e,t,a){if(a&&a[e]){const n=a[e].indexOf(t);-1!==n&&a[e].splice(n,1)}}(e,t,this._listeners),this}fire(e,t){if(e instanceof ed)return this;const a="string"==typeof e?new Xc(e,t||{}):e,n=a.name;if(this._listens(n)){a.target=this;const e=this._listeners[n]?[...this._listeners[n]]:[];for(const t of e)t.call(this,a)}return this}_listens(e){return this._listeners[e]&&this._listeners[e].length>0}};function ad(e,t){td.on(e,t)}function nd(e,t={}){td.fire(e,t)}function id(e,t){td.off(e,t)}const rd="loginStateChanged",ud="loginStateExpire",sd="loginTypeChanged",od="anonymousConverted",ld="refreshAccessToken";var cd;!function(e){e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.WECHAT_PUBLIC="WECHAT-PUBLIC",e.WECHAT_OPEN="WECHAT-OPEN",e.CUSTOM="CUSTOM",e.EMAIL="EMAIL",e.USERNAME="USERNAME",e.NULL="NULL"}(cd||(cd={}));const dd=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"],fd={"X-SDK-Version":"1.3.5"};function hd(e,t,a){const n=e[t];e[t]=function(t){const i={},r={};a.forEach((a=>{const{data:n,headers:u}=a.call(e,t);Object.assign(i,n),Object.assign(r,u)}));const u=t.data;return u&&(()=>{var e;if(e=u,"[object FormData]"!==Object.prototype.toString.call(e))t.data={...u,...i};else for(const t in i)u.append(t,i[t])})(),t.headers={...t.headers||{},...r},n.call(e,t)}}function pd(){const e=Math.random().toString(16).slice(2);return{data:{seqId:e},headers:{...fd,"x-seqid":e}}}class vd{constructor(e={}){var t;this.config=e,this._reqClass=new Kc.adapter.reqClass({timeout:this.config.timeout,timeoutMsg:`请求在${this.config.timeout/1e3}s内未完成，已中断`,restrictedMethods:["post"]}),this._cache=Qc(this.config.env),this._localCache=(t=this.config.env,Gc[t]),hd(this._reqClass,"post",[pd]),hd(this._reqClass,"upload",[pd]),hd(this._reqClass,"download",[pd])}async post(e){return await this._reqClass.post(e)}async upload(e){return await this._reqClass.upload(e)}async download(e){return await this._reqClass.download(e)}async refreshAccessToken(){let e,t;this._refreshAccessTokenPromise||(this._refreshAccessTokenPromise=this._refreshAccessToken());try{e=await this._refreshAccessTokenPromise}catch(a){t=a}if(this._refreshAccessTokenPromise=null,this._shouldRefreshAccessTokenHook=null,t)throw t;return e}async _refreshAccessToken(){const{accessTokenKey:e,accessTokenExpireKey:t,refreshTokenKey:a,loginTypeKey:n,anonymousUuidKey:i}=this._cache.keys;this._cache.removeStore(e),this._cache.removeStore(t);let r=this._cache.getStore(a);if(!r)throw new yc({message:"未登录CloudBase"});const u={refresh_token:r},s=await this.request("auth.fetchAccessTokenWithRefreshToken",u);if(s.data.code){const{code:e}=s.data;if("SIGN_PARAM_INVALID"===e||"REFRESH_TOKEN_EXPIRED"===e||"INVALID_REFRESH_TOKEN"===e){if(this._cache.getStore(n)===cd.ANONYMOUS&&"INVALID_REFRESH_TOKEN"===e){const e=this._cache.getStore(i),t=this._cache.getStore(a),n=await this.send("auth.signInAnonymously",{anonymous_uuid:e,refresh_token:t});return this.setRefreshToken(n.refresh_token),this._refreshAccessToken()}nd(ud),this._cache.removeStore(a)}throw new yc({code:s.data.code,message:`刷新access token失败：${s.data.code}`})}if(s.data.access_token)return nd(ld),this._cache.setStore(e,s.data.access_token),this._cache.setStore(t,s.data.access_token_expire+Date.now()),{accessToken:s.data.access_token,accessTokenExpire:s.data.access_token_expire};s.data.refresh_token&&(this._cache.removeStore(a),this._cache.setStore(a,s.data.refresh_token),this._refreshAccessToken())}async getAccessToken(){const{accessTokenKey:e,accessTokenExpireKey:t,refreshTokenKey:a}=this._cache.keys;if(!this._cache.getStore(a))throw new yc({message:"refresh token不存在，登录状态异常"});let n=this._cache.getStore(e),i=this._cache.getStore(t),r=!0;return this._shouldRefreshAccessTokenHook&&!(await this._shouldRefreshAccessTokenHook(n,i))&&(r=!1),(!n||!i||i<Date.now())&&r?this.refreshAccessToken():{accessToken:n,accessTokenExpire:i}}async request(e,t,a){const n=`x-tcb-trace_${this.config.env}`;let i="application/x-www-form-urlencoded";const r={action:e,env:this.config.env,dataVersion:"2019-08-16",...t};if(-1===dd.indexOf(e)){const{refreshTokenKey:e}=this._cache.keys;this._cache.getStore(e)&&(r.access_token=(await this.getAccessToken()).accessToken)}let u;if("storage.uploadFile"===e){u=new FormData;for(let e in u)u.hasOwnProperty(e)&&void 0!==u[e]&&u.append(e,r[e]);i="multipart/form-data"}else{i="application/json",u={};for(let e in r)void 0!==r[e]&&(u[e]=r[e])}let s={headers:{"content-type":i}};a&&a.onUploadProgress&&(s.onUploadProgress=a.onUploadProgress);const o=this._localCache.getStore(n);o&&(s.headers["X-TCB-Trace"]=o);const{parse:l,inQuery:c,search:d}=t;let f={env:this.config.env};l&&(f.parse=!0),c&&(f={...c,...f});let h=function(e,t,a={}){const n=/\?/.test(t);let i="";for(let r in a)""===i?!n&&(t+="?"):i+="&",i+=`${r}=${encodeURIComponent(a[r])}`;return/^http(s)?\:\/\//.test(t+=i)?t:`${e}${t}`}(Pc,"//tcb-api.tencentcloudapi.com/web",f);d&&(h+=d);const p=await this.post({url:h,data:u,...s}),v=p.header&&p.header["x-tcb-trace"];if(v&&this._localCache.setStore(n,v),200!==Number(p.status)&&200!==Number(p.statusCode)||!p.data)throw new yc({code:"NETWORK_ERROR",message:"network request error"});return p}async send(e,t={}){const a=await this.request(e,t,{onUploadProgress:t.onUploadProgress});if("ACCESS_TOKEN_EXPIRED"===a.data.code&&-1===dd.indexOf(e)){await this.refreshAccessToken();const a=await this.request(e,t,{onUploadProgress:t.onUploadProgress});if(a.data.code)throw new yc({code:a.data.code,message:a.data.message});return a.data}if(a.data.code)throw new yc({code:a.data.code,message:a.data.message});return a.data}setRefreshToken(e){const{accessTokenKey:t,accessTokenExpireKey:a,refreshTokenKey:n}=this._cache.keys;this._cache.removeStore(t),this._cache.removeStore(a),this._cache.setStore(n,e)}}const md={};function _d(e){return md[e]}class gd{constructor(e){this.config=e,this._cache=Qc(e.env),this._request=_d(e.env)}setRefreshToken(e){const{accessTokenKey:t,accessTokenExpireKey:a,refreshTokenKey:n}=this._cache.keys;this._cache.removeStore(t),this._cache.removeStore(a),this._cache.setStore(n,e)}setAccessToken(e,t){const{accessTokenKey:a,accessTokenExpireKey:n}=this._cache.keys;this._cache.setStore(a,e),this._cache.setStore(n,t)}async refreshUserInfo(){const{data:e}=await this._request.send("auth.getUserInfo",{});return this.setLocalUserInfo(e),e}setLocalUserInfo(e){const{userInfoKey:t}=this._cache.keys;this._cache.setStore(t,e)}}class yd{constructor(e){if(!e)throw new yc({code:"PARAM_ERROR",message:"envId is not defined"});this._envId=e,this._cache=Qc(this._envId),this._request=_d(this._envId),this.setUserInfo()}linkWithTicket(e){if("string"!=typeof e)throw new yc({code:"PARAM_ERROR",message:"ticket must be string"});return this._request.send("auth.linkWithTicket",{ticket:e})}linkWithRedirect(e){e.signInWithRedirect()}updatePassword(e,t){return this._request.send("auth.updatePassword",{oldPassword:t,newPassword:e})}updateEmail(e){return this._request.send("auth.updateEmail",{newEmail:e})}updateUsername(e){if("string"!=typeof e)throw new yc({code:"PARAM_ERROR",message:"username must be a string"});return this._request.send("auth.updateUsername",{username:e})}async getLinkedUidList(){const{data:e}=await this._request.send("auth.getLinkedUidList",{});let t=!1;const{users:a}=e;return a.forEach((e=>{e.wxOpenId&&e.wxPublicId&&(t=!0)})),{users:a,hasPrimaryUid:t}}setPrimaryUid(e){return this._request.send("auth.setPrimaryUid",{uid:e})}unlink(e){return this._request.send("auth.unlink",{platform:e})}async update(e){const{nickName:t,gender:a,avatarUrl:n,province:i,country:r,city:u}=e,{data:s}=await this._request.send("auth.updateUserInfo",{nickName:t,gender:a,avatarUrl:n,province:i,country:r,city:u});this.setLocalUserInfo(s)}async refresh(){const{data:e}=await this._request.send("auth.getUserInfo",{});return this.setLocalUserInfo(e),e}setUserInfo(){const{userInfoKey:e}=this._cache.keys,t=this._cache.getStore(e);["uid","loginType","openid","wxOpenId","wxPublicId","unionId","qqMiniOpenId","email","hasPassword","customUserId","nickName","gender","avatarUrl"].forEach((e=>{this[e]=t[e]})),this.location={country:t.country,province:t.province,city:t.city}}setLocalUserInfo(e){const{userInfoKey:t}=this._cache.keys;this._cache.setStore(t,e),this.setUserInfo()}}class Dd{constructor(e){if(!e)throw new yc({code:"PARAM_ERROR",message:"envId is not defined"});this._cache=Qc(e);const{refreshTokenKey:t,accessTokenKey:a,accessTokenExpireKey:n}=this._cache.keys,i=this._cache.getStore(t),r=this._cache.getStore(a),u=this._cache.getStore(n);this.credential={refreshToken:i,accessToken:r,accessTokenExpire:u},this.user=new yd(e)}get isAnonymousAuth(){return this.loginType===cd.ANONYMOUS}get isCustomAuth(){return this.loginType===cd.CUSTOM}get isWeixinAuth(){return this.loginType===cd.WECHAT||this.loginType===cd.WECHAT_OPEN||this.loginType===cd.WECHAT_PUBLIC}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}}class wd extends gd{async signIn(){this._cache.updatePersistence("local");const{anonymousUuidKey:e,refreshTokenKey:t}=this._cache.keys,a=this._cache.getStore(e)||void 0,n=this._cache.getStore(t)||void 0,i=await this._request.send("auth.signInAnonymously",{anonymous_uuid:a,refresh_token:n});if(i.uuid&&i.refresh_token){this._setAnonymousUUID(i.uuid),this.setRefreshToken(i.refresh_token),await this._request.refreshAccessToken(),nd(rd),nd(sd,{env:this.config.env,loginType:cd.ANONYMOUS,persistence:"local"});const e=new Dd(this.config.env);return await e.user.refresh(),e}throw new yc({message:"匿名登录失败"})}async linkAndRetrieveDataWithTicket(e){const{anonymousUuidKey:t,refreshTokenKey:a}=this._cache.keys,n=this._cache.getStore(t),i=this._cache.getStore(a),r=await this._request.send("auth.linkAndRetrieveDataWithTicket",{anonymous_uuid:n,refresh_token:i,ticket:e});if(r.refresh_token)return this._clearAnonymousUUID(),this.setRefreshToken(r.refresh_token),await this._request.refreshAccessToken(),nd(od,{env:this.config.env}),nd(sd,{loginType:cd.CUSTOM,persistence:"local"}),{credential:{refreshToken:r.refresh_token}};throw new yc({message:"匿名转化失败"})}_setAnonymousUUID(e){const{anonymousUuidKey:t,loginTypeKey:a}=this._cache.keys;this._cache.removeStore(t),this._cache.setStore(t,e),this._cache.setStore(a,cd.ANONYMOUS)}_clearAnonymousUUID(){this._cache.removeStore(this._cache.keys.anonymousUuidKey)}}class bd extends gd{async signIn(e){if("string"!=typeof e)throw new yc({code:"PARAM_ERROR",message:"ticket must be a string"});const{refreshTokenKey:t}=this._cache.keys,a=await this._request.send("auth.signInWithTicket",{ticket:e,refresh_token:this._cache.getStore(t)||""});if(a.refresh_token)return this.setRefreshToken(a.refresh_token),await this._request.refreshAccessToken(),nd(rd),nd(sd,{env:this.config.env,loginType:cd.CUSTOM,persistence:this.config.persistence}),await this.refreshUserInfo(),new Dd(this.config.env);throw new yc({message:"自定义登录失败"})}}class Cd extends gd{async signIn(e,t){if("string"!=typeof e)throw new yc({code:"PARAM_ERROR",message:"email must be a string"});const{refreshTokenKey:a}=this._cache.keys,n=await this._request.send("auth.signIn",{loginType:"EMAIL",email:e,password:t,refresh_token:this._cache.getStore(a)||""}),{refresh_token:i,access_token:r,access_token_expire:u}=n;if(i)return this.setRefreshToken(i),r&&u?this.setAccessToken(r,u):await this._request.refreshAccessToken(),await this.refreshUserInfo(),nd(rd),nd(sd,{env:this.config.env,loginType:cd.EMAIL,persistence:this.config.persistence}),new Dd(this.config.env);throw n.code?new yc({code:n.code,message:`邮箱登录失败: ${n.message}`}):new yc({message:"邮箱登录失败"})}async activate(e){return this._request.send("auth.activateEndUserMail",{token:e})}async resetPasswordWithToken(e,t){return this._request.send("auth.resetPasswordWithToken",{token:e,newPassword:t})}}class Ad extends gd{async signIn(e,t){if("string"!=typeof e)throw new yc({code:"PARAM_ERROR",message:"username must be a string"});"string"!=typeof t&&(t="");const{refreshTokenKey:a}=this._cache.keys,n=await this._request.send("auth.signIn",{loginType:cd.USERNAME,username:e,password:t,refresh_token:this._cache.getStore(a)||""}),{refresh_token:i,access_token_expire:r,access_token:u}=n;if(i)return this.setRefreshToken(i),u&&r?this.setAccessToken(u,r):await this._request.refreshAccessToken(),await this.refreshUserInfo(),nd(rd),nd(sd,{env:this.config.env,loginType:cd.USERNAME,persistence:this.config.persistence}),new Dd(this.config.env);throw n.code?new yc({code:n.code,message:`用户名密码登录失败: ${n.message}`}):new yc({message:"用户名密码登录失败"})}}class kd{constructor(e){this.config=e,this._cache=Qc(e.env),this._request=_d(e.env),this._onAnonymousConverted=this._onAnonymousConverted.bind(this),this._onLoginTypeChanged=this._onLoginTypeChanged.bind(this),ad(sd,this._onLoginTypeChanged)}get currentUser(){const e=this.hasLoginState();return e&&e.user||null}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}anonymousAuthProvider(){return new wd(this.config)}customAuthProvider(){return new bd(this.config)}emailAuthProvider(){return new Cd(this.config)}usernameAuthProvider(){return new Ad(this.config)}async signInAnonymously(){return new wd(this.config).signIn()}async signInWithEmailAndPassword(e,t){return new Cd(this.config).signIn(e,t)}signInWithUsernameAndPassword(e,t){return new Ad(this.config).signIn(e,t)}async linkAndRetrieveDataWithTicket(e){return this._anonymousAuthProvider||(this._anonymousAuthProvider=new wd(this.config)),ad(od,this._onAnonymousConverted),await this._anonymousAuthProvider.linkAndRetrieveDataWithTicket(e)}async signOut(){if(this.loginType===cd.ANONYMOUS)throw new yc({message:"匿名用户不支持登出操作"});const{refreshTokenKey:e,accessTokenKey:t,accessTokenExpireKey:a}=this._cache.keys,n=this._cache.getStore(e);if(!n)return;const i=await this._request.send("auth.logout",{refresh_token:n});return this._cache.removeStore(e),this._cache.removeStore(t),this._cache.removeStore(a),nd(rd),nd(sd,{env:this.config.env,loginType:cd.NULL,persistence:this.config.persistence}),i}async signUpWithEmailAndPassword(e,t){return this._request.send("auth.signUpWithEmailAndPassword",{email:e,password:t})}async sendPasswordResetEmail(e){return this._request.send("auth.sendPasswordResetEmail",{email:e})}onLoginStateChanged(e){ad(rd,(()=>{const t=this.hasLoginState();e.call(this,t)}));const t=this.hasLoginState();e.call(this,t)}onLoginStateExpired(e){ad(ud,e.bind(this))}onAccessTokenRefreshed(e){ad(ld,e.bind(this))}onAnonymousConverted(e){ad(od,e.bind(this))}onLoginTypeChanged(e){ad(sd,(()=>{const t=this.hasLoginState();e.call(this,t)}))}async getAccessToken(){return{accessToken:(await this._request.getAccessToken()).accessToken,env:this.config.env}}hasLoginState(){const{refreshTokenKey:e}=this._cache.keys;return this._cache.getStore(e)?new Dd(this.config.env):null}async isUsernameRegistered(e){if("string"!=typeof e)throw new yc({code:"PARAM_ERROR",message:"username must be a string"});const{data:t}=await this._request.send("auth.isUsernameRegistered",{username:e});return t&&t.isRegistered}getLoginState(){return Promise.resolve(this.hasLoginState())}async signInWithTicket(e){return new bd(this.config).signIn(e)}shouldRefreshAccessToken(e){this._request._shouldRefreshAccessTokenHook=e.bind(this)}getUserInfo(){return this._request.send("auth.getUserInfo",{}).then((e=>e.code?e:{...e.data,requestId:e.seqId}))}getAuthHeader(){const{refreshTokenKey:e,accessTokenKey:t}=this._cache.keys,a=this._cache.getStore(e);return{"x-cloudbase-credentials":this._cache.getStore(t)+"/@@/"+a}}_onAnonymousConverted(e){const{env:t}=e.data;t===this.config.env&&this._cache.updatePersistence(this.config.persistence)}_onLoginTypeChanged(e){const{loginType:t,persistence:a,env:n}=e.data;n===this.config.env&&(this._cache.updatePersistence(a),this._cache.setStore(this._cache.keys.loginTypeKey,t))}}const xd=function(e,t){t=t||jc();const a=_d(this.config.env),{cloudPath:n,filePath:i,onUploadProgress:r,fileType:u="image"}=e;return a.send("storage.getUploadMetadata",{path:n}).then((e=>{const{data:{url:s,authorization:o,token:l,fileId:c,cosFileId:d},requestId:f}=e,h={key:n,signature:o,"x-cos-meta-fileid":d,success_action_status:"201","x-cos-security-token":l};a.upload({url:s,data:h,file:i,name:n,fileType:u,onUploadProgress:r}).then((e=>{201===e.statusCode?t(null,{fileID:c,requestId:f}):t(new yc({code:"STORAGE_REQUEST_FAIL",message:`STORAGE_REQUEST_FAIL: ${e.data}`}))})).catch((e=>{t(e)}))})).catch((e=>{t(e)})),t.promise},Ed=function(e,t){t=t||jc();const a=_d(this.config.env),{cloudPath:n}=e;return a.send("storage.getUploadMetadata",{path:n}).then((e=>{t(null,e)})).catch((e=>{t(e)})),t.promise},Fd=function({fileList:e},t){if(t=t||jc(),!e||!Array.isArray(e))return{code:"INVALID_PARAM",message:"fileList必须是非空的数组"};for(let n of e)if(!n||"string"!=typeof n)return{code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"};const a={fileid_list:e};return _d(this.config.env).send("storage.batchDeleteFile",a).then((e=>{e.code?t(null,e):t(null,{fileList:e.data.delete_list,requestId:e.requestId})})).catch((e=>{t(e)})),t.promise},Id=function({fileList:e},t){t=t||jc(),e&&Array.isArray(e)||t(null,{code:"INVALID_PARAM",message:"fileList必须是非空的数组"});let a=[];for(let i of e)"object"==typeof i?(i.hasOwnProperty("fileID")&&i.hasOwnProperty("maxAge")||t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是包含fileID和maxAge的对象"}),a.push({fileid:i.fileID,max_age:i.maxAge})):"string"==typeof i?a.push({fileid:i}):t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是字符串"});const n={file_list:a};return _d(this.config.env).send("storage.batchGetDownloadUrl",n).then((e=>{e.code?t(null,e):t(null,{fileList:e.data.download_list,requestId:e.requestId})})).catch((e=>{t(e)})),t.promise},Td=async function({fileID:e},t){const a=(await Id.call(this,{fileList:[{fileID:e,maxAge:600}]})).fileList[0];if("SUCCESS"!==a.code)return t?t(a):new Promise((e=>{e(a)}));const n=_d(this.config.env);let i=a.download_url;if(i=encodeURI(i),!t)return n.download({url:i});t(await n.download({url:i}))},Sd=function({name:e,data:t,query:a,parse:n,search:i},r){const u=r||jc();let s;try{s=t?JSON.stringify(t):""}catch(l){return Promise.reject(l)}if(!e)return Promise.reject(new yc({code:"PARAM_ERROR",message:"函数名不能为空"}));const o={inQuery:a,parse:n,search:i,function_name:e,request_data:s};return _d(this.config.env).send("functions.invokeFunction",o).then((e=>{if(e.code)u(null,e);else{let a=e.data.response_data;if(n)u(null,{result:a,requestId:e.requestId});else try{a=JSON.parse(e.data.response_data),u(null,{result:a,requestId:e.requestId})}catch(t){u(new yc({message:"response data must be json"}))}}return u.promise})).catch((e=>{u(e)})),u.promise},Bd={timeout:15e3,persistence:"session"},Nd={};class Pd{constructor(e){this.config=e||this.config,this.authObj=void 0}init(e){switch(Kc.adapter||(this.requestClient=new Kc.adapter.reqClass({timeout:e.timeout||5e3,timeoutMsg:`请求在${(e.timeout||5e3)/1e3}s内未完成，已中断`})),this.config={...Bd,...e},!0){case this.config.timeout>6e5:this.config.timeout=6e5;break;case this.config.timeout<100:this.config.timeout=100}return new Pd(this.config)}auth({persistence:e}={}){if(this.authObj)return this.authObj;const t=e||Kc.adapter.primaryStorage||Bd.persistence;var a;return t!==this.config.persistence&&(this.config.persistence=t),function(e){const{env:t}=e;Yc[t]=new Zc(e),Gc[t]=new Zc({...e,persistence:"local"})}(this.config),a=this.config,md[a.env]=new vd(a),this.authObj=new kd(this.config),this.authObj}on(e,t){return ad.apply(this,[e,t])}off(e,t){return id.apply(this,[e,t])}callFunction(e,t){return Sd.apply(this,[e,t])}deleteFile(e,t){return Fd.apply(this,[e,t])}getTempFileURL(e,t){return Id.apply(this,[e,t])}downloadFile(e,t){return Td.apply(this,[e,t])}uploadFile(e,t){return xd.apply(this,[e,t])}getUploadMetadata(e,t){return Ed.apply(this,[e,t])}registerExtension(e){Nd[e.name]=e}async invokeExtension(e,t){const a=Nd[e];if(!a)throw new yc({message:`扩展${e} 必须先注册`});return await a.invoke(t,this)}useAdapters(e){const{adapter:t,runtime:a}=function(e){const t=(a=e,"[object Array]"===Object.prototype.toString.call(a)?e:[e]);var a;for(const n of t){const{isMatch:e,genAdapter:t,runtime:a}=n;if(e())return{adapter:t(),runtime:a}}}(e)||{};t&&(Kc.adapter=t),a&&(Kc.runtime=a)}}var Md=new Pd;function Od(e,t,a){void 0===a&&(a={});var n=/\?/.test(t),i="";for(var r in a)""===i?!n&&(t+="?"):i+="&",i+=r+"="+encodeURIComponent(a[r]);return/^http(s)?:\/\//.test(t+=i)?t:""+e+t}class Ld{post(e){const{url:t,data:a,headers:n}=e;return new Promise(((e,i)=>{Dc.request({url:Od("https:",t),data:a,method:"POST",header:n,success(t){e(t)},fail(e){i(e)}})}))}upload(e){return new Promise(((t,a)=>{const{url:n,file:i,data:r,headers:u,fileType:s}=e,o=Dc.uploadFile({url:Od("https:",n),name:"file",formData:Object.assign({},r),filePath:i,fileType:s,header:u,success(e){const a={statusCode:e.statusCode,data:e.data||{}};200===e.statusCode&&r.success_action_status&&(a.statusCode=parseInt(r.success_action_status,10)),t(a)},fail(e){a(new Error(e.errMsg||"uploadFile:fail"))}});"function"==typeof e.onUploadProgress&&o&&"function"==typeof o.onProgressUpdate&&o.onProgressUpdate((t=>{e.onUploadProgress({loaded:t.totalBytesSent,total:t.totalBytesExpectedToSend})}))}))}}const Ud={setItem(e,t){Dc.setStorageSync(e,t)},getItem:e=>Dc.getStorageSync(e),removeItem(e){Dc.removeStorageSync(e)},clear(){Dc.clearStorageSync()}};var Rd={genAdapter:function(){return{root:{},reqClass:Ld,localStorage:Ud,primaryStorage:"local"}},isMatch:function(){return!0},runtime:"uni_app"};Md.useAdapters(Rd);const zd=Md,jd=zd.init;zd.init=function(e){e.env=e.spaceId;const t=jd.call(this,e);t.config.provider="tencent",t.config.spaceId=e.spaceId;const a=t.auth;return t.auth=function(e){const t=a.call(this,e);return["linkAndRetrieveDataWithTicket","signInAnonymously","signOut","getAccessToken","getLoginState","signInWithTicket","getUserInfo"].forEach((e=>{var a;t[e]=(a=t[e],function(e){e=e||{};const{success:t,fail:n,complete:i}=gc(e);if(!(t||n||i))return a.call(this,e);a.call(this,e).then((e=>{t&&t(e),i&&i(e)}),(e=>{n&&n(e),i&&i(e)}))}).bind(t)})),t},t.customAuth=t.auth,t};var $d=zd,qd=class extends Bc{getAccessToken(){return new Promise(((e,t)=>{const a="Anonymous_Access_token";this.setAccessToken(a),e(a)}))}setupRequest(e,t){const a=Object.assign({},e,{spaceId:this.config.spaceId,timestamp:Date.now()}),n={"Content-Type":"application/json"};"auth"!==t&&(a.token=this.accessToken,n["x-basement-token"]=this.accessToken),n["x-serverless-sign"]=Ic(a,this.config.clientSecret);const i=Fc();n["x-client-info"]=encodeURIComponent(JSON.stringify(i));const{token:r}=bc();return n["x-client-token"]=r,{url:this.config.requestUrl,method:"POST",data:a,dataType:"json",header:JSON.parse(JSON.stringify(n))}}uploadFileToOSS({url:e,formData:t,name:a,filePath:n,fileType:i,onUploadProgress:r}){return new Promise(((u,s)=>{const o=this.adapter.uploadFile({url:e,formData:t,name:a,filePath:n,fileType:i,success(e){e&&e.statusCode<400?u(e):s(new yc({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail(e){s(new yc({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof r&&o&&"function"==typeof o.onProgressUpdate&&o.onProgressUpdate((e=>{r({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}uploadFile({filePath:e,cloudPath:t,fileType:a="image",onUploadProgress:n}){if(!t)throw new yc({code:"CLOUDPATH_REQUIRED",message:"cloudPath不可为空"});let i;return this.getOSSUploadOptionsFromPath({cloudPath:t}).then((t=>{const{url:r,formData:u,name:s}=t.result;i=t.result.fileUrl;const o={url:r,formData:u,name:s,filePath:e,fileType:a};return this.uploadFileToOSS(Object.assign({},o,{onUploadProgress:n}))})).then((()=>this.reportOSSUpload({cloudPath:t}))).then((t=>new Promise(((a,n)=>{t.success?a({success:!0,filePath:e,fileID:i}):n(new yc({code:"UPLOAD_FAILED",message:"文件上传失败"}))}))))}deleteFile({fileList:e}){const t={method:"serverless.file.resource.delete",params:JSON.stringify({fileList:e})};return this.request(this.setupRequest(t)).then((e=>{if(e.success)return e.result;throw new yc({code:"DELETE_FILE_FAILED",message:"删除文件失败"})}))}getTempFileURL({fileList:e,maxAge:t}={}){if(!Array.isArray(e)||0===e.length)throw new yc({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"});const a={method:"serverless.file.resource.getTempFileURL",params:JSON.stringify({fileList:e,maxAge:t})};return this.request(this.setupRequest(a)).then((e=>{if(e.success)return{fileList:e.result.fileList.map((e=>({fileID:e.fileID,tempFileURL:e.tempFileURL})))};throw new yc({code:"GET_TEMP_FILE_URL_FAILED",message:"获取临时文件链接失败"})}))}},Vd={init(e){const t=new qd(e),a={signInAnonymously:function(){return t.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return t.auth=function(){return a},t.customAuth=t.auth,t}},Kd=Fl((function(e,t){e.exports=Tl.enc.Hex}));function Hd(e="",t={}){const{data:a,functionName:n,method:i,headers:r,signHeaderKeys:u=[],config:s}=t,o=Date.now(),l="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),c=Object.assign({},r,{"x-from-app-id":s.spaceAppId,"x-from-env-id":s.spaceId,"x-to-env-id":s.spaceId,"x-from-instance-id":o,"x-from-function-name":n,"x-client-timestamp":o,"x-alipay-source":"client","x-request-id":l,"x-alipay-callid":l,"x-trace-id":l}),d=["x-from-app-id","x-from-env-id","x-to-env-id","x-from-instance-id","x-from-function-name","x-client-timestamp"].concat(u),[f="",h=""]=e.split("?")||[],p=function(e){const t=e.signedHeaders.join(";"),a=e.signedHeaders.map((t=>`${t.toLowerCase()}:${e.headers[t]}\n`)).join(""),n=Rc(e.body).toString(Kd),i=`${e.method.toUpperCase()}\n${e.path}\n${e.query}\n${a}\n${t}\n${n}\n`,r=Rc(i).toString(Kd),u=`HMAC-SHA256\n${e.timestamp}\n${r}\n`,s=zc(u,e.secretKey).toString(Kd);return`HMAC-SHA256 Credential=${e.secretId}, SignedHeaders=${t}, Signature=${s}`}({path:f,query:h,method:i,headers:c,timestamp:o,body:JSON.stringify(a),secretId:s.accessKey,secretKey:s.secretKey,signedHeaders:d.sort()});return{url:`${s.endpoint}${e}`,headers:Object.assign({},c,{Authorization:p})}}function Wd({url:e,data:t,method:a="POST",headers:n={}}){return new Promise(((i,r)=>{Dc.request({url:e,method:a,data:t,header:n,dataType:"json",complete:(e={})=>{const t=n["x-trace-id"]||"";if(!e.statusCode||e.statusCode>=400){const{message:a,errMsg:n,trace_id:i}=e.data||{};return r(new yc({code:"SYS_ERR",message:a||n||"request:fail",requestId:i||t}))}i({status:e.statusCode,data:e.data,headers:e.header,requestId:t})}})}))}function Jd(e,t){const{path:a,data:n,method:i="GET"}=e,{url:r,headers:u}=Hd(a,{functionName:"",data:n,method:i,headers:{"x-alipay-cloud-mode":"oss","x-data-api-type":"oss","x-expire-timestamp":Date.now()+6e4},signHeaderKeys:["x-data-api-type","x-expire-timestamp"],config:t});return Wd({url:r,data:n,method:i,headers:u}).then((e=>{const t=e.data||{};if(!t.success)throw new yc({code:e.errCode,message:e.errMsg,requestId:e.requestId});return t.data||{}})).catch((e=>{throw new yc({code:e.errCode,message:e.errMsg,requestId:e.requestId})}))}function Zd(e=""){const t=e.trim().replace(/^cloud:\/\//,""),a=t.indexOf("/");if(a<=0)throw new yc({code:"INVALID_PARAM",message:"fileID不合法"});t.substring(0,a);const n=t.substring(a+1);return this.config.spaceId,n}function Yd(e=""){return"cloud://".concat(this.config.spaceId,"/").concat(e.replace(/^\/+/,""))}var Gd=class{constructor(e){if(["spaceId","spaceAppId","accessKey","secretKey"].forEach((t=>{if(!Object.prototype.hasOwnProperty.call(e,t))throw new Error(`${t} required`)})),e.endpoint){if("string"!=typeof e.endpoint)throw new Error("endpoint must be string");if(!/^https:\/\//.test(e.endpoint))throw new Error("endpoint must start with https://");e.endpoint=e.endpoint.replace(/\/$/,"")}this.config=Object.assign({},e,{endpoint:e.endpoint||`https://${e.spaceId}.api-hz.cloudbasefunction.cn`})}callFunction(e){return function(e,t){const{name:a,data:n}=e,i="POST",{url:r,headers:u}=Hd("/functions/invokeFunction",{functionName:a,data:n,method:i,headers:{"x-to-function-name":a},signHeaderKeys:["x-to-function-name"],config:t});return Wd({url:r,data:n,method:i,headers:u}).then((e=>({errCode:0,success:!0,requestId:e.requestId,result:e.data}))).catch((e=>{throw new yc({code:e.errCode,message:e.errMsg,requestId:e.requestId})}))}(e,this.config)}uploadFileToOSS({url:e,filePath:t,fileType:a,formData:n,onUploadProgress:i}){return new Promise(((r,u)=>{const s=Dc.uploadFile({url:e,filePath:t,fileType:a,formData:n,name:"file",success(e){e&&e.statusCode<400?r(e):u(new yc({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail(e){u(new yc({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof i&&s&&"function"==typeof s.onProgressUpdate&&s.onProgressUpdate((e=>{i({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}async uploadFile({filePath:e,cloudPath:t="",fileType:a="image",onUploadProgress:n}){if("string"!==Ll(t))throw new yc({code:"INVALID_PARAM",message:"cloudPath必须为字符串类型"});if(!(t=t.trim()))throw new yc({code:"INVALID_PARAM",message:"cloudPath不可为空"});if(/:\/\//.test(t))throw new yc({code:"INVALID_PARAM",message:"cloudPath不合法"});const i=await Jd({path:"/".concat(t.replace(/^\//,""),"?post_url")},this.config),{file_id:r,upload_url:u,form_data:s}=i,o=s&&s.reduce(((e,t)=>(e[t.key]=t.value,e)),{});return this.uploadFileToOSS({url:u,filePath:e,fileType:a,formData:o,onUploadProgress:n}).then((()=>({fileID:r})))}async getTempFileURL({fileList:e}){return new Promise(((t,a)=>{(!e||e.length<0)&&a(new yc({errCode:"INVALID_PARAM",errMsg:"fileList不能为空数组"})),e.length>50&&a(new yc({errCode:"INVALID_PARAM",errMsg:"fileList数组长度不能超过50"}));const n=[];for(const i of e){"string"!==Ll(i)&&a(new yc({errCode:"INVALID_PARAM",errMsg:"fileList的元素必须是非空的字符串"}));const e=Zd.call(this,i);n.push({file_id:e,expire:600})}Jd({path:"/?download_url",data:{file_list:n},method:"POST"},this.config).then((e=>{const{file_list:a=[]}=e;t({fileList:a.map((e=>({fileID:Yd.call(this,e.file_id),tempFileURL:e.download_url})))})})).catch((e=>a(e)))}))}},Qd={init:e=>{e.provider="alipay";const t=new Gd(e);return t.auth=function(){return{signInAnonymously:function(){return Promise.resolve()},getLoginState:function(){return Promise.resolve(!0)}}},t}};function Xd({data:e}){let t;t=Fc();const a=JSON.parse(JSON.stringify(e||{}));if(Object.assign(a,{clientInfo:t}),!a.uniIdToken){const{token:e}=bc();e&&(a.uniIdToken=e)}return a}const ef=[{rule:/fc_function_not_found|FUNCTION_NOT_FOUND/,content:"，云函数[{functionName}]在云端不存在，请检查此云函数名称是否正确以及该云函数是否已上传到服务空间",mode:"append"}];var tf=/[\\^$.*+?()[\]{}|]/g,af=RegExp(tf.source);function nf(e,t,a){return e.replace(new RegExp((n=t)&&af.test(n)?n.replace(tf,"\\$&"):n,"g"),a);var n}const rf="request",uf="response",sf="both",of={code:2e4,message:"System error"},lf={code:20101,message:"Invalid client"};function cf(e){const{errSubject:t,subject:a,errCode:n,errMsg:i,code:r,message:u,cause:s}=e||{};return new yc({subject:t||a||"uni-secure-network",code:n||r||of.code,message:i||u,cause:s})}let df;function ff({secretType:e}={}){return e===rf||e===uf||e===sf}function hf({name:e,data:t={}}={}){return"app"===Hl}function pf({functionName:e,result:t,logPvd:a}){}function vf(e){const t=e.callFunction,a=function(a){const n=a.name;a.data=Xd.call(e,{data:a.data});const i={aliyun:"aliyun",tencent:"tcb",tcb:"tcb",alipay:"alipay"}[this.config.provider],r=ff(a),u=hf(a),s=r||u;return t.call(this,a).then((e=>(e.errCode=0,!s&&pf.call(this,{functionName:n,result:e,logPvd:i}),Promise.resolve(e))),(e=>(!s&&pf.call(this,{functionName:n,result:e,logPvd:i}),e&&e.message&&(e.message=function({message:e="",extraInfo:t={},formatter:a=[]}={}){for(let n=0;n<a.length;n++){const{rule:i,content:r,mode:u}=a[n],s=e.match(i);if(!s)continue;let o=r;for(let e=1;e<s.length;e++)o=nf(o,`{$${e}}`,s[e]);for(const e in t)o=nf(o,`{${e}}`,t[e]);return"replace"===u?o:e+o}return e}({message:`[${a.name}]: ${e.message}`,formatter:ef,extraInfo:{functionName:n}})),Promise.reject(e))))};e.callFunction=function(t){const{provider:n,spaceId:i}=e.config,r=t.name;let u,s;return t.data=t.data||{},u=a,u=u.bind(e),hf(t)||(s=ff(t)?new df({secretType:t.secretType,uniCloudIns:e}).wrapEncryptDataCallFunction(a.bind(e))(t):function({provider:e,spaceId:t,functionName:a}={}){const{appId:n,uniPlatform:i,osName:r}=xc();let u=i;"app"===i&&(u=r);const s=function({provider:e,spaceId:t}={}){if(!Kl)return{};var a;e="tencent"===(a=e)?"tcb":a;const n=Kl.find((a=>a.provider===e&&a.spaceId===t));return n&&n.config}({provider:e,spaceId:t});if(!s||!s.accessControl||!s.accessControl.enable)return!1;const o=s.accessControl.function||{},l=Object.keys(o);if(0===l.length)return!0;const c=function(e,t){let a,n,i;for(let r=0;r<e.length;r++){const u=e[r];u!==t?"*"!==u?u.split(",").map((e=>e.trim())).indexOf(t)>-1&&(n=u):i=u:a=u}return a||n||i}(l,a);if(!c)return!1;if((o[c]||[]).find(((e={})=>e.appId===n&&(e.platform||"").toLowerCase()===u.toLowerCase())))return!0;throw cf(lf)}({provider:n,spaceId:i,functionName:r})?new df({secretType:t.secretType,uniCloudIns:e}).wrapVerifyClientCallFunction(a.bind(e))(t):u(t)),Object.defineProperty(s,"result",{get:()=>({})}),s.then((e=>("undefined"!=typeof UTSJSONObject&&(e.result=new UTSJSONObject(e.result)),e)))}}df=class{constructor(){throw cf({message:`Platform ${Hl} is not supported by secure network`})}};const mf=Symbol("CLIENT_DB_INTERNAL");function _f(e,t){return e.then="DoNotReturnProxyWithAFunctionNamedThen",e._internalType=mf,e.inspect=null,e.__v_raw=void 0,new Proxy(e,{get(e,a,n){if("_uniClient"===a)return null;if("symbol"==typeof a)return e[a];if(a in e||"string"!=typeof a){const t=e[a];return"function"==typeof t?t.bind(e):t}return t.get(e,a,n)}})}function gf(e){return{on:(t,a)=>{e[t]=e[t]||[],e[t].indexOf(a)>-1||e[t].push(a)},off:(t,a)=>{e[t]=e[t]||[];const n=e[t].indexOf(a);-1!==n&&e[t].splice(n,1)}}}const yf=["db.Geo","db.command","command.aggregate"];function Df(e,t){return yf.indexOf(`${e}.${t}`)>-1}function wf(e){switch(Ll(e=wc(e))){case"array":return e.map((e=>wf(e)));case"object":return e._internalType===mf||Object.keys(e).forEach((t=>{e[t]=wf(e[t])})),e;case"regexp":return{$regexp:{source:e.source,flags:e.flags}};case"date":return{$date:e.toISOString()};default:return e}}function bf(e){return e&&e.content&&e.content.$method}class Cf{constructor(e,t,a){this.content=e,this.prevStage=t||null,this.udb=null,this._database=a}toJSON(){let e=this;const t=[e.content];for(;e.prevStage;)e=e.prevStage,t.push(e.content);return{$db:t.reverse().map((e=>({$method:e.$method,$param:wf(e.$param)})))}}toString(){return JSON.stringify(this.toJSON())}getAction(){const e=this.toJSON().$db.find((e=>"action"===e.$method));return e&&e.$param&&e.$param[0]}getCommand(){return{$db:this.toJSON().$db.filter((e=>"action"!==e.$method))}}get isAggregate(){let e=this;for(;e;){const t=bf(e),a=bf(e.prevStage);if("aggregate"===t&&"collection"===a||"pipeline"===t)return!0;e=e.prevStage}return!1}get isCommand(){let e=this;for(;e;){if("command"===bf(e))return!0;e=e.prevStage}return!1}get isAggregateCommand(){let e=this;for(;e;){const t=bf(e),a=bf(e.prevStage);if("aggregate"===t&&"command"===a)return!0;e=e.prevStage}return!1}getNextStageFn(e){const t=this;return function(){return Af({$method:e,$param:wf(Array.from(arguments))},t,t._database)}}get count(){return this.isAggregate?this.getNextStageFn("count"):function(){return this._send("count",Array.from(arguments))}}get remove(){return this.isCommand?this.getNextStageFn("remove"):function(){return this._send("remove",Array.from(arguments))}}get(){return this._send("get",Array.from(arguments))}get add(){return this.isCommand?this.getNextStageFn("add"):function(){return this._send("add",Array.from(arguments))}}update(){return this._send("update",Array.from(arguments))}end(){return this._send("end",Array.from(arguments))}get set(){return this.isCommand?this.getNextStageFn("set"):function(){throw new Error("JQL禁止使用set方法")}}_send(e,t){const a=this.getAction(),n=this.getCommand();return n.$db.push({$method:e,$param:wf(t)}),this._database._callCloudFunction({action:a,command:n})}}function Af(e,t,a){return _f(new Cf(e,t,a),{get(e,t){let n="db";return e&&e.content&&(n=e.content.$method),Df(n,t)?Af({$method:t},e,a):function(){return Af({$method:t,$param:wf(Array.from(arguments))},e,a)}}})}function kf({path:e,method:t}){return class{constructor(){this.param=Array.from(arguments)}toJSON(){return{$newDb:[...e.map((e=>({$method:e}))),{$method:t,$param:this.param}]}}toString(){return JSON.stringify(this.toJSON())}}}function xf(e,t={}){return _f(new e(t),{get:(e,t)=>Df("db",t)?Af({$method:t},null,e):function(){return Af({$method:t,$param:wf(Array.from(arguments))},null,e)}})}class Ef extends class{constructor({uniClient:e={},isJQL:t=!1}={}){this._uniClient=e,this._authCallBacks={},this._dbCallBacks={},e._isDefault&&(this._dbCallBacks=Yl("_globalUniCloudDatabaseCallback")),t||(this.auth=gf(this._authCallBacks)),this._isJQL=t,Object.assign(this,gf(this._dbCallBacks)),this.env=_f({},{get:(e,t)=>({$env:t})}),this.Geo=_f({},{get:(e,t)=>kf({path:["Geo"],method:t})}),this.serverDate=kf({path:[],method:"serverDate"}),this.RegExp=kf({path:[],method:"RegExp"})}getCloudEnv(e){if("string"!=typeof e||!e.trim())throw new Error("getCloudEnv参数错误");return{$env:e.replace("$cloudEnv_","")}}_callback(e,t){const a=this._dbCallBacks;a[e]&&a[e].forEach((e=>{e(...t)}))}_callbackAuth(e,t){const a=this._authCallBacks;a[e]&&a[e].forEach((e=>{e(...t)}))}multiSend(){const e=Array.from(arguments),t=e.map((e=>{const t=e.getAction(),a=e.getCommand();if("getTemp"!==a.$db[a.$db.length-1].$method)throw new Error("multiSend只支持子命令内使用getTemp");return{action:t,command:a}}));return this._callCloudFunction({multiCommand:t,queryList:e})}}{_parseResult(e){return this._isJQL?e.result:e}_callCloudFunction({action:e,command:t,multiCommand:a,queryList:n}){function i(e,t){if(a&&n)for(let a=0;a<n.length;a++){const i=n[a];i.udb&&"function"==typeof i.udb.setResult&&(t?i.udb.setResult(t):i.udb.setResult(e.result.dataList[a]))}}const r=this,u=this._isJQL?"databaseForJQL":"database";function s(e){return r._callback("error",[e]),tc(ac(u,"fail"),e).then((()=>tc(ac(u,"complete"),e))).then((()=>(i(null,e),pc(rc,{type:oc,content:e}),Promise.reject(e))))}const o=tc(ac(u,"invoke")),l=this._uniClient;return o.then((()=>l.callFunction({name:"DCloud-clientDB",type:"CLIENT_DB",data:{action:e,command:t,multiCommand:a}}))).then((e=>{const{code:t,message:a,token:n,tokenExpired:o,systemInfo:l=[]}=e.result;if(l)for(let i=0;i<l.length;i++){const{level:e,message:t,detail:a}=l[i];let n="[System Info]"+t;a&&(n=`${n}\n详细信息：${a}`),(console[e]||console.log)(n)}if(t)return s(new yc({code:t,message:a,requestId:e.requestId}));e.result.errCode=e.result.errCode||e.result.code,e.result.errMsg=e.result.errMsg||e.result.message,n&&o&&(Cc({token:n,tokenExpired:o}),this._callbackAuth("refreshToken",[{token:n,tokenExpired:o}]),this._callback("refreshToken",[{token:n,tokenExpired:o}]),pc(sc,{token:n,tokenExpired:o}));const c=[{prop:"affectedDocs",tips:"affectedDocs不再推荐使用，请使用inserted/deleted/updated/data.length替代"},{prop:"code",tips:"code不再推荐使用，请使用errCode替代"},{prop:"message",tips:"message不再推荐使用，请使用errMsg替代"}];for(let i=0;i<c.length;i++){const{prop:t,tips:a}=c[i];if(t in e.result){const a=e.result[t];Object.defineProperty(e.result,t,{get:()=>a})}}return d=e,tc(ac(u,"success"),d).then((()=>tc(ac(u,"complete"),d))).then((()=>{i(d,null);const e=r._parseResult(d);return pc(rc,{type:oc,content:e}),Promise.resolve(e)}));var d}),(e=>(/fc_function_not_found|FUNCTION_NOT_FOUND/g.test(e.message),s(new yc({code:e.code||"SYSTEM_ERROR",message:e.message,requestId:e.requestId})))))}}const Ff="token无效，跳转登录页面",If="token过期，跳转登录页面",Tf={TOKEN_INVALID_TOKEN_EXPIRED:If,TOKEN_INVALID_INVALID_CLIENTID:Ff,TOKEN_INVALID:Ff,TOKEN_INVALID_WRONG_TOKEN:Ff,TOKEN_INVALID_ANONYMOUS_USER:Ff},Sf={"uni-id-token-expired":If,"uni-id-check-token-failed":Ff,"uni-id-token-not-exist":Ff,"uni-id-check-device-feature-failed":Ff};function Bf(e,t){let a="";return a=e?`${e}/${t}`:t,a.replace(/^\//,"")}function Nf(e=[],t=""){const a=[],n=[];return e.forEach((e=>{!0===e.needLogin?a.push(Bf(t,e.path)):!1===e.needLogin&&n.push(Bf(t,e.path))})),{needLoginPage:a,notNeedLoginPage:n}}function Pf(e){return e.split("?")[0].replace(/^\//,"")}function Mf(){return function(e){let t=e&&e.$page&&e.$page.fullPath||"";return t?("/"!==t.charAt(0)&&(t="/"+t),t):t}(function(){const e=ht();return e[e.length-1]}())}function Of(){return Pf(Mf())}function Lf(e="",t={}){if(!e)return!1;if(!(t&&t.list&&t.list.length))return!1;const a=t.list,n=Pf(e);return a.some((e=>e.pagePath===n))}const Uf=!!El.uniIdRouter,{loginPage:Rf,routerNeedLogin:zf,resToLogin:jf,needLoginPage:$f,notNeedLoginPage:qf,loginPageInTabBar:Vf}=function({pages:e=[],subPackages:t=[],uniIdRouter:a={},tabBar:n={}}=El){const{loginPage:i,needLogin:r=[],resToLogin:u=!0}=a,{needLoginPage:s,notNeedLoginPage:o}=Nf(e),{needLoginPage:l,notNeedLoginPage:c}=function(e=[]){const t=[],a=[];return e.forEach((e=>{const{root:n,pages:i=[]}=e,{needLoginPage:r,notNeedLoginPage:u}=Nf(i,n);t.push(...r),a.push(...u)})),{needLoginPage:t,notNeedLoginPage:a}}(t);return{loginPage:i,routerNeedLogin:r,resToLogin:u,needLoginPage:[...s,...l],notNeedLoginPage:[...o,...c],loginPageInTabBar:Lf(i,n)}}();if($f.indexOf(Rf)>-1)throw new Error(`Login page [${Rf}] should not be "needLogin", please check your pages.json`);function Kf(e){const t=Of();if("/"===e.charAt(0))return e;const[a,n]=e.split("?"),i=a.replace(/^\//,"").split("/"),r=t.split("/");r.pop();for(let u=0;u<i.length;u++){const e=i[u];".."===e?r.pop():"."!==e&&r.push(e)}return""===r[0]&&r.shift(),"/"+r.join("/")+(n?"?"+n:"")}function Hf({redirect:e}){const t=Pf(e),a=Pf(Rf);return Of()!==a&&t!==a}function Wf({api:e,redirect:t}={}){if(!t||!Hf({redirect:t}))return;const a=(i=t,"/"!==(n=Rf).charAt(0)&&(n="/"+n),i?n.indexOf("?")>-1?n+`&uniIdRedirectUrl=${encodeURIComponent(i)}`:n+`?uniIdRedirectUrl=${encodeURIComponent(i)}`:n);var n,i;Vf?"navigateTo"!==e&&"redirectTo"!==e||(e="switchTab"):"switchTab"===e&&(e="navigateTo");const r={navigateTo:Et,redirectTo:Ft,switchTab:It,reLaunch:Tt};setTimeout((()=>{r[e]({url:a})}))}function Jf({url:e}={}){const t={abortLoginPageJump:!1,autoToLoginPage:!1},a=function(){const{token:e,tokenExpired:t}=bc();let a;if(e){if(t<Date.now()){const e="uni-id-token-expired";a={errCode:e,errMsg:Sf[e]}}}else{const e="uni-id-check-token-failed";a={errCode:e,errMsg:Sf[e]}}return a}();if(function(e){const t=Pf(Kf(e));return!(qf.indexOf(t)>-1)&&($f.indexOf(t)>-1||zf.some((t=>{return a=e,new RegExp(t).test(a);var a})))}(e)&&a){if(a.uniIdRedirectUrl=e,dc(uc).length>0)return setTimeout((()=>{pc(uc,a)}),0),t.abortLoginPageJump=!0,t;t.autoToLoginPage=!0}return t}function Zf(){!function(){const e=Mf(),{abortLoginPageJump:t,autoToLoginPage:a}=Jf({url:e});t||a&&Wf({api:"redirectTo",redirect:e})}();const e=["navigateTo","redirectTo","reLaunch","switchTab"];for(let t=0;t<e.length;t++){const a=e[t];pt(a,{invoke(e){const{abortLoginPageJump:t,autoToLoginPage:n}=Jf({url:e.url});return t?e:n?(Wf({api:a,redirect:Kf(e.url)}),!1):e}})}}function Yf(){this.onResponse((e=>{const{type:t,content:a}=e;let n=!1;switch(t){case"cloudobject":n=function(e){if("object"!=typeof e)return!1;const{errCode:t}=e||{};return t in Sf}(a);break;case"clientdb":n=function(e){if("object"!=typeof e)return!1;const{errCode:t}=e||{};return t in Tf}(a)}n&&function(e={}){const t=dc(uc);_c().then((()=>{const a=Mf();if(a&&Hf({redirect:a}))return t.length>0?pc(uc,Object.assign({uniIdRedirectUrl:a},e)):void(Rf&&Wf({api:"navigateTo",redirect:a}))}))}(a)}))}function Gf(e){var t;(t=e).onResponse=function(e){fc(rc,e)},t.offResponse=function(e){hc(rc,e)},function(e){e.onNeedLogin=function(e){fc(uc,e)},e.offNeedLogin=function(e){hc(uc,e)},Uf&&(Yl("_globalUniCloudStatus").needLoginInit||(Yl("_globalUniCloudStatus").needLoginInit=!0,_c().then((()=>{Zf.call(e)})),jf&&Yf.call(e)))}(e),function(e){e.onRefreshToken=function(e){fc(sc,e)},e.offRefreshToken=function(e){hc(sc,e)}}(e)}let Qf;const Xf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",eh=/^(?:[A-Za-z\d+/]{4})*?(?:[A-Za-z\d+/]{2}(?:==)?|[A-Za-z\d+/]{3}=?)?$/;function th(){const e=bc().token||"",t=e.split(".");if(!e||3!==t.length)return{uid:null,role:[],permission:[],tokenExpired:0};let a;try{a=JSON.parse((n=t[1],decodeURIComponent(Qf(n).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))))}catch(i){throw new Error("获取当前用户信息出错，详细错误信息为："+i.message)}var n;return a.tokenExpired=1e3*a.exp,delete a.exp,delete a.iat,a}Qf="function"!=typeof atob?function(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!eh.test(e))throw new Error("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");var t;e+="==".slice(2-(3&e.length));for(var a,n,i="",r=0;r<e.length;)t=Xf.indexOf(e.charAt(r++))<<18|Xf.indexOf(e.charAt(r++))<<12|(a=Xf.indexOf(e.charAt(r++)))<<6|(n=Xf.indexOf(e.charAt(r++))),i+=64===a?String.fromCharCode(t>>16&255):64===n?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,255&t);return i}:atob;var ah=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(Fl((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const a="chooseAndUploadFile:ok",n="chooseAndUploadFile:fail";function i(e,t){return e.tempFiles.forEach(((e,a)=>{e.name||(e.name=e.path.substring(e.path.lastIndexOf("/")+1)),t&&(e.fileType=t),e.cloudPath=Date.now()+"_"+a+e.name.substring(e.name.lastIndexOf("."))})),e.tempFilePaths||(e.tempFilePaths=e.tempFiles.map((e=>e.path))),e}function r(e,t,{onChooseFile:n,onUploadProgress:i}){return t.then((e=>{if(n){const t=n(e);if(void 0!==t)return Promise.resolve(t).then((t=>void 0===t?e:t))}return e})).then((t=>!1===t?{errMsg:a,tempFilePaths:[],tempFiles:[]}:function(e,t,n=5,i){(t=Object.assign({},t)).errMsg=a;const r=t.tempFiles,u=r.length;let s=0;return new Promise((a=>{for(;s<n;)o();function o(){const n=s++;if(n>=u)return void(!r.find((e=>!e.url&&!e.errMsg))&&a(t));const l=r[n];e.uploadFile({provider:l.provider,filePath:l.path,cloudPath:l.cloudPath,fileType:l.fileType,cloudPathAsRealPath:l.cloudPathAsRealPath,onUploadProgress(e){e.index=n,e.tempFile=l,e.tempFilePath=l.path,i&&i(e)}}).then((e=>{l.url=e.fileID,n<u&&o()})).catch((e=>{l.errMsg=e.errMsg||e.message,n<u&&o()}))}}))}(e,t,5,i)))}t.initChooseAndUploadFile=function(e){return function(t={type:"all"}){return"image"===t.type?r(e,function(e){const{count:t,sizeType:a,sourceType:r=["album","camera"],extension:u}=e;return new Promise(((e,s)=>{dt({count:t,sizeType:a,sourceType:r,extension:u,success(t){e(i(t,"image"))},fail(e){s({errMsg:e.errMsg.replace("chooseImage:fail",n)})}})}))}(t),t):"video"===t.type?r(e,function(e){const{camera:t,compressed:a,maxDuration:r,sourceType:u=["album","camera"],extension:s}=e;return new Promise(((e,o)=>{ft({camera:t,compressed:a,maxDuration:r,sourceType:u,extension:s,success(t){const{tempFilePath:a,duration:n,size:r,height:u,width:s}=t;e(i({errMsg:"chooseVideo:ok",tempFilePaths:[a],tempFiles:[{name:t.tempFile&&t.tempFile.name||"",path:a,size:r,type:t.tempFile&&t.tempFile.type||"",width:s,height:u,duration:n,fileType:"video",cloudPath:""}]},"video"))},fail(e){o({errMsg:e.errMsg.replace("chooseVideo:fail",n)})}})}))}(t),t):r(e,function(e){const{count:t,extension:a}=e;return new Promise(((e,r)=>{let u=vt;if("undefined"!=typeof wx&&"function"==typeof wx.chooseMessageFile&&(u=wx.chooseMessageFile),"function"!=typeof u)return r({errMsg:n+" 请指定 type 类型，该平台仅支持选择 image 或 video。"});u({type:"all",count:t,extension:a,success(t){e(i(t))},fail(e){r({errMsg:e.errMsg.replace("chooseFile:fail",n)})}})}))}(t),t)}}})));function nh(e){return{props:{localdata:{type:Array,default:()=>[]},options:{type:[Object,Array],default:()=>({})},spaceInfo:{type:Object,default:()=>({})},collection:{type:[String,Array],default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String],default:!1},gettreepath:{type:[Boolean,String],default:!1},startwith:{type:String,default:""},limitlevel:{type:Number,default:10},groupby:{type:String,default:""},groupField:{type:String,default:""},distinct:{type:[Boolean,String],default:!1},foreignKey:{type:String,default:""},loadtime:{type:String,default:"auto"},manual:{type:Boolean,default:!1}},data:()=>({mixinDatacomLoading:!1,mixinDatacomHasMore:!1,mixinDatacomResData:[],mixinDatacomErrorMessage:"",mixinDatacomPage:{},mixinDatacomError:null}),created(){this.mixinDatacomPage={current:this.pageCurrent,size:this.pageSize,count:0},this.$watch((()=>{var e=[];return["pageCurrent","pageSize","localdata","collection","action","field","orderby","where","getont","getcount","gettree","groupby","groupField","distinct"].forEach((t=>{e.push(this[t])})),e}),((e,t)=>{if("manual"===this.loadtime)return;let a=!1;const n=[];for(let i=2;i<e.length;i++)e[i]!==t[i]&&(n.push(e[i]),a=!0);e[0]!==t[0]&&(this.mixinDatacomPage.current=this.pageCurrent),this.mixinDatacomPage.size=this.pageSize,this.onMixinDatacomPropsChange(a,n)}))},methods:{onMixinDatacomPropsChange(e,t){},mixinDatacomEasyGet({getone:e=!1,success:t,fail:a}={}){this.mixinDatacomLoading||(this.mixinDatacomLoading=!0,this.mixinDatacomErrorMessage="",this.mixinDatacomError=null,this.mixinDatacomGet().then((a=>{this.mixinDatacomLoading=!1;const{data:n,count:i}=a.result;this.getcount&&(this.mixinDatacomPage.count=i),this.mixinDatacomHasMore=n.length<this.pageSize;const r=e?n.length?n[0]:void 0:n;this.mixinDatacomResData=r,t&&t(r)})).catch((e=>{this.mixinDatacomLoading=!1,this.mixinDatacomErrorMessage=e,this.mixinDatacomError=e,a&&a(e)})))},mixinDatacomGet(t={}){let a;t=t||{},a="undefined"!=typeof __uniX&&__uniX?e.databaseForJQL(this.spaceInfo):e.database(this.spaceInfo);const n=t.action||this.action;n&&(a=a.action(n));const i=t.collection||this.collection;a=Array.isArray(i)?a.collection(...i):a.collection(i);const r=t.where||this.where;r&&Object.keys(r).length&&(a=a.where(r));const u=t.field||this.field;u&&(a=a.field(u));const s=t.foreignKey||this.foreignKey;s&&(a=a.foreignKey(s));const o=t.groupby||this.groupby;o&&(a=a.groupBy(o));const l=t.groupField||this.groupField;l&&(a=a.groupField(l)),!0===(void 0!==t.distinct?t.distinct:this.distinct)&&(a=a.distinct());const c=t.orderby||this.orderby;c&&(a=a.orderBy(c));const d=void 0!==t.pageCurrent?t.pageCurrent:this.mixinDatacomPage.current,f=void 0!==t.pageSize?t.pageSize:this.mixinDatacomPage.size,h=void 0!==t.getcount?t.getcount:this.getcount,p=void 0!==t.gettree?t.gettree:this.gettree,v=void 0!==t.gettreepath?t.gettreepath:this.gettreepath,m={getCount:h},_={limitLevel:void 0!==t.limitlevel?t.limitlevel:this.limitlevel,startWith:void 0!==t.startwith?t.startwith:this.startwith};return p&&(m.getTree=_),v&&(m.getTreePath=_),a=a.skip(f*(d-1)).limit(f).get(m),a}}}}function ih(e){return Yl("_globalUniCloudSecureNetworkCache__{spaceId}".replace("{spaceId}",e.config.spaceId))}async function rh({openid:e,callLoginByWeixin:t=!1}={}){throw ih(this),new Error(`[SecureNetwork] API \`initSecureNetworkByWeixin\` is not supported on platform \`${Hl}\``)}async function uh(e){const t=ih(this);return t.initPromise||(t.initPromise=rh.call(this,e).then((e=>e)).catch((e=>{throw delete t.initPromise,e}))),t.initPromise}function sh(e){const t={getSystemInfo:St,getPushClientId:Bt};return function(a){return new Promise(((n,i)=>{t[e]({...a,success(e){n(e)},fail(e){i(e)}})}))}}class oh extends class{constructor(){this._callback={}}addListener(e,t){this._callback[e]||(this._callback[e]=[]),this._callback[e].push(t)}on(e,t){return this.addListener(e,t)}removeListener(e,t){if(!t)throw new Error('The "listener" argument must be of type function. Received undefined');const a=this._callback[e];if(!a)return;const n=function(e,t){for(let a=e.length-1;a>=0;a--)if(e[a]===t)return a;return-1}(a,t);a.splice(n,1)}off(e,t){return this.removeListener(e,t)}removeAllListener(e){delete this._callback[e]}emit(e,...t){const a=this._callback[e];if(a)for(let n=0;n<a.length;n++)a[n](...t)}}{constructor(){super(),this._uniPushMessageCallback=this._receivePushMessage.bind(this),this._currentMessageId=-1,this._payloadQueue=[]}init(){return Promise.all([sh("getSystemInfo")(),sh("getPushClientId")()]).then((([{appId:e}={},{cid:t}={}]=[])=>{if(!e)throw new Error("Invalid appId, please check the manifest.json file");if(!t)throw new Error("Invalid push client id");this._appId=e,this._pushClientId=t,this._seqId=Date.now()+"-"+Math.floor(9e5*Math.random()+1e5),this.emit("open"),this._initMessageListener()}),(e=>{throw this.emit("error",e),this.close(),e}))}async open(){return this.init()}_isUniCloudSSE(e){if("receive"!==e.type)return!1;const t=e&&e.data&&e.data.payload;return!(!t||"UNI_CLOUD_SSE"!==t.channel||t.seqId!==this._seqId)}_receivePushMessage(e){if(!this._isUniCloudSSE(e))return;const t=e&&e.data&&e.data.payload,{action:a,messageId:n,message:i}=t;this._payloadQueue.push({action:a,messageId:n,message:i}),this._consumMessage()}_consumMessage(){for(;;){const e=this._payloadQueue.find((e=>e.messageId===this._currentMessageId+1));if(!e)break;this._currentMessageId++,this._parseMessagePayload(e)}}_parseMessagePayload(e){const{action:t,messageId:a,message:n}=e;"end"===t?this._end({messageId:a,message:n}):"message"===t&&this._appendMessage({messageId:a,message:n})}_appendMessage({messageId:e,message:t}={}){this.emit("message",t)}_end({messageId:e,message:t}={}){this.emit("end",t),this.close()}_initMessageListener(){yt(this._uniPushMessageCallback)}_destroy(){Dt(this._uniPushMessageCallback)}toJSON(){return{appId:this._appId,pushClientId:this._pushClientId,seqId:this._seqId}}close(){this._destroy(),this.emit("close")}}const lh={tcb:$d,tencent:$d,aliyun:Nc,private:Vd,alipay:Qd};let ch=new class{init(e){let t={};const a=lh[e.provider];if(!a)throw new Error("未提供正确的provider参数");var n;return t=a.init(e),function(e){e._initPromiseHub||(e._initPromiseHub=new ql({createPromise:function(){let t=Promise.resolve();t=new Promise((e=>{setTimeout((()=>{e()}),1)}));const a=e.auth();return t.then((()=>a.getLoginState())).then((e=>e?Promise.resolve():a.signInAnonymously()))}}))}(t),vf(t),function(e){const t=e.uploadFile;e.uploadFile=function(e){return t.call(this,e)}}(t),(n=t).database=function(e){if(e&&Object.keys(e).length>0)return n.init(e).database();if(this._database)return this._database;const t=xf(Ef,{uniClient:n});return this._database=t,t},n.databaseForJQL=function(e){if(e&&Object.keys(e).length>0)return n.init(e).databaseForJQL();if(this._databaseForJQL)return this._databaseForJQL;const t=xf(Ef,{uniClient:n,isJQL:!0});return this._databaseForJQL=t,t},function(e){e.getCurrentUserInfo=th,e.chooseAndUploadFile=ah.initChooseAndUploadFile(e),Object.assign(e,{get mixinDatacom(){return nh(e)}}),e.SSEChannel=oh,e.initSecureNetworkByWeixin=function(e){return function({openid:t,callLoginByWeixin:a=!1}={}){return uh.call(e,{openid:t,callLoginByWeixin:a})}}(e),e.importObject=function(t){return function(a,n={}){n=function(e,t={}){return e.customUI=t.customUI||e.customUI,e.parseSystemError=t.parseSystemError||e.parseSystemError,Object.assign(e.loadingOptions,t.loadingOptions),Object.assign(e.errorOptions,t.errorOptions),"object"==typeof t.secretMethods&&(e.secretMethods=t.secretMethods),e}({customUI:!1,loadingOptions:{title:"加载中...",mask:!0},errorOptions:{type:"modal",retry:!1}},n);const{customUI:i,loadingOptions:r,errorOptions:u,parseSystemError:s}=n,o=!i;return new Proxy({},{get(i,l){switch(l){case"toString":return"[object UniCloudObject]";case"toJSON":return{}}return function({fn:e,interceptorName:t,getCallbackArgs:a}={}){return async function(...n){const i=a?a({params:n}):{};let r,u;try{return await tc(ac(t,"invoke"),{...i}),r=await e(...n),await tc(ac(t,"success"),{...i,result:r}),r}catch(s){throw u=s,await tc(ac(t,"fail"),{...i,error:u}),u}finally{await tc(ac(t,"complete"),u?{...i,error:u}:{...i,result:r})}}}({fn:async function i(...c){let d;o&&mt({title:r.title,mask:r.mask});const f={name:a,type:"OBJECT",data:{method:l,params:c}};"object"==typeof n.secretMethods&&function(e,t){const a=t.data.method,n=e.secretMethods||{},i=n[a]||n["*"];i&&(t.secretType=i)}(n,f);let h=!1;try{d=await t.callFunction(f)}catch(e){h=!0,d={result:new yc(e)}}const{errSubject:p,errCode:v,errMsg:m,newToken:_}=d.result||{};if(o&&_t(),_&&_.token&&_.tokenExpired&&(Cc(_),pc(sc,{..._})),v){let e=m;if(h&&s&&(e=(await s({objectName:a,methodName:l,params:c,errSubject:p,errCode:v,errMsg:m})).errMsg||m),o)if("toast"===u.type)uni.showToast({title:e,icon:"none"});else{if("modal"!==u.type)throw new Error(`Invalid errorOptions.type: ${u.type}`);{const{confirm:t}=await async function({title:e,content:t,showCancel:a,cancelText:n,confirmText:i}={}){return new Promise(((r,u)=>{gt({title:e,content:t,showCancel:a,cancelText:n,confirmText:i,success(e){r(e)},fail(){r({confirm:!1,cancel:!0})}})}))}({title:"提示",content:e,showCancel:u.retry,cancelText:"取消",confirmText:u.retry?"重试":"确定"});if(u.retry&&t)return i(...c)}}const t=new yc({subject:p,code:v,message:m,requestId:d.requestId});throw t.detail=d.result,pc(rc,{type:cc,content:t}),t}return pc(rc,{type:cc,content:d.result}),d.result},interceptorName:"callObject",getCallbackArgs:function({params:e}={}){return{objectName:a,methodName:l,params:e}}})}})}}(e)}(t),["callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","chooseAndUploadFile"].forEach((e=>{if(!t[e])return;const a=t[e];var n,i;t[e]=function(){return a.apply(t,Array.from(arguments))},t[e]=(n=t[e],i=e,function(e){let t=!1;if("callFunction"===i){const a=e&&e.type||Pl;t=a!==Pl}const a="callFunction"===i&&!t,r=this._initPromiseHub.exec();e=e||{};const{success:u,fail:s,complete:o}=gc(e),l=r.then((()=>t?Promise.resolve():tc(ac(i,"invoke"),e))).then((()=>n.call(this,e))).then((e=>t?Promise.resolve(e):tc(ac(i,"success"),e).then((()=>tc(ac(i,"complete"),e))).then((()=>(a&&pc(rc,{type:lc,content:e}),Promise.resolve(e))))),(e=>t?Promise.reject(e):tc(ac(i,"fail"),e).then((()=>tc(ac(i,"complete"),e))).then((()=>(pc(rc,{type:lc,content:e}),Promise.reject(e))))));if(!(u||s||o))return l;l.then((e=>{u&&u(e),o&&o(e),a&&pc(rc,{type:lc,content:e})}),(e=>{s&&s(e),o&&o(e),a&&pc(rc,{type:lc,content:e})}))}).bind(t)})),t.init=this.init,t}};(()=>{const e=Wl;let t={};if(e&&1===e.length)t=e[0],ch=ch.init(t),ch._isDefault=!0;else{const t=["auth","callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","database","getCurrentUSerInfo","importObject"];let a;a=e&&e.length>0?"应用有多个服务空间，请通过uniCloud.init方法指定要使用的服务空间":"uni-app cli项目内使用uniCloud需要使用HBuilderX的运行菜单运行项目，且需要在uniCloud目录关联服务空间",t.forEach((e=>{ch[e]=function(){return Promise.reject(new yc({code:"SYS_ERR",message:a}))}}))}Object.assign(ch,{get mixinDatacom(){return nh(ch)}}),Gf(ch),ch.addInterceptor=Xl,ch.removeInterceptor=ec,ch.interceptObject=nc})();const dh=T({name:"uni-data-select",mixins:[ch.mixinDatacom||{}],props:{localdata:{type:Array,default:()=>[]},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},placeholder:{type:String,default:"请选择"},emptyTips:{type:String,default:"无选项"},clear:{type:Boolean,default:!0},defItem:{type:Number,default:0},disabled:{type:Boolean,default:!1},format:{type:String,default:""}},data:()=>({showSelector:!1,current:"",mixinDatacomResData:[],apps:[],channels:[],cacheKey:"uni-data-select-lastSelectedValue"}),created(){this.debounceGet=this.debounce((()=>{this.query()}),300),this.collection&&!this.localdata.length&&this.debounceGet()},computed:{typePlaceholder(){const e=this.placeholder,t={"opendb-stat-app-versions":"版本","opendb-app-channels":"渠道","opendb-app-list":"应用"}[this.collection];return t?e+t:e},valueCom(){return this.modelValue}},watch:{localdata:{immediate:!0,handler(e,t){Array.isArray(e)&&t!==e&&(this.mixinDatacomResData=e)}},valueCom(e,t){this.initDefVal()},mixinDatacomResData:{immediate:!0,handler(e){e.length&&this.initDefVal()}}},methods:{debounce(e,t=100){let a=null;return function(...n){a&&clearTimeout(a),a=setTimeout((()=>{e.apply(this,n)}),t)}},query(){this.mixinDatacomEasyGet()},onMixinDatacomPropsChange(){this.collection&&this.debounceGet()},initDefVal(){let e="";if(!this.valueCom&&0!==this.valueCom||this.isDisabled(this.valueCom)){let t;if(this.collection&&(t=this.getCache()),t||0===t)e=t;else{let t="";this.defItem>0&&this.defItem<=this.mixinDatacomResData.length&&(t=this.mixinDatacomResData[this.defItem-1].value),e=t}(e||0===e)&&this.emit(e)}else e=this.valueCom;const t=this.mixinDatacomResData.find((t=>t.value===e));this.current=t?this.formatItemName(t):""},isDisabled(e){let t=!1;return this.mixinDatacomResData.forEach((a=>{a.value===e&&(t=a.disable)})),t},clearVal(){this.emit(""),this.collection&&this.removeCache()},change(e){e.disable||(this.showSelector=!1,this.current=this.formatItemName(e),this.emit(e.value))},emit(e){this.$emit("input",e),this.$emit("update:modelValue",e),this.$emit("change",e),this.collection&&this.setCache(e)},toggleSelector(){this.disabled||(this.showSelector=!this.showSelector)},formatItemName(e){let{text:t,value:a,channel_code:n}=e;if(n=n?`(${n})`:"",this.format){let t="";t=this.format;for(let a in e)t=t.replace(new RegExp(`{${a}}`,"g"),e[a]);return t}return this.collection.indexOf("app-list")>0?`${t}(${a})`:t||`未命名${n}`},getLoadData(){return this.mixinDatacomResData},getCurrentCacheKey(){return this.collection},getCache(e=this.getCurrentCacheKey()){return(At(this.cacheKey)||{})[e]},setCache(e,t=this.getCurrentCacheKey()){let a=At(this.cacheKey)||{};a[t]=e,Ct(this.cacheKey,a)},removeCache(e=this.getCurrentCacheKey()){let t=At(this.cacheKey)||{};delete t[e],Ct(this.cacheKey,t)}}},[["render",function(e,t,a,n,i,r){const u=$,s=N(M("uni-icons"),Ce),o=ce,l=ae;return O(),L(u,{class:"uni-stat__select"},{default:U((()=>[a.label?(O(),X("span",{key:0,class:"uni-label-text hide-on-phone"},J(a.label+"："),1)):de("",!0),R(u,{class:j(["uni-stat-box",{"uni-stat__actived":i.current}])},{default:U((()=>[R(u,{class:j(["uni-select",{"uni-select--disabled":a.disabled}])},{default:U((()=>[R(u,{class:"uni-select__input-box",onClick:r.toggleSelector},{default:U((()=>[i.current?(O(),L(u,{key:0,class:"uni-select__input-text"},{default:U((()=>[W(J(i.current),1)])),_:1})):(O(),L(u,{key:1,class:"uni-select__input-text uni-select__input-placeholder"},{default:U((()=>[W(J(r.typePlaceholder),1)])),_:1})),i.current&&a.clear&&!a.disabled?(O(),L(u,{key:2,onClick:Ae(r.clearVal,["stop"])},{default:U((()=>[R(s,{type:"clear",color:"#c0c4cc",size:"24"})])),_:1},8,["onClick"])):(O(),L(u,{key:3},{default:U((()=>[R(s,{type:i.showSelector?"top":"bottom",size:"14",color:"#999"},null,8,["type"])])),_:1}))])),_:1},8,["onClick"]),i.showSelector?(O(),L(u,{key:0,class:"uni-select--mask",onClick:r.toggleSelector},null,8,["onClick"])):de("",!0),i.showSelector?(O(),L(u,{key:1,class:"uni-select__selector"},{default:U((()=>[R(u,{class:"uni-popper__arrow"}),R(l,{"scroll-y":"true",class:"uni-select__selector-scroll"},{default:U((()=>[0===i.mixinDatacomResData.length?(O(),L(u,{key:0,class:"uni-select__selector-empty"},{default:U((()=>[R(o,null,{default:U((()=>[W(J(a.emptyTips),1)])),_:1})])),_:1})):(O(!0),X(ee,{key:1},te(i.mixinDatacomResData,((e,t)=>(O(),L(u,{class:"uni-select__selector-item",key:t,onClick:t=>r.change(e)},{default:U((()=>[R(o,{class:j({"uni-select__selector__disabled":e.disable})},{default:U((()=>[W(J(r.formatItemName(e)),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):de("",!0)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1})}],["__scopeId","data-v-6425133e"]]),fh={en:{"uni-pagination.prevText":"prev","uni-pagination.nextText":"next","uni-pagination.piecePerPage":"piece/page"},es:{"uni-pagination.prevText":"anterior","uni-pagination.nextText":"prxima","uni-pagination.piecePerPage":"Art��culo/P��gina"},fr:{"uni-pagination.prevText":"précédente","uni-pagination.nextText":"suivante","uni-pagination.piecePerPage":"Articles/Pages"},"zh-Hans":{"uni-pagination.prevText":"上一页","uni-pagination.nextText":"下一页","uni-pagination.piecePerPage":"条/页"},"zh-Hant":{"uni-pagination.prevText":"上一頁","uni-pagination.nextText":"下一頁","uni-pagination.piecePerPage":"條/頁"}},{t:hh}=Mt(fh),ph={name:"UniPagination",emits:["update:modelValue","input","change","pageSizeChange"],props:{value:{type:[Number,String],default:1},modelValue:{type:[Number,String],default:1},prevText:{type:String},nextText:{type:String},piecePerPageText:{type:String},current:{type:[Number,String],default:1},total:{type:[Number,String],default:0},pageSize:{type:[Number,String],default:10},showIcon:{type:[Boolean,String],default:!1},showPageSize:{type:[Boolean,String],default:!1},pagerCount:{type:Number,default:7},pageSizeRange:{type:Array,default:()=>[20,50,100,500]}},data:()=>({pageSizeIndex:0,currentIndex:1,paperData:[],pickerShow:!1}),computed:{piecePerPage(){return this.piecePerPageText||hh("uni-pagination.piecePerPage")},prevPageText(){return this.prevText||hh("uni-pagination.prevText")},nextPageText(){return this.nextText||hh("uni-pagination.nextText")},maxPage(){let e=1,t=Number(this.total),a=Number(this.pageSize);return t&&a&&(e=Math.ceil(t/a)),e},paper(){const e=this.currentIndex,t=this.pagerCount,a=this.total,n=this.pageSize;let i=[],r=[],u=Math.ceil(a/n);for(let o=0;o<u;o++)i.push(o+1);r.push(1);const s=i[i.length-(t+1)/2];return i.forEach(((a,n)=>{(t+1)/2>=e?a<t+1&&a>1&&r.push(a):e+2<=s?a>e-(t+1)/2&&a<e+(t+1)/2&&r.push(a):(a>e-(t+1)/2||u-t<a)&&a<i[i.length-1]&&r.push(a)})),u>t?((t+1)/2>=e?r[r.length-1]="...":e+2<=s?(r[1]="...",r[r.length-1]="..."):r[1]="...",r.push(i[i.length-1])):(t+1)/2>=e||e+2<=s||(r.shift(),r.push(i[i.length-1])),r}},watch:{current:{immediate:!0,handler(e,t){this.currentIndex=e<1?1:e}},value:{immediate:!0,handler(e){1===Number(this.current)&&(this.currentIndex=e<1?1:e)}},pageSizeIndex(e){this.$emit("pageSizeChange",this.pageSizeRange[e])}},methods:{pickerChange(e){this.pageSizeIndex=e.detail.value,this.pickerClick()},pickerClick(){const e=document.querySelector("body");if(!e)return;const t="uni-pagination-picker-show";this.pickerShow=!this.pickerShow,this.pickerShow?e.classList.add(t):setTimeout((()=>e.classList.remove(t)),300)},selectPage(e,t){if(parseInt(e))this.currentIndex=e,this.change("current");else{let e=Math.ceil(this.total/this.pageSize);if(t<=1)return void(this.currentIndex-5>1?this.currentIndex-=5:this.currentIndex=1);if(t>=6)return void(this.currentIndex+5>e?this.currentIndex=e:this.currentIndex+=5)}},clickLeft(){1!==Number(this.currentIndex)&&(this.currentIndex-=1,this.change("prev"))},clickRight(){Number(this.currentIndex)>=this.maxPage||(this.currentIndex+=1,this.change("next"))},change(e){this.$emit("input",this.currentIndex),this.$emit("update:modelValue",this.currentIndex),this.$emit("change",{type:e,current:this.currentIndex})}}};const vh=T(ph,[["render",function(e,t,a,n,i,r){const u=ce,s=N(M("uni-icons"),Ce),o=be,l=Ot,c=$;return O(),L(c,{class:"uni-pagination"},{default:U((()=>[!0===a.showPageSize||"true"===a.showPageSize?(O(),L(l,{key:0,class:"select-picker",mode:"selector",value:i.pageSizeIndex,range:a.pageSizeRange,onChange:r.pickerChange,onCancel:r.pickerClick,onClick:r.pickerClick},{default:U((()=>[R(o,{type:"default",size:"mini",plain:!0},{default:U((()=>[R(u,null,{default:U((()=>[W(J(a.pageSizeRange[i.pageSizeIndex])+" "+J(r.piecePerPage),1)])),_:1}),R(s,{class:"select-picker-icon",type:"arrowdown",size:"12",color:"#999"})])),_:1})])),_:1},8,["value","range","onChange","onCancel","onClick"])):de("",!0),R(c,{class:"uni-pagination__total is-phone-hide"},{default:U((()=>[W("共 "+J(a.total)+" 条",1)])),_:1}),R(c,{class:j(["uni-pagination__btn",1===i.currentIndex?"uni-pagination--disabled":"uni-pagination--enabled"]),"hover-class":1===i.currentIndex?"":"uni-pagination--hover","hover-start-time":20,"hover-stay-time":70,onClick:r.clickLeft},{default:U((()=>[!0===a.showIcon||"true"===a.showIcon?(O(),L(s,{key:0,color:"#666",size:"16",type:"left"})):(O(),L(u,{key:1,class:"uni-pagination__child-btn"},{default:U((()=>[W(J(r.prevPageText),1)])),_:1}))])),_:1},8,["class","hover-class","onClick"]),R(c,{class:"uni-pagination__num uni-pagination__num-flex-none"},{default:U((()=>[R(c,{class:"uni-pagination__num-current"},{default:U((()=>[R(u,{class:"uni-pagination__num-current-text is-pc-hide current-index-text"},{default:U((()=>[W(J(i.currentIndex),1)])),_:1}),R(u,{class:"uni-pagination__num-current-text is-pc-hide"},{default:U((()=>[W("/"+J(r.maxPage||0),1)])),_:1}),(O(!0),X(ee,null,te(r.paper,((e,t)=>(O(),L(c,{key:t,class:j([{"page--active":e===i.currentIndex},"uni-pagination__num-tag tag--active is-phone-hide"]),onClick:a=>r.selectPage(e,t)},{default:U((()=>[R(u,null,{default:U((()=>[W(J(e),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),R(c,{class:j(["uni-pagination__btn",i.currentIndex>=r.maxPage?"uni-pagination--disabled":"uni-pagination--enabled"]),"hover-class":i.currentIndex===r.maxPage?"":"uni-pagination--hover","hover-start-time":20,"hover-stay-time":70,onClick:r.clickRight},{default:U((()=>[!0===a.showIcon||"true"===a.showIcon?(O(),L(s,{key:0,color:"#666",size:"16",type:"right"})):(O(),L(u,{key:1,class:"uni-pagination__child-btn"},{default:U((()=>[W(J(r.nextPageText),1)])),_:1}))])),_:1},8,["class","hover-class","onClick"])])),_:1})}],["__scopeId","data-v-7a02a0a9"]]),mh=T({__name:"order-type-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null}},emits:["update:menuId","menuClick"],setup(e,{emit:t}){const a=t,n=e,i=F(0),r=F(0),u=F([]),s=qe().in(this);q((()=>n.list),(async e=>{if(e&&0!=e.length&&(await je(),e.map(((e,t)=>{s.select(`#scroll-item-${t}`).boundingClientRect((e=>{if(!e)return;const a=u.value;a[t]=e.width+10,u.value=a})).exec()})),n.menuId>0)){const e=n.list.findIndex((e=>e.category_id==n.menuId));e>-1&&o(e)}}),{deep:!0,immediate:!0});const o=e=>{r.value=e,i.value=u.value.slice(0,e+1).reduce(((e,t)=>e+t),0)-(u.value[e]+100),a("update:menuId",n.list[e].category_id),a("menuClick",n.list[e].category_id)};return(e,t)=>{const a=ce,u=$,s=ae;return O(),L(s,{class:"ti-order-menu","scroll-left":i.value,"scroll-x":"","enable-flex":"","scroll-with-animation":""},{default:U((()=>[R(u,{class:"ti-menu-content"},{default:U((()=>[(O(!0),X(ee,null,te(n.list,((e,t)=>(O(),L(u,{key:t,class:j(["ti-menu-item",{active:t==r.value}]),id:`scroll-item-${t}`,onClick:e=>o(t)},{default:U((()=>[R(u,null,{default:U((()=>[R(a,{class:"ti-menu-title"},{default:U((()=>[W(J(`${Z(Y)(e.name_text)}`+(e.number?`(${e.number})`:"")),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scroll-left"])}}},[["__scopeId","data-v-0c36077c"]]),_h=T({__name:"dialog-refuse-payed",props:{show:{type:Boolean,default:!1},orderAmount:{type:String,default:""}},emits:["update:show","success"],setup(e,{expose:t,emit:a}){const n=a,i=e,r=F({refund_money:""}),u=F({}),s=F(!1),o=ne((()=>parseFloat(u.value.pay_price)-parseFloat(u.value.refund_money))),l=()=>{r.value.refund_money=""},c=e=>{r.value.refund_money+=e,d()},d=()=>{parseFloat(r.value.refund_money)>o.value&&(r.value.refund_money=parseFloat(o.value)+"")},f=async()=>{const e={...r.value};e.order_id=u.value.order_id;try{s.value=!0;const t=await function(e){return k("order.order/refund",e)}(e);setTimeout((()=>{uni.showToast({title:t.msg,icon:"none"})}),200),1==t.code&&(h(),n("success")),s.value=!1}catch(t){}finally{s.value=!1}},h=()=>{r.value.refund_money="",n("update:show",!1)};return t({getOrderData:e=>{u.value=e,n("update:show",!0)}}),(e,t)=>{const a=$,n=ce,u=N(M("ti-input"),V),d=N(M("ti-keyboard"),K),p=N(M("ti-modal"),H);return O(),L(p,{show:i.show,title:Z(Y)("退款")},{content:U((()=>[R(a,{class:"ti-dialog-content"},{default:U((()=>[R(a,{class:"ti-preferential-box"},{default:U((()=>[R(a,{class:"ti-preferential-label"},{default:U((()=>[W(J(Z(Y)("可退款金額")),1)])),_:1}),R(a,{class:"ti-preferential-input"},{default:U((()=>[R(n,{class:"ti-preferential-price"},{default:U((()=>[W(J(Z(se)(o.value)),1)])),_:1}),R(n,{class:"ti-preferential-subPrice"},{default:U((()=>[W(J(Z(oe)(o.value)),1)])),_:1})])),_:1})])),_:1}),R(a,{class:"ti-preferential-input-item"},{default:U((()=>[R(u,{modelValue:r.value.refund_money,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value.refund_money=e),placeholder:Z(Y)("請輸入退款金額，不能大於可退款金額"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:U((()=>[R(a,{class:"ti-dialog-btn ti-preferential-keyboard"},{default:U((()=>[R(d,{primaryLoading:s.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:h,onClear:l,onInput:c,onConfirm:f},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-b576680d"]]),gh=T({__name:"dialog-order-detail",setup(e,{expose:t}){const a=F(""),n=F(!1),i=F(!1),r=F(!1),u=F(!1),s=F({}),o=F(),l=F(!1),c=F(!1),d=F([]),f=ne((()=>{const e=[];return(s.value.buffet||[]).map((t=>{e.push(t.name_text||t.name)})),e.join("+")})),h=async()=>{const e={order_id:a.value};c.value=!0;try{const t=await function(e){return k("order.order/detail",e)}(e);d.value=t.data.detail.product||[],s.value=t.data.detail}catch(t){}finally{c.value=!1}},p=()=>{r.value=!0},v=()=>{i.value=!0},m=()=>{var e;null==(e=o.value)||e.getOrderData(s.value)},_=()=>{u.value=!0},g=async()=>{const e={order_id:a.value};i.value=!1;try{const t=await qn(e);setTimeout((()=>{uni.showToast({title:t.msg,icon:"none"}),1==t.code&&w()}),200)}catch(t){}},y=async()=>{const e={order_id:a.value};r.value=!1;try{const t=await Vn(e);setTimeout((()=>{uni.showToast({title:t.msg,icon:"none"}),1==t.code&&w()}),200)}catch(t){}},D=async()=>{const e={order_id:a.value};u.value=!1;try{const t=await Kn(e);setTimeout((()=>{uni.showToast({title:t.msg,icon:"none"})}),200)}catch(t){}},w=()=>{l.value=!1,i.value=!1,r.value=!1};return t({showDetailWithData:e=>{a.value=e,l.value=!0,h()}}),(e,t)=>{const a=$,b=N(M("uni-td"),Lt),C=N(M("uni-tr"),Ut),A=Te,k=N(M("ti-image"),Ye),x=N(M("uni-table"),Rt),E=ae,F=N(M("ti-button"),G),I=N(M("ti-modal"),H),T=N(M("ti-drawer"),ue);return O(),L(a,{class:""},{default:U((()=>[R(T,{ref:"dialogRef",title:Z(Y)("訂單詳情"),round:16,show:l.value,width:660,mode:"right"},{content:U((()=>[R(a,{class:"ti-order-detail-container"},{default:U((()=>[R(a,{class:"ti-order-detail-header"},{default:U((()=>[R(a,{class:"ti-order-detail-header-tag"}),R(a,{class:"ti-order-detail-header-title"},{default:U((()=>[W(J(Z(Y)("基本信息")),1)])),_:1})])),_:1}),R(a,{class:"ti-order-detail-other"},{default:U((()=>{var e,t,n,i;return[R(a,{class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("訂單類型")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>[W(J(s.value.order_type_text||"-"),1)])),_:1})])),_:1}),R(a,{class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("訂單號")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>[W(J(s.value.order_no||"-"),1)])),_:1})])),_:1}),s.value.user?(O(),L(a,{key:0,class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("買家")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>{var e;return[W(J((null==(e=s.value.user)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1})):de("",!0),R(a,{class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("訂單金額")),1)])),_:1}),R(a,{class:"ti-order-detail-other-price-list"},{default:U((()=>[R(a,{class:"ti-order-detail-other-price-main"},{default:U((()=>[W(J(Z(se)(s.value.order_price)),1)])),_:1}),R(a,{class:"ti-order-detail-other-price-sub"},{default:U((()=>[W(J(Z(oe)(s.value.order_price)),1)])),_:1})])),_:1})])),_:1}),R(a,{class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("实付金额")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>{var e,t,a;return[W(J(10==(null==(t=null==(e=s.value)?void 0:e.pay_status)?void 0:t.value)?"-":Z(se)(null==(a=s.value)?void 0:a.actual_receive_price)),1)]})),_:1})])),_:1}),20==(null==(t=null==(e=s.value)?void 0:e.pay_status)?void 0:t.value)&&(null==(n=s.value)?void 0:n.refund_money)>0?(O(),L(a,{key:1,class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("退款金额")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>{var e;return[W(J(Z(se)(null==(e=s.value)?void 0:e.refund_money)),1)]})),_:1})])),_:1})):de("",!0),R(a,{class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("支付方式")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>{var e,t,a;return[W(J(10==(null==(t=null==(e=s.value)?void 0:e.pay_status)?void 0:t.value)?"-":null==(a=s.value.pay_type)?void 0:a.text),1)]})),_:1})])),_:1}),R(a,{class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("用餐方式")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>{var e;return[W(J(null==(e=s.value.delivery_type)?void 0:e.text),1)]})),_:1})])),_:1}),0===s.value.table_id?(O(),L(a,{key:2,class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("序號")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>[W(J(s.value.callNo),1)])),_:1})])),_:1})):de("",!0),0!==s.value.table_id?(O(),L(a,{key:3,class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("桌號")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>[W(J(s.value.table_no),1)])),_:1})])),_:1})):de("",!0),R(a,{class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("交易狀態")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>[W(J(s.value.state_text),1)])),_:1})])),_:1}),R(a,{class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("收銀員")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>{var e,t;return[W(J(null==(t=null==(e=s.value)?void 0:e.cashier)?void 0:t.real_name),1)]})),_:1})])),_:1}),1==(null==(i=s.value)?void 0:i.is_buffet)?(O(),L(a,{key:4,class:"ti-order-detail-other-item"},{default:U((()=>[R(a,{class:"ti-order-detail-other-item-title"},{default:U((()=>[W(J(Z(Y)("自助餐")),1)])),_:1}),R(a,{class:"ti-order-detail-other-item-content"},{default:U((()=>[W(J(f.value),1)])),_:1})])),_:1})):de("",!0)]})),_:1}),R(a,{class:"ti-order-detail-header"},{default:U((()=>[R(a,{class:"ti-order-detail-header-tag"}),R(a,{class:"ti-order-detail-header-title"},{default:U((()=>[W(J(Z(Y)("商品信息")),1)])),_:1})])),_:1}),R(a,{class:"scroll-content"},{default:U((()=>[R(E,{class:"scroll-view","scroll-y":"true"},{default:U((()=>[R(a,{class:"scroll-view-bg"},{default:U((()=>[R(x,{class:"table-body",ref:"table",loading:c.value,border:"",stripe:"",emptyText:Z(Y)("暂无更多数据")},{default:U((()=>[R(C,{class:"table-header"},{default:U((()=>[R(b,{width:"240",align:"left"},{default:U((()=>[W(J(Z(Y)("商品")),1)])),_:1}),R(b,{width:"140",align:"right"},{default:U((()=>[W(J(Z(Y)("價格")),1)])),_:1}),R(b,{width:"80",align:"right"},{default:U((()=>[W(J(Z(Y)("購買數量")),1)])),_:1}),R(b,{width:"140",align:"right"},{default:U((()=>[W(J(Z(Y)("商品總價")),1)])),_:1})])),_:1}),(O(!0),X(ee,null,te(s.value.buffetCustomerType,((e,t)=>(O(),L(C,{key:t},{default:U((()=>[R(b,{width:"240"},{default:U((()=>[R(a,{class:"goods-list"},{default:U((()=>[R(A,{class:"goods-list-image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAYAAACohjseAAAACXBIWXMAAAsSAAALEgHS3X78AAACP0lEQVRoge2aPSwDYRiAXyJhQCdEk3YROtBYWNRQTCXRifjbJH4Goy5YMEgNBgMGnUSsJEyY2i7t1kr8bCckbMVADOS99C7Xy9317616m+9JLv3ue79ev+e+/6RV3w9rP1DBVFeyHAjBCkAIckcIckcIckcIckcIckcIcodcMLgXhjbPDjR1b8mXf/YYHp9TahzTGL+4vpcvTEfikpq3ErwE73iIrD6kgktr57C9H4a3jy81LxqXwDsWgtT7p3wvPafkePLuVb4wHYlJGXk3d69kdSITxFY4OUsYxrDyq8Erqp/KCzLBg6OYZRzltV31r6BrwZiUtUzi9oWvoHbcmZEkHFu5UtZlQpl4SkkN1bMb62uztqLTblPTOGaV8sr41eZRQdaCw4MdWct4ep3g6XHKaa2IklY+Ha02kyfkD5ng/EyPZXxi1A2OdAvOTWcp63dTVYtOsMvVArvrI4axTlczbAaG1PvAYj/0pVtSD74IjFNBOsngm19eyKwcjs3TwymwNdSpeZjGPN9Ae+b3R92wu2H8kgqFfBbVd1WU1sppcdhtlvf/UlAvYyYHButiKXY65IL5VFK/DkocBPWVxE24GfpTQykW/n914KU8JinQd9Gn3LqZVctSUvIuGs1ThFq8bF00l+MVBeSCxU4USeIzI7lgsWc+q3WzEMgFu1zNOZWbNNhQ47bON9huWL5QyAX1G2mzDThuyzCGUooc7kOpW1D8T4Y7QpA7QpA7QpA7QpA7QpA7QpA7QpA1APALkSrRS/P5cqkAAAAASUVORK5CYII=",mode:"widthFix"}),R(a,{class:"goods-list-title"},{default:U((()=>[R(a,{class:"goods-list-main-title"},{default:U((()=>[W(J(e.buffet_name_text),1)])),_:2},1024),R(a,{class:"goods-list-sub-title"},{default:U((()=>[W("("+J(e.customer_type_name_text)+")",1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),R(b,{align:"right",width:"140"},{default:U((()=>[R(a,{class:"price-colum"},{default:U((()=>[R(a,{class:"price-table-sub"},{default:U((()=>[W(J(Z(oe)(e.price)),1)])),_:2},1024),R(a,{class:"price-table-main"},{default:U((()=>[W(J(Z(se)(e.price)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),R(b,{align:"right",width:"80"},{default:U((()=>[R(a,{class:"price-table"},{default:U((()=>[W(J(e.num),1)])),_:2},1024)])),_:2},1024),R(b,{align:"right",width:"140"},{default:U((()=>[R(a,{class:"price-colum"},{default:U((()=>[R(a,{class:"price-table-sub"},{default:U((()=>[W(J(Z(oe)(e.total_price||0)),1)])),_:2},1024),R(a,{class:"price-table-main"},{default:U((()=>[W(J(Z(se)(e.total_price||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),(O(!0),X(ee,null,te(s.value.delay,((e,t)=>(O(),L(C,{key:t},{default:U((()=>[R(b,{width:"240"},{default:U((()=>[R(a,{class:"goods-list"},{default:U((()=>[R(A,{class:"goods-list-image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAYAAACohjseAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/klEQVRoge2YPSxDURiGPyLpgm4apN2oRC3STjX4G9DEJhHE0IF0aGLRRTuppcYOFQkTiRCJSIrBTwed2lgYRLcaxFgMxEDeG4vSuHq+ezk351lv7nvOk3Pv+c53al4LsTeyMLVWliMlaAGUoOwoQdlRgrKjBGVHCcqOEpSdOiPnf3B6Q4dnBcrminR7V/r0zNlsJ7/PRcN9bTTS327YHAxpeLP5IoWj6S9SlYBsMh4gv9fFPRV+wYXEMa1u5qt6d2bSS0uRQc7p8P6D4Vi6ajmAd5HBCZsgVm5r/1I4BxnI4oJFEP+cyMqVgyxkcsAiiA3lJxrrbbS3NqFtKFyZehAWRCnQs1t6OhzaLuls1SeITGSLIiyIOmcUHNnCgijiRsGRLSyot5j/VbbpZ1F7g83U8UwTvLq+p9LjM0VCPWYNqWGa4MPTC0UTJ+RxO7Ry0eluMmVcYUG9dY0+TinTc7vkarFTZjtI8fkBrT5yZFdCWBAtz2/A1t87tk6J1DnNTvkosxNky/4OYUH0c78Fn+vyyjl1D6VoZSPHml0OS7uEiXKXC3yeF0ch4RyWTQbNKjdcmSyCOGOiWeUCWVzdPVuZQCc+PtolnIMMzq6etQ4mFwNCK4l3kcGJunQSwbLXhv8JdXUvO0pQdpSg7ChB2VGCsqMEZUcJyo61BYnoHfrDu/aEOYuqAAAAAElFTkSuQmCC",mode:"widthFix"}),R(a,{class:"goods-list-title"},{default:U((()=>[R(a,{class:"goods-list-main-title"},{default:U((()=>[W(J(e.name_text),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),R(b,{align:"right",width:"140"},{default:U((()=>[R(a,{class:"price-colum"},{default:U((()=>[R(a,{class:"price-table-sub"},{default:U((()=>[W(J(Z(oe)(e.price)),1)])),_:2},1024),R(a,{class:"price-table-main"},{default:U((()=>[W(J(Z(se)(e.price)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),R(b,{align:"right",width:"80"},{default:U((()=>[R(a,{class:"price-table"},{default:U((()=>[W(J(e.num),1)])),_:2},1024)])),_:2},1024),R(b,{align:"right",width:"140"},{default:U((()=>[R(a,{class:"price-colum"},{default:U((()=>[R(a,{class:"price-table-sub"},{default:U((()=>[W(J(Z(oe)(e.total_price||0)),1)])),_:2},1024),R(a,{class:"price-table-main"},{default:U((()=>[W(J(Z(se)(e.total_price||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),(O(!0),X(ee,null,te(d.value,((e,t)=>(O(),L(C,{key:t},{default:U((()=>[R(b,{width:"240"},{default:U((()=>[R(a,{class:"goods-list"},{default:U((()=>{var t;return[zt("div",{class:"goods-list-image"},[R(k,{src:(null==(t=e.image)?void 0:t.file_path)||""},null,8,["src"])]),R(a,{class:"goods-list-title"},{default:U((()=>[R(a,{class:"goods-list-main-title"},{default:U((()=>[W(J(e.product_name_text),1)])),_:2},1024),e.product_attr?(O(),L(a,{key:0,class:"goods-list-sub-title"},{default:U((()=>[W(J(e.product_attr),1)])),_:2},1024)):de("",!0)])),_:2},1024)]})),_:2},1024)])),_:2},1024),R(b,{align:"right",width:"140"},{default:U((()=>[R(a,{class:"price-colum"},{default:U((()=>[R(a,{class:"price-table-sub"},{default:U((()=>[W(J(Z(oe)(e.product_price)),1)])),_:2},1024),R(a,{class:"price-table-main"},{default:U((()=>[W(J(Z(se)(e.product_price)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),R(b,{align:"right",width:"80"},{default:U((()=>[R(a,{class:"price-table"},{default:U((()=>[W(J(e.total_num),1)])),_:2},1024)])),_:2},1024),R(b,{align:"right",width:"140"},{default:U((()=>[R(a,{class:"price-colum"},{default:U((()=>[R(a,{class:"price-table-sub"},{default:U((()=>[W(J(Z(oe)(e.total_product_price||0)),1)])),_:2},1024),R(a,{class:"price-table-main"},{default:U((()=>[W(J(Z(se)(e.total_product_price||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["loading","emptyText"])])),_:1})])),_:1})])),_:1}),R(a,{class:"ti-data-bottom"},{default:U((()=>[R(a,{class:"ti-data-bottom-grid"},{default:U((()=>{var e,a,n;return[R(F,{onClick:t[0]||(t[0]=e=>w())},{default:U((()=>[W(J(Z(Y)("退出")),1)])),_:1}),30==(null==(e=s.value.order_status)?void 0:e.value)?(O(),L(F,{key:0,onClick:m,type:"primary"},{default:U((()=>[W(J(Z(Y)("退款")),1)])),_:1})):de("",!0),20==(null==(a=s.value.order_status)?void 0:a.value)?(O(),L(F,{key:1,onClick:p,type:"danger"},{default:U((()=>[W(J(Z(Y)("删除")),1)])),_:1})):de("",!0),10==(null==(n=s.value.order_status)?void 0:n.value)?(O(),L(F,{key:2,onClick:v,type:"danger"},{default:U((()=>[W(J(Z(Y)("取消")),1)])),_:1})):de("",!0),R(F,{type:"primary",onClick:_},{default:U((()=>[W(J(Z(Y)("打印")),1)])),_:1})]})),_:1})])),_:1}),R(_h,{ref_key:"refuse",ref:o,show:n.value,"onUpdate:show":t[1]||(t[1]=e=>n.value=e),onSuccess:h},null,8,["show"]),R(I,{class:"ti-action-tips",show:i.value,"onUpdate:show":t[2]||(t[2]=e=>i.value=e),title:Z(Y)("溫馨提示"),content:Z(Y)("是否取消此訂單？"),onConfirm:g},null,8,["show","title","content"]),R(I,{class:"ti-action-tips",show:r.value,"onUpdate:show":t[3]||(t[3]=e=>r.value=e),title:Z(Y)("溫馨提示"),content:Z(Y)("是否删除此訂單？"),onConfirm:y},null,8,["show","title","content"]),R(I,{class:"ti-action-tips",show:u.value,"onUpdate:show":t[4]||(t[4]=e=>u.value=e),title:Z(Y)("溫馨提示"),content:Z(Y)("確定要打印小票嗎？"),onConfirm:D},null,8,["show","title","content"])])),_:1})])),footer:U((()=>[R(a)])),_:1},8,["title","show"])])),_:1})}}},[["__scopeId","data-v-ee1c14bf"]]),yh=T({__name:"order-select",props:{modelValue:{type:[String,Number]},localdata:{type:Array,default:()=>[]},clear:{type:Boolean,default:!0},placeholder:{type:String,default:null},placement:{type:String,default:"top"},left:{type:Number,default:0},top:{type:Number,default:0},ready:{type:Boolean,default:!1}},emits:["update:modelValue","change","size","update:ready"],setup(e,{emit:t}){const a=t,n=e,i=F(!1),r=ne((()=>({left:n.left+"px",top:n.top+"px"})));q(i,(e=>{e||je((()=>{a("update:ready",!1)}))}));const u=ne((()=>{var e;return(null==(e=n.localdata.find((e=>e.key==n.modelValue)))?void 0:e.value)||""})),s=()=>{a("update:modelValue",""),a("change",""),a("update:ready",!1)};return(t,o)=>{const l=$,c=N(M("uni-icons"),Ce),d=ae;return O(),L(l,{class:"ti-select",onClick:o[1]||(o[1]=e=>i.value=!0)},{default:U((()=>[He(t.$slots,"select",{},(()=>[R(l,{class:"ti-select-input-box"},{default:U((()=>[u.value?(O(),L(l,{key:0,class:"ti-select-input-text"},{default:U((()=>[W(J(u.value),1)])),_:1})):(O(),L(l,{key:1,class:"ti-select-placeholder"},{default:U((()=>[W(J(n.placeholder||Z(Y)("请选择")),1)])),_:1})),u.value&&n.clear?(O(),L(l,{key:2,class:"ti-select-icon",onClick:Ae(s,["stop"])},{default:U((()=>[R(c,{type:"closeempty",size:"16",color:"#999999"})])),_:1})):(O(),L(l,{key:3,class:j(["ti-select-icon ti-icon-down",{active:i.value}])},{default:U((()=>[R(c,{type:"right",size:"16",color:"#100A05"})])),_:1},8,["class"]))])),_:1})]),!0),i.value&&e.ready?(O(),L(l,{key:0,class:"ti-select-mask",onClick:o[0]||(o[0]=Ae((e=>i.value=!1),["stop"]))},{default:U((()=>[R(l,{class:"ti-select-locate",style:z(r.value)},{default:U((()=>[R(l,{class:j(["ti-select-selector",n.placement])},{default:U((()=>[R(d,{"scroll-y":""},{default:U((()=>[(O(!0),X(ee,null,te(n.localdata,(e=>(O(),L(l,{key:e.key,class:j(["ti-select-selector-item",{active:e.key==n.modelValue}]),onClick:Ae((t=>{return a("update:modelValue",n=e),a("change",n),a("update:ready",!1),void(i.value=!1);var n}),["stop"])},{default:U((()=>[R(l,{class:"ti-select-selector-item-text"},{default:U((()=>[W(J(Z(Y)(e.value)),1)])),_:2},1024),e.value==n.modelValue?(O(),L(l,{key:0,class:"ti-select-selector-item-icon"},{default:U((()=>[R(c,{type:"checkmarkempty",size:"16",color:"#FFBE00"})])),_:1})):de("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},8,["class"])])),_:1},8,["style"])])),_:1})):de("",!0)])),_:3})}}},[["__scopeId","data-v-873ce65d"]]),Dh=T({__name:"index",setup(e){const t=Oe(),{pathName:a}=Se(t),{allPermission:n}=Se(Be()),i=F(0),r=F(),u=F(),s=F(-1),o=F(!1),l=F(!1),c=F(!1),d=F(!1),f=F(!1),h=F(!1),p=F(!1),v=F({}),m=F(!1),_=F({}),g=F(),y=F(""),D=F("");var w={};const b=F([]),C=F(0),A=F(0),E=F(!1),I=(e,t)=>{s.value=t;const a=`#more${s.value}`;qe().in(this).select(a).boundingClientRect((e=>{C.value=e.left,A.value=e.top+e.height,E.value=!0})).exec();let i=[];[{permission:"cashier_store_order_print",key:"",value:"打印小票",action:"print"},{permission:"cashier_store_order_print_invoice",key:30,value:"发票",action:"print_invoice"},{permission:"cashier_store_order_reverse_settle",key:30,value:"反结账",action:"reverse_settle",hide_reverse:!0}].map((t=>{var a;if(n.value.includes(t.permission)&&((null==(a=e.order_status)?void 0:a.value)==t.key||!t.key)){if(e.hide_reverse_settle&&t.hide_reverse==e.hide_reverse_settle)return t;i.push(t)}return e})),b.value=i},T=e=>{let t=[];return[{permission:"cashier_store_order_print",key:"",value:"打印小票",action:"print"},{permission:"cashier_store_order_print_invoice",key:30,value:"打印发票",action:"print_invoice"},{permission:"cashier_store_order_reverse_settle",key:30,value:"反结账",action:"reverse_settle",hide_reverse:!0}].map((a=>{var i;if(n.value.includes(a.permission)&&((null==(i=e.order_status)?void 0:i.value)==a.key||!a.key)){if(e.hide_reverse_settle&&a.hide_reverse==e.hide_reverse_settle)return a;t.push(a)}return a})),t.length>0},S=F({eat_type:null,time_type:1,time:null,dataType:0,search:null,order_type:0,page:1,list_rows:6,search:null}),B=F([]),P=F([]),z=()=>{P.value=[{name:Y("今天"),value:"1"},{name:Y("昨天"),value:"2"},{name:Y("7天"),value:"3"},{name:Y("全部"),value:"0"}],B.value=[{name_text:Y("全部"),number:0,category_id:0},{name_text:Y("待付款"),number:0,category_id:1},{name_text:Y("已取消"),number:0,category_id:3},{name_text:Y("已完成"),number:0,category_id:2}]};z();const q=F([{value:20,text:Y("收银订单")},{value:10,text:Y("桌台订单")}]),V=F([]),K=e=>{S.value.dataType=e,S.value.page=1,be()},Q=e=>{S.value.time_type=e,S.value.page=1,be()},ne=e=>{y.value=e},re=e=>{D.value=e},ue=e=>{S.value.page=e.current,be()},ce=e=>{"print_invoice"==e.action?me(V.value[s.value]):"print"==e.action?ye(V.value[s.value]):"reverse_settle"==e.action&&he(V.value[s.value])},fe=async()=>{try{const t=await(e={order_id:w.order_id},k("order.order/printInvoice",e));uni.showToast({title:t.msg,icon:"none"}),h.value=!1}catch(t){}var e},he=async e=>{var t,a,n,i,r;v.value=e;try{const u=await(r=e.order_id,x("order.order/reverseSettle",{order_id:r}));m.value=!0,_.value=u.data,(null==(t=_.value)?void 0:t.tables)&&(null==(a=_.value)?void 0:a.tables.length)>0&&(g.value=null==(i=null==(n=_.value)?void 0:n.tables[0])?void 0:i.table_id)}catch(u){}},pe=async()=>{var e,t;const n={sign:_.value.sign};if((null==(e=_.value)?void 0:e.tables)&&(null==(t=_.value)?void 0:t.tables.length)>0){if(!g.value)return uni.showToast({title:Y("请选择其他桌台打开"),icon:"none"});n.new_table_id=g.value}try{const e=await function(e){return k("order.order/reverseSettle",e)}(n);e.data.table_id?(et(e.data.table_id),setTimeout((()=>{a.value="desk",qt("reDesk")}),300)):e.data.order_id&&(le(e.data.order_id),setTimeout((()=>{a.value="index",qt("reIndex")}),300)),m.value=!1,be(),setTimeout((()=>{uni.showToast({title:e.msg,icon:"none"})}),200)}catch(i){}},ve=async()=>{const e={order_id:w.order_id};try{const t=await Kn(e);setTimeout((()=>{uni.showToast({title:t.msg,icon:"none"})}),200),1==t.code&&(f.value=!1)}catch(t){}},me=e=>{h.value=!0,w=e},ye=e=>{f.value=!0,w=e},De=async()=>{const e={order_id:w.order_id};try{const t=await Vn(e);setTimeout((()=>{uni.showToast({title:t.msg,icon:"none"})}),200),1==t.code&&(d.value=!1,be())}catch(t){}},we=async()=>{const e={order_id:w.order_id};try{const t=await qn(e);setTimeout((()=>{uni.showToast({title:t.msg,icon:"none"})}),200),1==t.code&&(c.value=!1,be())}catch(t){}},be=async()=>{var e={...S.value},t=[0,0];y.value&&(t[0]=y.value),D.value&&(t[1]=D.value),0===t[0]&&0===t[1]||(e.time=t),p.value=!0;try{const t=await function(e){return k("order.order/index",e,{isLoading:!1})}(e);V.value=t.data.list.data,i.value=t.data.list.total,B.value[0].number=t.data.info.all,B.value[1].number=t.data.info.pendingNum,B.value[2].number=t.data.info.cancelNum,B.value[3].number=t.data.info.completeNum}catch(a){}finally{p.value=!1}};return(n.value||[]).includes("cashier_store_order")&&be(),Ue("langChange",(()=>{z(),be()})),Ue("orderRefresh",(()=>{be()})),(e,t)=>{const a=$,n=Vt,s=N(M("uni-data-select"),dh),y=N(M("ti-button"),G),D=N(M("uni-td"),Lt),k=N(M("uni-tr"),Ut),x=N(M("ti-loading"),ie),F=N(M("uni-table"),Rt),z=N(M("uni-pagination"),vh),le=N(M("ti-modal"),H),he=ae,me=_e("permission");return O(),L(a,{class:"ti-order-container"},{default:U((()=>[R(mh,{list:B.value,"onUpdate:list":t[0]||(t[0]=e=>B.value=e),onMenuClick:K},null,8,["list"]),R(a,{class:"ti-order-container-option"},{default:U((()=>[R(jt,{list:P.value,"onUpdate:list":t[1]||(t[1]=e=>P.value=e),onOutput:Q},null,8,["list"]),R(a,{class:"date-picker"},{default:U((()=>[R($t,{onStartDateChange:ne,onEndDateChange:re})])),_:1}),R(a,{class:"date-order-input-item"},{default:U((()=>[R(n,{class:"date-order-input",modelValue:S.value.search,"onUpdate:modelValue":t[2]||(t[2]=e=>S.value.search=e),placeholder:Z(Y)("訂單號")},null,8,["modelValue","placeholder"])])),_:1}),R(a,{class:"date-select-type"},{default:U((()=>[R(s,{modelValue:S.value.eat_type,"onUpdate:modelValue":t[3]||(t[3]=e=>S.value.eat_type=e),localdata:q.value,placeholder:Z(Y)("所有類型"),clear:!0},null,8,["modelValue","localdata","placeholder"])])),_:1}),R(a,{class:"date-search-confirm"},{default:U((()=>[R(y,{class:"date-search-confirm-button",type:"primary",onClick:t[4]||(t[4]=e=>(S.value.page=1,be()))},{default:U((()=>[W(J(Z(Y)("查询")),1)])),_:1})])),_:1})])),_:1}),R(F,{class:"table-body",ref:"table",border:"",stripe:"",emptyText:Z(Y)("暂无更多数据")},{default:U((()=>[R(k,{class:"table-header"},{default:U((()=>[R(D,{width:"130",align:"left"},{default:U((()=>[W(J(Z(Y)("訂單類型")),1)])),_:1}),R(D,{width:"120",align:"left"},{default:U((()=>[W(J(Z(Y)("桌號/序號")),1)])),_:1}),R(D,{width:"160",align:"left"},{default:U((()=>[W(J(Z(Y)("訂單號")),1)])),_:1}),R(D,{width:"100",align:"left"},{default:U((()=>[W(J(Z(Y)("狀態")),1)])),_:1}),R(D,{width:"150",align:"left"},{default:U((()=>[W(J(Z(Y)("支付時間")),1)])),_:1}),R(D,{width:"140",align:"left"},{default:U((()=>[W(J(Z(Y)("訂單金額")),1)])),_:1}),R(D,{width:"140",align:"left"},{default:U((()=>[W(J(Z(Y)("实付金额")),1)])),_:1}),R(D,{width:"100",align:"left"},{default:U((()=>[W(J(Z(Y)("支付方式")),1)])),_:1}),R(D,{width:"280",align:"left"},{default:U((()=>[W(J(""))])),_:1})])),_:1}),(O(!0),X(ee,null,te(V.value,((e,n)=>(O(),L(k,{key:n},{default:U((()=>[R(D,{align:"left"},{default:U((()=>[R(a,{class:"order-table-cell"},{default:U((()=>[W(J(e.order_source_text),1)])),_:2},1024)])),_:2},1024),R(D,{align:"left"},{default:U((()=>[W(J(e.table_no||e.callNo),1)])),_:2},1024),R(D,{align:"left"},{default:U((()=>[W(J(e.order_no),1)])),_:2},1024),R(D,{align:"left"},{default:U((()=>[W(J(e.order_status.text),1)])),_:2},1024),R(D,{align:"left"},{default:U((()=>[W(J(e.pay_time_text),1)])),_:2},1024),R(D,{align:"left"},{default:U((()=>[R(a,{class:"date-order-price-item"},{default:U((()=>[R(a,{class:"date-order-price-main"},{default:U((()=>[W(J(Z(se)(e.order_price)),1)])),_:2},1024),R(a,{class:"date-order-price-sub"},{default:U((()=>[W(J(Z(oe)(e.order_price)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),R(D,{align:"left"},{default:U((()=>[R(a,{class:"date-order-price-item"},{default:U((()=>[R(a,{class:"date-order-price-main"},{default:U((()=>[W(J(10==e.pay_status.value?"-":Z(se)(null==e?void 0:e.actual_receive_price)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),R(D,{align:"left"},{default:U((()=>[W(J(10==e.pay_status.value?"-":e.pay_type.text.length>8?e.pay_type.text.slice(0,8)+"...":e.pay_type.text),1)])),_:2},1024),R(D,{align:"left"},{default:U((()=>[R(a,{class:"edit-buttons"},{default:U((()=>{var i,s,o;return[ge((O(),L(y,{class:"function-buttons",onClick:t=>(e=>{var t;null==(t=r.value)||t.showDetailWithData(e)})(e.order_id),type:"primary"},{default:U((()=>[W(J(Z(Y)("詳情")),1)])),_:2},1032,["onClick"])),[[me,["cashier_store_order_detail"]]]),30==(null==(i=e.order_status)?void 0:i.value)?ge((O(),L(y,{key:0,class:"function-buttons margin",onClick:t=>(e=>{var t;null==(t=u.value)||t.getOrderData(e)})(e),type:"primary"},{default:U((()=>[W(J(Z(Y)("退款")),1)])),_:2},1032,["onClick"])),[[me,["cashier_store_order_refund"]]]):de("",!0),20==(null==(s=e.order_status)?void 0:s.value)?ge((O(),L(y,{key:1,class:"function-buttons margin",onClick:t=>{return a=e,d.value=!0,void(w=a);var a},type:"danger"},{default:U((()=>[W(J(Z(Y)("删除")),1)])),_:2},1032,["onClick"])),[[me,["cashier_store_order_delete"]]]):de("",!0),10==(null==(o=e.order_status)?void 0:o.value)?ge((O(),L(y,{key:2,class:"function-buttons margin",onClick:t=>{return a=e,c.value=!0,void(w=a);var a},type:"danger"},{default:U((()=>[W(J(Z(Y)("取消")),1)])),_:2},1032,["onClick"])),[[me,["cashier_store_order_cancel"]]]):de("",!0),T(e)?(O(),L(a,{key:3,id:"more"+n},{default:U((()=>[R(yh,{localdata:b.value,ready:E.value,"onUpdate:ready":t[5]||(t[5]=e=>E.value=e),top:A.value,left:C.value,onChange:ce},{select:U((()=>[R(y,{class:"function-buttons margin",onClick:t=>I(e,n),type:"primary"},{default:U((()=>[W(J(Z(Y)("更多")),1)])),_:2},1032,["onClick"])])),_:2},1032,["localdata","ready","top","left"])])),_:2},1032,["id"])):de("",!0)]})),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),p.value?(O(),L(a,{key:0,class:"ti-table-mask"},{default:U((()=>[R(x)])),_:1})):de("",!0)])),_:1},8,["emptyText"]),R(a,{class:"page-control"},{default:U((()=>[R(z,{current:S.value.page,title:"",showIcon:!0,"page-size":S.value.list_rows,total:i.value,onChange:ue},null,8,["current","page-size","total"])])),_:1}),R(gh,{ref_key:"orderDetail",ref:r,show:o.value,"onUpdate:show":t[6]||(t[6]=e=>o.value=e)},null,8,["show"]),R(_h,{ref_key:"refuse",ref:u,show:l.value,"onUpdate:show":t[7]||(t[7]=e=>l.value=e),onSuccess:be},null,8,["show"]),R(le,{class:"ti-action-tips",show:c.value,"onUpdate:show":t[8]||(t[8]=e=>c.value=e),title:Z(Y)("溫馨提示"),content:Z(Y)("是否取消此訂單？"),onConfirm:we},null,8,["show","title","content"]),R(le,{class:"ti-action-tips",show:d.value,"onUpdate:show":t[9]||(t[9]=e=>d.value=e),title:Z(Y)("溫馨提示"),content:Z(Y)("是否删除此訂單？"),onConfirm:De},null,8,["show","title","content"]),R(le,{class:"ti-action-tips",show:f.value,"onUpdate:show":t[10]||(t[10]=e=>f.value=e),title:Z(Y)("溫馨提示"),content:Z(Y)("確定要打印小票嗎？"),onConfirm:ve},null,8,["show","title","content"]),R(le,{class:"ti-action-tips",show:h.value,"onUpdate:show":t[11]||(t[11]=e=>h.value=e),title:Z(Y)("打印发票"),content:Z(Y)("确定要打印发票吗？"),onConfirm:fe},null,8,["show","title","content"]),R(le,{class:"ti-action-tips ti-re-order",show:m.value,"onUpdate:show":t[12]||(t[12]=e=>m.value=e),title:Z(Y)("反结账"),onConfirm:pe},{content:U((()=>[R(a,{class:"ti-dialog-content"},{default:U((()=>{var e,t;return[R(a,{class:"ti-cancel-title",style:{"text-align":"left"}},{default:U((()=>{var e,t;return[W(J(1==(null==(e=_.value)?void 0:e.is_occupy)?null==(t=_.value)?void 0:t.info:Z(Y)("是否将订单恢复为反结账？")),1)]})),_:1}),R(a,{class:"ti-cancel-order"},{default:U((()=>[R(a,{class:"ti-cancel-order-item"},{default:U((()=>[R(a,{class:"ti-cancel-order-label"},{default:U((()=>[W(J(Z(Y)("订单号")),1)])),_:1}),R(a,{class:"ti-cancel-order-input"},{default:U((()=>{var e;return[W(J(null==(e=v.value)?void 0:e.order_no),1)]})),_:1})])),_:1}),R(a,{class:"ti-cancel-order-item"},{default:U((()=>[R(a,{class:"ti-cancel-order-label"},{default:U((()=>[W(J(Z(Y)("支付方式")),1)])),_:1}),R(a,{class:"ti-cancel-order-input"},{default:U((()=>{var e,t;return[W(J(10==(null==(e=v.value)?void 0:e.pay_status.value)?"-":null==(t=v.value)?void 0:t.pay_type.text),1)]})),_:1})])),_:1}),R(a,{class:"ti-cancel-order-item"},{default:U((()=>[R(a,{class:"ti-cancel-order-label"},{default:U((()=>[W(J(Z(Y)("订单金额")),1)])),_:1}),R(a,{class:"ti-cancel-order-input"},{default:U((()=>{var e;return[R(a,null,{default:U((()=>{var e;return[W(J(Z(se)(null==(e=v.value)?void 0:e.order_price)),1)]})),_:1}),(null==(e=v.value)?void 0:e.refund_money)>0?(O(),L(a,{key:0,class:"ti-cancel-order-input-red"},{default:U((()=>{var e;return[W(" ("+J(Z(Y)("已退款:"))+J(Z(se)(null==(e=v.value)?void 0:e.refund_money))+") ",1)]})),_:1})):de("",!0)]})),_:1})])),_:1}),R(a,{class:"ti-cancel-order-item"},{default:U((()=>[R(a,{class:"ti-cancel-order-label"},{default:U((()=>[W(J(Z(Y)("实付金额")),1)])),_:1}),R(a,{class:"ti-cancel-order-input"},{default:U((()=>{var e,t;return[W(J(10==(null==(e=v.value)?void 0:e.pay_status.value)?"-":Z(se)(null==(t=v.value)?void 0:t.actual_receive_price)),1)]})),_:1})])),_:1})])),_:1}),(null==(e=_.value)?void 0:e.tables)&&(null==(t=_.value)?void 0:t.tables.length)>0?(O(),L(he,{key:0,"scroll-y":""},{default:U((()=>[R(a,{class:"ti-cancel-list"},{default:U((()=>{var e;return[(O(!0),X(ee,null,te(null==(e=_.value)?void 0:e.tables,(e=>(O(),L(a,{key:e.id,class:j(["ti-cancel-item",{active:g.value==e.table_id}]),onClick:t=>g.value=e.table_id},{default:U((()=>[W(J(null==e?void 0:e.table_no),1)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):de("",!0)]})),_:1})])),_:1},8,["show","title"])])),_:1})}}},[["__scopeId","data-v-fc5283ef"]]),wh=T({__name:"ti-text",props:{content:{type:[String,Number],default:""}},setup(e){const t=e,a=e=>{let a=t.content,n="",i="";if(a){let e=3;a.length<6&&(e=2),a.length>12&&(e=6),i=a.substring(0,a.length-e),n=a.substring(a.length-e)}return 1==e?a:2==e?i:3==e?n:void 0};return(e,t)=>{const n=$;return O(),L(n,{class:"omitText"},{default:U((()=>[zt("span",{class:"text-front"},J(a(2)),1),zt("span",{class:"text-after"},J(a(3)),1)])),_:1})}}},[["__scopeId","data-v-25a40c96"]]),bh=""+new URL("icon-check-06f9d0e2.svg",import.meta.url).href,Ch=""+new URL("icon-check-some-f04a1061.svg",import.meta.url).href,Ah=""+new URL("icon-search-734821ba.svg",import.meta.url).href,kh=""+new URL("icon_transfer_right-e4616c28.svg",import.meta.url).href,xh=""+new URL("icon_transfer_left-e969e115.svg",import.meta.url).href,Eh=T({__name:"ti-transfer",emits:["info"],setup(e,{expose:t,emit:a}){const n=a,i=Kt(),{languageValue:r}=Se(i),u=Be(),s=F([]),o=F([]),l=F([]),c=F([]),d=F([]),f=F([]),h=F([]),p=F([]),v=F({is_show_sold_out:0,default_language:!1,sold_out_data:[]}),m=F({on_sale_search:"",on_sale_page:1,on_sale_list_rows:50,sold_out_search:"",sold_out_page:1,sold_out_list_rows:50}),_=F(0),g=F(0),{clearGoodsData:y}=Ge(),{clearTableGoodsData:D}=Xe(),w=()=>d.value.length>0&&d.value.length==l.value.length?1:d.value.length>0?0:-1,b=()=>f.value.length>0&&f.value.length==c.value.length?1:f.value.length>0?0:-1,C=e=>{e?1==w()?A(!0,!1):A(!0,!0):1==b()?A(!1,!1):A(!1,!0)},A=(e,t)=>{e?d.value=t?d.value=[].concat(l.value):[]:f.value=t?f.value=[].concat(c.value):[]},k=e=>{e?m.value.on_sale_page=1:m.value.sold_out_page=1,E()},x=e=>{if(e){if(m.value.on_sale_page>=_.value)return;m.value.on_sale_page++}else{if(m.value.sold_out_page>=g.value)return;m.value.sold_out_page++}E()},E=async(e=!0)=>{m.value.on_sale_search?m.value.on_sale_list_rows=200:m.value.on_sale_list_rows=50,m.value.sold_out_search?m.value.sold_out_list_rows=200:m.value.on_sale_list_rows=50;const t={...m.value};e&&mt({title:Y("加载中...")});try{const e=await Ht(t);1==e.data.on_sale_list.current_page?s.value=e.data.on_sale_list.data:s.value=s.value.concat(e.data.on_sale_list.data),_.value=e.data.on_sale_list.last_page,1==e.data.sold_out_list.current_page?o.value=e.data.sold_out_list.data:o.value=o.value.concat(e.data.sold_out_list.data),g.value=e.data.sold_out_list.last_page,n("info",e.data.version),I()}catch(Oc){}finally{_t()}},I=()=>{l.value=s.value.filter((e=>-1==h.value.findIndex((t=>t.product_id==e.product_id&&t.product_sku_id==e.product_sku_id)))),l.value=l.value.concat(p.value),c.value=o.value.filter((e=>-1==p.value.findIndex((t=>t.product_id==e.product_id&&t.product_sku_id==e.product_sku_id)))),c.value=c.value.concat(h.value),l.value=l.value.filter((e=>e.product_name_text.includes(m.value.on_sale_search))),c.value=c.value.filter((e=>e.product_name_text.includes(m.value.sold_out_search)))};return E(),t({setSaleList:async(e,t,a)=>{v.value.default_language=t,v.value.is_show_sold_out=a,v.value.sold_out_data=c.value,v.value.device_remark=e;const n={...v.value};try{const e=await Wt(n);uni.showToast({title:e.msg,icon:"none"}),1==e.code&&(h.value=[],p.value=[],setTimeout((()=>{r.value=v.value.default_language,Jt(v.value.default_language),u.getUserInfo(!0,!1),E(!1),y(),D(!0),qt("langChange")}),300))}catch(Oc){}},reset:()=>{m.value={on_sale_search:"",on_sale_page:1,on_sale_list_rows:50,sold_out_search:"",sold_out_page:1,sold_out_list_rows:50},f.value=[],d.value=[],h.value=[],p.value=[],E()}}),(e,t)=>{const a=Te,n=ce,i=$,r=N(M("ti-input"),V),u=N(M("ti-text"),wh),s=N(M("ti-empty-data"),re),o=ae;return O(),L(i,{class:"ti-transfer"},{default:U((()=>[R(i,{class:"ti-transfer-unselect"},{default:U((()=>[R(i,{class:"ti-transfer-title-view",onClick:t[0]||(t[0]=e=>C(!0))},{default:U((()=>[1==w()?(O(),L(a,{key:0,class:"ti-transfer-check select",src:bh})):0==w()?(O(),L(a,{key:1,class:"ti-transfer-check select",src:Ch})):(O(),L(a,{key:2,class:"ti-transfer-check"})),R(n,{class:"ti-transfer-title"},{default:U((()=>[W(J(Z(Y)("在售中状态")),1)])),_:1})])),_:1}),R(i,{class:"ti-transfer-list"},{default:U((()=>[R(r,{class:"ti-transfer-search",popKeyboard:!0,disabled:!1,modelValue:m.value.on_sale_search,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value.on_sale_search=e),placeholder:Z(Y)("請輸入商品名稱"),onConfirm:t[2]||(t[2]=e=>k(!0))},{prefix:U((()=>[R(a,{class:"search-icon",src:Ah})])),suffix:U((()=>[R(i)])),_:1},8,["modelValue","placeholder"]),R(o,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:t[3]||(t[3]=e=>x(!0))},{default:U((()=>[(O(!0),X(ee,null,te(l.value,((e,t)=>(O(),L(i,{class:"ti-transfer-list-item",key:t,onClick:t=>(e=>{const t=d.value.findIndex((t=>{if(t.product_id==e.product_id&&t.product_sku_id==e.product_sku_id)return!0}));-1==t?d.value.push(e):d.value.splice(t,1)})(e)},{default:U((()=>[R(i,{class:"ti-transfer-list-item-box"},{default:U((()=>[-1!=d.value.findIndex((t=>t.product_id==e.product_id&&t.product_sku_id==e.product_sku_id))?(O(),L(a,{key:0,class:"ti-transfer-check select",src:bh})):(O(),L(a,{key:1,class:"ti-transfer-check"})),R(i,{class:"ti-transfer-list-item-title"},{default:U((()=>[R(u,{content:e.product_name_text},null,8,["content"])])),_:2},1024)])),_:2},1024),R(i,{class:"ti-transfer-list-item-end-title"},{default:U((()=>[R(u,{content:e.spec_name_text},null,8,["content"])])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0==l.value.length?(O(),L(s,{key:0,class:"ti-empty-data",image:""})):de("",!0)])),_:1})])),_:1})])),_:1}),R(i,{class:"ti-transfer-action-button"},{default:U((()=>[R(i,{class:j(["ti-transfer-round",{disable:0==d.value.length}]),onClick:t[4]||(t[4]=e=>(()=>{const e=[...d.value.filter((e=>{const t=p.value.findIndex((t=>t.product_id==e.product_id&&t.product_sku_id==e.product_sku_id));return-1==t||(p.value.splice(t,1),!1)})),...h.value];h.value=Array.from(new Set(e.map((e=>JSON.stringify(e))))).map((e=>JSON.parse(e))),d.value=[],I()})())},{default:U((()=>[R(a,{class:"ti-transfer-image",src:kh})])),_:1},8,["class"]),R(i,{class:j(["ti-transfer-round",{disable:0==f.value.length}]),onClick:t[5]||(t[5]=e=>(()=>{const e=[...f.value.filter((e=>{const t=h.value.findIndex((t=>t.product_id==e.product_id&&t.product_sku_id==e.product_sku_id));return-1==t||(h.value.splice(t,1),!1)})),...p.value];p.value=Array.from(new Set(e.map((e=>JSON.stringify(e))))).map((e=>JSON.parse(e))),f.value=[],I()})())},{default:U((()=>[R(a,{class:"ti-transfer-image",src:xh})])),_:1},8,["class"])])),_:1}),R(i,{class:"ti-transfer-unselect"},{default:U((()=>[R(i,{class:"ti-transfer-title-view",onClick:t[6]||(t[6]=e=>C(!1))},{default:U((()=>[1==b()?(O(),L(a,{key:0,class:"ti-transfer-check select",src:bh})):0==b()?(O(),L(a,{key:1,class:"ti-transfer-check select",src:Ch})):(O(),L(a,{key:2,class:"ti-transfer-check"})),R(n,{class:"ti-transfer-title"},{default:U((()=>[W(J(Z(Y)("已售罄状态")),1)])),_:1})])),_:1}),R(i,{class:"ti-transfer-list"},{default:U((()=>[R(r,{class:"ti-transfer-search",popKeyboard:!0,disabled:!1,modelValue:m.value.sold_out_search,"onUpdate:modelValue":t[7]||(t[7]=e=>m.value.sold_out_search=e),placeholder:Z(Y)("請輸入商品名稱"),onConfirm:t[8]||(t[8]=e=>k(!1))},{prefix:U((()=>[R(a,{class:"search-icon",src:Ah})])),suffix:U((()=>[R(i)])),_:1},8,["modelValue","placeholder"]),R(o,{class:"ti-scroll","scroll-y":"","lower-threshold":20,onScrolltolower:t[9]||(t[9]=e=>x(!1))},{default:U((()=>[(O(!0),X(ee,null,te(c.value,((e,t)=>(O(),L(i,{class:"ti-transfer-list-item",key:t,onClick:t=>(e=>{const t=f.value.findIndex((t=>{if(t.product_id==e.product_id&&t.product_sku_id==e.product_sku_id)return!0}));-1==t?f.value.push(e):f.value.splice(t,1)})(e)},{default:U((()=>[R(i,{class:"ti-transfer-list-item-box"},{default:U((()=>[-1!=f.value.findIndex((t=>t.product_id==e.product_id&&t.product_sku_id==e.product_sku_id))?(O(),L(a,{key:0,class:"ti-transfer-check select",src:bh})):(O(),L(a,{key:1,class:"ti-transfer-check"})),R(i,{class:"ti-transfer-list-item-title"},{default:U((()=>[R(u,{content:e.product_name_text},null,8,["content"])])),_:2},1024)])),_:2},1024),R(i,{class:"ti-transfer-list-item-end-title"},{default:U((()=>[R(u,{content:e.spec_name_text},null,8,["content"])])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0==c.value.length?(O(),L(s,{key:0,class:"ti-empty-data",image:""})):de("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-e9cb37b5"]]),Fh=T({__name:"index",setup(e){const t=Kt(),{languageData:a,languageDefault:n}=Se(t),i=Be(),{tablet:r,device:u}=Se(i),s=F(!1),o=F([]),l=F([]),c=F(""),d=F(""),f=F(),h=F({is_show_sold_out:0,default_language:fe(),sold_out_data:[],device_id:u.value.device_id,device_remark:u.value.device_remark});q((()=>n.value),(()=>{fe()||(h.value.default_language=n.value)})),q((()=>r.value),(()=>{var e;h.value.is_show_sold_out=+(null==(e=r.value)?void 0:e.is_show_sold_out)||0}),{deep:!0,immediate:!0});const p=async()=>{try{await t.getList(),uni.showToast({title:Y("刷新成功"),icon:"none"})}catch(e){}},v=e=>{c.value=e.client_version||"1.0.0",d.value=e.server_version||"1.0.0"},m=()=>{var e,t;h.value.is_show_sold_out=(null==(e=r.value)?void 0:e.is_show_sold_out)||0,h.value.default_language=fe()||n.value,h.value.device_remark=u.value.device_remark,null==(t=f.value)||t.reset()},_=async()=>{var e;try{null==(e=f.value)||e.setSaleList(h.value.device_remark,h.value.default_language,h.value.is_show_sold_out)}catch(t){}finally{s.value=!1}};return Ue("settingRefresh",(()=>{m()})),Ke((()=>{t.getList()})),(e,t)=>{const n=$,i=N(M("u-switch"),Zn),r=N(M("ti-select"),Zt),u=N(M("uni-icons"),Ce),g=N(M("ti-input"),V),y=N(M("ti-button"),G),D=ae;return O(),L(n,{class:"ti-setting-container"},{default:U((()=>[R(D,{"scroll-y":""},{default:U((()=>[R(n,{class:"ti-setting-header"},{default:U((()=>[R(n,{class:"ti-setting-header-tag"}),R(n,{class:"ti-setting-header-title"},{default:U((()=>[W(J(Z(Y)("系统设置")),1)])),_:1})])),_:1}),R(n,{class:"ti-setting-content"},{default:U((()=>[R(n,{class:"ti-setting-item"},{default:U((()=>[R(n,{class:"ti-setting-item-title"},{default:U((()=>[W(J(Z(Y)("平板顯示售罄商品")),1)])),_:1}),R(i,{modelValue:h.value.is_show_sold_out,"onUpdate:modelValue":t[0]||(t[0]=e=>h.value.is_show_sold_out=e),inactiveValue:0,activeValue:1,activeColor:"#FFBE00",inactiveColor:"rgb(153,153,153,.1)",size:"20"},null,8,["modelValue"])])),_:1}),R(n,{class:"ti-setting-item"},{default:U((()=>[R(n,{class:"ti-setting-item-title"},{default:U((()=>[W(J(Z(Y)("语言")),1)])),_:1}),R(r,{modelValue:h.value.default_language,"onUpdate:modelValue":t[1]||(t[1]=e=>h.value.default_language=e),clear:!1,localdata:Z(a),placeholder:Z(Y)("请选择")},null,8,["modelValue","localdata","placeholder"]),R(n,{class:"ti-setting-refresh",onClick:p},{default:U((()=>[R(u,{class:"ti-setting-refresh-icon","custom-prefix":"iconfont",type:"icon-shuaxin",size:"18",color:"#100A05"})])),_:1})])),_:1}),R(n,{class:"ti-setting-item"},{default:U((()=>[R(n,{class:"ti-setting-item-title"},{default:U((()=>[W(J(Z(Y)("当前机器ID")),1)])),_:1}),R(g,{class:"ti-setting-item-input disable",modelValue:h.value.device_id,"onUpdate:modelValue":t[2]||(t[2]=e=>h.value.device_id=e),suffixIcon:"",placeholder:Z(Y)("机器备注")},null,8,["modelValue","placeholder"])])),_:1}),R(n,{class:"ti-setting-item"},{default:U((()=>[R(n,{class:"ti-setting-item-title"},{default:U((()=>[W(J(Z(Y)("机器备注 (非必填)")),1)])),_:1}),R(g,{class:"ti-setting-item-input",modelValue:h.value.device_remark,"onUpdate:modelValue":t[3]||(t[3]=e=>h.value.device_remark=e),suffixIcon:"",placeholder:Z(Y)("机器备注"),popKeyboard:!0,disabled:!1,maxlength:100},null,8,["modelValue","placeholder"])])),_:1}),R(n,{class:"ti-setting-transfer"},{default:U((()=>[R(n,{class:"ti-setting-transfer-title"},{default:U((()=>[W(J(Z(Y)("售罄商品顯示")),1)])),_:1}),R(Eh,{ref_key:"transfer",ref:f,selectList:o.value,unSelectList:l.value,onInfo:v},null,8,["selectList","unSelectList"])])),_:1}),R(n,{class:"ti-setting-item"},{default:U((()=>[R(n,{class:"ti-setting-item-title"},{default:U((()=>[W(J(Z(Y)("客户端版本")),1)])),_:1}),R(n,{style:{display:"block"}},{default:U((()=>[W(J(c.value),1)])),_:1})])),_:1}),R(n,{class:"ti-setting-item"},{default:U((()=>[R(n,{class:"ti-setting-item-title"},{default:U((()=>[W(J(Z(Y)("服务端版本")),1)])),_:1}),R(n,{style:{display:"block"}},{default:U((()=>[W(J(d.value),1)])),_:1})])),_:1}),R(n,{class:"ti-setting-bottom"},{default:U((()=>[R(n,{class:"ti-setting-bottom-temps"}),R(n,{class:"ti-setting-bottom-buttons"},{default:U((()=>[R(y,{onClick:m},{default:U((()=>[W(J(Z(Y)("重置")),1)])),_:1}),R(y,{type:"primary",loading:s.value,onClick:_},{default:U((()=>[W(J(Z(Y)("保存")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-707fd673"]]),Ih=T({__name:"index",setup(e){const t=Oe(),{pathName:a}=Se(t),n=Be(),{loading:i,allPermission:r,cashier:u}=Se(n),{firstLoading:s}=Se(We()),o=F(!1),l=F(),c=()=>{var e;1==(null==(e=u.value)?void 0:e.is_auto_lock_screen)&&(o.value=!1,d())},d=()=>{var e,t;1==(null==(e=u.value)?void 0:e.is_auto_lock_screen)&&(o.value?Gt():(o.value=!0,l.value&&clearTimeout(l.value),l.value=setTimeout((()=>d()),1e3*((null==(t=u.value)?void 0:t.auto_lock_screen)||300))))};return q((()=>r.value),(()=>{t.setPathName(r.value)}),{deep:!0,immediate:!0}),q((()=>{var e;return null==(e=u.value)?void 0:e.auto_lock_screen}),(()=>{c()}),{deep:!0,immediate:!0}),ut((()=>{st()})),Yt((()=>{je((()=>{_t()}))})),Ke((()=>{})),Ue("getUserInfo",(()=>{n.getUserInfo(!0)})),(e,t)=>{const n=nt("ti-layout"),r=N(M("ti-loading"),ie);return Z(i)||Z(s)?(O(),L(r,{key:1})):(O(),L(n,{key:0,onClick:c,onTouchstart:c,onTouchend:c},{default:U((()=>[ge(R(jo,null,null,512),[[at,"index"==Z(a)]]),ge(R(xl,null,null,512),[[at,"desk"==Z(a)]]),ge(R(Dh,null,null,512),[[at,"order"==Z(a)]]),ge(R(Fh,null,null,512),[[at,"setting"==Z(a)]])])),_:1}))}}},[["__scopeId","data-v-11bfbce4"]]);export{Ih as default};
