import{aL as e,aM as t,ak as a,aN as l,aO as s,aP as i,aQ as u,aR as o,aS as n,aT as r,aU as c,_ as d,n as f,p as v,q as p,y as m,C as h,D as b,t as g,L as A,N as _,x as y,ax as w,b as x,s as C,c as k,r as B,ab as I,ac as S,$ as T,k as E,l as U,aG as F,g as M,w as D,J as Q,K as N,m as Y,ae as R,E as K,aV as O,B as j,aI as G,aJ as P,G as H,e as L,aF as X,aW as V,aX as Z,aY as W,aq as z,av as q,aZ as J,z as $,V as ee,as as te,F as ae,A as le,aB as se,aC as ie,aE as ue,a_ as oe,O as ne,a$ as re,al as ce,b0 as de,b1 as fe,af as ve,b2 as pe,d as me,a as he,aa as be,W as ge,b3 as Ae,b4 as _e,b5 as ye,ah as we,b6 as xe,v as Ce,a2 as ke,b7 as Be,a5 as Ie,T as Se,b8 as Te,b9 as Ee,f as Ue,a6 as Fe,ba as Me,bb as De,bc as Qe}from"./index-5804117e.js";import{d as Ne,V as Ye,e as Re,b as Ke,a as Oe,_ as je,c as Ge}from"./ti-layout-table-list.10135a73.js";import Pe from"./components-ti-keyboard-ti-keyboard.6d6dc459.js";import{_ as He}from"./ti-button.31ea88ae.js";var Le=Date.now;var Xe=function(){try{var t=e(Object,"defineProperty");return t({},"",{}),t}catch(a){}}();const Ve=Xe;var Ze=Ve?function(e,t){return Ve(e,"toString",{configurable:!0,enumerable:!1,value:(a=t,function(){return a}),writable:!0});var a}:t;var We,ze,qe;const Je=(We=Ze,ze=0,qe=0,function(){var e=Le(),t=16-(e-qe);if(qe=e,t>0){if(++ze>=800)return arguments[0]}else ze=0;return We.apply(void 0,arguments)});var $e=Math.max;function et(e,t,u){if(!a(u))return!1;var o=typeof t;return!!("number"==o?l(u)&&s(t,u.length):"string"==o&&t in u)&&i(u[t],e)}var tt=u?u.isConcatSpreadable:void 0;function at(e){return o(e)||n(e)||!!(tt&&e&&e[tt])}function lt(e,t,a,l,s){var i=-1,u=e.length;for(a||(a=at),s||(s=[]);++i<u;){var o=e[i];t>0&&a(o)?t>1?lt(o,t-1,a,l,s):r(s,o):l||(s[s.length]=o)}return s}var st=function(e,a){return Je(function(e,t,a){return t=$e(void 0===t?e.length-1:t,0),function(){for(var l=arguments,s=-1,i=$e(l.length-t,0),u=Array(i);++s<i;)u[s]=l[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=l[s];return o[t]=a(u),function(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}(e,this,o)}}(e,a,t),e+"")}((function(e,t){if(null==e)return[];var a=t.length;return a>1&&et(e,t[0],t[1])?t=[]:a>2&&et(t[0],t[1],t[2])&&(t=[t[0]]),c(e,lt(t,1),[])}));const it=st,ut=""+new URL("notification-yellow-5a0f90af.svg",import.meta.url).href,ot=d({__name:"ti-call-toast",props:{title:{type:String,default:null},showTips:{type:Boolean,default:!1}},setup(e){const t=e;return(e,a)=>{const l=A,s=_,i=y;return t.showTips?(f(),v(i,{key:0,class:"ti-toast"},{default:p((()=>[m(l,{class:"ti-toast-image",src:ut}),m(s,{class:"ti-toast-title"},{default:p((()=>[h(b(t.title),1)])),_:1})])),_:1})):g("",!0)}}},[["__scopeId","data-v-9c80bb27"]]),nt=""+new URL("ttpos-logo-white-2695f339.svg",import.meta.url).href;const rt=d({__name:"ti-layout-head",props:{isPay:{type:Boolean,default:!1},isTableNo:{type:Boolean,default:!1},is_call_service:{type:Number,default:1}},emits:["doubleLogo"],setup(e,{expose:t,emit:a}){const l=x(),{userInfo:s}=C(l),i=k(),{tableInfo:u}=C(i),o=B(!1),n=B(!0),r=B(!1),c=B(0),d=B(),z=B(!1),q=B(0),J=e,$=B(I[S()]),ee=()=>{$.value=I[S()]},te=a,ae=()=>{te("doubleLogo")},le=async()=>{try{await(null==l?void 0:l.getUserInfo(!0)),null==i||i.getTableInfoAsync(!0),L()&&X("goodsListRefresh")}catch(e){}};T("change",(()=>{$.value=I[S()]}));const se=()=>{d.value.isShow()?d.value.close():d.value.open()},ie=B(!1),ue=e=>{ie.value||(ie.value=!0,setTimeout((()=>{ie.value=!1}),2e3),ce(e))},oe=B(!1),ne=B({table_id:"",call_type:"",shop_supplier_id:""}),re=B(),ce=async e=>{re.value=V(),ne.value.table_id=re.value.table_id,ne.value.call_type=e,ne.value.shop_supplier_id=re.value.shop_supplier_id;try{o.value=!0;await(t=ne.value,w("call.call/call",t));oe.value=!0,setTimeout((()=>{oe.value=!1}),3e3)}catch(a){}finally{o.value=!1}var t},de=B(!1),fe=B(0),ve=e=>{e.cache_id!==q.value?(q.value=e.cache_id,z.value=-1==parseInt(e.buffet.buffet_expired_time),r.value=!0,0!=e.buffet.remain_continue_time?de.value=!0:de.value=!1,c.value=e.buffet.buffet_remaining_time,fe.value=e.buffet.buffet_order_remaining_time,clearInterval(me),me=setInterval((()=>{c.value>0?(c.value--,pe.value=ge(c.value)):(pe.value="00:00:00",clearInterval(me))}),1e3),clearInterval(be),be=setInterval((()=>{fe.value>0?(fe.value--,he.value=ge(fe.value)):(he.value="00:00:00",clearInterval(be))}),1e3)):0!=e.buffet.remain_continue_time?(de.value=!0,fe.value=e.buffet.buffet_order_remaining_time):de.value=!1},pe=B("");let me;const he=B("");let be;const ge=e=>{let t=Math.floor(e/3600),a=Math.floor(e%3600/60),l=e%60;return`${Ae(t)}:${Ae(a)}:${Ae(l)}`},Ae=e=>String(e).padStart(2,"0"),_e=B(0);let ye=Date.now();const we=B(!0),xe=()=>{const e=Date.now();e-ye>1e3?_e.value=1:_e.value++,ye=e,_e.value>=10&&(new Ye,_e.value=0)};return E((()=>{T("sendHead",(e=>{ve(e)})),T("isConnect",(e=>{we.value=e}))})),U((()=>{F("sendHead"),F("isConnect")})),M((()=>{(async()=>{const e=Z();if("pages/index/opentable-index"!=e[e.length-1].route)return;const t=await W();1==t.data.buffet.is_buffet&&(q.value=t.data.cache_id,r.value=!0,c.value=t.data.buffet.buffet_remaining_time,fe.value=t.data.buffet.buffet_order_remaining_time,z.value=-1==parseInt(t.data.buffet.buffet_expired_time)),q.value=""})()})),D((()=>we.value),((e,t)=>{e&&(showNetWorkConnect.value=!0)})),t({tiCallClick:ue,showBuffet:(e,t)=>{n.value=e}}),(t,a)=>{const l=A,i=y,o=_,c=Q(N("ti-layout-language-item"),Ne),w=Q(N("ti-call-toast"),ot);return f(),v(i,{class:"ti-head",onClick:a[3]||(a[3]=e=>Y(H)(!1))},{default:p((()=>[m(i,{class:"ti-head-left"},{default:p((()=>{var e;return[m(i,{class:"ti-logo-box",onDblclick:ae},{default:p((()=>{var e,t,a,i,u,o;return[(null==(a=null==(t=null==(e=Y(s))?void 0:e.cloud_basic)?void 0:t.base)?void 0:a.brand_logo_long)?(f(),v(l,{key:0,class:"ti-logo",src:null==(o=null==(u=null==(i=Y(s))?void 0:i.cloud_basic)?void 0:u.base)?void 0:o.brand_logo_long},null,8,["src"])):"jbc"==Y(R)()?(f(),v(l,{key:1,class:"ti-logo",src:"data:image/png;base64,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"})):"ttpos"==Y(R)()?(f(),v(l,{key:2,class:"ti-logo",src:nt})):(f(),v(l,{key:3,class:"ti-logo",src:nt}))]})),_:1}),(null==(e=Y(u))?void 0:e.table_no)?(f(),v(i,{key:0,class:"ti-table-no"},{default:p((()=>{var e;return[h(b(Y(K)("桌號：")+Y(O)(null==(e=Y(u))?void 0:e.table_no,17)),1)]})),_:1})):g("",!0),n.value&&r.value&&!z.value?(f(),v(i,{key:1,class:"yx-flex-and-row"},{default:p((()=>[m(i,{class:"ti-table-no"},{default:p((()=>[h(b(Y(K)("剩餘用餐：")),1)])),_:1}),m(i,{class:"ti-table-no yx-color-red yx-margin-0 yx-padding-0"},{default:p((()=>[h(b(pe.value),1)])),_:1})])),_:1})):g("",!0),n.value&&de.value&&!z.value?(f(),v(i,{key:2,class:"yx-flex-and-row"},{default:p((()=>[m(i,{class:"ti-table-no remaining-time"},{default:p((()=>[h("("+b(Y(K)("剩餘點餐：")),1)])),_:1}),m(i,{class:"ti-table-no remaining-time yx-color-red yx-margin-0 yx-padding-0"},{default:p((()=>[h(b(he.value),1)])),_:1}),m(i,{class:"ti-table-no remaining-time yx-margin-0 yx-padding-0"},{default:p((()=>[h(")")])),_:1})])),_:1})):g("",!0),n.value&&r.value&&z.value?(f(),v(i,{key:3,class:"ti-table-no"},{default:p((()=>[h(b(Y(K)("剩餘用餐：")+Y(K)("不限制")),1)])),_:1})):g("",!0)]})),_:1}),m(i,{class:"ti-head-right"},{default:p((()=>[m(i,{class:"yx-private-box",onClick:xe}),m(i,{class:"ti-image-box",onClick:le},{default:p((()=>[m(l,{class:"ti-refresh-image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHgSURBVHgB7ZjtbcIwEIYvVf+XEbxB2aCMQDfICGwAnaDtBGEDukFgAugEsAFscD2Xs+K4iXU2diUkP9LJJLHPby7+OgAKhUKhUAigggQg4oSKmuyFbGo9urDtyLZVVW1H2us2F3p+gpxQRzOyFuUcyWrHR83PWsgJdfA+ImhD1rDp3/uReor9rM09yIH+/ANRbXS0PW0UR/LotFv+h+CN1eHeRCqg/coRfc4mmCNii51ABBzxoyM8rWDuxB6DwWJ5ONVsq9yCG8u5ggjQv6KkE+xEt4FIqO3CI/gDUoHdWqmZwg3wsFCuQUqwWxnyLD0BPAjrKS6/IQP6q0knsVSwcXaGxOB1q96TbST1pYJPXO4gPTMulaTyI8h41Q7pNHWA9DxxeYF7ALsd70tSXxph41yP5T+TI/Ycy0uk4kuR4BDntW+XwriturF8KEgJdsfAMYIEY+TuGTQkHD7JzCQ80bAQTxp+OTvDeIPUDERYn2PnEAhvzXYWsoIceIbEMsDHFPvnYNFmcatg3eEcu0zB3Ks9bWfYn2C/YjEyAQgWzNdDWYN+iRb7SahbR5PuKOkRbDKE1rm/GBE1RIs3Hk+D/kjBa2Z8GFoReEjo58/Q31y2cD3lrUNWkkKhUCgUkvAD5MmZuUxCRYMAAAAASUVORK5CYII="})])),_:1}),m(i,{class:"ti-buttons-box",onClick:[a[0]||(a[0]=j((()=>{}),["stop"])),se]},{default:p((()=>[m(i,{class:"yx-language-box",style:{position:"relative"}},{default:p((()=>[m(l,{class:"ti-pay-image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIxSURBVHgB1Va7TtxAFL0bkSZF7CZFmuwPZJ0fIKFIIiJYSJMiCY8GBIhHg4S0AtHwdI8QIFEBgn6Xl0QDuytRUNlGNDTs8gF4kGhozJyBMbZ3DKYAiSONNPLM3DP3njtnN6W/e+vRM+INPTMSEfxr7yTr5JQurq7FKB4eUd/gUJKj8QRNLa3UN3Ab5H9bB31Kp/21jPGFmrOtYo49uEAsoEF0zE5NeEC28buX/vjBiwPWsAeYnZ7wVLEoLrgM0Nz4I5YgegEVSV201rmxcTEvlw6IMZd0XSNzepIu+Zy5TKxp/Nt7TRfrGOXiAdV/a6Dc6DgdWxZtbeb9mKlgm6Kex7ZFjmPzYC49BZquUyZj0Geuz+L8nJpAbOQ3w6ZL90IQzS8tU/3XhpDIQLVSEVkO9HYLwV3GxOWQkVLk3MiwVyru39dz6raelbOzWA2wFtUNMfp7umpFti0rdBiE+P4Y5OVUxBj+O8gYRigzxhglhRRfIljOl7MKiBaEpmmUFGjbIBwudg2BOTMp+vmeQFcSByHX5F4AnfVwm971Mw7hwSRpU+iH/ar3U/PQHNtW9/MjkO8HZMEMQlZxzm+1ubvnp9ry66c40JT9XVMqZOQ4Fm0X8lTY2RNWASCjEKLmZEbMTrplErMzFWantGvzCXYt3daMses6VT3RUdVqRfywlEtF3y2DkG5r8BK2//1DW4W8UhslAbC+tuLPt3k3ie7ihAD02FhbFfOFgKAqpF79v4obedc8+SUx1RUAAAAASUVORK5CYII="}),m(o,{class:"ti-pay-text"},{default:p((()=>[h(b($.value),1)])),_:1}),m(i,{class:"ti-language-box"},{default:p((()=>[m(c,{ref_key:"refShowLanguage",ref:d,onLanguageText:ee},null,512)])),_:1})])),_:1})])),_:1}),1===e.is_call_service||"1"===e.is_call_service?G((f(),v(i,{key:0,class:"ti-buttons-box"},{default:p((()=>[J.isPay?(f(),v(i,{key:0,class:"ti-pay-box",onClick:a[1]||(a[1]=e=>ue("2"))},{default:p((()=>[m(l,{class:"ti-pay-image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEMSURBVHgB5ZXhEYIwDIWDxwBuICM4QkfQCdQJdAMdQSdQJ9ANYAPcgBFgg/qiQXNaegL1j3537wq0zaNJoUR/g7V2DK2hAsr5nvqCIENoBaX2SSomKXUFkw20h0oVdMOG0n9gE2oLJs1UUG63bOYY194AExIJnMsKhp6xHxvE6nou7VRaLmrTvJEYGfWsiqLoQp632qh8d6XgTOi4A4eXoe4kUKrTO6DwJNCkvok9A3fQ2dPPQZYekxu+FVjy09RfQe/FVkXuWlzjcgtVgyOUKMNVaINGYgoDF3uBDy167Qi1At73J0lPqevxjRSxmXEZZBSOzPnU9vsP1TQfRPZ+gm1lX7eFc/84lH6HK0WszDSg1bNEAAAAAElFTkSuQmCC"}),m(o,{class:"ti-pay-text"},{default:p((()=>[h(b(Y(K)("結賬")),1)])),_:1})])),_:1})):g("",!0),m(i,{class:"ti-call-box",onClick:a[2]||(a[2]=e=>ue("1"))},{default:p((()=>[m(l,{class:"ti-call-image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEvSURBVHgB5ZXRTcMwFEXvS+IoMT8eISOUCQgbsAHZADZINqAbICZgBMoG3YBugD+jtvB4LhUIWjd2KepHr/IUyXbusSP7GjgZGZ23RmevqyrVHQ4lY+TR6l6Kf1SZP5oC1dD3tNPcGZB6klGVZ8gM74tL28t7L0CpXnaYf0Pyxbm1sNs6E695oZoAc6cK8/zW1+kFgPgaoWK+iAeAKoSKMEI8IEoG/wxAPID8s/ozYH2AogCmyOpgABLVIlZEbRBgtf+BBtEA1EanV4MAaamxrzhtNu02ZsJbj3yQEp4NA9SyA/vDyyvmCd7S8e9mb9gZpUbI3O+SGPjMJCla7yxZJZOslKfS9izmU9svJziGKGSQxLZLyxu4aHYHkF3Rg+3nHQ4lc5aNv65MnXU4GX0AyjBH7Mx/5MAAAAAASUVORK5CYII="}),m(o,{class:"ti-call-text"},{default:p((()=>[h(b(Y(K)("呼叫服務員")),1)])),_:1})])),_:1})])),_:1},512)),[[P,we.value]]):g("",!0)])),_:1}),oe.value?(f(),v(i,{key:0,class:"ti-call-toast-box"},{default:p((()=>[m(w,{showTips:oe.value,title:Y(K)("已呼叫服務員，請稍等...")},null,8,["showTips","title"])])),_:1})):g("",!0)])),_:1})}}},[["__scopeId","data-v-5437349b"]]),ct=""+new URL("icon-ring-192350e1.svg",import.meta.url).href,dt=d({__name:"diners-number",props:{show:{type:Boolean,default:!1},title:{type:String,default:null},placeholder:{type:String,default:null},password:{type:Boolean,default:!1},isBuffet:{type:Boolean,default:!1}},emits:["update:show","exit","confirm"],setup(e,{emit:t}){const a=x(),l=k(),{userInfo:s}=C(a),i=e,u=t,o=B({table_id:"",meal_num:"",is_buffet:i.isBuffet,buffet_ids:[],number:"",buffet_customer_type:[]}),n=B(1150),r=B(!1),c=z((()=>{var e;return((null==(e=o.value)?void 0:e.buffet_customer_type)||[]).reduce(((e,t)=>e+Number(t.num)),0)||0})),d=B(0),A=B(null),w=B(!1),I=B(""),S=B([]),T=B(!1),U=B(i.isBuffet),F=B(!1);function M(){U.value=!0,n.value=1150,o.value.number=""}function R(){U.value=!1,n.value=824,o.value.buffet_ids=[],o.value.buffet_customer_type=[]}const O=z((()=>{var e;const t=[];return null==(e=S.value)||e.map((e=>{var a;(null==(a=o.value)?void 0:a.buffet_ids.includes(e.id))&&t.push(e.name_text)})),t})),j=e=>{e&&1==T.value&&(o.value.number+=e)},G=()=>{1==T.value&&(o.value.number="")},P=()=>{G(),u("exit")},H=()=>{var e;if(U.value&&!i.password){if(!O.value||O.value.length<=0)return uni.showToast({title:K("请选择自助餐套餐"),icon:"none"});if(!o.value.buffet_customer_type||o.value.buffet_customer_type.length<=0)return uni.showToast({title:K("[{title}]暂无用户类型，请选择其他自助餐",{title:O.value[0]}),icon:"none"});let t="";if(((null==(e=o.value)?void 0:e.buffet_ids)||[]).some((e=>{var a;const l=null==(a=S.value)?void 0:a.find((t=>t.id==e));if(!l.buffetCustomerType||l.buffetCustomerType.length<=0)return t=l.name_text,!0})),t)return w.value=!0,void(I.value=t);if(!c.value)return uni.showToast({title:K("請輸入人數"),icon:"none"});if(!/^(?!0+$)\d{1,3}$/.test(c.value))return uni.showToast({title:K("用餐人數支持1-999"),icon:"none"});F.value=!0}else if(U.value||i.password)u("confirm",o.value.number,U.value&&"1"==(null==s?void 0:s.value.buffet.is_open)),o.value.number="";else{if(!o.value.number)return uni.showToast({title:K("請輸入人數"),icon:"none"});if(!/^(?!0+$)\d{1,3}$/.test(o.value.number))return uni.showToast({title:K("用餐人數支持1-999"),icon:"none"});L()}},L=async()=>{if(!r.value){o.value.meal_num=o.value.number,o.value.is_buffet=U.value?1:0,o.value.table_id=ue(),delete o.value.number;try{r.value=!0,await oe(o.value),null==l||l.openTablePage(o.value.is_buffet)}catch(e){F.value=!1,-34==e.code?u("exit"):u("exit",e)}finally{r.value=!1}}},X=()=>{!o.value.buffet_customer_type||o.value.buffet_customer_type.length<=0||(o.value.buffet_customer_type[d.value].num=0)},V=e=>{const t=o.value.buffet_customer_type[d.value].num||0;if(t<999){const a=Number(`${t}${e}`);a<999?o.value.buffet_customer_type[d.value].num=a:(o.value.buffet_customer_type[d.value].num=999,uni.showToast({title:K("用餐人數支持1-999"),icon:"none"}))}else uni.showToast({title:K("用餐人數支持1-999"),icon:"none"})};return E((()=>{setTimeout((()=>{T.value=!0}),500)})),D((()=>o.value.buffet_ids),(()=>{var e;let t=[];((null==(e=o.value)?void 0:e.buffet_ids)||[]).map((e=>{var a;const l=null==(a=S.value)?void 0:a.find((t=>t.id==e));l.buffetCustomerType&&l.buffetCustomerType.length>0&&l.buffetCustomerType.map((e=>{t.findIndex((t=>t.customer_type_id==e.customer_type_id))<0&&t.push({name_text:e.name_text,customer_type_id:e.customer_type_id,num:0})}))})),o.value.buffet_customer_type=it(t,"customer_type_id")}),{deep:!0}),D((()=>i.password),(e=>{n.value=e?824:1150})),D((()=>i.show),(async e=>{await q(),1==i.isBuffet&&i.show?(J().then((e=>{var t;if(S.value=e.data,i.isUpdate&&i.buffetIds&&i.buffetIds.length>0){const e=null==(t=S.value)?void 0:t.find((e=>e.id==i.buffetIds[0]));A.value=null==e?void 0:e.is_comb}})),e&&G(),M()):R()}),{immediate:!0}),(t,a)=>{const l=y,x=_,C=Q(N("ti-empty-data"),Re),k=ne,B=Q(N("uni-icons"),Ke),E=re,D=Q(N("ti-keyboard"),Pe),Z=Q(N("ti-input-d"),Oe),W=Q(N("ti-modal"),je);return f(),$(ae,null,[m(W,{show:i.show,isBgGray:!0,title:i.title,width:n.value,isBuffet:U.value,isCancelShow:!1,isConfirmShow:!1,onCancel:a[4]||(a[4]=e=>u("update:show",!1))},{content:p((()=>[m(l,{class:"ti-dialog-content"},{default:p((()=>{var t;return[e.password||"1"!=(null==(t=Y(s))?void 0:t.buffet.is_open)?g("",!0):(f(),v(l,{key:0,class:"ti-dinner-select"},{default:p((()=>[m(l,{class:ee(["ti-dinner-select-item",{select:U.value,unselect:!U.value}]),onClick:a[0]||(a[0]=e=>M())},{default:p((()=>[h(b(Y(K)("自助餐")),1)])),_:1},8,["class"]),m(l,{class:ee(["ti-dinner-select-item",{select:!U.value,unselect:U.value}]),onClick:a[1]||(a[1]=e=>R())},{default:p((()=>[h(b(Y(K)("非自助餐")),1)])),_:1},8,["class"])])),_:1})),U.value&&!e.password?(f(),v(l,{key:1,class:"ti-buffet-box",style:te({"grid-template-columns":i.isBuffetProduct?"1fr":""})},{default:p((()=>[i.isBuffetProduct?g("",!0):(f(),v(k,{key:0,class:"ti-buffet-scroll","scroll-y":""},{default:p((()=>[S.value&&S.value.length>0?(f(),v(l,{key:0,class:"ti-buffet-list"},{default:p((()=>[(f(!0),$(ae,null,le(S.value,(e=>(f(),v(l,{key:e.id,class:ee(["ti-buffet-item",{active:o.value.buffet_ids.includes(e.id),disabled:o.value.buffet_ids.length>0&&A.value!=e.is_comb}]),onClick:t=>(e=>{if(!(o.value.buffet_ids.length>0&&A.value!=e.is_comb))if(A.value=e.is_comb,0==A.value)o.value.buffet_ids=o.value.buffet_ids[0]!=e.id?[e.id]:[];else{const t=o.value.buffet_ids.indexOf(e.id);if(t>-1)o.value.buffet_ids.splice(t,1);else{if(o.value.buffet_ids.length>=2)return uni.showToast({title:K("最多只能选择{count}个",{count:2}),icon:"none"});o.value.buffet_ids.push(e.id)}}})(e)},{default:p((()=>[m(l,{class:"ti-buffet-name"},{default:p((()=>[h(b(e.name_text||e.name),1)])),_:2},1024),m(l,null,{default:p((()=>[m(x,{class:"ti-buffet-price"},{default:p((()=>{var t;return[h(b(Y(se)(e.buffetCustomerType?null==(t=e.buffetCustomerType[0])?void 0:t.price:0)),1)]})),_:2},1024),m(x,{class:"ti-buffet-subPrice"},{default:p((()=>{var t;return[h(b(Y(ie)(e.buffetCustomerType?null==(t=e.buffetCustomerType[0])?void 0:t.price:0)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(f(),v(C,{key:1}))])),_:1})),m(l,{style:{overflow:"hidden"}},{default:p((()=>[m(l,{class:"ti-buffet-info"},{default:p((()=>[O.value&&0!=O.value.length?(f(),$(ae,{key:1},[m(l,{class:"ti-buffet-select"},{default:p((()=>[(f(!0),$(ae,null,le(O.value,((e,t)=>(f(),v(l,{key:t,class:"ti-buffet-select-item"},{default:p((()=>[h(b(e),1)])),_:2},1024)))),128))])),_:1}),o.value.buffet_customer_type&&o.value.buffet_customer_type.length>0?(f(),$(ae,{key:0},[m(l,{class:"ti-buffet-num"},{default:p((()=>[(f(!0),$(ae,null,le(o.value.buffet_customer_type,((e,t)=>(f(),v(l,{key:e.customer_type_id,class:"ti-buffet-num-item"},{default:p((()=>[m(l,{class:"ti-buffet-num-label"},{default:p((()=>[h(b(e.name_text.length>8?e.name_text.slice(0,6)+"...":e.name_text),1)])),_:2},1024),m(l,{class:"ti-buffet-num-input"},{default:p((()=>[m(E,{class:"ti-input-minus",disabled:e.num<=0,onClick:t=>e.num--},{default:p((()=>[m(B,{"custom-prefix":"iconfont",type:"icon-minus",size:"16",color:"#FFBE00"})])),_:2},1032,["disabled","onClick"]),m(l,{class:ee(["ti-input-box",{active:d.value==t}]),onClick:e=>d.value=t},{default:p((()=>[h(b(e.num),1)])),_:2},1032,["class","onClick"]),m(E,{class:"ti-input-plus",disabled:c.value>=999,onClick:t=>e.num++},{default:p((()=>[m(B,{type:"plusempty",size:"16",color:"#FFBE00"})])),_:2},1032,["disabled","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),m(l,{class:"ti-buffet-num-total"},{default:p((()=>[m(x,null,{default:p((()=>[h(b(Y(K)("共")),1)])),_:1}),m(x,{class:"orange"},{default:p((()=>[h(b(c.value),1)])),_:1}),m(x,null,{default:p((()=>[h(b(Y(K)("人")),1)])),_:1})])),_:1})],64)):(f(),v(l,{key:1,class:"ti-buffet-num-empty"},{default:p((()=>[h(b(Y(K)("暂无可选顾客类型")),1)])),_:1}))],64)):(f(),v(l,{key:0,class:"ti-buffet-info-empty"},{default:p((()=>[h(b(Y(K)("请选择自助餐套餐")),1)])),_:1}))])),_:1}),m(l,{class:"ti-dialog-btn",style:{padding:"16px","border-radius":"10px"}},{default:p((()=>[m(D,{primaryLoading:r.value,isDoubleZero:!0,isCross:!1,isDrop:!1,onInput:V,onClear:X,onConfirm:H,onExit:P},null,8,["primaryLoading"])])),_:1})])),_:1})])),_:1},8,["style"])):g("",!0),!U.value||e.password?(f(),v(Z,{key:2,modelValue:o.value.number,"onUpdate:modelValue":a[2]||(a[2]=e=>o.value.number=e),password:i.password,placeholder:i.placeholder,focus:T.value,onClick:a[3]||(a[3]=e=>{return t="number",void(T.value="number"===t);var t})},null,8,["modelValue","password","placeholder","focus"])):g("",!0)]})),_:1})])),footer:p((()=>[!U.value||e.password?(f(),v(l,{key:0,class:"ti-dialog-footer"},{default:p((()=>[m(D,{onInput:j,onClear:G,onExit:P,onConfirm:H})])),_:1})):g("",!0)])),_:1},8,["show","title","width","isBuffet"]),m(W,{class:"ti-action-tips",show:w.value,"onUpdate:show":a[5]||(a[5]=e=>w.value=e),title:Y(K)("溫馨提示"),content:Y(K)("[{title}]暂无用户类型，请选择其他自助餐",{title:I.value}),isCancelShow:!1,onConfirm:a[6]||(a[6]=e=>w.value=!1)},null,8,["show","title","content"]),m(W,{class:"ti-dialog-buffet",show:F.value,title:Y(K)("提示"),onCancel:a[7]||(a[7]=e=>(F.value=!1,t.directGo=!1)),onConfirm:a[8]||(a[8]=e=>L())},{content:p((()=>[m(l,{class:"ti-dialog-content"},{default:p((()=>[m(k,{class:"ti-buffet-dialog-scroll","scroll-y":""},{default:p((()=>[m(l,{class:"ti-buffet-message"},{default:p((()=>[m(l,{class:"ti-buffet-case"}),m(l,{class:"ti-buffet-text"},{default:p((()=>[h(b(Y(K)("如有剩餘食物，可能產生額外費用")),1)])),_:1})])),_:1}),m(l,{class:"ti-buffet-message"},{default:p((()=>[m(l,{class:"ti-buffet-case"}),m(l,{class:"ti-buffet-text"},{default:p((()=>[h(b(Y(K)("點菜時請考慮您的飽食量，只訂購能夠完全食用的食品數量")),1)])),_:1})])),_:1}),m(l,{class:"ti-buffet-message"},{default:p((()=>[m(l,{class:"ti-buffet-case"}),m(l,{class:"ti-buffet-text"},{default:p((()=>[h(b(Y(K)("對於食品和飲品的過度點單，可能會引發額外費用")),1)])),_:1})])),_:1}),m(l,{class:"ti-buffet-message"},{default:p((()=>[m(l,{class:"ti-buffet-case"}),m(l,{class:"ti-buffet-text"},{default:p((()=>[h(b(Y(K)("如有多餘食物或飲品浪費的情況，我們可能會視情況追加費用")),1)])),_:1})])),_:1}),m(l,{class:"ti-buffet-tips"},{default:p((()=>[h(b(Y(K)("我们鼓励客人谨慎点菜，仅订购会食用完的食品，避免剩菜问题和额外费用")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title"])],64)}}},[["__scopeId","data-v-69afcee2"]]),ft=""+new URL("clear-icon-16ceeab3.png",import.meta.url).href;function vt(e){let t="";for(let a in e){t+=`${a}:${e[a]};`}return t}const pt=d({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change","keyboardheightchange"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:18},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!1},cursorSpacing:{type:Number,default:0},passwordIcon:{type:Boolean,default:!0},primaryColor:{type:String,default:"#FFBE00"},styles:{type:Object,default:()=>({color:"#100A05",backgroundColor:"#fff",disableColor:"#F7F6F6",borderColor:"#24160B26"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:"",isEnter:!1,floor:.733}),computed:{isVal(){const e=this.val;return!(!e&&0!==e)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(e){let t="";for(let a in e)e[a]&&(t+=`${a} `);return t}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled,"is-focused":this.focusShow})},inputContentStyle(){const e=this.focusShow?this.primaryColor:this.styles.borderColor;return vt({"border-color":(this.inputBorder&&this.msg?"#dd524d":e)||"#24160B26","background-color":this.disabled?this.styles.disableColor:this.styles.backgroundColor})},inputStyle(){return vt({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":16*this.floor+"px","padding-left":this.prefixIcon?"":16*this.floor+"px"})}},watch:{value(e){this.val=e},modelValue(e){this.val=e},focus(e){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",(e=>{this.localMsg=e}))},mounted(){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue||""===this.modelValue?this.val=this.modelValue:this.val=null},onClickIcon(e){this.$emit("iconClick",e)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(e){let t=e.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(t=this.trimStr(t)),"string"==typeof this.trim&&(t=this.trimStr(t,this.trim))),this.errMsg&&(this.errMsg=""),this.val=t,this.$emit("input",t),this.$emit("update:modelValue",t)},onFocus(){this.$nextTick((()=>{this.focused=!0})),this.$emit("focus",null)},_Focus(e){this.focusShow=!0,this.$emit("focus",e)},onBlur(){this.focused=!1,this.$emit("focus",null)},_Blur(e){if(e.detail.value,this.focusShow=!1,this.$emit("blur",e),!1===this.isEnter&&this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:e}=this.form;"blur"===e&&this.formItem.onFieldChange()}},onConfirm(e){this.$emit("confirm",this.val),this.isEnter=!0,this.$emit("change",this.val),this.$nextTick((()=>{this.isEnter=!1}))},onClear(e){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},onkeyboardheightchange(e){this.$emit("keyboardheightchange",e)},trimStr:(e,t="both")=>"both"===t?e.trim():"left"===t?e.trimLeft():"right"===t?e.trimRight():"start"===t?e.trimStart():"end"===t?e.trimEnd():"all"===t?e.replace(/\s+/g,""):e}},[["render",function(e,t,a,l,s,i){const u=de,o=fe,n=A,r=y;return f(),v(r,{class:ee(["uni-easyinput",{"uni-easyinput-error":i.msg}]),style:te(i.boxStyle)},{default:p((()=>[m(r,{class:ee(["uni-easyinput__content",i.inputContentClass]),style:te(i.inputContentStyle)},{default:p((()=>["textarea"===a.type?(f(),v(u,{key:0,class:ee(["uni-easyinput__content-textarea",{"input-padding":a.inputBorder}]),name:a.name,value:s.val,placeholder:a.placeholder,placeholderStyle:a.placeholderStyle,disabled:a.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:i.inputMaxlength,focus:s.focused,autoHeight:a.autoHeight,"cursor-spacing":a.cursorSpacing,onInput:i.onInput,onBlur:i._Blur,onFocus:i._Focus,onConfirm:i.onConfirm,onKeyboardheightchange:i.onkeyboardheightchange},null,8,["class","name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight","cursor-spacing","onInput","onBlur","onFocus","onConfirm","onKeyboardheightchange"])):(f(),v(o,{key:1,type:"password"===a.type?"text":a.type,class:"uni-easyinput__content-input",style:te(i.inputStyle),name:a.name,value:s.val,password:!s.showPassword&&"password"===a.type,placeholder:a.placeholder,placeholderStyle:a.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:a.disabled,maxlength:i.inputMaxlength,focus:s.focused,confirmType:a.confirmType,"cursor-spacing":a.cursorSpacing,onFocus:i._Focus,onBlur:i._Blur,onInput:i.onInput,onConfirm:i.onConfirm,onKeyboardheightchange:i.onkeyboardheightchange},null,8,["type","style","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType","cursor-spacing","onFocus","onBlur","onInput","onConfirm","onKeyboardheightchange"])),"password"===a.type&&a.passwordIcon?(f(),$(ae,{key:2},[i.isVal?(f(),v(n,{key:0,class:ee(["content-clear-icon",{"is-textarea-icon":"textarea"===a.type}]),src:s.showPassword?"../../static/eye.png":"../../static/eye-off.png",style:te({width:a.clearSize+"px",height:a.clearSize+"px"}),onClick:i.onEyes},null,8,["class","src","style","onClick"])):g("",!0)],64)):(f(),$(ae,{key:3},[a.clearable&&i.isVal&&!a.disabled&&"textarea"!==a.type?(f(),v(n,{key:0,class:ee(["content-clear-icon",{"is-textarea-icon":"textarea"===a.type}]),style:te({width:a.clearSize+"px",height:a.clearSize+"px"}),src:ft,onClick:i.onClear},null,8,["class","style","onClick"])):g("",!0)],64)),ce(e.$slots,"right",{},void 0,!0)])),_:3},8,["class","style"])])),_:3},8,["class","style"])}],["__scopeId","data-v-9cf5eec2"]]),mt=d({__name:"ti-update",props:{show:{type:Boolean,default:!1},updateInfo:{type:Object,default:()=>{}}},emits:["update:show","cancel"],setup(e,{emit:t}){const a=t,l=e,s=()=>{a("update:show",!1)},i=()=>{pe(l.updateInfo.download_url)};return(t,a)=>{var u;const o=y,n=Q(N("ti-modal"),je);return f(),v(n,{class:"ti-action-tips-update",title:t.$t("新版本"),show:l.show,cancelText:t.$t("暂不更新"),confirmText:t.$t("更新"),isCancelShow:0==(null==(u=l.updateInfo)?void 0:u.forced_update),onCancel:s,onConfirm:i},{content:p((()=>[m(o,{class:"ti-update-container"},{default:p((()=>{var a;return[m(o,{class:"ti-update-title-box"},{default:p((()=>[m(o,{class:"ti-update-title"},{default:p((()=>[h(b(t.$t("版本号")+":"),1)])),_:1}),m(o,{class:"ti-update-version"},{default:p((()=>[h(b(e.updateInfo.version_name),1)])),_:1})])),_:1}),m(o,{class:"ti-update-tips"},{default:p((()=>[h(b(t.$t("更新内容")),1)])),_:1}),ve("pre",{class:"ti-update-content"},b(null==(a=l.updateInfo)?void 0:a.update_log),1)]})),_:1})])),_:1},8,["title","show","cancelText","confirmText","isCancelShow"])}}},[["__scopeId","data-v-f967047a"]]);function ht(e){return w("base.base/verifyPassword",e)}const bt=d({__name:"ti-setting-dialog",props:{show:{type:Boolean,default:!1},serverVersionNum:{type:String,default:""}},emits:["update:show","cancel","bindSuccess"],setup(e,{emit:t}){const a=me(),l=he(),s=e,i=t;let u="",o="",n="";const r=B(),c=B({device_id:"",remark:""}),d=B(""),v=B(!1),g=B(),A=B(!1),x=B(!1),C=B({}),k=Z(),I=k[k.length-1].route,S=B(!1),T=B(""),E=async()=>{var e,t,a,l;let s="com.ttpos.menu"==u?1:2;try{const o=await(i={brand:s},w("base.base/getNewVersion",i));n<(null==(e=o.data)?void 0:e.apk_version_code)&&u==(null==(a=null==(t=o.data)?void 0:t.apk_data)?void 0:a.name)&&s==(null==(l=o.data)?void 0:l.brand)?(C.value=o.data,x.value=!0):uni.showToast({icon:"none",title:K("当前已是最新版本")})}catch(o){}var i},U=()=>{Ce("client_voice").time>Ce("server_voice").time?r.value="1"==Ce("client_voice").value:r.value="1"==Ce("server_voice").value},F=e=>{r.value=e.detail.value},M=e=>{v.value=!1,e&&(g.value=e,d.value=e.table_no)},R=async()=>{try{const e=await ke();1==parseInt(e.data.cashier.order_method.is_table_order)?setTimeout((()=>{v.value=!0}),150):uni.showToast({title:K("桌台用餐方式已关闭，请联系管理员"),icon:"none"})}catch(e){uni.showToast({title:K("查找失败"),icon:"none"})}},j=e=>{c.value.remark=e},G=async()=>{await(null==a?void 0:a.getGoodsBaseList({category_id:0},!0)),setTimeout((()=>{uni.showToast({title:K("清除成功"),icon:"none"})}),100)},P=()=>{d.value=V().table_no,g.value=V(),c.value.remark=Ce("machine_remark"),U()},H=async()=>{Ce("client_voice").value==r.value&&r.value==("1"==Ce("server_voice").value)||Be("client_voice",{value:r.value?"1":"0",time:Date.now()});try{const e=await ke();if(!g.value)return void uni.showToast({title:K("請查找桌位"),icon:"none"});1==parseInt(e.data.cashier.order_method.is_table_order)?L():uni.showToast({title:K("桌台用餐方式已关闭，请联系管理员"),icon:"none"})}catch(e){-102==e.code?uni.showToast({title:K("綁定失敗,該商家授權已過期"),icon:"none"}):uni.showToast({title:K("綁定失敗"),icon:"none"})}},L=async()=>{if(ue()===g.value.table_id&&c.value.remark==Ce("machine_remark"))return uni.showToast({title:K("绑定成功"),icon:"none"}),void i("update:show",!1);try{const e=await Ie({key:Ce("machine_id"),table_id:g.value.table_id,old_table_id:ue(),device_remark:c.value.remark,brand:Se()});c.value.remark!=Ce("machine_remark")&&Te({key:"machine_remark",data:c.value.remark}),"pages/index/opentable-index"==I&&ue()!=g.value.table_id?(Ee(!1),setTimeout((()=>{Ue({url:"/pages/index/index",fail:e=>{}}),Fe(g.value),i("bindSuccess")}),150)):(Fe(g.value),i("bindSuccess")),uni.showToast({title:e.msg,icon:"none"}),l.clearCartData()}catch(e){uni.showToast({title:e.msg||e.errMsg,icon:"none"})}},X=()=>{x.value=!1},W=async()=>{var e;try{const t=await Me();Ee(!1),Fe(""),De(),null==(e=he())||e.clearCartData(),uni.showToast({title:t.msg,icon:"none"}),setTimeout((()=>{Ue({url:"/pages/first-binding/first-binding"})}),100)}catch(t){}};return D((()=>s.show),(e=>{A.value=e,be()?(c.value.device_id=ge(),u=Ae(),o=_e(),n=ye()):we({success:e=>{c.value.device_id=e.deviceId,u=e.appName,o=e.appVersion,n=e.appVersionCode}}),e&&(g.value=V(),d.value=g.value.table_no,c.value.remark=Ce("machine_remark"),U(),T.value=xe())})),(e,t)=>{const a=_,l=y,i=Qe,u=Q(N("ti-input"),pt),n=Q(N("ti-layout-table-list"),Ge),g=Q(N("ti-button"),He),w=Q(N("ti-modal"),je);return f(),$(ae,null,[m(w,{show:A.value,title:Y(K)("設置")},{content:p((()=>[m(l,{class:"ti-item-input"},{default:p((()=>[m(l,{class:"ti-label-box"},{default:p((()=>[m(l,{class:"ti-label-left yx-label-left"},{default:p((()=>[m(l,{class:""},{default:p((()=>[m(a,{class:"ti-label-server"},{default:p((()=>[h(b(Y(K)("当前登录")),1)])),_:1}),m(a,{class:"ti-label-server yx-label-version"},{default:p((()=>[h(b(T.value),1)])),_:1}),m(a,{class:"ti-label-server check-version",onClick:t[0]||(t[0]=e=>S.value=!0)},{default:p((()=>[h(b(Y(K)("退出")),1)])),_:1})])),_:1}),m(l,null,{default:p((()=>[m(a,{class:"ti-label-server"},{default:p((()=>[h(b(Y(K)("客戶端版本")),1)])),_:1}),m(a,{class:"ti-label-server yx-label-version"},{default:p((()=>[h(b(Y(o)),1)])),_:1}),m(a,{class:"ti-label-server check-version",onClick:E},{default:p((()=>[h(b(Y(K)("檢查新版本")),1)])),_:1})])),_:1}),m(l,null,{default:p((()=>[m(a,{class:"ti-label-server"},{default:p((()=>[h(b(Y(K)("服務端版本")),1)])),_:1}),m(a,{class:"ti-label-server yx-label-version"},{default:p((()=>[h(b(s.serverVersionNum),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),m(l,{class:"ti-item-input"},{default:p((()=>[m(l,{class:"ti-label-box"},{default:p((()=>[m(l,{class:"ti-label-left ti-label-voice"},{default:p((()=>[m(a,{class:"ti-label-server"},{default:p((()=>[h(b(Y(K)("聲音提醒")),1)])),_:1}),m(i,{checked:r.value,color:"#FFBE00",class:"voice-switch",onChange:F},null,8,["checked"])])),_:1})])),_:1})])),_:1}),m(l,{class:"ti-item-input"},{default:p((()=>[m(l,{class:"ti-label-box"},{default:p((()=>[m(l,{class:"ti-label-left"},{default:p((()=>[m(a,{class:"ti-label-server"},{default:p((()=>[h(b(Y(K)("當前機器ID")),1)])),_:1})])),_:1})])),_:1}),m(l,{class:"ti-input-box"},{default:p((()=>[m(u,{type:"text",clearable:!1,disabled:!0,value:c.value.device_id},null,8,["value"])])),_:1})])),_:1}),m(l,{class:"ti-item-input"},{default:p((()=>[m(l,{class:"ti-label-box"},{default:p((()=>[m(l,{class:"ti-label-left"},{default:p((()=>[m(a,{class:"ti-label-server"},{default:p((()=>[h(b(Y(K)("機器備註(非必填)")),1)])),_:1})])),_:1})])),_:1}),m(l,{class:"ti-input-box"},{default:p((()=>[m(u,{type:"text",value:c.value.remark,onInput:j,placeholder:Y(K)("機器備註"),clearable:!1},null,8,["value","placeholder"])])),_:1})])),_:1}),m(l,{class:"ti-item-input"},{default:p((()=>[m(l,{class:"ti-label-box"},{default:p((()=>[m(l,{class:"ti-label-left yx-label-left"},{default:p((()=>[m(l,null,{default:p((()=>[m(a,{class:"ti-label-server"},{default:p((()=>[h(b(Y(K)("当前桌位")),1)])),_:1}),m(a,{class:"ti-label-server yx-margin-l-20 yx-label-version"},{default:p((()=>[h(b(d.value?Y(O)(d.value,19):Y(K)("查找桌位")),1)])),_:1}),m(a,{class:"ti-label-table yx-margin-l-10",onClick:R},{default:p((()=>[h(b(Y(K)("查找桌位")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),m(n,{show:v.value,"onUpdate:show":t[1]||(t[1]=e=>v.value=e),onConfirm:M},null,8,["show"])])),footer:p((()=>[m(l,{class:"footer-button"},{default:p((()=>[m(g,{onClick:G},{default:p((()=>[h(b(Y(K)("清除緩存")),1)])),_:1}),m(g,{onClick:P},{default:p((()=>[h(b(Y(K)("重置")),1)])),_:1}),m(g,{type:"primary",onClick:H},{default:p((()=>[h(b(Y(K)("確定")),1)])),_:1})])),_:1})])),_:1},8,["show","title"]),m(w,{class:"ti-action-tips",show:S.value,title:Y(K)("温馨提示"),content:Y(K)("确定要退出登录吗？"),onCancel:t[2]||(t[2]=e=>S.value=!1),cancelText:Y(K)("取消"),onConfirm:W},null,8,["show","title","content","cancelText"]),m(mt,{show:x.value,"onUpdate:show":t[3]||(t[3]=e=>x.value=e),updateInfo:C.value,onCancel:X},null,8,["show","updateInfo"])],64)}}},[["__scopeId","data-v-2a3f99d1"]]),gt=d({__name:"ti-store-expire",props:{show:{type:Boolean,default:!1}},setup(e){const t=e;return(e,a)=>{const l=A,s=y,i=Q(N("ti-modal"),je);return f(),v(i,{class:"ti-action-tips",show:t.show,title:e.$t("店鋪到期"),isCancelShow:!1,isConfirmShow:!1,content:e.$t("店铺状态已到期，当前系统已锁定")},{title:p((()=>[m(s,{class:"warning-header"},{default:p((()=>[m(s,{class:"warning-image-round"},{default:p((()=>[m(l,{class:"warning-image",src:ct,mode:""})])),_:1}),m(s,{class:"warning-text"},{default:p((()=>[h(b(e.$t("店鋪到期")),1)])),_:1})])),_:1})])),_:1},8,["show","title","content"])}}},[["__scopeId","data-v-57432730"]]);export{dt as D,bt as T,ct as _,gt as a,rt as b,ht as v};
